/**
 * @sunl-fe/sunlands-live  
 * @version 1.6.0
 * @date 2019-5-22 13:56:13
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).SLIVE=t()}(this,function(){var i="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function t(e,t){return e(t={exports:{}},t.exports),t.exports}var s=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e},h=function(e){return Object(s(e))},r={}.hasOwnProperty,g=function(e,t){return r.call(e,t)},m=t(function(e){var t=e.exports={version:"2.5.6"};"number"==typeof __e&&(__e=t)}),v=t(function(e){var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)}),n=t(function(e){var t="__core-js_shared__",r=v[t]||(v[t]={});(e.exports=function(e,t){return r[e]||(r[e]=void 0!==t?t:{})})("versions",[]).push({version:m.version,mode:"pure",copyright:"© 2018 Denis Pushkarev (zloirock.ru)"})}),a=0,o=Math.random(),l=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++a+o).toString(36))},u=n("keys"),c=function(e){return u[e]||(u[e]=l(e))},d=c("IE_PROTO"),f=Object.prototype,T=Object.getPrototypeOf||function(e){return e=h(e),g(e,d)?e[d]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?f:null},p=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e},y=function(i,n,e){if(p(i),void 0===n)return i;switch(e){case 1:return function(e){return i.call(n,e)};case 2:return function(e,t){return i.call(n,e,t)};case 3:return function(e,t,r){return i.call(n,e,t,r)}}return function(){return i.apply(n,arguments)}},_=function(e){return"object"==typeof e?null!==e:"function"==typeof e},b=function(e){if(!_(e))throw TypeError(e+" is not an object!");return e},S=function(e){try{return!!e()}catch(e){return!0}},E=!S(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),k=v.document,w=_(k)&&_(k.createElement),C=function(e){return w?k.createElement(e):{}},A=!E&&!S(function(){return 7!=Object.defineProperty(C("div"),"a",{get:function(){return 7}}).a}),L=function(e,t){if(!_(e))return e;var r,i;if(t&&"function"==typeof(r=e.toString)&&!_(i=r.call(e)))return i;if("function"==typeof(r=e.valueOf)&&!_(i=r.call(e)))return i;if(!t&&"function"==typeof(r=e.toString)&&!_(i=r.call(e)))return i;throw TypeError("Can't convert object to primitive value")},I=Object.defineProperty,P={f:E?Object.defineProperty:function(e,t,r){if(b(e),t=L(t,!0),b(r),A)try{return I(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},x=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},R=E?function(e,t,r){return P.f(e,t,x(1,r))}:function(e,t,r){return e[t]=r,e},O="prototype",D=function(e,t,r){var i,n,a,o=e&D.F,s=e&D.G,l=e&D.S,u=e&D.P,c=e&D.B,d=e&D.W,h=s?m:m[t]||(m[t]={}),f=h[O],p=s?v:l?v[t]:(v[t]||{})[O];for(i in s&&(r=t),r)(n=!o&&p&&void 0!==p[i])&&g(h,i)||(a=n?p[i]:r[i],h[i]=s&&"function"!=typeof p[i]?r[i]:c&&n?y(a,v):d&&p[i]==a?function(i){var e=function(e,t,r){if(this instanceof i){switch(arguments.length){case 0:return new i;case 1:return new i(e);case 2:return new i(e,t)}return new i(e,t,r)}return i.apply(this,arguments)};return e[O]=i[O],e}(a):u&&"function"==typeof a?y(Function.call,a):a,u&&((h.virtual||(h.virtual={}))[i]=a,e&D.R&&f&&!f[i]&&R(f,i,a)))};D.F=1,D.G=2,D.S=4,D.P=8,D.B=16,D.W=32,D.U=64,D.R=128;var M=D,N=function(e,t){var r=(m.Object||{})[e]||Object[e],i={};i[e]=t(r),M(M.S+M.F*S(function(){r(1)}),"Object",i)};N("getPrototypeOf",function(){return function(e){return T(h(e))}});var F,j=m.Object.getPrototypeOf,B=e(t(function(e){e.exports={default:j,__esModule:!0}})),U=Math.ceil,H=Math.floor,G=function(e){return isNaN(e=+e)?0:(0<e?H:U)(e)},q=R,V={},W={}.toString,z=function(e){return W.call(e).slice(8,-1)},K=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==z(e)?e.split(""):Object(e)},Y=function(e){return K(s(e))},X=Math.min,Q=function(e){return 0<e?X(G(e),9007199254740991):0},J=Math.max,Z=Math.min,$=(F=!1,function(e,t,r){var i,n,a,o=Y(e),s=Q(o.length),l=(n=s,(i=G(i=r))<0?J(i+n,0):Z(i,n));if(F&&t!=t){for(;l<s;)if((a=o[l++])!=a)return!0}else for(;l<s;l++)if((F||l in o)&&o[l]===t)return F||l||0;return!F&&-1}),ee=c("IE_PROTO"),te=function(e,t){var r,i=Y(e),n=0,a=[];for(r in i)r!=ee&&g(i,r)&&a.push(r);for(;n<t.length;)g(i,r=t[n++])&&(~$(a,r)||a.push(r));return a},re="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),ie=Object.keys||function(e){return te(e,re)},ne=E?Object.defineProperties:function(e,t){b(e);for(var r,i=ie(t),n=i.length,a=0;a<n;)P.f(e,r=i[a++],t[r]);return e},ae=v.document,oe=ae&&ae.documentElement,se=c("IE_PROTO"),le=function(){},ue="prototype",ce=function(){var e,t=C("iframe"),r=re.length;for(t.style.display="none",oe.appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),ce=e.F;r--;)delete ce[ue][re[r]];return ce()},de=Object.create||function(e,t){var r;return null!==e?(le[ue]=b(e),r=new le,le[ue]=null,r[se]=e):r=ce(),void 0===t?r:ne(r,t)},he=t(function(e){var t=n("wks"),r=v.Symbol,i="function"==typeof r;(e.exports=function(e){return t[e]||(t[e]=i&&r[e]||(i?r:l)("Symbol."+e))}).store=t}),fe=P.f,pe=he("toStringTag"),ge=function(e,t,r){e&&!g(e=r?e:e.prototype,pe)&&fe(e,pe,{configurable:!0,value:t})},me={};R(me,he("iterator"),function(){return this});var ve,ye=he("iterator"),_e=!([].keys&&"next"in[].keys()),be="values",Te=function(){return this},Se=function(e,t,r,i,n,a,o){var s,l;l=t,(s=r).prototype=de(me,{next:x(1,i)}),ge(s,l+" Iterator");var u,c,d,h=function(e){if(!_e&&e in m)return m[e];switch(e){case"keys":case be:return function(){return new r(this,e)}}return function(){return new r(this,e)}},f=t+" Iterator",p=n==be,g=!1,m=e.prototype,v=m[ye]||m["@@iterator"]||n&&m[n],y=v||h(n),_=n?p?h("entries"):y:void 0,b="Array"==t&&m.entries||v;if(b&&(d=T(b.call(new e)))!==Object.prototype&&d.next&&ge(d,f,!0),p&&v&&v.name!==be&&(g=!0,y=function(){return v.call(this)}),o&&(_e||g||!m[ye])&&R(m,ye,y),V[t]=y,V[f]=Te,n)if(u={values:p?y:h(be),keys:a?y:h("keys"),entries:_},o)for(c in u)c in m||q(m,c,u[c]);else M(M.P+M.F*(_e||g),t,u);return u},Ee=(ve=!0,function(e,t){var r,i,n=s(e)+"",a=G(t),o=n.length;return a<0||o<=a?ve?"":void 0:(r=n.charCodeAt(a))<55296||56319<r||a+1===o||(i=n.charCodeAt(a+1))<56320||57343<i?ve?n.charAt(a):r:ve?n.slice(a,a+2):i-56320+(r-55296<<10)+65536});Se(String,"String",function(e){this._t=e+"",this._i=0},function(){var e,t=this._t,r=this._i;return t.length<=r?{value:void 0,done:!0}:(e=Ee(t,r),this._i+=e.length,{value:e,done:!1})});var ke=function(e,t){return{value:t,done:!!e}};Se(Array,"Array",function(e,t){this._t=Y(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,r=this._i++;return!e||e.length<=r?(this._t=void 0,ke(1)):ke(0,"keys"==t?r:"values"==t?e[r]:[r,e[r]])},"values");V.Arguments=V.Array;for(var we=he("toStringTag"),Ce="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),Ae=0;Ae<Ce.length;Ae++){var Le=Ce[Ae],Ie=v[Le],Pe=Ie&&Ie.prototype;Pe&&!Pe[we]&&R(Pe,we,Le),V[Le]=V.Array}var xe={f:he},Re=xe.f("iterator"),Oe=t(function(e){e.exports={default:Re,__esModule:!0}});e(Oe);var De=t(function(e){var r=l("meta"),t=P.f,i=0,n=Object.isExtensible||function(){return!0},a=!S(function(){return n(Object.preventExtensions({}))}),o=function(e){t(e,r,{value:{i:"O"+ ++i,w:{}}})},s=e.exports={KEY:r,NEED:!1,fastKey:function(e,t){if(!_(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!g(e,r)){if(!n(e))return"F";if(!t)return"E";o(e)}return e[r].i},getWeak:function(e,t){if(!g(e,r)){if(!n(e))return!0;if(!t)return!1;o(e)}return e[r].w},onFreeze:function(e){return a&&s.NEED&&n(e)&&!g(e,r)&&o(e),e}}}),Me=P.f,Ne=function(e){var t=m.Symbol||(m.Symbol={});"_"==e.charAt(0)||e in t||Me(t,e,{value:xe.f(e)})},Fe={f:Object.getOwnPropertySymbols},je={f:{}.propertyIsEnumerable},Be=Array.isArray||function(e){return"Array"==z(e)},Ue=re.concat("length","prototype"),He={f:Object.getOwnPropertyNames||function(e){return te(e,Ue)}},Ge=He.f,qe={}.toString,Ve="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],We={f:function(e){return Ve&&"[object Window]"==qe.call(e)?function(e){try{return Ge(e)}catch(e){return Ve.slice()}}(e):Ge(Y(e))}},ze=Object.getOwnPropertyDescriptor,Ke={f:E?ze:function(e,t){if(e=Y(e),t=L(t,!0),A)try{return ze(e,t)}catch(e){}if(g(e,t))return x(!je.f.call(e,t),e[t])}},Ye=De.KEY,Xe=Ke.f,Qe=P.f,Je=We.f,Ze=v.Symbol,$e=v.JSON,et=$e&&$e.stringify,tt="prototype",rt=he("_hidden"),it=he("toPrimitive"),nt={}.propertyIsEnumerable,at=n("symbol-registry"),ot=n("symbols"),st=n("op-symbols"),lt=Object[tt],ut="function"==typeof Ze,ct=v.QObject,dt=!ct||!ct[tt]||!ct[tt].findChild,ht=E&&S(function(){return 7!=de(Qe({},"a",{get:function(){return Qe(this,"a",{value:7}).a}})).a})?function(e,t,r){var i=Xe(lt,t);i&&delete lt[t],Qe(e,t,r),i&&e!==lt&&Qe(lt,t,i)}:Qe,ft=function(e){var t=ot[e]=de(Ze[tt]);return t._k=e,t},pt=ut&&"symbol"==typeof Ze.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof Ze},gt=function(e,t,r){return e===lt&&gt(st,t,r),b(e),t=L(t,!0),b(r),g(ot,t)?(r.enumerable?(g(e,rt)&&e[rt][t]&&(e[rt][t]=!1),r=de(r,{enumerable:x(0,!1)})):(g(e,rt)||Qe(e,rt,x(1,{})),e[rt][t]=!0),ht(e,t,r)):Qe(e,t,r)},mt=function(e,t){b(e);for(var r,i=function(e){var t=ie(e),r=Fe.f;if(r)for(var i,n=r(e),a=je.f,o=0;o<n.length;)a.call(e,i=n[o++])&&t.push(i);return t}(t=Y(t)),n=0,a=i.length;n<a;)gt(e,r=i[n++],t[r]);return e},vt=function(e){var t=nt.call(this,e=L(e,!0));return!(this===lt&&g(ot,e)&&!g(st,e))&&(!(t||!g(this,e)||!g(ot,e)||g(this,rt)&&this[rt][e])||t)},yt=function(e,t){if(e=Y(e),t=L(t,!0),e!==lt||!g(ot,t)||g(st,t)){var r=Xe(e,t);return!r||!g(ot,t)||g(e,rt)&&e[rt][t]||(r.enumerable=!0),r}},_t=function(e){for(var t,r=Je(Y(e)),i=[],n=0;n<r.length;)g(ot,t=r[n++])||t==rt||t==Ye||i.push(t);return i},bt=function(e){for(var t,r=e===lt,i=Je(r?st:Y(e)),n=[],a=0;a<i.length;)!g(ot,t=i[a++])||r&&!g(lt,t)||n.push(ot[t]);return n};ut||(q((Ze=function(){if(this instanceof Ze)throw TypeError("Symbol is not a constructor!");var t=l(0<arguments.length?arguments[0]:void 0),r=function(e){this===lt&&r.call(st,e),g(this,rt)&&g(this[rt],t)&&(this[rt][t]=!1),ht(this,t,x(1,e))};return E&&dt&&ht(lt,t,{configurable:!0,set:r}),ft(t)})[tt],"toString",function(){return this._k}),Ke.f=yt,P.f=gt,He.f=We.f=_t,je.f=vt,Fe.f=bt,xe.f=function(e){return ft(he(e))}),M(M.G+M.W+M.F*!ut,{Symbol:Ze});for(var Tt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),St=0;St<Tt.length;)he(Tt[St++]);for(var Et=ie(he.store),kt=0;kt<Et.length;)Ne(Et[kt++]);M(M.S+M.F*!ut,"Symbol",{for:function(e){return g(at,e+="")?at[e]:at[e]=Ze(e)},keyFor:function(e){if(!pt(e))throw TypeError(e+" is not a symbol!");for(var t in at)if(at[t]===e)return t},useSetter:function(){dt=!0},useSimple:function(){dt=!1}}),M(M.S+M.F*!ut,"Object",{create:function(e,t){return void 0===t?de(e):mt(de(e),t)},defineProperty:gt,defineProperties:mt,getOwnPropertyDescriptor:yt,getOwnPropertyNames:_t,getOwnPropertySymbols:bt}),$e&&M(M.S+M.F*(!ut||S(function(){var e=Ze();return"[null]"!=et([e])||"{}"!=et({a:e})||"{}"!=et(Object(e))})),"JSON",{stringify:function(e){for(var t,r,i=[e],n=1;n<arguments.length;)i.push(arguments[n++]);if(r=t=i[1],(_(t)||void 0!==e)&&!pt(e))return Be(t)||(t=function(e,t){if("function"==typeof r&&(t=r.call(this,e,t)),!pt(t))return t}),i[1]=t,et.apply($e,i)}}),Ze[tt][it]||R(Ze[tt],it,Ze[tt].valueOf),ge(Ze,"Symbol"),ge(Math,"Math",!0),ge(v.JSON,"JSON",!0),Ne("asyncIterator"),Ne("observable");var wt=m.Symbol,Ct=t(function(e){e.exports={default:wt,__esModule:!0}});e(Ct);var At=t(function(e,t){t.__esModule=!0;var r=a(Oe),i=a(Ct),n="function"==typeof i.default&&"symbol"==typeof r.default?function(e){return typeof e}:function(e){return e&&"function"==typeof i.default&&e.constructor===i.default&&e!==i.default.prototype?"symbol":typeof e};function a(e){return e&&e.__esModule?e:{default:e}}t.default="function"==typeof i.default&&"symbol"===n(r.default)?function(e){return void 0===e?"undefined":n(e)}:function(e){return e&&"function"==typeof i.default&&e.constructor===i.default&&e!==i.default.prototype?"symbol":void 0===e?"undefined":n(e)}}),Lt=e(At),It=e(t(function(e,t){t.__esModule=!0;var r,i=(r=At)&&r.__esModule?r:{default:r};t.default=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":(0,i.default)(t))&&"function"!=typeof t?e:t}})),Pt=function(e,t){if(b(e),!_(t)&&null!==t)throw TypeError(t+": can't set as prototype!")},xt={set:Object.setPrototypeOf||("__proto__"in{}?function(e,r,i){try{(i=y(Function.call,Ke.f(Object.prototype,"__proto__").set,2))(e,[]),r=!(e instanceof Array)}catch(e){r=!0}return function(e,t){return Pt(e,t),r?e.__proto__=t:i(e,t),e}}({},!1):void 0),check:Pt};M(M.S,"Object",{setPrototypeOf:xt.set});var Rt=m.Object.setPrototypeOf,Ot=t(function(e){e.exports={default:Rt,__esModule:!0}});e(Ot),M(M.S,"Object",{create:de});var Dt=m.Object,Mt=function(e,t){return Dt.create(e,t)},Nt=t(function(e){e.exports={default:Mt,__esModule:!0}});e(Nt);var Ft=e(t(function(e,t){t.__esModule=!0;var r=a(Ot),i=a(Nt),n=a(At);function a(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":(0,n.default)(t)));e.prototype=(0,i.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(r.default?(0,r.default)(e,t):e.__proto__=t)}})),jt=m.JSON||(m.JSON={stringify:JSON.stringify}),Bt=function(e){return jt.stringify.apply(jt,arguments)},Ut=e(t(function(e){e.exports={default:Bt,__esModule:!0}}));N("keys",function(){return function(e){return ie(h(e))}});var Ht=m.Object.keys,Gt=e(t(function(e){e.exports={default:Ht,__esModule:!0}})),qt=Object.assign,Vt=!qt||S(function(){var e={},t={},r=Symbol(),i="abcdefghijklmnopqrst";return e[r]=7,i.split("").forEach(function(e){t[e]=e}),7!=qt({},e)[r]||Object.keys(qt({},t)).join("")!=i})?function(e,t){for(var r=h(e),i=arguments.length,n=1,a=Fe.f,o=je.f;n<i;)for(var s,l=K(arguments[n++]),u=a?ie(l).concat(a(l)):ie(l),c=u.length,d=0;d<c;)o.call(l,s=u[d++])&&(r[s]=l[s]);return r}:qt;M(M.S+M.F,"Object",{assign:Vt});var Wt=m.Object.assign,zt=t(function(e){e.exports={default:Wt,__esModule:!0}}),Kt=e(zt),Yt=function(t,e,r,i){try{return i?e(b(r)[0],r[1]):e(r)}catch(e){var n=t.return;throw void 0!==n&&b(n.call(t)),e}},Xt=he("iterator"),Qt=Array.prototype,Jt=function(e){return void 0!==e&&(V.Array===e||Qt[Xt]===e)},Zt=function(e,t,r){t in e?P.f(e,t,x(0,r)):e[t]=r},$t=he("toStringTag"),er="Arguments"==z(function(){return arguments}()),tr=function(e){var t,r,i;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),$t))?r:er?z(t):"Object"==(i=z(t))&&"function"==typeof t.callee?"Arguments":i},rr=he("iterator"),ir=m.getIteratorMethod=function(e){if(null!=e)return e[rr]||e["@@iterator"]||V[tr(e)]},nr=he("iterator"),ar=!1;try{[7][nr]().return=function(){ar=!0}}catch(e){}var or=function(e,t){if(!t&&!ar)return!1;var r=!1;try{var i=[7],n=i[nr]();n.next=function(){return{done:r=!0}},i[nr]=function(){return n},e(i)}catch(e){}return r};M(M.S+M.F*!or(function(e){}),"Array",{from:function(e){var t,r,i,n,a=h(e),o="function"==typeof this?this:Array,s=arguments.length,l=1<s?arguments[1]:void 0,u=void 0!==l,c=0,d=ir(a);if(u&&(l=y(l,2<s?arguments[2]:void 0,2)),null==d||o==Array&&Jt(d))for(r=new o(t=Q(a.length));c<t;c++)Zt(r,c,u?l(a[c],c):a[c]);else for(n=d.call(a),r=new o;!(i=n.next()).done;c++)Zt(r,c,u?Yt(n,l,[i.value,c],!0):i.value);return r.length=c,r}});var sr=m.Array.from,lr=t(function(e){e.exports={default:sr,__esModule:!0}}),ur=e(lr),cr=e(t(function(e,t){t.__esModule=!0;var r,i=(r=lr)&&r.__esModule?r:{default:r};t.default=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return(0,i.default)(e)}})),dr=e(t(function(e,t){t.__esModule=!0;var r,i=(r=zt)&&r.__esModule?r:{default:r};t.default=i.default||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}})),hr=e(t(function(e,t){t.__esModule=!0,t.default=function(e,t){var r={};for(var i in e)0<=t.indexOf(i)||Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i]);return r}})),fr=he("iterator"),pr=m.isIterable=function(e){var t=Object(e);return void 0!==t[fr]||"@@iterator"in t||V.hasOwnProperty(tr(t))},gr=t(function(e){e.exports={default:pr,__esModule:!0}});e(gr);var mr=m.getIterator=function(e){var t=ir(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return b(t.call(e))},vr=t(function(e){e.exports={default:mr,__esModule:!0}});e(vr);var yr=e(t(function(e,t){t.__esModule=!0;var r=i(gr),l=i(vr);function i(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t){if(Array.isArray(e))return e;if((0,r.default)(Object(e)))return function(e,t){var r=[],i=!0,n=!1,a=void 0;try{for(var o,s=(0,l.default)(e);!(i=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);i=!0);}catch(e){n=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(n)throw a}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}})),_r=e(t(function(e,t){t.__esModule=!0,t.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}}));M(M.S+M.F*!E,"Object",{defineProperty:P.f});var br=m.Object,Tr=function(e,t,r){return br.defineProperty(e,t,r)},Sr=t(function(e){e.exports={default:Tr,__esModule:!0}});e(Sr);var Er,kr,wr,Cr=e(t(function(e,t){t.__esModule=!0;var r,n=(r=Sr)&&r.__esModule?r:{default:r};t.default=function(){function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,n.default)(e,i.key,i)}}return function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}}()})),Ar=e(t(function(e,t){t.__esModule=!0;var r,i=(r=Sr)&&r.__esModule?r:{default:r};t.default=function(e,t,r){return t in e?(0,i.default)(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}})),Lr=Object.prototype.hasOwnProperty,Ir=Object.prototype.toString,Pr=function(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===Ir.call(e)},xr=function(e){if(!e||"[object Object]"!==Ir.call(e))return!1;var t,r=Lr.call(e,"constructor"),i=e.constructor&&e.constructor.prototype&&Lr.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!r&&!i)return!1;for(t in e);return void 0===t||Lr.call(e,t)},Rr=function e(){var t,r,i,n,a,o,s=arguments[0],l=1,u=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[1]||{},l=2),(null==s||"object"!=typeof s&&"function"!=typeof s)&&(s={});l<u;++l)if(null!=(t=arguments[l]))for(r in t)i=s[r],s!==(n=t[r])&&(c&&n&&(xr(n)||(a=Pr(n)))?(o=a?(a=!1,i&&Pr(i)?i:[]):i&&xr(i)?i:{},s[r]=e(c,o,n)):void 0!==n&&(s[r]=n));return s},Or={RoleType:{RT_BEGIN:0,RT_TEACHER:1,RT_STUDENT:2,RT_ADMIN:3,RT_END:4},TraceType:{TT_PATH:1,TT_SOLID_LINE:2,TT_DASH_LINE:3,TT_ARROW_LINE:4,TT_RECT:5,TT_ELLIPSE:6,TT_TEXT:7},ClientMsgType:{CMT_BEGIN_LIVE:1,CMT_END_LIVE:2,CMT_HEARTBEAT:3,CMT_PAGE_CHANGE:4,CMT_ADD_TRACE:5,CMT_ERASE_TRACE:6,CMT_DOWNLOAD_DOCUMENT:7,CMT_CREATE_TABULA:8,CMT_LOGIN_REQUEST:9,CMT_DESTROY_TABULA:10,CMT_VIDEO_BEGIN:5e3,CMT_GET_PAGE:5001,CMT_GET_INCREAMENT_MSG:5002,SMT_BEGIN:1e4,SMT_LOGIN_REPLY:10001,SMT_LOGIN_NOTIFY:10002,SMT_BEGIN_LIVE:10003,SMT_END_LIVE:10004,SMT_HEARTBEAT:10005,SMT_ADD_TRACE:10006,SMT_ERASE_TRACE:10007,SMT_PAGE_CHANGE_NOTIFY:10008,SMT_DOCUMENT_INFO:10009,SMT_ERROR:10010,SMT_VIDEO_LOGIN_RES:10011,SMT_VIDEO_BATCH_RES:10012,SMT_CHANGE_CDN_NOTIFY:10015,SMT_PAUSE_LIVE_NOTIFY:10016,SMT_CONTINUE_LIVE_NOTIFY:10017,SMT_BEGIN_PAPER_NOTIFY:10018,SMT_SCROLL_POSITION:10021,EC_AUTH_TOKEN_FAILED:40002,EC_AUTH_EXPIRED:40004},AppType:{WEB:1,WX_MINI_PROGRAM:2,APP:3},StreamProtocol:{RTMP_PROTOCOL:1,FLV_PROTOCOL:2,HLS_PROTOCOL:3,MP4_PROTOCOL:-1},RoomStatus:{READY:1,LIVE:2,PAUSE:3,END:4},eUrlType:{COMMON:1,SHARE_DESKTOP:2,SHARE_VIDEO:3},iErrorCode:{EC_KICK_BY_ADMIN:10034}},Dr=t(function(e){var h={},f={},t=e.exports=function(e,t,r,i,n){var a,o,s,l,u=n?function(){return e}:ir(e),c=y(r,i,t?2:1),d=0;if("function"!=typeof u)throw TypeError(e+" is not iterable!");if(Jt(u)){for(a=Q(e.length);d<a;d++)if((l=t?c(b(o=e[d])[0],o[1]):c(e[d]))===h||l===f)return l}else for(s=u.call(e);!(o=s.next()).done;)if((l=Yt(s,c,o.value,t))===h||l===f)return l};t.BREAK=h,t.RETURN=f}),Mr=he("species"),Nr=function(e,t){var r,i=b(e).constructor;return void 0===i||null==(r=b(i)[Mr])?t:p(r)},Fr=v.process,jr=v.setImmediate,Br=v.clearImmediate,Ur=v.MessageChannel,Hr=v.Dispatch,Gr=0,qr={},Vr="onreadystatechange",Wr=function(){var e=+this;if(qr.hasOwnProperty(e)){var t=qr[e];delete qr[e],t()}},zr=function(e){Wr.call(e.data)};jr&&Br||(jr=function(e){for(var t=[],r=1;r<arguments.length;)t.push(arguments[r++]);return qr[++Gr]=function(){!function(e,t,r){var i=void 0===r;switch(t.length){case 0:return i?e():e.call(r);case 1:return i?e(t[0]):e.call(r,t[0]);case 2:return i?e(t[0],t[1]):e.call(r,t[0],t[1]);case 3:return i?e(t[0],t[1],t[2]):e.call(r,t[0],t[1],t[2]);case 4:return i?e(t[0],t[1],t[2],t[3]):e.call(r,t[0],t[1],t[2],t[3])}e.apply(r,t)}("function"==typeof e?e:Function(e),t)},Er(Gr),Gr},Br=function(e){delete qr[e]},"process"==z(Fr)?Er=function(e){Fr.nextTick(y(Wr,e,1))}:Hr&&Hr.now?Er=function(e){Hr.now(y(Wr,e,1))}:Ur?(wr=(kr=new Ur).port2,kr.port1.onmessage=zr,Er=y(wr.postMessage,wr,1)):v.addEventListener&&"function"==typeof postMessage&&!v.importScripts?(Er=function(e){v.postMessage(e+"","*")},v.addEventListener("message",zr,!1)):Er=Vr in C("script")?function(e){oe.appendChild(C("script"))[Vr]=function(){oe.removeChild(this),Wr.call(e)}}:function(e){setTimeout(y(Wr,e,1),0)});var Kr={set:jr,clear:Br},Yr=Kr.set,Xr=v.MutationObserver||v.WebKitMutationObserver,Qr=v.process,Jr=v.Promise,Zr="process"==z(Qr);function $r(e){var r,i;this.promise=new e(function(e,t){if(void 0!==r||void 0!==i)throw TypeError("Bad Promise constructor");r=e,i=t}),this.resolve=p(r),this.reject=p(i)}var ei,ti,ri,ii,ni,ai,oi={f:function(e){return new $r(e)}},si=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}},li=v.navigator,ui=li&&li.userAgent||"",ci=function(e,t){if(b(e),_(t)&&t.constructor===e)return t;var r=oi.f(e);return(0,r.resolve)(t),r.promise},di=he("species"),hi=Kr.set,fi=function(){var r,i,n,e=function(){var e,t;for(Zr&&(e=Qr.domain)&&e.exit();r;){t=r.fn,r=r.next;try{t()}catch(e){throw r?n():i=void 0,e}}i=void 0,e&&e.enter()};if(Zr)n=function(){Qr.nextTick(e)};else if(!Xr||v.navigator&&v.navigator.standalone)if(Jr&&Jr.resolve){var t=Jr.resolve(void 0);n=function(){t.then(e)}}else n=function(){Yr.call(v,e)};else{var a=!0,o=document.createTextNode("");new Xr(e).observe(o,{characterData:!0}),n=function(){o.data=a=!a}}return function(e){var t={fn:e,next:void 0};i&&(i.next=t),r||(r=t,n()),i=t}}(),pi="Promise",gi=v.TypeError,mi=v.process,vi=mi&&mi.versions,yi=vi&&vi.v8||"",_i=v[pi],bi="process"==tr(mi),Ti=function(){},Si=ti=oi.f,Ei=!!function(){try{var e=_i.resolve(1),t=(e.constructor={})[he("species")]=function(e){e(Ti,Ti)};return(bi||"function"==typeof PromiseRejectionEvent)&&e.then(Ti)instanceof t&&0!=yi.indexOf("6.6")&&-1==ui.indexOf("Chrome/66")}catch(e){}}(),ki=function(e){var t;return!(!_(e)||"function"!=typeof(t=e.then))&&t},wi=function(c,r){if(!c._n){c._n=!0;var i=c._c;fi(function(){for(var l=c._v,u=1==c._s,e=0,t=function(e){var t,r,i,n=u?e.ok:e.fail,a=e.resolve,o=e.reject,s=e.domain;try{n?(u||(2==c._h&&Li(c),c._h=1),!0===n?t=l:(s&&s.enter(),t=n(l),s&&(s.exit(),i=!0)),t===e.promise?o(gi("Promise-chain cycle")):(r=ki(t))?r.call(t,a,o):a(t)):o(l)}catch(e){s&&!i&&s.exit(),o(e)}};e<i.length;)t(i[e++]);c._c=[],c._n=!1,r&&!c._h&&Ci(c)})}},Ci=function(a){hi.call(v,function(){var e,t,r,i=a._v,n=Ai(a);if(n&&(e=si(function(){bi?mi.emit("unhandledRejection",i,a):(t=v.onunhandledrejection)?t({promise:a,reason:i}):(r=v.console)&&r.error&&r.error("Unhandled promise rejection",i)}),a._h=bi||Ai(a)?2:1),a._a=void 0,n&&e.e)throw e.v})},Ai=function(e){return 1!==e._h&&0===(e._a||e._c).length},Li=function(t){hi.call(v,function(){var e;bi?mi.emit("rejectionHandled",t):(e=v.onrejectionhandled)&&e({promise:t,reason:t._v})})},Ii=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),wi(t,!0))},Pi=function(e){var r,i=this;if(!i._d){i._d=!0,i=i._w||i;try{if(i===e)throw gi("Promise can't be resolved itself");(r=ki(e))?fi(function(){var t={_w:i,_d:!1};try{r.call(e,y(Pi,t,1),y(Ii,t,1))}catch(e){Ii.call(t,e)}}):(i._v=e,i._s=1,wi(i,!1))}catch(e){Ii.call({_w:i,_d:!1},e)}}};Ei||(_i=function(e){!function(e,t,r,i){if(!(e instanceof t)||void 0!==i&&i in e)throw TypeError(r+": incorrect invocation!")}(this,_i,pi,"_h"),p(e),ei.call(this);try{e(y(Pi,this,1),y(Ii,this,1))}catch(e){Ii.call(this,e)}},(ei=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=function(e,t,r){for(var i in t)r&&e[i]?e[i]=t[i]:R(e,i,t[i]);return e}(_i.prototype,{then:function(e,t){var r=Si(Nr(this,_i));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=bi?mi.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&wi(this,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),ri=function(){var e=new ei;this.promise=e,this.resolve=y(Pi,e,1),this.reject=y(Ii,e,1)},oi.f=Si=function(e){return e===_i||e===ii?new ri(e):ti(e)}),M(M.G+M.W+M.F*!Ei,{Promise:_i}),ge(_i,pi),ai="function"==typeof m[ni=pi]?m[ni]:v[ni],E&&ai&&!ai[di]&&P.f(ai,di,{configurable:!0,get:function(){return this}}),ii=m[pi],M(M.S+M.F*!Ei,pi,{reject:function(e){var t=Si(this);return(0,t.reject)(e),t.promise}}),M(M.S+!0*M.F,pi,{resolve:function(e){return ci(this===ii?_i:this,e)}}),M(M.S+M.F*!(Ei&&or(function(e){_i.all(e).catch(Ti)})),pi,{all:function(e){var o=this,t=Si(o),s=t.resolve,l=t.reject,r=si(function(){var i=[],n=0,a=1;Dr(e,!1,function(e){var t=n++,r=!1;i.push(void 0),a++,o.resolve(e).then(function(e){r||(r=!0,i[t]=e,--a||s(i))},l)}),--a||s(i)});return r.e&&l(r.v),t.promise},race:function(e){var t=this,r=Si(t),i=r.reject,n=si(function(){Dr(e,!1,function(e){t.resolve(e).then(r.resolve,i)})});return n.e&&i(n.v),r.promise}}),M(M.P+M.R,"Promise",{finally:function(t){var r=Nr(this,m.Promise||v.Promise),e="function"==typeof t;return this.then(e?function(e){return ci(r,t()).then(function(){return e})}:t,e?function(e){return ci(r,t()).then(function(){throw e})}:t)}}),M(M.S,"Promise",{try:function(e){var t=oi.f(this),r=si(e);return(r.e?t.reject:t.resolve)(r.v),t.promise}});var xi=m.Promise,Ri=e(t(function(e){e.exports={default:xi,__esModule:!0}})),Oi=t(function(e){var t,r;t="undefined"!=typeof window?window:i,r=function(E,e){var t=[],k=E.document,i=Object.getPrototypeOf,s=t.slice,g=t.concat,l=t.push,n=t.indexOf,r={},a=r.toString,m=r.hasOwnProperty,o=m.toString,u=o.call(Object),v={},y=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},_=function(e){return null!=e&&e===e.window},c={type:!0,src:!0,noModule:!0};function b(e,t,r){var i,n=(t=t||k).createElement("script");if(n.text=e,r)for(i in c)r[i]&&(n[i]=r[i]);t.head.appendChild(n).parentNode.removeChild(n)}function T(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?r[a.call(e)]||"object":typeof e}var w=function(e,t){return new w.fn.init(e,t)},d=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;function h(e){var t=!!e&&"length"in e&&e.length,r=T(e);return!y(e)&&!_(e)&&("array"===r||0===t||"number"==typeof t&&0<t&&t-1 in e)}w.fn=w.prototype={jquery:"3.3.1",constructor:w,length:0,toArray:function(){return s.call(this)},get:function(e){return null==e?s.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=w.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return w.each(this,e)},map:function(r){return this.pushStack(w.map(this,function(e,t){return r.call(e,t,e)}))},slice:function(){return this.pushStack(s.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,r=+e+(e<0?t:0);return this.pushStack(0<=r&&r<t?[this[r]]:[])},end:function(){return this.prevObject||this.constructor()},push:l,sort:t.sort,splice:t.splice},w.extend=w.fn.extend=function(){var e,t,r,i,n,a,o=arguments[0]||{},s=1,l=arguments.length,u=!1;for("boolean"==typeof o&&(u=o,o=arguments[s]||{},s++),"object"==typeof o||y(o)||(o={}),s===l&&(o=this,s--);s<l;s++)if(null!=(e=arguments[s]))for(t in e)r=o[t],o!==(i=e[t])&&(u&&i&&(w.isPlainObject(i)||(n=Array.isArray(i)))?(a=n?(n=!1,r&&Array.isArray(r)?r:[]):r&&w.isPlainObject(r)?r:{},o[t]=w.extend(u,a,i)):void 0!==i&&(o[t]=i));return o},w.extend({expando:"jQuery"+("3.3.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw Error(e)},noop:function(){},isPlainObject:function(e){var t,r;return!(!e||"[object Object]"!==a.call(e))&&(!(t=i(e))||"function"==typeof(r=m.call(t,"constructor")&&t.constructor)&&o.call(r)===u)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e){b(e)},each:function(e,t){var r,i=0;if(h(e))for(r=e.length;i<r&&!1!==t.call(e[i],i,e[i]);i++);else for(i in e)if(!1===t.call(e[i],i,e[i]))break;return e},trim:function(e){return null==e?"":(e+"").replace(d,"")},makeArray:function(e,t){var r=t||[];return null!=e&&(h(Object(e))?w.merge(r,"string"==typeof e?[e]:e):l.call(r,e)),r},inArray:function(e,t,r){return null==t?-1:n.call(t,e,r)},merge:function(e,t){for(var r=+t.length,i=0,n=e.length;i<r;i++)e[n++]=t[i];return e.length=n,e},grep:function(e,t,r){for(var i=[],n=0,a=e.length,o=!r;n<a;n++)!t(e[n],n)!==o&&i.push(e[n]);return i},map:function(e,t,r){var i,n,a=0,o=[];if(h(e))for(i=e.length;a<i;a++)null!=(n=t(e[a],a,r))&&o.push(n);else for(a in e)null!=(n=t(e[a],a,r))&&o.push(n);return g.apply([],o)},guid:1,support:v}),"function"==typeof Symbol&&(w.fn[Symbol.iterator]=t[Symbol.iterator]),w.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){r["[object "+t+"]"]=t.toLowerCase()});var f=function(r){var e,f,b,a,n,p,d,g,T,l,u,S,E,o,k,m,s,c,v,w="sizzle"+1*new Date,y=r.document,C=0,i=0,h=oe(),_=oe(),A=oe(),L=function(e,t){return e===t&&(u=!0),0},I={}.hasOwnProperty,t=[],P=t.pop,x=t.push,R=t.push,O=t.slice,D=function(e,t){for(var r=0,i=e.length;r<i;r++)if(e[r]===t)return r;return-1},M="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",N="[\\x20\\t\\r\\n\\f]",F="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",j="\\["+N+"*("+F+")(?:"+N+"*([*^$|!~]?=)"+N+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+F+"))|)"+N+"*\\]",B=":("+F+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+j+")*)|.*)\\)|)",U=RegExp(N+"+","g"),H=RegExp("^"+N+"+|((?:^|[^\\\\])(?:\\\\.)*)"+N+"+$","g"),G=RegExp("^"+N+"*,"+N+"*"),q=RegExp("^"+N+"*([>+~]|"+N+")"+N+"*"),V=RegExp("="+N+"*([^\\]'\"]*?)"+N+"*\\]","g"),W=RegExp(B),z=RegExp("^"+F+"$"),K={ID:RegExp("^#("+F+")"),CLASS:RegExp("^\\.("+F+")"),TAG:RegExp("^("+F+"|[*])"),ATTR:RegExp("^"+j),PSEUDO:RegExp("^"+B),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+N+"*(even|odd|(([+-]|)(\\d*)n|)"+N+"*(?:([+-]|)"+N+"*(\\d+)|))"+N+"*\\)|)","i"),bool:RegExp("^(?:"+M+")$","i"),needsContext:RegExp("^"+N+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+N+"*((?:-\\d)?\\d*)"+N+"*\\)|)(?=[^-]|$)","i")},Y=/^(?:input|select|textarea|button)$/i,X=/^h\d$/i,Q=/^[^{]+\{\s*\[native \w/,J=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Z=/[+~]/,$=RegExp("\\\\([\\da-f]{1,6}"+N+"?|("+N+")|.)","ig"),ee=function(e,t,r){var i="0x"+t-65536;return i!=i||r?t:i<0?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)},te=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,re=function(e,t){return t?"\0"===e?"�":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},ie=function(){S()},ne=ye(function(e){return!0===e.disabled&&("form"in e||"label"in e)},{dir:"parentNode",next:"legend"});try{R.apply(t=O.call(y.childNodes),y.childNodes)}catch(e){R={apply:t.length?function(e,t){x.apply(e,O.call(t))}:function(e,t){for(var r=e.length,i=0;e[r++]=t[i++];);e.length=r-1}}}function ae(e,t,r,i){var n,a,o,s,l,u,c,d=t&&t.ownerDocument,h=t?t.nodeType:9;if(r=r||[],"string"!=typeof e||!e||1!==h&&9!==h&&11!==h)return r;if(!i&&((t?t.ownerDocument||t:y)!==E&&S(t),t=t||E,k)){if(11!==h&&(l=J.exec(e)))if(n=l[1]){if(9===h){if(!(o=t.getElementById(n)))return r;if(o.id===n)return r.push(o),r}else if(d&&(o=d.getElementById(n))&&v(t,o)&&o.id===n)return r.push(o),r}else{if(l[2])return R.apply(r,t.getElementsByTagName(e)),r;if((n=l[3])&&f.getElementsByClassName&&t.getElementsByClassName)return R.apply(r,t.getElementsByClassName(n)),r}if(f.qsa&&!A[e+" "]&&(!m||!m.test(e))){if(1!==h)d=t,c=e;else if("object"!==t.nodeName.toLowerCase()){for((s=t.getAttribute("id"))?s=s.replace(te,re):t.setAttribute("id",s=w),a=(u=p(e)).length;a--;)u[a]="#"+s+" "+ve(u[a]);c=u.join(","),d=Z.test(e)&&ge(t.parentNode)||t}if(c)try{return R.apply(r,d.querySelectorAll(c)),r}catch(e){}finally{s===w&&t.removeAttribute("id")}}}return g(e.replace(H,"$1"),t,r,i)}function oe(){var i=[];return function e(t,r){return i.push(t+" ")>b.cacheLength&&delete e[i.shift()],e[t+" "]=r}}function se(e){return e[w]=!0,e}function le(e){var t=E.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function ue(e,t){for(var r=e.split("|"),i=r.length;i--;)b.attrHandle[r[i]]=t}function ce(e,t){var r=t&&e,i=r&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(i)return i;if(r)for(;r=r.nextSibling;)if(r===t)return-1;return e?1:-1}function de(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function he(r){return function(e){var t=e.nodeName.toLowerCase();return("input"===t||"button"===t)&&e.type===r}}function fe(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&ne(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function pe(o){return se(function(a){return a=+a,se(function(e,t){for(var r,i=o([],e.length,a),n=i.length;n--;)e[r=i[n]]&&(e[r]=!(t[r]=e[r]))})})}function ge(e){return e&&void 0!==e.getElementsByTagName&&e}for(e in f=ae.support={},n=ae.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},S=ae.setDocument=function(e){var t,r,i=e?e.ownerDocument||e:y;return i!==E&&9===i.nodeType&&i.documentElement&&(o=(E=i).documentElement,k=!n(E),y!==E&&(r=E.defaultView)&&r.top!==r&&(r.addEventListener?r.addEventListener("unload",ie,!1):r.attachEvent&&r.attachEvent("onunload",ie)),f.attributes=le(function(e){return e.className="i",!e.getAttribute("className")}),f.getElementsByTagName=le(function(e){return e.appendChild(E.createComment("")),!e.getElementsByTagName("*").length}),f.getElementsByClassName=Q.test(E.getElementsByClassName),f.getById=le(function(e){return o.appendChild(e).id=w,!E.getElementsByName||!E.getElementsByName(w).length}),b.find.ID=f.getById?(b.filter.ID=function(e){var t=e.replace($,ee);return function(e){return e.getAttribute("id")===t}},function(e,t){if(void 0!==t.getElementById&&k){var r=t.getElementById(e);return r?[r]:[]}}):(b.filter.ID=function(e){var r=e.replace($,ee);return function(e){var t=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return t&&t.value===r}},function(e,t){if(void 0!==t.getElementById&&k){var r,i,n,a=t.getElementById(e);if(a){if((r=a.getAttributeNode("id"))&&r.value===e)return[a];for(n=t.getElementsByName(e),i=0;a=n[i++];)if((r=a.getAttributeNode("id"))&&r.value===e)return[a]}return[]}}),b.find.TAG=f.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):f.qsa?t.querySelectorAll(e):void 0}:function(e,t){var r,i=[],n=0,a=t.getElementsByTagName(e);if("*"!==e)return a;for(;r=a[n++];)1===r.nodeType&&i.push(r);return i},b.find.CLASS=f.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&k)return t.getElementsByClassName(e)},s=[],m=[],(f.qsa=Q.test(E.querySelectorAll))&&(le(function(e){o.appendChild(e).innerHTML="<a id='"+w+"'></a><select id='"+w+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&m.push("[*^$]="+N+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||m.push("\\["+N+"*(?:value|"+M+")"),e.querySelectorAll("[id~="+w+"-]").length||m.push("~="),e.querySelectorAll(":checked").length||m.push(":checked"),e.querySelectorAll("a#"+w+"+*").length||m.push(".#.+[+~]")}),le(function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=E.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&m.push("name"+N+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&m.push(":enabled",":disabled"),o.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&m.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),m.push(",.*:")})),(f.matchesSelector=Q.test(c=o.matches||o.webkitMatchesSelector||o.mozMatchesSelector||o.oMatchesSelector||o.msMatchesSelector))&&le(function(e){f.disconnectedMatch=c.call(e,"*"),c.call(e,"[s!='']:x"),s.push("!=",B)}),m=m.length&&RegExp(m.join("|")),s=s.length&&RegExp(s.join("|")),t=Q.test(o.compareDocumentPosition),v=t||Q.test(o.contains)?function(e,t){var r=9===e.nodeType?e.documentElement:e,i=t&&t.parentNode;return e===i||!(!i||1!==i.nodeType||!(r.contains?r.contains(i):e.compareDocumentPosition&&16&e.compareDocumentPosition(i)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},L=t?function(e,t){if(e===t)return u=!0,0;var r=!e.compareDocumentPosition-!t.compareDocumentPosition;return r||(1&(r=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!f.sortDetached&&t.compareDocumentPosition(e)===r?e===E||e.ownerDocument===y&&v(y,e)?-1:t===E||t.ownerDocument===y&&v(y,t)?1:l?D(l,e)-D(l,t):0:4&r?-1:1)}:function(e,t){if(e===t)return u=!0,0;var r,i=0,n=e.parentNode,a=t.parentNode,o=[e],s=[t];if(!n||!a)return e===E?-1:t===E?1:n?-1:a?1:l?D(l,e)-D(l,t):0;if(n===a)return ce(e,t);for(r=e;r=r.parentNode;)o.unshift(r);for(r=t;r=r.parentNode;)s.unshift(r);for(;o[i]===s[i];)i++;return i?ce(o[i],s[i]):o[i]===y?-1:s[i]===y?1:0}),E},ae.matches=function(e,t){return ae(e,null,null,t)},ae.matchesSelector=function(e,t){if((e.ownerDocument||e)!==E&&S(e),t=t.replace(V,"='$1']"),f.matchesSelector&&k&&!A[t+" "]&&(!s||!s.test(t))&&(!m||!m.test(t)))try{var r=c.call(e,t);if(r||f.disconnectedMatch||e.document&&11!==e.document.nodeType)return r}catch(e){}return 0<ae(t,E,null,[e]).length},ae.contains=function(e,t){return(e.ownerDocument||e)!==E&&S(e),v(e,t)},ae.attr=function(e,t){(e.ownerDocument||e)!==E&&S(e);var r=b.attrHandle[t.toLowerCase()],i=r&&I.call(b.attrHandle,t.toLowerCase())?r(e,t,!k):void 0;return void 0!==i?i:f.attributes||!k?e.getAttribute(t):(i=e.getAttributeNode(t))&&i.specified?i.value:null},ae.escape=function(e){return(e+"").replace(te,re)},ae.error=function(e){throw Error("Syntax error, unrecognized expression: "+e)},ae.uniqueSort=function(e){var t,r=[],i=0,n=0;if(u=!f.detectDuplicates,l=!f.sortStable&&e.slice(0),e.sort(L),u){for(;t=e[n++];)t===e[n]&&(i=r.push(n));for(;i--;)e.splice(r[i],1)}return l=null,e},a=ae.getText=function(e){var t,r="",i=0,n=e.nodeType;if(n){if(1===n||9===n||11===n){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)r+=a(e)}else if(3===n||4===n)return e.nodeValue}else for(;t=e[i++];)r+=a(t);return r},(b=ae.selectors={cacheLength:50,createPseudo:se,match:K,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace($,ee),e[3]=(e[3]||e[4]||e[5]||"").replace($,ee),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||ae.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&ae.error(e[0]),e},PSEUDO:function(e){var t,r=!e[6]&&e[2];return K.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":r&&W.test(r)&&(t=p(r,!0))&&(t=r.indexOf(")",r.length-t)-r.length)&&(e[0]=e[0].slice(0,t),e[2]=r.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace($,ee).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=h[e+" "];return t||(t=RegExp("(^|"+N+")"+e+"("+N+"|$)"))&&h(e,function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(r,i,n){return function(e){var t=ae.attr(e,r);return null==t?"!="===i:!i||(t+="","="===i?t===n:"!="===i?t!==n:"^="===i?n&&0==t.indexOf(n):"*="===i?n&&-1<t.indexOf(n):"$="===i?n&&t.slice(-n.length)===n:"~="===i?-1<(" "+t.replace(U," ")+" ").indexOf(n):"|="===i&&(t===n||t.slice(0,n.length+1)===n+"-"))}},CHILD:function(p,e,t,g,m){var v="nth"!==p.slice(0,3),y="last"!==p.slice(-4),_="of-type"===e;return 1===g&&0===m?function(e){return!!e.parentNode}:function(e,t,r){var i,n,a,o,s,l,u=v!==y?"nextSibling":"previousSibling",c=e.parentNode,d=_&&e.nodeName.toLowerCase(),h=!r&&!_,f=!1;if(c){if(v){for(;u;){for(o=e;o=o[u];)if(_?o.nodeName.toLowerCase()===d:1===o.nodeType)return!1;l=u="only"===p&&!l&&"nextSibling"}return!0}if(l=[y?c.firstChild:c.lastChild],y&&h){for(f=(s=(i=(n=(a=(o=c)[w]||(o[w]={}))[o.uniqueID]||(a[o.uniqueID]={}))[p]||[])[0]===C&&i[1])&&i[2],o=s&&c.childNodes[s];o=++s&&o&&o[u]||(f=s=0)||l.pop();)if(1===o.nodeType&&++f&&o===e){n[p]=[C,s,f];break}}else if(h&&(f=s=(i=(n=(a=(o=e)[w]||(o[w]={}))[o.uniqueID]||(a[o.uniqueID]={}))[p]||[])[0]===C&&i[1]),!1===f)for(;(o=++s&&o&&o[u]||(f=s=0)||l.pop())&&((_?o.nodeName.toLowerCase()!==d:1!==o.nodeType)||!++f||(h&&((n=(a=o[w]||(o[w]={}))[o.uniqueID]||(a[o.uniqueID]={}))[p]=[C,f]),o!==e)););return(f-=m)===g||f%g==0&&0<=f/g}}},PSEUDO:function(e,a){var t,o=b.pseudos[e]||b.setFilters[e.toLowerCase()]||ae.error("unsupported pseudo: "+e);return o[w]?o(a):1<o.length?(t=[e,e,"",a],b.setFilters.hasOwnProperty(e.toLowerCase())?se(function(e,t){for(var r,i=o(e,a),n=i.length;n--;)e[r=D(e,i[n])]=!(t[r]=i[n])}):function(e){return o(e,0,t)}):o}},pseudos:{not:se(function(e){var i=[],n=[],s=d(e.replace(H,"$1"));return s[w]?se(function(e,t,r,i){for(var n,a=s(e,null,i,[]),o=e.length;o--;)(n=a[o])&&(e[o]=!(t[o]=n))}):function(e,t,r){return i[0]=e,s(i,null,r,n),i[0]=null,!n.pop()}}),has:se(function(t){return function(e){return 0<ae(t,e).length}}),contains:se(function(t){return t=t.replace($,ee),function(e){return-1<(e.textContent||e.innerText||a(e)).indexOf(t)}}),lang:se(function(r){return z.test(r||"")||ae.error("unsupported lang: "+r),r=r.replace($,ee).toLowerCase(),function(e){var t;do{if(t=k?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(t=t.toLowerCase())===r||0==t.indexOf(r+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var t=r.location&&r.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===o},focus:function(e){return e===E.activeElement&&(!E.hasFocus||E.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:fe(!1),disabled:fe(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!b.pseudos.empty(e)},header:function(e){return X.test(e.nodeName)},input:function(e){return Y.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:pe(function(){return[0]}),last:pe(function(e,t){return[t-1]}),eq:pe(function(e,t,r){return[r<0?r+t:r]}),even:pe(function(e,t){for(var r=0;r<t;r+=2)e.push(r);return e}),odd:pe(function(e,t){for(var r=1;r<t;r+=2)e.push(r);return e}),lt:pe(function(e,t,r){for(var i=r<0?r+t:r;0<=--i;)e.push(i);return e}),gt:pe(function(e,t,r){for(var i=r<0?r+t:r;++i<t;)e.push(i);return e})}}).pseudos.nth=b.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})b.pseudos[e]=de(e);for(e in{submit:!0,reset:!0})b.pseudos[e]=he(e);function me(){}function ve(e){for(var t=0,r=e.length,i="";t<r;t++)i+=e[t].value;return i}function ye(s,e,t){var l=e.dir,u=e.next,c=u||l,d=t&&"parentNode"===c,h=i++;return e.first?function(e,t,r){for(;e=e[l];)if(1===e.nodeType||d)return s(e,t,r);return!1}:function(e,t,r){var i,n,a,o=[C,h];if(r){for(;e=e[l];)if((1===e.nodeType||d)&&s(e,t,r))return!0}else for(;e=e[l];)if(1===e.nodeType||d)if(n=(a=e[w]||(e[w]={}))[e.uniqueID]||(a[e.uniqueID]={}),u&&u===e.nodeName.toLowerCase())e=e[l]||e;else{if((i=n[c])&&i[0]===C&&i[1]===h)return o[2]=i[2];if((n[c]=o)[2]=s(e,t,r))return!0}return!1}}function _e(n){return 1<n.length?function(e,t,r){for(var i=n.length;i--;)if(!n[i](e,t,r))return!1;return!0}:n[0]}function be(e,t,r,i,n){for(var a,o=[],s=0,l=e.length,u=null!=t;s<l;s++)(a=e[s])&&(r&&!r(a,i,n)||(o.push(a),u&&t.push(s)));return o}function Te(f,p,g,m,v,e){return m&&!m[w]&&(m=Te(m)),v&&!v[w]&&(v=Te(v,e)),se(function(e,t,r,i){var n,a,o,s=[],l=[],u=t.length,c=e||function(e,t,r){for(var i=0,n=t.length;i<n;i++)ae(e,t[i],r);return r}(p||"*",r.nodeType?[r]:r,[]),d=!f||!e&&p?c:be(c,s,f,r,i),h=g?v||(e?f:u||m)?[]:t:d;if(g&&g(d,h,r,i),m)for(n=be(h,l),m(n,[],r,i),a=n.length;a--;)(o=n[a])&&(h[l[a]]=!(d[l[a]]=o));if(e){if(v||f){if(v){for(n=[],a=h.length;a--;)(o=h[a])&&n.push(d[a]=o);v(null,h=[],n,i)}for(a=h.length;a--;)(o=h[a])&&-1<(n=v?D(e,o):s[a])&&(e[n]=!(t[n]=o))}}else h=be(h===t?h.splice(u,h.length):h),v?v(null,t,h,i):R.apply(t,h)})}function Se(e){for(var n,t,r,i=e.length,a=b.relative[e[0].type],o=a||b.relative[" "],s=a?1:0,l=ye(function(e){return e===n},o,!0),u=ye(function(e){return-1<D(n,e)},o,!0),c=[function(e,t,r){var i=!a&&(r||t!==T)||((n=t).nodeType?l(e,t,r):u(e,t,r));return n=null,i}];s<i;s++)if(t=b.relative[e[s].type])c=[ye(_e(c),t)];else{if((t=b.filter[e[s].type].apply(null,e[s].matches))[w]){for(r=++s;r<i&&!b.relative[e[r].type];r++);return Te(1<s&&_e(c),1<s&&ve(e.slice(0,s-1).concat({value:" "===e[s-2].type?"*":""})).replace(H,"$1"),t,s<r&&Se(e.slice(s,r)),r<i&&Se(e=e.slice(r)),r<i&&ve(e))}c.push(t)}return _e(c)}return me.prototype=b.filters=b.pseudos,b.setFilters=new me,p=ae.tokenize=function(e,t){var r,i,n,a,o,s,l,u=_[e+" "];if(u)return t?0:u.slice(0);for(o=e,s=[],l=b.preFilter;o;){for(a in r&&!(i=G.exec(o))||(i&&(o=o.slice(i[0].length)||o),s.push(n=[])),r=!1,(i=q.exec(o))&&(r=i.shift(),n.push({value:r,type:i[0].replace(H," ")}),o=o.slice(r.length)),b.filter)!(i=K[a].exec(o))||l[a]&&!(i=l[a](i))||(r=i.shift(),n.push({value:r,type:a,matches:i}),o=o.slice(r.length));if(!r)break}return t?o.length:o?ae.error(e):_(e,s).slice(0)},d=ae.compile=function(e,t){var r,m,v,y,_,i,n=[],a=[],o=A[e+" "];if(!o){for(t||(t=p(e)),r=t.length;r--;)(o=Se(t[r]))[w]?n.push(o):a.push(o);(o=A(e,(_=0<(m=a).length,i=function(e,t,r,i,n){var a,o,s,l=0,u="0",c=e&&[],d=[],h=T,f=e||_&&b.find.TAG("*",n),p=C+=null==h?1:Math.random()||.1,g=f.length;for(n&&(T=t===E||t||n);u!==g&&null!=(a=f[u]);u++){if(_&&a){for(o=0,t||a.ownerDocument===E||(S(a),r=!k);s=m[o++];)if(s(a,t||E,r)){i.push(a);break}n&&(C=p)}y&&((a=!s&&a)&&l--,e&&c.push(a))}if(l+=u,y&&u!==l){for(o=0;s=v[o++];)s(c,d,t,r);if(e){if(0<l)for(;u--;)c[u]||d[u]||(d[u]=P.call(i));d=be(d)}R.apply(i,d),n&&!e&&0<d.length&&1<l+v.length&&ae.uniqueSort(i)}return n&&(C=p,T=h),c},(y=0<(v=n).length)?se(i):i))).selector=e}return o},g=ae.select=function(e,t,r,i){var n,a,o,s,l,u="function"==typeof e&&e,c=!i&&p(e=u.selector||e);if(r=r||[],1===c.length){if(2<(a=c[0]=c[0].slice(0)).length&&"ID"===(o=a[0]).type&&9===t.nodeType&&k&&b.relative[a[1].type]){if(!(t=(b.find.ID(o.matches[0].replace($,ee),t)||[])[0]))return r;u&&(t=t.parentNode),e=e.slice(a.shift().value.length)}for(n=K.needsContext.test(e)?0:a.length;n--&&!b.relative[s=(o=a[n]).type];)if((l=b.find[s])&&(i=l(o.matches[0].replace($,ee),Z.test(a[0].type)&&ge(t.parentNode)||t))){if(a.splice(n,1),!(e=i.length&&ve(a)))return R.apply(r,i),r;break}}return(u||d(e,c))(i,t,!k,r,!t||Z.test(e)&&ge(t.parentNode)||t),r},f.sortStable=w.split("").sort(L).join("")===w,f.detectDuplicates=!!u,S(),f.sortDetached=le(function(e){return 1&e.compareDocumentPosition(E.createElement("fieldset"))}),le(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||ue("type|href|height|width",function(e,t,r){if(!r)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),f.attributes&&le(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||ue("value",function(e,t,r){if(!r&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),le(function(e){return null==e.getAttribute("disabled")})||ue(M,function(e,t,r){var i;if(!r)return!0===e[t]?t.toLowerCase():(i=e.getAttributeNode(t))&&i.specified?i.value:null}),ae}(E);w.find=f,w.expr=f.selectors,w.expr[":"]=w.expr.pseudos,w.uniqueSort=w.unique=f.uniqueSort,w.text=f.getText,w.isXMLDoc=f.isXML,w.contains=f.contains,w.escapeSelector=f.escape;var p=function(e,t,r){for(var i=[],n=void 0!==r;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(n&&w(e).is(r))break;i.push(e)}return i},S=function(e,t){for(var r=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&r.push(e);return r},C=w.expr.match.needsContext;function A(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}var L=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function I(e,r,i){return y(r)?w.grep(e,function(e,t){return!!r.call(e,t,e)!==i}):r.nodeType?w.grep(e,function(e){return e===r!==i}):"string"!=typeof r?w.grep(e,function(e){return-1<n.call(r,e)!==i}):w.filter(r,e,i)}w.filter=function(e,t,r){var i=t[0];return r&&(e=":not("+e+")"),1===t.length&&1===i.nodeType?w.find.matchesSelector(i,e)?[i]:[]:w.find.matches(e,w.grep(t,function(e){return 1===e.nodeType}))},w.fn.extend({find:function(e){var t,r,i=this.length,n=this;if("string"!=typeof e)return this.pushStack(w(e).filter(function(){for(t=0;t<i;t++)if(w.contains(n[t],this))return!0}));for(r=this.pushStack([]),t=0;t<i;t++)w.find(e,n[t],r);return 1<i?w.uniqueSort(r):r},filter:function(e){return this.pushStack(I(this,e||[],!1))},not:function(e){return this.pushStack(I(this,e||[],!0))},is:function(e){return!!I(this,"string"==typeof e&&C.test(e)?w(e):e||[],!1).length}});var P,x=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(w.fn.init=function(e,t,r){var i,n;if(!e)return this;if(r=r||P,"string"!=typeof e)return e.nodeType?(this[0]=e,this.length=1,this):y(e)?void 0!==r.ready?r.ready(e):e(w):w.makeArray(e,this);if(!(i="<"===e[0]&&">"===e[e.length-1]&&3<=e.length?[null,e,null]:x.exec(e))||!i[1]&&t)return!t||t.jquery?(t||r).find(e):this.constructor(t).find(e);if(i[1]){if(w.merge(this,w.parseHTML(i[1],(t=t instanceof w?t[0]:t)&&t.nodeType?t.ownerDocument||t:k,!0)),L.test(i[1])&&w.isPlainObject(t))for(i in t)y(this[i])?this[i](t[i]):this.attr(i,t[i]);return this}return(n=k.getElementById(i[2]))&&(this[0]=n,this.length=1),this}).prototype=w.fn,P=w(k);var R=/^(?:parents|prev(?:Until|All))/,O={children:!0,contents:!0,next:!0,prev:!0};function D(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}w.fn.extend({has:function(e){var t=w(e,this),r=t.length;return this.filter(function(){for(var e=0;e<r;e++)if(w.contains(this,t[e]))return!0})},closest:function(e,t){var r,i=0,n=this.length,a=[],o="string"!=typeof e&&w(e);if(!C.test(e))for(;i<n;i++)for(r=this[i];r&&r!==t;r=r.parentNode)if(r.nodeType<11&&(o?-1<o.index(r):1===r.nodeType&&w.find.matchesSelector(r,e))){a.push(r);break}return this.pushStack(1<a.length?w.uniqueSort(a):a)},index:function(e){return e?"string"==typeof e?n.call(w(e),this[0]):n.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(w.uniqueSort(w.merge(this.get(),w(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),w.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return p(e,"parentNode")},parentsUntil:function(e,t,r){return p(e,"parentNode",r)},next:function(e){return D(e,"nextSibling")},prev:function(e){return D(e,"previousSibling")},nextAll:function(e){return p(e,"nextSibling")},prevAll:function(e){return p(e,"previousSibling")},nextUntil:function(e,t,r){return p(e,"nextSibling",r)},prevUntil:function(e,t,r){return p(e,"previousSibling",r)},siblings:function(e){return S((e.parentNode||{}).firstChild,e)},children:function(e){return S(e.firstChild)},contents:function(e){return A(e,"iframe")?e.contentDocument:(A(e,"template")&&(e=e.content||e),w.merge([],e.childNodes))}},function(i,n){w.fn[i]=function(e,t){var r=w.map(this,n,e);return"Until"!==i.slice(-5)&&(t=e),t&&"string"==typeof t&&(r=w.filter(t,r)),1<this.length&&(O[i]||w.uniqueSort(r),R.test(i)&&r.reverse()),this.pushStack(r)}});var M=/[^\x20\t\r\n\f]+/g;function N(e){return e}function F(e){throw e}function j(e,t,r,i){var n;try{e&&y(n=e.promise)?n.call(e).done(t).fail(r):e&&y(n=e.then)?n.call(e,t,r):t.apply(void 0,[e].slice(i))}catch(e){r.call(void 0,e)}}w.Callbacks=function(i){var r;i="string"==typeof i?(r={},w.each(i.match(M)||[],function(e,t){r[t]=!0}),r):w.extend({},i);var n,e,t,a,o=[],s=[],l=-1,u=function(){for(a=a||i.once,t=n=!0;s.length;l=-1)for(e=s.shift();++l<o.length;)!1===o[l].apply(e[0],e[1])&&i.stopOnFalse&&(l=o.length,e=!1);i.memory||(e=!1),n=!1,a&&(o=e?[]:"")},c={add:function(){return o&&(e&&!n&&(l=o.length-1,s.push(e)),function r(e){w.each(e,function(e,t){y(t)?i.unique&&c.has(t)||o.push(t):t&&t.length&&"string"!==T(t)&&r(t)})}(arguments),e&&!n&&u()),this},remove:function(){return w.each(arguments,function(e,t){for(var r;-1<(r=w.inArray(t,o,r));)o.splice(r,1),r<=l&&l--}),this},has:function(e){return e?-1<w.inArray(e,o):0<o.length},empty:function(){return o&&(o=[]),this},disable:function(){return a=s=[],o=e="",this},disabled:function(){return!o},lock:function(){return a=s=[],e||n||(o=e=""),this},locked:function(){return!!a},fireWith:function(e,t){return a||(t=[e,(t=t||[]).slice?t.slice():t],s.push(t),n||u()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!t}};return c},w.extend({Deferred:function(e){var a=[["notify","progress",w.Callbacks("memory"),w.Callbacks("memory"),2],["resolve","done",w.Callbacks("once memory"),w.Callbacks("once memory"),0,"resolved"],["reject","fail",w.Callbacks("once memory"),w.Callbacks("once memory"),1,"rejected"]],n="pending",o={state:function(){return n},always:function(){return s.done(arguments).fail(arguments),this},catch:function(e){return o.then(null,e)},pipe:function(){var n=arguments;return w.Deferred(function(i){w.each(a,function(e,t){var r=y(n[t[4]])&&n[t[4]];s[t[1]](function(){var e=r&&r.apply(this,arguments);e&&y(e.promise)?e.promise().progress(i.notify).done(i.resolve).fail(i.reject):i[t[0]+"With"](this,r?[e]:arguments)})}),n=null}).promise()},then:function(t,r,i){var l=0;function u(n,a,o,s){return function(){var r=this,i=arguments,e=function(){var e,t;if(!(n<l)){if((e=o.apply(r,i))===a.promise())throw new TypeError("Thenable self-resolution");y(t=e&&("object"==typeof e||"function"==typeof e)&&e.then)?s?t.call(e,u(l,a,N,s),u(l,a,F,s)):t.call(e,u(++l,a,N,s),u(l,a,F,s),u(l,a,N,a.notifyWith)):(o!==N&&(r=void 0,i=[e]),(s||a.resolveWith)(r,i))}},t=s?e:function(){try{e()}catch(e){w.Deferred.exceptionHook&&w.Deferred.exceptionHook(e,t.stackTrace),l<=n+1&&(o!==F&&(r=void 0,i=[e]),a.rejectWith(r,i))}};n?t():(w.Deferred.getStackHook&&(t.stackTrace=w.Deferred.getStackHook()),E.setTimeout(t))}}return w.Deferred(function(e){a[0][3].add(u(0,e,y(i)?i:N,e.notifyWith)),a[1][3].add(u(0,e,y(t)?t:N)),a[2][3].add(u(0,e,y(r)?r:F))}).promise()},promise:function(e){return null!=e?w.extend(e,o):o}},s={};return w.each(a,function(e,t){var r=t[2],i=t[5];o[t[1]]=r.add,i&&r.add(function(){n=i},a[3-e][2].disable,a[3-e][3].disable,a[0][2].lock,a[0][3].lock),r.add(t[3].fire),s[t[0]]=function(){return s[t[0]+"With"](this===s?void 0:this,arguments),this},s[t[0]+"With"]=r.fireWith}),o.promise(s),e&&e.call(s,s),s},when:function(e){var r=arguments.length,t=r,i=Array(t),n=s.call(arguments),a=w.Deferred(),o=function(t){return function(e){i[t]=this,n[t]=1<arguments.length?s.call(arguments):e,--r||a.resolveWith(i,n)}};if(r<=1&&(j(e,a.done(o(t)).resolve,a.reject,!r),"pending"===a.state()||y(n[t]&&n[t].then)))return a.then();for(;t--;)j(n[t],o(t),a.reject);return a.promise()}});var B=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;w.Deferred.exceptionHook=function(e,t){E.console&&E.console.warn&&e&&B.test(e.name)&&E.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)},w.readyException=function(e){E.setTimeout(function(){throw e})};var U=w.Deferred();function H(){k.removeEventListener("DOMContentLoaded",H),E.removeEventListener("load",H),w.ready()}w.fn.ready=function(e){return U.then(e).catch(function(e){w.readyException(e)}),this},w.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--w.readyWait:w.isReady)||(w.isReady=!0)!==e&&0<--w.readyWait||U.resolveWith(k,[w])}}),w.ready.then=U.then,"complete"===k.readyState||"loading"!==k.readyState&&!k.documentElement.doScroll?E.setTimeout(w.ready):(k.addEventListener("DOMContentLoaded",H),E.addEventListener("load",H));var G=function(e,t,r,i,n,a,o){var s=0,l=e.length,u=null==r;if("object"===T(r))for(s in n=!0,r)G(e,t,s,r[s],!0,a,o);else if(void 0!==i&&(n=!0,y(i)||(o=!0),u&&(t=o?(t.call(e,i),null):(u=t,function(e,t,r){return u.call(w(e),r)})),t))for(;s<l;s++)t(e[s],r,o?i:i.call(e[s],s,t(e[s],r)));return n?e:u?t.call(e):l?t(e[0],r):a},q=/^-ms-/,V=/-([a-z])/g;function W(e,t){return t.toUpperCase()}function z(e){return e.replace(q,"ms-").replace(V,W)}var K=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function Y(){this.expando=w.expando+Y.uid++}Y.uid=1,Y.prototype={cache:function(e){var t=e[this.expando];return t||(t={},K(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,r){var i,n=this.cache(e);if("string"==typeof t)n[z(t)]=r;else for(i in t)n[z(i)]=t[i];return n},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][z(t)]},access:function(e,t,r){return void 0===t||t&&"string"==typeof t&&void 0===r?this.get(e,t):(this.set(e,t,r),void 0!==r?r:t)},remove:function(e,t){var r,i=e[this.expando];if(void 0!==i){if(void 0!==t){r=(t=Array.isArray(t)?t.map(z):(t=z(t))in i?[t]:t.match(M)||[]).length;for(;r--;)delete i[t[r]]}(void 0===t||w.isEmptyObject(i))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!w.isEmptyObject(t)}};var X=new Y,Q=new Y,J=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Z=/[A-Z]/g;function $(e,t,r){var i,n;if(void 0===r&&1===e.nodeType)if(i="data-"+t.replace(Z,"-$&").toLowerCase(),"string"==typeof(r=e.getAttribute(i))){try{r="true"===(n=r)||"false"!==n&&("null"===n?null:n===+n+""?+n:J.test(n)?JSON.parse(n):n)}catch(e){}Q.set(e,t,r)}else r=void 0;return r}w.extend({hasData:function(e){return Q.hasData(e)||X.hasData(e)},data:function(e,t,r){return Q.access(e,t,r)},removeData:function(e,t){Q.remove(e,t)},_data:function(e,t,r){return X.access(e,t,r)},_removeData:function(e,t){X.remove(e,t)}}),w.fn.extend({data:function(r,e){var t,i,n,a=this[0],o=a&&a.attributes;if(void 0!==r)return"object"==typeof r?this.each(function(){Q.set(this,r)}):G(this,function(e){var t;if(a&&void 0===e)return void 0!==(t=Q.get(a,r))?t:void 0!==(t=$(a,r))?t:void 0;this.each(function(){Q.set(this,r,e)})},null,e,1<arguments.length,null,!0);if(this.length&&(n=Q.get(a),1===a.nodeType&&!X.get(a,"hasDataAttrs"))){for(t=o.length;t--;)o[t]&&0==(i=o[t].name).indexOf("data-")&&(i=z(i.slice(5)),$(a,i,n[i]));X.set(a,"hasDataAttrs",!0)}return n},removeData:function(e){return this.each(function(){Q.remove(this,e)})}}),w.extend({queue:function(e,t,r){var i;if(e)return i=X.get(e,t=(t||"fx")+"queue"),r&&(!i||Array.isArray(r)?i=X.access(e,t,w.makeArray(r)):i.push(r)),i||[]},dequeue:function(e,t){var r=w.queue(e,t=t||"fx"),i=r.length,n=r.shift(),a=w._queueHooks(e,t);"inprogress"===n&&(n=r.shift(),i--),n&&("fx"===t&&r.unshift("inprogress"),delete a.stop,n.call(e,function(){w.dequeue(e,t)},a)),!i&&a&&a.empty.fire()},_queueHooks:function(e,t){var r=t+"queueHooks";return X.get(e,r)||X.access(e,r,{empty:w.Callbacks("once memory").add(function(){X.remove(e,[t+"queue",r])})})}}),w.fn.extend({queue:function(t,r){var e=2;return"string"!=typeof t&&(r=t,t="fx",e--),arguments.length<e?w.queue(this[0],t):void 0===r?this:this.each(function(){var e=w.queue(this,t,r);w._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&w.dequeue(this,t)})},dequeue:function(e){return this.each(function(){w.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var r,i=1,n=w.Deferred(),a=this,o=this.length,s=function(){--i||n.resolveWith(a,[a])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";o--;)(r=X.get(a[o],e+"queueHooks"))&&r.empty&&(i++,r.empty.add(s));return s(),n.promise(t)}});var ee=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,te=RegExp("^(?:([+-])=|)("+ee+")([a-z%]*)$","i"),re=["Top","Right","Bottom","Left"],ie=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&w.contains(e.ownerDocument,e)&&"none"===w.css(e,"display")},ne=function(e,t,r,i){var n,a,o={};for(a in t)o[a]=e.style[a],e.style[a]=t[a];for(a in n=r.apply(e,i||[]),t)e.style[a]=o[a];return n};function ae(e,t,r,i){var n,a,o=20,s=i?function(){return i.cur()}:function(){return w.css(e,t,"")},l=s(),u=r&&r[3]||(w.cssNumber[t]?"":"px"),c=(w.cssNumber[t]||"px"!==u&&+l)&&te.exec(w.css(e,t));if(c&&c[3]!==u){for(u=u||c[3],c=+(l/=2)||1;o--;)w.style(e,t,c+u),(1-a)*(1-(a=s()/l||.5))<=0&&(o=0),c/=a;w.style(e,t,(c*=2)+u),r=r||[]}return r&&(c=+c||+l||0,n=r[1]?c+(r[1]+1)*r[2]:+r[2],i&&(i.unit=u,i.start=c,i.end=n)),n}var oe={};function se(e,t){for(var r,i,n,a,o,s,l,u=[],c=0,d=e.length;c<d;c++)(i=e[c]).style&&(r=i.style.display,t?("none"===r&&(u[c]=X.get(i,"display")||null,u[c]||(i.style.display="")),""===i.style.display&&ie(i)&&(u[c]=(l=o=a=void 0,o=(n=i).ownerDocument,(l=oe[s=n.nodeName])||(a=o.body.appendChild(o.createElement(s)),l=w.css(a,"display"),a.parentNode.removeChild(a),"none"===l&&(l="block"),oe[s]=l)))):"none"!==r&&(u[c]="none",X.set(i,"display",r)));for(c=0;c<d;c++)null!=u[c]&&(e[c].style.display=u[c]);return e}w.fn.extend({show:function(){return se(this,!0)},hide:function(){return se(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){ie(this)?w(this).show():w(this).hide()})}});var le=/^(?:checkbox|radio)$/i,ue=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,ce=/^$|^module$|\/(?:java|ecma)script/i,de={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function he(e,t){var r;return r=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&A(e,t)?w.merge([e],r):r}function fe(e,t){for(var r=0,i=e.length;r<i;r++)X.set(e[r],"globalEval",!t||X.get(t[r],"globalEval"))}de.optgroup=de.option,de.tbody=de.tfoot=de.colgroup=de.caption=de.thead,de.th=de.td;var pe,ge,me=/<|&#?\w+;/;function ve(e,t,r,i,n){for(var a,o,s,l,u,c,d=t.createDocumentFragment(),h=[],f=0,p=e.length;f<p;f++)if((a=e[f])||0===a)if("object"===T(a))w.merge(h,a.nodeType?[a]:a);else if(me.test(a)){for(o=o||d.appendChild(t.createElement("div")),s=(ue.exec(a)||["",""])[1].toLowerCase(),o.innerHTML=(l=de[s]||de._default)[1]+w.htmlPrefilter(a)+l[2],c=l[0];c--;)o=o.lastChild;w.merge(h,o.childNodes),(o=d.firstChild).textContent=""}else h.push(t.createTextNode(a));for(d.textContent="",f=0;a=h[f++];)if(i&&-1<w.inArray(a,i))n&&n.push(a);else if(u=w.contains(a.ownerDocument,a),o=he(d.appendChild(a),"script"),u&&fe(o),r)for(c=0;a=o[c++];)ce.test(a.type||"")&&r.push(a);return d}pe=k.createDocumentFragment().appendChild(k.createElement("div")),(ge=k.createElement("input")).setAttribute("type","radio"),ge.setAttribute("checked","checked"),ge.setAttribute("name","t"),pe.appendChild(ge),v.checkClone=pe.cloneNode(!0).cloneNode(!0).lastChild.checked,pe.innerHTML="<textarea>x</textarea>",v.noCloneChecked=!!pe.cloneNode(!0).lastChild.defaultValue;var ye=k.documentElement,_e=/^key/,be=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Te=/^([^.]*)(?:\.(.+)|)/;function Se(){return!0}function Ee(){return!1}function ke(){try{return k.activeElement}catch(e){}}function we(e,t,r,i,n,a){var o,s;if("object"==typeof t){for(s in"string"!=typeof r&&(i=i||r,r=void 0),t)we(e,s,r,i,t[s],a);return e}if(null==i&&null==n?(n=r,i=r=void 0):null==n&&("string"==typeof r?(n=i,i=void 0):(n=i,i=r,r=void 0)),!1===n)n=Ee;else if(!n)return e;return 1===a&&(o=n,(n=function(e){return w().off(e),o.apply(this,arguments)}).guid=o.guid||(o.guid=w.guid++)),e.each(function(){w.event.add(this,t,n,i,r)})}w.event={global:{},add:function(t,e,r,i,n){var a,o,s,l,u,c,d,h,f,p,g,m=X.get(t);if(m)for(r.handler&&(r=(a=r).handler,n=a.selector),n&&w.find.matchesSelector(ye,n),r.guid||(r.guid=w.guid++),(l=m.events)||(l=m.events={}),(o=m.handle)||(o=m.handle=function(e){return void 0!==w&&w.event.triggered!==e.type?w.event.dispatch.apply(t,arguments):void 0}),u=(e=(e||"").match(M)||[""]).length;u--;)f=g=(s=Te.exec(e[u])||[])[1],p=(s[2]||"").split(".").sort(),f&&(d=w.event.special[f]||{},d=w.event.special[f=(n?d.delegateType:d.bindType)||f]||{},c=w.extend({type:f,origType:g,data:i,handler:r,guid:r.guid,selector:n,needsContext:n&&w.expr.match.needsContext.test(n),namespace:p.join(".")},a),(h=l[f])||((h=l[f]=[]).delegateCount=0,d.setup&&!1!==d.setup.call(t,i,p,o)||t.addEventListener&&t.addEventListener(f,o)),d.add&&(d.add.call(t,c),c.handler.guid||(c.handler.guid=r.guid)),n?h.splice(h.delegateCount++,0,c):h.push(c),w.event.global[f]=!0)},remove:function(e,t,r,i,n){var a,o,s,l,u,c,d,h,f,p,g,m=X.hasData(e)&&X.get(e);if(m&&(l=m.events)){for(u=(t=(t||"").match(M)||[""]).length;u--;)if(f=g=(s=Te.exec(t[u])||[])[1],p=(s[2]||"").split(".").sort(),f){for(d=w.event.special[f]||{},h=l[f=(i?d.delegateType:d.bindType)||f]||[],s=s[2]&&RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),o=a=h.length;a--;)c=h[a],!n&&g!==c.origType||r&&r.guid!==c.guid||s&&!s.test(c.namespace)||i&&i!==c.selector&&("**"!==i||!c.selector)||(h.splice(a,1),c.selector&&h.delegateCount--,d.remove&&d.remove.call(e,c));o&&!h.length&&(d.teardown&&!1!==d.teardown.call(e,p,m.handle)||w.removeEvent(e,f,m.handle),delete l[f])}else for(f in l)w.event.remove(e,f+t[u],r,i,!0);w.isEmptyObject(l)&&X.remove(e,"handle events")}},dispatch:function(e){var t,r,i,n,a,o,s=w.event.fix(e),l=Array(arguments.length),u=(X.get(this,"events")||{})[s.type]||[],c=w.event.special[s.type]||{};for(l[0]=s,t=1;t<arguments.length;t++)l[t]=arguments[t];if(s.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,s)){for(o=w.event.handlers.call(this,s,u),t=0;(n=o[t++])&&!s.isPropagationStopped();)for(s.currentTarget=n.elem,r=0;(a=n.handlers[r++])&&!s.isImmediatePropagationStopped();)s.rnamespace&&!s.rnamespace.test(a.namespace)||(s.handleObj=a,s.data=a.data,void 0!==(i=((w.event.special[a.origType]||{}).handle||a.handler).apply(n.elem,l))&&!1===(s.result=i)&&(s.preventDefault(),s.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,s),s.result}},handlers:function(e,t){var r,i,n,a,o,s=[],l=t.delegateCount,u=e.target;if(l&&u.nodeType&&!("click"===e.type&&1<=e.button))for(;u!==this;u=u.parentNode||this)if(1===u.nodeType&&("click"!==e.type||!0!==u.disabled)){for(a=[],o={},r=0;r<l;r++)void 0===o[n=(i=t[r]).selector+" "]&&(o[n]=i.needsContext?-1<w(n,this).index(u):w.find(n,this,null,[u]).length),o[n]&&a.push(i);a.length&&s.push({elem:u,handlers:a})}return u=this,l<t.length&&s.push({elem:u,handlers:t.slice(l)}),s},addProp:function(t,e){Object.defineProperty(w.Event.prototype,t,{enumerable:!0,configurable:!0,get:y(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(e){return e[w.expando]?e:new w.Event(e)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==ke()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===ke()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&A(this,"input"))return this.click(),!1},_default:function(e){return A(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},w.removeEvent=function(e,t,r){e.removeEventListener&&e.removeEventListener(t,r)},w.Event=function(e,t){if(!(this instanceof w.Event))return new w.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?Se:Ee,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&w.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[w.expando]=!0},w.Event.prototype={constructor:w.Event,isDefaultPrevented:Ee,isPropagationStopped:Ee,isImmediatePropagationStopped:Ee,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=Se,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=Se,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=Se,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},w.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(e){var t=e.button;return null==e.which&&_e.test(e.type)?null!=e.charCode?e.charCode:e.keyCode:!e.which&&void 0!==t&&be.test(e.type)?1&t?1:2&t?3:4&t?2:0:e.which}},w.event.addProp),w.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,n){w.event.special[e]={delegateType:n,bindType:n,handle:function(e){var t,r=e.relatedTarget,i=e.handleObj;return r&&(r===this||w.contains(this,r))||(e.type=i.origType,t=i.handler.apply(this,arguments),e.type=n),t}}}),w.fn.extend({on:function(e,t,r,i){return we(this,e,t,r,i)},one:function(e,t,r,i){return we(this,e,t,r,i,1)},off:function(e,t,r){var i,n;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,w(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"!=typeof e)return!1!==t&&"function"!=typeof t||(r=t,t=void 0),!1===r&&(r=Ee),this.each(function(){w.event.remove(this,e,r,t)});for(n in e)this.off(n,t,e[n]);return this}});var Ce=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,Ae=/<script|<style|<link/i,Le=/checked\s*(?:[^=]|=\s*.checked.)/i,Ie=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Pe(e,t){return A(e,"table")&&A(11!==t.nodeType?t:t.firstChild,"tr")&&w(e).children("tbody")[0]||e}function xe(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function Re(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Oe(e,t){var r,i,n,a,o,s,l,u;if(1===t.nodeType){if(X.hasData(e)&&(a=X.access(e),o=X.set(t,a),u=a.events))for(n in delete o.handle,o.events={},u)for(r=0,i=u[n].length;r<i;r++)w.event.add(t,n,u[n][r]);Q.hasData(e)&&(s=Q.access(e),l=w.extend({},s),Q.set(t,l))}}function De(r,i,n,a){i=g.apply([],i);var e,t,o,s,l,u,c=0,d=r.length,h=d-1,f=i[0],p=y(f);if(p||1<d&&"string"==typeof f&&!v.checkClone&&Le.test(f))return r.each(function(e){var t=r.eq(e);p&&(i[0]=f.call(this,e,t.html())),De(t,i,n,a)});if(d&&(t=(e=ve(i,r[0].ownerDocument,!1,r,a)).firstChild,1===e.childNodes.length&&(e=t),t||a)){for(s=(o=w.map(he(e,"script"),xe)).length;c<d;c++)l=e,c!==h&&(l=w.clone(l,!0,!0),s&&w.merge(o,he(l,"script"))),n.call(r[c],l,c);if(s)for(u=o[o.length-1].ownerDocument,w.map(o,Re),c=0;c<s;c++)ce.test((l=o[c]).type||"")&&!X.access(l,"globalEval")&&w.contains(u,l)&&(l.src&&"module"!==(l.type||"").toLowerCase()?w._evalUrl&&w._evalUrl(l.src):b(l.textContent.replace(Ie,""),u,l))}return r}function Me(e,t,r){for(var i,n=t?w.filter(t,e):e,a=0;null!=(i=n[a]);a++)r||1!==i.nodeType||w.cleanData(he(i)),i.parentNode&&(r&&w.contains(i.ownerDocument,i)&&fe(he(i,"script")),i.parentNode.removeChild(i));return e}w.extend({htmlPrefilter:function(e){return e.replace(Ce,"<$1></$2>")},clone:function(e,t,r){var i,n,a,o,s,l,u,c=e.cloneNode(!0),d=w.contains(e.ownerDocument,e);if(!(v.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||w.isXMLDoc(e)))for(o=he(c),i=0,n=(a=he(e)).length;i<n;i++)s=a[i],void 0,"input"===(u=(l=o[i]).nodeName.toLowerCase())&&le.test(s.type)?l.checked=s.checked:"input"!==u&&"textarea"!==u||(l.defaultValue=s.defaultValue);if(t)if(r)for(a=a||he(e),o=o||he(c),i=0,n=a.length;i<n;i++)Oe(a[i],o[i]);else Oe(e,c);return 0<(o=he(c,"script")).length&&fe(o,!d&&he(e,"script")),c},cleanData:function(e){for(var t,r,i,n=w.event.special,a=0;void 0!==(r=e[a]);a++)if(K(r)){if(t=r[X.expando]){if(t.events)for(i in t.events)n[i]?w.event.remove(r,i):w.removeEvent(r,i,t.handle);r[X.expando]=void 0}r[Q.expando]&&(r[Q.expando]=void 0)}}}),w.fn.extend({detach:function(e){return Me(this,e,!0)},remove:function(e){return Me(this,e)},text:function(e){return G(this,function(e){return void 0===e?w.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return De(this,arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Pe(this,e).appendChild(e)})},prepend:function(){return De(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Pe(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return De(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return De(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(w.cleanData(he(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return w.clone(this,e,t)})},html:function(e){return G(this,function(e){var t=this[0]||{},r=0,i=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Ae.test(e)&&!de[(ue.exec(e)||["",""])[1].toLowerCase()]){e=w.htmlPrefilter(e);try{for(;r<i;r++)1===(t=this[r]||{}).nodeType&&(w.cleanData(he(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var r=[];return De(this,arguments,function(e){var t=this.parentNode;w.inArray(this,r)<0&&(w.cleanData(he(this)),t&&t.replaceChild(e,this))},r)}}),w.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,o){w.fn[e]=function(e){for(var t,r=[],i=w(e),n=i.length-1,a=0;a<=n;a++)t=a===n?this:this.clone(!0),w(i[a])[o](t),l.apply(r,t.get());return this.pushStack(r)}});var Ne=RegExp("^("+ee+")(?!px)[a-z%]+$","i"),Fe=function(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=E),t.getComputedStyle(e)},je=RegExp(re.join("|"),"i");function Be(e,t,r){var i,n,a,o,s=e.style;return(r=r||Fe(e))&&(""!==(o=r.getPropertyValue(t)||r[t])||w.contains(e.ownerDocument,e)||(o=w.style(e,t)),!v.pixelBoxStyles()&&Ne.test(o)&&je.test(t)&&(i=s.width,n=s.minWidth,a=s.maxWidth,s.minWidth=s.maxWidth=s.width=o,o=r.width,s.width=i,s.minWidth=n,s.maxWidth=a)),void 0!==o?o+"":o}function Ue(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function e(){if(l){s.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",l.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",ye.appendChild(s).appendChild(l);var e=E.getComputedStyle(l);r="1%"!==e.top,o=12===t(e.marginLeft),l.style.right="60%",a=36===t(e.right),i=36===t(e.width),l.style.position="absolute",n=36===l.offsetWidth||"absolute",ye.removeChild(s),l=null}}function t(e){return Math.round(parseFloat(e))}var r,i,n,a,o,s=k.createElement("div"),l=k.createElement("div");l.style&&(l.style.backgroundClip="content-box",l.cloneNode(!0).style.backgroundClip="",v.clearCloneStyle="content-box"===l.style.backgroundClip,w.extend(v,{boxSizingReliable:function(){return e(),i},pixelBoxStyles:function(){return e(),a},pixelPosition:function(){return e(),r},reliableMarginLeft:function(){return e(),o},scrollboxSize:function(){return e(),n}}))}();var He=/^(none|table(?!-c[ea]).+)/,Ge=/^--/,qe={position:"absolute",visibility:"hidden",display:"block"},Ve={letterSpacing:"0",fontWeight:"400"},We=["Webkit","Moz","ms"],ze=k.createElement("div").style;function Ke(e){var t=w.cssProps[e];return t||(t=w.cssProps[e]=function(e){if(e in ze)return e;for(var t=e[0].toUpperCase()+e.slice(1),r=We.length;r--;)if((e=We[r]+t)in ze)return e}(e)||e),t}function Ye(e,t,r){var i=te.exec(t);return i?Math.max(0,i[2]-(r||0))+(i[3]||"px"):t}function Xe(e,t,r,i,n,a){var o="width"===t?1:0,s=0,l=0;if(r===(i?"border":"content"))return 0;for(;o<4;o+=2)"margin"===r&&(l+=w.css(e,r+re[o],!0,n)),i?("content"===r&&(l-=w.css(e,"padding"+re[o],!0,n)),"margin"!==r&&(l-=w.css(e,"border"+re[o]+"Width",!0,n))):(l+=w.css(e,"padding"+re[o],!0,n),"padding"!==r?l+=w.css(e,"border"+re[o]+"Width",!0,n):s+=w.css(e,"border"+re[o]+"Width",!0,n));return!i&&0<=a&&(l+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-a-l-s-.5))),l}function Qe(e,t,r){var i=Fe(e),n=Be(e,t,i),a="border-box"===w.css(e,"boxSizing",!1,i),o=a;if(Ne.test(n)){if(!r)return n;n="auto"}return o=o&&(v.boxSizingReliable()||n===e.style[t]),("auto"===n||!parseFloat(n)&&"inline"===w.css(e,"display",!1,i))&&(n=e["offset"+t[0].toUpperCase()+t.slice(1)],o=!0),(n=parseFloat(n)||0)+Xe(e,t,r||(a?"border":"content"),o,i,n)+"px"}function Je(e,t,r,i,n){return new Je.prototype.init(e,t,r,i,n)}w.extend({cssHooks:{opacity:{get:function(e,t){if(t){var r=Be(e,"opacity");return""===r?"1":r}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(e,t,r,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var n,a,o,s=z(t),l=Ge.test(t),u=e.style;if(l||(t=Ke(s)),o=w.cssHooks[t]||w.cssHooks[s],void 0===r)return o&&"get"in o&&void 0!==(n=o.get(e,!1,i))?n:u[t];"string"===(a=typeof r)&&(n=te.exec(r))&&n[1]&&(r=ae(e,t,n),a="number"),null!=r&&r==r&&("number"===a&&(r+=n&&n[3]||(w.cssNumber[s]?"":"px")),v.clearCloneStyle||""!==r||0!=t.indexOf("background")||(u[t]="inherit"),o&&"set"in o&&void 0===(r=o.set(e,r,i))||(l?u.setProperty(t,r):u[t]=r))}},css:function(e,t,r,i){var n,a,o,s=z(t);return Ge.test(t)||(t=Ke(s)),(o=w.cssHooks[t]||w.cssHooks[s])&&"get"in o&&(n=o.get(e,!0,r)),void 0===n&&(n=Be(e,t,i)),"normal"===n&&t in Ve&&(n=Ve[t]),""===r||r?(a=parseFloat(n),!0===r||isFinite(a)?a||0:n):n}}),w.each(["height","width"],function(e,s){w.cssHooks[s]={get:function(e,t,r){if(t)return!He.test(w.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?Qe(e,s,r):ne(e,qe,function(){return Qe(e,s,r)})},set:function(e,t,r){var i,n=Fe(e),a="border-box"===w.css(e,"boxSizing",!1,n),o=r&&Xe(e,s,r,a,n);return a&&v.scrollboxSize()===n.position&&(o-=Math.ceil(e["offset"+s[0].toUpperCase()+s.slice(1)]-parseFloat(n[s])-Xe(e,s,"border",!1,n)-.5)),o&&(i=te.exec(t))&&"px"!==(i[3]||"px")&&(e.style[s]=t,t=w.css(e,s)),Ye(0,t,o)}}}),w.cssHooks.marginLeft=Ue(v.reliableMarginLeft,function(e,t){if(t)return(parseFloat(Be(e,"marginLeft"))||e.getBoundingClientRect().left-ne(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),w.each({margin:"",padding:"",border:"Width"},function(n,a){w.cssHooks[n+a]={expand:function(e){for(var t=0,r={},i="string"==typeof e?e.split(" "):[e];t<4;t++)r[n+re[t]+a]=i[t]||i[t-2]||i[0];return r}},"margin"!==n&&(w.cssHooks[n+a].set=Ye)}),w.fn.extend({css:function(e,t){return G(this,function(e,t,r){var i,n,a={},o=0;if(Array.isArray(t)){for(i=Fe(e),n=t.length;o<n;o++)a[t[o]]=w.css(e,t[o],!1,i);return a}return void 0!==r?w.style(e,t,r):w.css(e,t)},e,t,1<arguments.length)}}),((w.Tween=Je).prototype={constructor:Je,init:function(e,t,r,i,n,a){this.elem=e,this.prop=r,this.easing=n||w.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=i,this.unit=a||(w.cssNumber[r]?"":"px")},cur:function(){var e=Je.propHooks[this.prop];return e&&e.get?e.get(this):Je.propHooks._default.get(this)},run:function(e){var t,r=Je.propHooks[this.prop];return this.pos=t=this.options.duration?w.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),r&&r.set?r.set(this):Je.propHooks._default.set(this),this}}).init.prototype=Je.prototype,(Je.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=w.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){w.fx.step[e.prop]?w.fx.step[e.prop](e):1!==e.elem.nodeType||null==e.elem.style[w.cssProps[e.prop]]&&!w.cssHooks[e.prop]?e.elem[e.prop]=e.now:w.style(e.elem,e.prop,e.now+e.unit)}}}).scrollTop=Je.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},w.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},w.fx=Je.prototype.init,w.fx.step={};var Ze,$e,et,tt,rt=/^(?:toggle|show|hide)$/,it=/queueHooks$/;function nt(){$e&&(!1===k.hidden&&E.requestAnimationFrame?E.requestAnimationFrame(nt):E.setTimeout(nt,w.fx.interval),w.fx.tick())}function at(){return E.setTimeout(function(){Ze=void 0}),Ze=Date.now()}function ot(e,t){var r,i=0,n={height:e};for(t=t?1:0;i<4;i+=2-t)n["margin"+(r=re[i])]=n["padding"+r]=e;return t&&(n.opacity=n.width=e),n}function st(e,t,r){for(var i,n=(lt.tweeners[t]||[]).concat(lt.tweeners["*"]),a=0,o=n.length;a<o;a++)if(i=n[a].call(r,t,e))return i}function lt(a,e,t){var r,o,i=0,n=lt.prefilters.length,s=w.Deferred().always(function(){delete l.elem}),l=function(){if(o)return!1;for(var e=Ze||at(),t=Math.max(0,u.startTime+u.duration-e),r=1-(t/u.duration||0),i=0,n=u.tweens.length;i<n;i++)u.tweens[i].run(r);return s.notifyWith(a,[u,r,t]),r<1&&n?t:(n||s.notifyWith(a,[u,1,0]),s.resolveWith(a,[u]),!1)},u=s.promise({elem:a,props:w.extend({},e),opts:w.extend(!0,{specialEasing:{},easing:w.easing._default},t),originalProperties:e,originalOptions:t,startTime:Ze||at(),duration:t.duration,tweens:[],createTween:function(e,t){var r=w.Tween(a,u.opts,e,t,u.opts.specialEasing[e]||u.opts.easing);return u.tweens.push(r),r},stop:function(e){var t=0,r=e?u.tweens.length:0;if(o)return this;for(o=!0;t<r;t++)u.tweens[t].run(1);return e?(s.notifyWith(a,[u,1,0]),s.resolveWith(a,[u,e])):s.rejectWith(a,[u,e]),this}}),c=u.props;for(!function(e,t){var r,i,n,a,o;for(r in e)if(n=t[i=z(r)],Array.isArray(a=e[r])&&(n=a[1],a=e[r]=a[0]),r!==i&&(e[i]=a,delete e[r]),(o=w.cssHooks[i])&&"expand"in o)for(r in a=o.expand(a),delete e[i],a)r in e||(e[r]=a[r],t[r]=n);else t[i]=n}(c,u.opts.specialEasing);i<n;i++)if(r=lt.prefilters[i].call(u,a,c,u.opts))return y(r.stop)&&(w._queueHooks(u.elem,u.opts.queue).stop=r.stop.bind(r)),r;return w.map(c,st,u),y(u.opts.start)&&u.opts.start.call(a,u),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always),w.fx.timer(w.extend(l,{elem:a,anim:u,queue:u.opts.queue})),u}w.Animation=w.extend(lt,{tweeners:{"*":[function(e,t){var r=this.createTween(e,t);return ae(r.elem,e,te.exec(t),r),r}]},tweener:function(e,t){for(var r,i=0,n=(e=y(e)?(t=e,["*"]):e.match(M)).length;i<n;i++)(lt.tweeners[r=e[i]]=lt.tweeners[r]||[]).unshift(t)},prefilters:[function(e,t,r){var i,n,a,o,s,l,u,c,d="width"in t||"height"in t,h=this,f={},p=e.style,g=e.nodeType&&ie(e),m=X.get(e,"fxshow");for(i in r.queue||(null==(o=w._queueHooks(e,"fx")).unqueued&&(o.unqueued=0,s=o.empty.fire,o.empty.fire=function(){o.unqueued||s()}),o.unqueued++,h.always(function(){h.always(function(){o.unqueued--,w.queue(e,"fx").length||o.empty.fire()})})),t)if(rt.test(n=t[i])){if(delete t[i],a=a||"toggle"===n,n===(g?"hide":"show")){if("show"!==n||!m||void 0===m[i])continue;g=!0}f[i]=m&&m[i]||w.style(e,i)}if((l=!w.isEmptyObject(t))||!w.isEmptyObject(f))for(i in d&&1===e.nodeType&&(r.overflow=[p.overflow,p.overflowX,p.overflowY],null==(u=m&&m.display)&&(u=X.get(e,"display")),"none"===(c=w.css(e,"display"))&&(u?c=u:(se([e],!0),u=e.style.display||u,c=w.css(e,"display"),se([e]))),("inline"===c||"inline-block"===c&&null!=u)&&"none"===w.css(e,"float")&&(l||(h.done(function(){p.display=u}),null==u&&(u="none"===(c=p.display)?"":c)),p.display="inline-block")),r.overflow&&(p.overflow="hidden",h.always(function(){p.overflow=r.overflow[0],p.overflowX=r.overflow[1],p.overflowY=r.overflow[2]})),l=!1,f)l||(m?"hidden"in m&&(g=m.hidden):m=X.access(e,"fxshow",{display:u}),a&&(m.hidden=!g),g&&se([e],!0),h.done(function(){for(i in g||se([e]),X.remove(e,"fxshow"),f)w.style(e,i,f[i])})),l=st(g?m[i]:0,i,h),i in m||(m[i]=l.start,g&&(l.end=l.start,l.start=0))}],prefilter:function(e,t){t?lt.prefilters.unshift(e):lt.prefilters.push(e)}}),w.speed=function(e,t,r){var i=e&&"object"==typeof e?w.extend({},e):{complete:r||!r&&t||y(e)&&e,duration:e,easing:r&&t||t&&!y(t)&&t};return w.fx.off?i.duration=0:"number"!=typeof i.duration&&(i.duration=i.duration in w.fx.speeds?w.fx.speeds[i.duration]:w.fx.speeds._default),null!=i.queue&&!0!==i.queue||(i.queue="fx"),i.old=i.complete,i.complete=function(){y(i.old)&&i.old.call(this),i.queue&&w.dequeue(this,i.queue)},i},w.fn.extend({fadeTo:function(e,t,r,i){return this.filter(ie).css("opacity",0).show().end().animate({opacity:t},e,r,i)},animate:function(t,e,r,i){var n=w.isEmptyObject(t),a=w.speed(e,r,i),o=function(){var e=lt(this,w.extend({},t),a);(n||X.get(this,"finish"))&&e.stop(!0)};return o.finish=o,n||!1===a.queue?this.each(o):this.queue(a.queue,o)},stop:function(n,e,a){var o=function(e){var t=e.stop;delete e.stop,t(a)};return"string"!=typeof n&&(a=e,e=n,n=void 0),e&&!1!==n&&this.queue(n||"fx",[]),this.each(function(){var e=!0,t=null!=n&&n+"queueHooks",r=w.timers,i=X.get(this);if(t)i[t]&&i[t].stop&&o(i[t]);else for(t in i)i[t]&&i[t].stop&&it.test(t)&&o(i[t]);for(t=r.length;t--;)r[t].elem!==this||null!=n&&r[t].queue!==n||(r[t].anim.stop(a),e=!1,r.splice(t,1));!e&&a||w.dequeue(this,n)})},finish:function(o){return!1!==o&&(o=o||"fx"),this.each(function(){var e,t=X.get(this),r=t[o+"queue"],i=t[o+"queueHooks"],n=w.timers,a=r?r.length:0;for(t.finish=!0,w.queue(this,o,[]),i&&i.stop&&i.stop.call(this,!0),e=n.length;e--;)n[e].elem===this&&n[e].queue===o&&(n[e].anim.stop(!0),n.splice(e,1));for(e=0;e<a;e++)r[e]&&r[e].finish&&r[e].finish.call(this);delete t.finish})}}),w.each(["toggle","show","hide"],function(e,i){var n=w.fn[i];w.fn[i]=function(e,t,r){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(ot(i,!0),e,t,r)}}),w.each({slideDown:ot("show"),slideUp:ot("hide"),slideToggle:ot("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,i){w.fn[e]=function(e,t,r){return this.animate(i,e,t,r)}}),w.timers=[],w.fx.tick=function(){var e,t=0,r=w.timers;for(Ze=Date.now();t<r.length;t++)(e=r[t])()||r[t]!==e||r.splice(t--,1);r.length||w.fx.stop(),Ze=void 0},w.fx.timer=function(e){w.timers.push(e),w.fx.start()},w.fx.interval=13,w.fx.start=function(){$e||($e=!0,nt())},w.fx.stop=function(){$e=null},w.fx.speeds={slow:600,fast:200,_default:400},w.fn.delay=function(i,e){return i=w.fx&&w.fx.speeds[i]||i,this.queue(e=e||"fx",function(e,t){var r=E.setTimeout(e,i);t.stop=function(){E.clearTimeout(r)}})},et=k.createElement("input"),tt=k.createElement("select").appendChild(k.createElement("option")),et.type="checkbox",v.checkOn=""!==et.value,v.optSelected=tt.selected,(et=k.createElement("input")).value="t",et.type="radio",v.radioValue="t"===et.value;var ut,ct=w.expr.attrHandle;w.fn.extend({attr:function(e,t){return G(this,w.attr,e,t,1<arguments.length)},removeAttr:function(e){return this.each(function(){w.removeAttr(this,e)})}}),w.extend({attr:function(e,t,r){var i,n,a=e.nodeType;if(3!==a&&8!==a&&2!==a)return void 0===e.getAttribute?w.prop(e,t,r):(1===a&&w.isXMLDoc(e)||(n=w.attrHooks[t.toLowerCase()]||(w.expr.match.bool.test(t)?ut:void 0)),void 0!==r?null===r?void w.removeAttr(e,t):n&&"set"in n&&void 0!==(i=n.set(e,r,t))?i:(e.setAttribute(t,r+""),r):n&&"get"in n&&null!==(i=n.get(e,t))?i:null==(i=w.find.attr(e,t))?void 0:i)},attrHooks:{type:{set:function(e,t){if(!v.radioValue&&"radio"===t&&A(e,"input")){var r=e.value;return e.setAttribute("type",t),r&&(e.value=r),t}}}},removeAttr:function(e,t){var r,i=0,n=t&&t.match(M);if(n&&1===e.nodeType)for(;r=n[i++];)e.removeAttribute(r)}}),ut={set:function(e,t,r){return!1===t?w.removeAttr(e,r):e.setAttribute(r,r),r}},w.each(w.expr.match.bool.source.match(/\w+/g),function(e,t){var o=ct[t]||w.find.attr;ct[t]=function(e,t,r){var i,n,a=t.toLowerCase();return r||(n=ct[a],ct[a]=i,i=null!=o(e,t,r)?a:null,ct[a]=n),i}});var dt=/^(?:input|select|textarea|button)$/i,ht=/^(?:a|area)$/i;function ft(e){return(e.match(M)||[]).join(" ")}function pt(e){return e.getAttribute&&e.getAttribute("class")||""}function gt(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(M)||[]}w.fn.extend({prop:function(e,t){return G(this,w.prop,e,t,1<arguments.length)},removeProp:function(e){return this.each(function(){delete this[w.propFix[e]||e]})}}),w.extend({prop:function(e,t,r){var i,n,a=e.nodeType;if(3!==a&&8!==a&&2!==a)return 1===a&&w.isXMLDoc(e)||(n=w.propHooks[t=w.propFix[t]||t]),void 0!==r?n&&"set"in n&&void 0!==(i=n.set(e,r,t))?i:e[t]=r:n&&"get"in n&&null!==(i=n.get(e,t))?i:e[t]},propHooks:{tabIndex:{get:function(e){var t=w.find.attr(e,"tabindex");return t?parseInt(t,10):dt.test(e.nodeName)||ht.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),v.optSelected||(w.propHooks.selected={get:function(e){return null},set:function(e){}}),w.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){w.propFix[this.toLowerCase()]=this}),w.fn.extend({addClass:function(t){var e,r,i,n,a,o,s,l=0;if(y(t))return this.each(function(e){w(this).addClass(t.call(this,e,pt(this)))});if((e=gt(t)).length)for(;r=this[l++];)if(n=pt(r),i=1===r.nodeType&&" "+ft(n)+" "){for(o=0;a=e[o++];)i.indexOf(" "+a+" ")<0&&(i+=a+" ");n!==(s=ft(i))&&r.setAttribute("class",s)}return this},removeClass:function(t){var e,r,i,n,a,o,s,l=0;if(y(t))return this.each(function(e){w(this).removeClass(t.call(this,e,pt(this)))});if(!arguments.length)return this.attr("class","");if((e=gt(t)).length)for(;r=this[l++];)if(n=pt(r),i=1===r.nodeType&&" "+ft(n)+" "){for(o=0;a=e[o++];)for(;-1<i.indexOf(" "+a+" ");)i=i.replace(" "+a+" "," ");n!==(s=ft(i))&&r.setAttribute("class",s)}return this},toggleClass:function(n,t){var a=typeof n,o="string"===a||Array.isArray(n);return"boolean"==typeof t&&o?t?this.addClass(n):this.removeClass(n):y(n)?this.each(function(e){w(this).toggleClass(n.call(this,e,pt(this),t),t)}):this.each(function(){var e,t,r,i;if(o)for(t=0,r=w(this),i=gt(n);e=i[t++];)r.hasClass(e)?r.removeClass(e):r.addClass(e);else void 0!==n&&"boolean"!==a||((e=pt(this))&&X.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||!1===n?"":X.get(this,"__className__")||""))})},hasClass:function(e){var t,r,i=0;for(t=" "+e+" ";r=this[i++];)if(1===r.nodeType&&-1<(" "+ft(pt(r))+" ").indexOf(t))return!0;return!1}});var mt=/\r/g;w.fn.extend({val:function(r){var i,e,n,t=this[0];return arguments.length?(n=y(r),this.each(function(e){var t;1===this.nodeType&&(null==(t=n?r.call(this,e,w(this).val()):r)?t="":"number"==typeof t?t+="":Array.isArray(t)&&(t=w.map(t,function(e){return null==e?"":e+""})),(i=w.valHooks[this.type]||w.valHooks[this.nodeName.toLowerCase()])&&"set"in i&&void 0!==i.set(this,t,"value")||(this.value=t))})):t?(i=w.valHooks[t.type]||w.valHooks[t.nodeName.toLowerCase()])&&"get"in i&&void 0!==(e=i.get(t,"value"))?e:"string"==typeof(e=t.value)?e.replace(mt,""):null==e?"":e:void 0}}),w.extend({valHooks:{option:{get:function(e){var t=w.find.attr(e,"value");return null!=t?t:ft(w.text(e))}},select:{get:function(e){var t,r,i,n=e.options,a=e.selectedIndex,o="select-one"===e.type,s=o?null:[],l=o?a+1:n.length;for(i=a<0?l:o?a:0;i<l;i++)if(((r=n[i]).selected||i===a)&&!r.disabled&&(!r.parentNode.disabled||!A(r.parentNode,"optgroup"))){if(t=w(r).val(),o)return t;s.push(t)}return s},set:function(e,t){for(var r,i,n=e.options,a=w.makeArray(t),o=n.length;o--;)((i=n[o]).selected=-1<w.inArray(w.valHooks.option.get(i),a))&&(r=!0);return r||(e.selectedIndex=-1),a}}}}),w.each(["radio","checkbox"],function(){w.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=-1<w.inArray(w(e).val(),t)}},v.checkOn||(w.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),v.focusin="onfocusin"in E;var vt=/^(?:focusinfocus|focusoutblur)$/,yt=function(e){e.stopPropagation()};w.extend(w.event,{trigger:function(e,t,r,i){var n,a,o,s,l,u,c,d,h=[r||k],f=m.call(e,"type")?e.type:e,p=m.call(e,"namespace")?e.namespace.split("."):[];if(a=d=o=r=r||k,3!==r.nodeType&&8!==r.nodeType&&!vt.test(f+w.event.triggered)&&(-1<f.indexOf(".")&&(f=(p=f.split(".")).shift(),p.sort()),l=f.indexOf(":")<0&&"on"+f,(e=e[w.expando]?e:new w.Event(f,"object"==typeof e&&e)).isTrigger=i?2:3,e.namespace=p.join("."),e.rnamespace=e.namespace?RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=r),t=null==t?[e]:w.makeArray(t,[e]),c=w.event.special[f]||{},i||!c.trigger||!1!==c.trigger.apply(r,t))){if(!i&&!c.noBubble&&!_(r)){for(vt.test((s=c.delegateType||f)+f)||(a=a.parentNode);a;a=a.parentNode)h.push(a),o=a;o===(r.ownerDocument||k)&&h.push(o.defaultView||o.parentWindow||E)}for(n=0;(a=h[n++])&&!e.isPropagationStopped();)d=a,e.type=1<n?s:c.bindType||f,(u=(X.get(a,"events")||{})[e.type]&&X.get(a,"handle"))&&u.apply(a,t),(u=l&&a[l])&&u.apply&&K(a)&&(e.result=u.apply(a,t),!1===e.result&&e.preventDefault());return e.type=f,i||e.isDefaultPrevented()||c._default&&!1!==c._default.apply(h.pop(),t)||!K(r)||l&&y(r[f])&&!_(r)&&((o=r[l])&&(r[l]=null),w.event.triggered=f,e.isPropagationStopped()&&d.addEventListener(f,yt),r[f](),e.isPropagationStopped()&&d.removeEventListener(f,yt),w.event.triggered=void 0,o&&(r[l]=o)),e.result}},simulate:function(e,t,r){var i=w.extend(new w.Event,r,{type:e,isSimulated:!0});w.event.trigger(i,null,t)}}),w.fn.extend({trigger:function(e,t){return this.each(function(){w.event.trigger(e,t,this)})},triggerHandler:function(e,t){var r=this[0];if(r)return w.event.trigger(e,t,r,!0)}}),v.focusin||w.each({focus:"focusin",blur:"focusout"},function(r,i){var n=function(e){w.event.simulate(i,e.target,w.event.fix(e))};w.event.special[i]={setup:function(){var e=this.ownerDocument||this,t=X.access(e,i);t||e.addEventListener(r,n,!0),X.access(e,i,(t||0)+1)},teardown:function(){var e=this.ownerDocument||this,t=X.access(e,i)-1;t?X.access(e,i,t):(e.removeEventListener(r,n,!0),X.remove(e,i))}}});var _t=E.location,bt=Date.now(),Tt=/\?/;w.parseXML=function(e){var t;if(!e||"string"!=typeof e)return null;try{t=(new E.DOMParser).parseFromString(e,"text/xml")}catch(e){t=void 0}return t&&!t.getElementsByTagName("parsererror").length||w.error("Invalid XML: "+e),t};var St=/\[\]$/,Et=/\r?\n/g,kt=/^(?:submit|button|image|reset|file)$/i,wt=/^(?:input|select|textarea|keygen)/i;function Ct(r,e,i,n){var t;if(Array.isArray(e))w.each(e,function(e,t){i||St.test(r)?n(r,t):Ct(r+"["+("object"==typeof t&&null!=t?e:"")+"]",t,i,n)});else if(i||"object"!==T(e))n(r,e);else for(t in e)Ct(r+"["+t+"]",e[t],i,n)}w.param=function(e,t){var r,i=[],n=function(e,t){var r=y(t)?t():t;i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==r?"":r)};if(Array.isArray(e)||e.jquery&&!w.isPlainObject(e))w.each(e,function(){n(this.name,this.value)});else for(r in e)Ct(r,e[r],t,n);return i.join("&")},w.fn.extend({serialize:function(){return w.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=w.prop(this,"elements");return e?w.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!w(this).is(":disabled")&&wt.test(this.nodeName)&&!kt.test(e)&&(this.checked||!le.test(e))}).map(function(e,t){var r=w(this).val();return null==r?null:Array.isArray(r)?w.map(r,function(e){return{name:t.name,value:e.replace(Et,"\r\n")}}):{name:t.name,value:r.replace(Et,"\r\n")}}).get()}});var At=/%20/g,Lt=/#.*$/,It=/([?&])_=[^&]*/,Pt=/^(.*?):[ \t]*([^\r\n]*)$/gm,xt=/^(?:GET|HEAD)$/,Rt=/^\/\//,Ot={},Dt={},Mt=k.createElement("a");function Nt(a){return function(e,t){"string"!=typeof e&&(t=e,e="*");var r,i=0,n=e.toLowerCase().match(M)||[];if(y(t))for(;r=n[i++];)"+"===r[0]?(r=r.slice(1)||"*",(a[r]=a[r]||[]).unshift(t)):(a[r]=a[r]||[]).push(t)}}function Ft(t,n,a,o){var s={},l=t===Dt;function u(e){var i;return s[e]=!0,w.each(t[e]||[],function(e,t){var r=t(n,a,o);return"string"!=typeof r||l||s[r]?l?!(i=r):void 0:(n.dataTypes.unshift(r),u(r),!1)}),i}return u(n.dataTypes[0])||!s["*"]&&u("*")}function jt(e,t){var r,i,n=w.ajaxSettings.flatOptions||{};for(r in t)void 0!==t[r]&&((n[r]?e:i||(i={}))[r]=t[r]);return i&&w.extend(!0,e,i),e}Mt.href=_t.href,w.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:_t.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(_t.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":"*/*",text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":w.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?jt(jt(e,w.ajaxSettings),t):jt(w.ajaxSettings,e)},ajaxPrefilter:Nt(Ot),ajaxTransport:Nt(Dt),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0);var c,d,h,r,f,i,p,g,n,a,m=w.ajaxSetup({},t=t||{}),v=m.context||m,y=m.context&&(v.nodeType||v.jquery)?w(v):w.event,_=w.Deferred(),b=w.Callbacks("once memory"),T=m.statusCode||{},o={},s={},l="canceled",S={readyState:0,getResponseHeader:function(e){var t;if(p){if(!r)for(r={};t=Pt.exec(h);)r[t[1].toLowerCase()]=t[2];t=r[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return p?h:null},setRequestHeader:function(e,t){return null==p&&(e=s[e.toLowerCase()]=s[e.toLowerCase()]||e,o[e]=t),this},overrideMimeType:function(e){return null==p&&(m.mimeType=e),this},statusCode:function(e){var t;if(e)if(p)S.always(e[S.status]);else for(t in e)T[t]=[T[t],e[t]];return this},abort:function(e){var t=e||l;return c&&c.abort(t),u(0,t),this}};if(_.promise(S),m.url=((e||m.url||_t.href)+"").replace(Rt,_t.protocol+"//"),m.type=t.method||t.type||m.method||m.type,m.dataTypes=(m.dataType||"*").toLowerCase().match(M)||[""],null==m.crossDomain){i=k.createElement("a");try{i.href=m.url,i.href=i.href,m.crossDomain=Mt.protocol+"//"+Mt.host!=i.protocol+"//"+i.host}catch(e){m.crossDomain=!0}}if(m.data&&m.processData&&"string"!=typeof m.data&&(m.data=w.param(m.data,m.traditional)),Ft(Ot,m,t,S),p)return S;for(n in(g=w.event&&m.global)&&0==w.active++&&w.event.trigger("ajaxStart"),m.type=m.type.toUpperCase(),m.hasContent=!xt.test(m.type),d=m.url.replace(Lt,""),m.hasContent?m.data&&m.processData&&0==(m.contentType||"").indexOf("application/x-www-form-urlencoded")&&(m.data=m.data.replace(At,"+")):(a=m.url.slice(d.length),m.data&&(m.processData||"string"==typeof m.data)&&(d+=(Tt.test(d)?"&":"?")+m.data,delete m.data),!1===m.cache&&(d=d.replace(It,"$1"),a=(Tt.test(d)?"&":"?")+"_="+bt+++a),m.url=d+a),m.ifModified&&(w.lastModified[d]&&S.setRequestHeader("If-Modified-Since",w.lastModified[d]),w.etag[d]&&S.setRequestHeader("If-None-Match",w.etag[d])),(m.data&&m.hasContent&&!1!==m.contentType||t.contentType)&&S.setRequestHeader("Content-Type",m.contentType),S.setRequestHeader("Accept",m.dataTypes[0]&&m.accepts[m.dataTypes[0]]?m.accepts[m.dataTypes[0]]+("*"!==m.dataTypes[0]?", */*; q=0.01":""):m.accepts["*"]),m.headers)S.setRequestHeader(n,m.headers[n]);if(m.beforeSend&&(!1===m.beforeSend.call(v,S,m)||p))return S.abort();if(l="abort",b.add(m.complete),S.done(m.success),S.fail(m.error),c=Ft(Dt,m,t,S)){if(S.readyState=1,g&&y.trigger("ajaxSend",[S,m]),p)return S;m.async&&0<m.timeout&&(f=E.setTimeout(function(){S.abort("timeout")},m.timeout));try{p=!1,c.send(o,u)}catch(e){if(p)throw e;u(-1,e)}}else u(-1,"No Transport");function u(e,t,r,i){var n,a,o,s,l,u=t;p||(p=!0,f&&E.clearTimeout(f),c=void 0,h=i||"",S.readyState=0<e?4:0,n=200<=e&&e<300||304===e,r&&(s=function(e,t,r){for(var i,n,a,o,s=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===i&&(i=e.mimeType||t.getResponseHeader("Content-Type"));if(i)for(n in s)if(s[n]&&s[n].test(i)){l.unshift(n);break}if(l[0]in r)a=l[0];else{for(n in r){if(!l[0]||e.converters[n+" "+l[0]]){a=n;break}o||(o=n)}a=a||o}if(a)return a!==l[0]&&l.unshift(a),r[a]}(m,S,r)),s=function(e,t,r,i){var n,a,o,s,l,u={},c=e.dataTypes.slice();if(c[1])for(o in e.converters)u[o.toLowerCase()]=e.converters[o];for(a=c.shift();a;)if(e.responseFields[a]&&(r[e.responseFields[a]]=t),!l&&i&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=a,a=c.shift())if("*"===a)a=l;else if("*"!==l&&l!==a){if(!(o=u[l+" "+a]||u["* "+a]))for(n in u)if((s=n.split(" "))[1]===a&&(o=u[l+" "+s[0]]||u["* "+s[0]])){!0===o?o=u[n]:!0!==u[n]&&(a=s[0],c.unshift(s[1]));break}if(!0!==o)if(o&&e.throws)t=o(t);else try{t=o(t)}catch(e){return{state:"parsererror",error:o?e:"No conversion from "+l+" to "+a}}}return{state:"success",data:t}}(m,s,S,n),n?(m.ifModified&&((l=S.getResponseHeader("Last-Modified"))&&(w.lastModified[d]=l),(l=S.getResponseHeader("etag"))&&(w.etag[d]=l)),204===e||"HEAD"===m.type?u="nocontent":304===e?u="notmodified":(u=s.state,a=s.data,n=!(o=s.error))):(o=u,!e&&u||(u="error",e<0&&(e=0))),S.status=e,S.statusText=(t||u)+"",n?_.resolveWith(v,[a,u,S]):_.rejectWith(v,[S,u,o]),S.statusCode(T),T=void 0,g&&y.trigger(n?"ajaxSuccess":"ajaxError",[S,m,n?a:o]),b.fireWith(v,[S,u]),g&&(y.trigger("ajaxComplete",[S,m]),--w.active||w.event.trigger("ajaxStop")))}return S},getJSON:function(e,t,r){return w.get(e,t,r,"json")},getScript:function(e,t){return w.get(e,void 0,t,"script")}}),w.each(["get","post"],function(e,n){w[n]=function(e,t,r,i){return y(t)&&(i=i||r,r=t,t=void 0),w.ajax(w.extend({url:e,type:n,dataType:i,data:t,success:r},w.isPlainObject(e)&&e))}}),w._evalUrl=function(e){return w.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,throws:!0})},w.fn.extend({wrapAll:function(e){var t;return this[0]&&(y(e)&&(e=e.call(this[0])),t=w(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(r){return y(r)?this.each(function(e){w(this).wrapInner(r.call(this,e))}):this.each(function(){var e=w(this),t=e.contents();t.length?t.wrapAll(r):e.append(r)})},wrap:function(t){var r=y(t);return this.each(function(e){w(this).wrapAll(r?t.call(this,e):t)})},unwrap:function(e){return this.parent(e).not("body").each(function(){w(this).replaceWith(this.childNodes)}),this}}),w.expr.pseudos.hidden=function(e){return!w.expr.pseudos.visible(e)},w.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},w.ajaxSettings.xhr=function(){try{return new E.XMLHttpRequest}catch(e){}};var Bt={0:200,1223:204},Ut=w.ajaxSettings.xhr();v.cors=!!Ut&&"withCredentials"in Ut,v.ajax=Ut=!!Ut,w.ajaxTransport(function(n){var a,o;if(v.cors||Ut&&!n.crossDomain)return{send:function(e,t){var r,i=n.xhr();if(i.open(n.type,n.url,n.async,n.username,n.password),n.xhrFields)for(r in n.xhrFields)i[r]=n.xhrFields[r];for(r in n.mimeType&&i.overrideMimeType&&i.overrideMimeType(n.mimeType),n.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest"),e)i.setRequestHeader(r,e[r]);a=function(e){return function(){a&&(a=o=i.onload=i.onerror=i.onabort=i.ontimeout=i.onreadystatechange=null,"abort"===e?i.abort():"error"===e?"number"!=typeof i.status?t(0,"error"):t(i.status,i.statusText):t(Bt[i.status]||i.status,i.statusText,"text"!==(i.responseType||"text")||"string"!=typeof i.responseText?{binary:i.response}:{text:i.responseText},i.getAllResponseHeaders()))}},i.onload=a(),o=i.onerror=i.ontimeout=a("error"),void 0!==i.onabort?i.onabort=o:i.onreadystatechange=function(){4===i.readyState&&E.setTimeout(function(){a&&o()})},a=a("abort");try{i.send(n.hasContent&&n.data||null)}catch(e){if(a)throw e}},abort:function(){a&&a()}}}),w.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),w.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return w.globalEval(e),e}}}),w.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),w.ajaxTransport("script",function(r){var i,n;if(r.crossDomain)return{send:function(e,t){i=w("<script>").prop({charset:r.scriptCharset,src:r.url}).on("load error",n=function(e){i.remove(),n=null,e&&t("error"===e.type?404:200,e.type)}),k.head.appendChild(i[0])},abort:function(){n&&n()}}});var Ht,Gt=[],qt=/(=)\?(?=&|$)|\?\?/;w.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Gt.pop()||w.expando+"_"+bt++;return this[e]=!0,e}}),w.ajaxPrefilter("json jsonp",function(e,t,r){var i,n,a,o=!1!==e.jsonp&&(qt.test(e.url)?"url":"string"==typeof e.data&&0==(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&qt.test(e.data)&&"data");if(o||"jsonp"===e.dataTypes[0])return i=e.jsonpCallback=y(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,o?e[o]=e[o].replace(qt,"$1"+i):!1!==e.jsonp&&(e.url+=(Tt.test(e.url)?"&":"?")+e.jsonp+"="+i),e.converters["script json"]=function(){return a||w.error(i+" was not called"),a[0]},e.dataTypes[0]="json",n=E[i],E[i]=function(){a=arguments},r.always(function(){void 0===n?w(E).removeProp(i):E[i]=n,e[i]&&(e.jsonpCallback=t.jsonpCallback,Gt.push(i)),a&&y(n)&&n(a[0]),a=n=void 0}),"script"}),v.createHTMLDocument=((Ht=k.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===Ht.childNodes.length),w.parseHTML=function(e,t,r){return"string"!=typeof e?[]:("boolean"==typeof t&&(r=t,t=!1),t||(v.createHTMLDocument?((i=(t=k.implementation.createHTMLDocument("")).createElement("base")).href=k.location.href,t.head.appendChild(i)):t=k),a=!r&&[],(n=L.exec(e))?[t.createElement(n[1])]:(n=ve([e],t,a),a&&a.length&&w(a).remove(),w.merge([],n.childNodes)));var i,n,a},w.fn.load=function(e,t,r){var i,n,a,o=this,s=e.indexOf(" ");return-1<s&&(i=ft(e.slice(s)),e=e.slice(0,s)),y(t)?(r=t,t=void 0):t&&"object"==typeof t&&(n="POST"),0<o.length&&w.ajax({url:e,type:n||"GET",dataType:"html",data:t}).done(function(e){a=arguments,o.html(i?w("<div>").append(w.parseHTML(e)).find(i):e)}).always(r&&function(e,t){o.each(function(){r.apply(this,a||[e.responseText,t,e])})}),this},w.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){w.fn[t]=function(e){return this.on(t,e)}}),w.expr.pseudos.animated=function(t){return w.grep(w.timers,function(e){return t===e.elem}).length},w.offset={setOffset:function(e,t,r){var i,n,a,o,s,l,u=w.css(e,"position"),c=w(e),d={};"static"===u&&(e.style.position="relative"),s=c.offset(),a=w.css(e,"top"),l=w.css(e,"left"),n=("absolute"===u||"fixed"===u)&&-1<(a+l).indexOf("auto")?(o=(i=c.position()).top,i.left):(o=parseFloat(a)||0,parseFloat(l)||0),y(t)&&(t=t.call(e,r,w.extend({},s))),null!=t.top&&(d.top=t.top-s.top+o),null!=t.left&&(d.left=t.left-s.left+n),"using"in t?t.using.call(e,d):c.css(d)}},w.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){w.offset.setOffset(this,t,e)});var e,r,i=this[0];return i?i.getClientRects().length?{top:(e=i.getBoundingClientRect()).top+(r=i.ownerDocument.defaultView).pageYOffset,left:e.left+r.pageXOffset}:{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,r,i=this[0],n={top:0,left:0};if("fixed"===w.css(i,"position"))t=i.getBoundingClientRect();else{for(t=this.offset(),r=i.ownerDocument,e=i.offsetParent||r.documentElement;e&&(e===r.body||e===r.documentElement)&&"static"===w.css(e,"position");)e=e.parentNode;e&&e!==i&&1===e.nodeType&&((n=w(e).offset()).top+=w.css(e,"borderTopWidth",!0),n.left+=w.css(e,"borderLeftWidth",!0))}return{top:t.top-n.top-w.css(i,"marginTop",!0),left:t.left-n.left-w.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&"static"===w.css(e,"position");)e=e.offsetParent;return e||ye})}}),w.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,n){var a="pageYOffset"===n;w.fn[t]=function(e){return G(this,function(e,t,r){var i;if(_(e)?i=e:9===e.nodeType&&(i=e.defaultView),void 0===r)return i?i[n]:e[t];i?i.scrollTo(a?i.pageXOffset:r,a?r:i.pageYOffset):e[t]=r},t,e,arguments.length)}}),w.each(["top","left"],function(e,r){w.cssHooks[r]=Ue(v.pixelPosition,function(e,t){if(t)return t=Be(e,r),Ne.test(t)?w(e).position()[r]+"px":t})}),w.each({Height:"height",Width:"width"},function(o,s){w.each({padding:"inner"+o,content:s,"":"outer"+o},function(i,a){w.fn[a]=function(e,t){var r=arguments.length&&(i||"boolean"!=typeof e),n=i||(!0===e||!0===t?"margin":"border");return G(this,function(e,t,r){var i;return _(e)?0==a.indexOf("outer")?e["inner"+o]:e.document.documentElement["client"+o]:9===e.nodeType?Math.max(e.body["scroll"+o],(i=e.documentElement)["scroll"+o],e.body["offset"+o],i["offset"+o],i["client"+o]):void 0===r?w.css(e,t,n):w.style(e,t,r,n)},s,r?e:void 0,r)}})}),w.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,r){w.fn[r]=function(e,t){return 0<arguments.length?this.on(r,null,e,t):this.trigger(r)}}),w.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),w.fn.extend({bind:function(e,t,r){return this.on(e,null,t,r)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,r,i){return this.on(t,e,r,i)},undelegate:function(e,t,r){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",r)}}),w.proxy=function(e,t){var r,i,n;if("string"==typeof t&&(r=e[t],t=e,e=r),y(e))return i=s.call(arguments,2),(n=function(){return e.apply(t||this,i.concat(s.call(arguments)))}).guid=e.guid=e.guid||w.guid++,n},w.holdReady=function(e){e?w.readyWait++:w.ready(!0)},w.isArray=Array.isArray,w.parseJSON=JSON.parse,w.nodeName=A,w.isFunction=y,w.isWindow=_,w.camelCase=z,w.type=T,w.now=Date.now,w.isNumeric=function(e){var t=w.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))};var Vt=E.jQuery,Wt=E.$;return w.noConflict=function(e){return E.$===w&&(E.$=Wt),e&&E.jQuery===w&&(E.jQuery=Vt),w},e||(E.jQuery=E.$=w),w},e.exports=t.document?r(t,!0):function(e){if(!e.document)throw Error("jQuery requires a window with a document");return r(e)}}),Di=window.navigator&&window.navigator.userAgent||"";function Mi(e){var t=Math.floor(e/3600),r=Math.floor((e-3600*t)/60),i=Math.floor(e-3600*t-60*r);return(0<t?[t,r,i]:[r,i]).map(function(e){return e<10?"0"+e:""+e}).join(":")}function Ni(e){if(!e)return"";var t=e.toString(16),r=((""+(t.length<8?ur({length:8-t.length+1}).join(0):"")+t).match(/[A-Za-z0-9]{2}/g)||[]).map(function(e){return parseInt(e,16)}),i=yr(r,4);return"rgba("+[i[1],i[2],i[3],Math.round(100*i[0]/255,10)/100].join(",")+")"}function Fi(r,i){var n=Date.now();return function(){var e=arguments,t=Date.now();i<=t-n&&(r.apply(this,e),n=Date.now())}}function ji(e,t,r){var i;r&&(i=console)[e].apply(i,cr(t))}function Bi(e){return"object"===("undefined"==typeof HTMLElement?"undefined":Lt(HTMLElement))?e instanceof HTMLElement:e&&"object"===(void 0===e?"undefined":Lt(e))&&1===e.nodeType&&"string"==typeof e.nodeName}function Ui(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=t.hasErr,i=void 0!==r&&r,n=hr(t,["hasErr"]);return new Ri(function(t,r){Oi.ajax(dr({url:e,type:"POST",contentType:"application/json;charset=utf-8"},n,{success:function(e){return e.err&&i?r(e):t(e)},error:function(e){return r(e)}}))})}function Hi(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:6;return Math.random().toString(35).substr(2,e)}function Gi(e,t){if(!t||!e)return!1;if(e.isEqualNode(t))return!0;if(e.contains)return e.contains(t);for(var r=t;!r.isEqualNode(document.body);r=r.parentNode)if(r.isEqualNode(e))return!0;return!1}function qi(e,t){return(Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(document||window.ownerDocument).querySelectorAll(e),r=t.length;0<=--r&&t.item(r)!==this;);return-1<r}).call(e,t)}function Vi(e){var t=this,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(e){var i=r.click,n=r.dblclick;e.addEventListener("dblclick",function(e){e.stopPropagation(),clearTimeout(t._dbClickTimer),n&&n(e)}),e.addEventListener("click",function(e){e.stopPropagation(),clearTimeout(t._dbClickTimer),t._dbClickTimer=setTimeout(function(){i&&i(e)},200)})}}function Wi(e,t){if(e){var r=e.requestFullScreen||e.webkitRequestFullScreen||e.mozRequestFullScreen||e.msRequestFullscreen;r?r.call(e):t&&t()}}function zi(e){var t=document.exitFullscreen||document.mozCancelFullScreen||document.webkitCancelFullScreen||document.msExitFullscreen;t?t.call(document):e&&e()}var Ki=/Edge/i.test(Di),Yi=!Ki&&(/Chrome/i.test(Di)||/CriOS/i.test(Di)),Xi=/Safari/i.test(Di)&&!Yi&&!Ki,Qi={heartbeats:null};function Ji(e){var t=e.websocket,r=void 0===t?{}:t,i=e.time,n=void 0===i?6e4:i,a=arguments[2];if(1<arguments.length&&void 0!==arguments[1]&&arguments[1])window.clearTimeout(Qi.heartbeats);else{var o=Or.ClientMsgType.CMT_HEARTBEAT;!function e(){var t=Ut({eType:o,bytes:Ut({lTimestamp:Date.now()})});a&&console.count("[心跳次数("+n/1e3+"s)]"),r.send(t),Qi.heartbeats=setTimeout(e,n)}()}}function Zi(e){return{LIVE_AUTH_ENTRY:"https://live.sunlands.com/auth",VOD_AUTH_ENTRY:"https://video.sunlands.com/auth",LIVE_ENTRY:"wss://live.sunlands.com/gate",VOD_ENTRY:"https://video.sunlands.com/video",LIVE_CHAT_ENTRY:"wss://liveim.sunlands.com",VOD_CHAT_ENTRY:"https://liveim.sunlands.com",REPORT_URL:"https://live.sunlands.com/stream/report"}[e]}function $i(e,t){Rr(t,{msgType:e,appType:3,appVersion:"v2"}),void 0!==t.uid&&(t.uid=""+t.uid),Oi.ajax({method:"POST",dataType:"json",contentType:"application/json",url:Zi("REPORT_URL"),data:Ut(t),complete:function(e,t){}})}var en=function(){var l,u,c,d,s,h,v="undefined",y="object",f="Shockwave Flash",p="application/x-shockwave-flash",g="SWFObjectExprInst",e="onreadystatechange",m=window,_=document,b=navigator,T=!1,i=[function(){T?function(){var t=_.getElementsByTagName("body")[0],r=F(y);r.setAttribute("type",p);var i=t.appendChild(r);if(i){var n=0;!function(){if(typeof i.GetVariable!=v){var e=i.GetVariable("$version");e&&(e=e.split(" ")[1].split(","),w.pv=[parseInt(e[0],10),parseInt(e[1],10),parseInt(e[2],10)])}else if(n<10)return n++,setTimeout(arguments.callee,10);t.removeChild(r),i=null,A()}()}else A()}():A()}],S=[],E=[],o=[],n=!1,k=!1,a=!0,w=function(){var e=typeof _.getElementById!=v&&typeof _.getElementsByTagName!=v&&typeof _.createElement!=v,t=b.userAgent.toLowerCase(),r=b.platform.toLowerCase(),i=/win/.test(r||t),n=/mac/.test(r||t),a=/webkit/.test(t)&&parseFloat(t.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")),o=!1,s=[0,0,0],l=null;if(typeof b.plugins!=v&&typeof b.plugins[f]==y)!(l=b.plugins[f].description)||typeof b.mimeTypes!=v&&b.mimeTypes[p]&&!b.mimeTypes[p].enabledPlugin||(o=!(T=!0),l=l.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),s[0]=parseInt(l.replace(/^(.*)\..*$/,"$1"),10),s[1]=parseInt(l.replace(/^.*\.(.*)\s.*$/,"$1"),10),s[2]=/[a-zA-Z]/.test(l)?parseInt(l.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof m.ActiveXObject!=v)try{var u=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");u&&(l=u.GetVariable("$version"))&&(o=!0,l=l.split(" ")[1].split(","),s=[parseInt(l[0],10),parseInt(l[1],10),parseInt(l[2],10)])}catch(e){}return{w3:e,pv:s,wk:a,ie:o,win:i,mac:n}}();w.w3&&((typeof _.readyState!=v&&"complete"==_.readyState||typeof _.readyState==v&&(_.getElementsByTagName("body")[0]||_.body))&&t(),n||(typeof _.addEventListener!=v&&_.addEventListener("DOMContentLoaded",t,!1),w.ie&&w.win&&(_.attachEvent(e,function(){"complete"==_.readyState&&(_.detachEvent(e,arguments.callee),t())}),m==top&&function(){if(!n){try{_.documentElement.doScroll("left")}catch(e){return setTimeout(arguments.callee,0)}t()}}()),w.wk&&function(){n||(/loaded|complete/.test(_.readyState)?t():setTimeout(arguments.callee,0))}(),C(t)));function t(){if(!n){try{var e=_.getElementsByTagName("body")[0].appendChild(F("span"));e.parentNode.removeChild(e)}catch(e){return}n=!0;for(var t=i.length,r=0;r<t;r++)i[r]()}}function r(e){n?e():i[i.length]=e}function C(e){if(typeof m.addEventListener!=v)m.addEventListener("load",e,!1);else if(typeof _.addEventListener!=v)_.addEventListener("load",e,!1);else if(typeof m.attachEvent!=v)(r=m).attachEvent(i="onload",n=e),o[o.length]=[r,i,n];else if("function"==typeof m.onload){var t=m.onload;m.onload=function(){t(),e()}}else m.onload=e;var r,i,n}function A(){var e=S.length;if(0<e)for(var t=0;t<e;t++){var r=S[t].id,i=S[t].callbackFn,n={success:!1,id:r};if(0<w.pv[0]){var a=N(r);if(a)if(!j(S[t].swfVersion)||w.wk&&w.wk<312)if(S[t].expressInstall&&I()){var o={};o.data=S[t].expressInstall,o.width=a.getAttribute("width")||"0",o.height=a.getAttribute("height")||"0",a.getAttribute("class")&&(o.styleclass=a.getAttribute("class")),a.getAttribute("align")&&(o.align=a.getAttribute("align"));for(var s={},l=a.getElementsByTagName("param"),u=l.length,c=0;c<u;c++)"movie"!=l[c].getAttribute("name").toLowerCase()&&(s[l[c].getAttribute("name")]=l[c].getAttribute("value"));P(o,s,r,i)}else x(a),i&&i(n);else U(r,!0),i&&(n.success=!0,n.ref=L(r),i(n))}else if(U(r,!0),i){var d=L(r);d&&typeof d.SetVariable!=v&&(n.success=!0,n.ref=d),i(n)}}}function L(e){var t=null,r=N(e);if(r&&"OBJECT"==r.nodeName)if(typeof r.SetVariable!=v)t=r;else{var i=r.getElementsByTagName(y)[0];i&&(t=i)}return t}function I(){return!k&&j("6.0.65")&&(w.win||w.mac)&&!(w.wk&&w.wk<312)}function P(e,t,r,i){c=i||null,d={success:!(k=!0),id:r};var n=N(r);if(n){u="OBJECT"==n.nodeName?(l=R(n),null):(l=n,r),e.id=g,(typeof e.width==v||!/%$/.test(e.width)&&parseInt(e.width,10)<310)&&(e.width="310"),(typeof e.height==v||!/%$/.test(e.height)&&parseInt(e.height,10)<137)&&(e.height="137"),_.title=_.title.slice(0,47)+" - Flash Player Installation";var a=w.ie&&w.win?"ActiveX":"PlugIn",o="MMredirectURL="+(""+m.location).replace(/&/g,"%26")+"&MMplayerType="+a+"&MMdoctitle="+_.title;if(typeof t.flashvars!=v?t.flashvars+="&"+o:t.flashvars=o,w.ie&&w.win&&4!=n.readyState){var s=F("div");s.setAttribute("id",r+="SWFObjectNew"),n.parentNode.insertBefore(s,n),n.style.display="none",function(){4==n.readyState?n.parentNode.removeChild(n):setTimeout(arguments.callee,10)}()}O(e,t,r)}}function x(e){if(w.ie&&w.win&&4!=e.readyState){var t=F("div");e.parentNode.insertBefore(t,e),t.parentNode.replaceChild(R(e),t),e.style.display="none",function(){4==e.readyState?e.parentNode.removeChild(e):setTimeout(arguments.callee,10)}()}else e.parentNode.replaceChild(R(e),e)}function R(e){var t=F("div");if(w.win&&w.ie)t.innerHTML=e.innerHTML;else{var r=e.getElementsByTagName(y)[0];if(r){var i=r.childNodes;if(i)for(var n=i.length,a=0;a<n;a++)1==i[a].nodeType&&"PARAM"==i[a].nodeName||8==i[a].nodeType||t.appendChild(i[a].cloneNode(!0))}}return t}function O(e,t,r){var i,n=N(r);if(w.wk&&w.wk<312)return i;if(n)if(typeof e.id==v&&(e.id=r),w.ie&&w.win){var a="";for(var o in e)e[o]!=Object.prototype[o]&&("data"==o.toLowerCase()?t.movie=e[o]:"styleclass"==o.toLowerCase()?a+=' class="'+e[o]+'"':"classid"!=o.toLowerCase()&&(a+=" "+o+'="'+e[o]+'"'));var s="";for(var l in t)t[l]!=Object.prototype[l]&&(s+='<param name="'+l+'" value="'+t[l]+'" />');n.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+a+">"+s+"</object>",E[E.length]=e.id,i=N(e.id)}else{var u=F(y);for(var c in u.setAttribute("type",p),e)e[c]!=Object.prototype[c]&&("styleclass"==c.toLowerCase()?u.setAttribute("class",e[c]):"classid"!=c.toLowerCase()&&u.setAttribute(c,e[c]));for(var d in t)t[d]!=Object.prototype[d]&&"movie"!=d.toLowerCase()&&D(u,d,t[d]);n.parentNode.replaceChild(u,n),i=u}return i}function D(e,t,r){var i=F("param");i.setAttribute("name",t),i.setAttribute("value",r),e.appendChild(i)}function M(e){var t=N(e);t&&"OBJECT"==t.nodeName&&(w.ie&&w.win?(t.style.display="none",function(){4==t.readyState?function(e){var t=N(e);if(t){for(var r in t)"function"==typeof t[r]&&(t[r]=null);t.parentNode.removeChild(t)}}(e):setTimeout(arguments.callee,10)}()):t.parentNode.removeChild(t))}function N(e){var t=null;try{t=_.getElementById(e)}catch(e){}return t}function F(e){return _.createElement(e)}function j(e){var t=w.pv,r=e.split(".");return r[0]=parseInt(r[0],10),r[1]=parseInt(r[1],10)||0,r[2]=parseInt(r[2],10)||0,r[0]<t[0]||t[0]==r[0]&&r[1]<t[1]||t[0]==r[0]&&t[1]==r[1]&&r[2]<=t[2]}function B(e,t,r,i){if(!w.ie||!w.mac){var n=_.getElementsByTagName("head")[0];if(n){var a=r&&"string"==typeof r?r:"screen";if(i&&(h=s=null),!s||h!=a){var o=F("style");o.setAttribute("type","text/css"),o.setAttribute("media",a),s=n.appendChild(o),w.ie&&w.win&&typeof _.styleSheets!=v&&0<_.styleSheets.length&&(s=_.styleSheets[_.styleSheets.length-1]),h=a}w.ie&&w.win?s&&typeof s.addRule==y&&s.addRule(e,t):s&&typeof _.createTextNode!=v&&s.appendChild(_.createTextNode(e+" {"+t+"}"))}}}function U(e,t){if(a){var r=t?"visible":"hidden";n&&N(e)?N(e).style.visibility=r:B("#"+e,"visibility:"+r)}}function H(e){return null!=/[\\\"<>\.;]/.exec(e)&&typeof encodeURIComponent!=v?encodeURIComponent(e):e}w.ie&&w.win&&window.attachEvent("onunload",function(){for(var e=o.length,t=0;t<e;t++)o[t][0].detachEvent(o[t][1],o[t][2]);for(var r=E.length,i=0;i<r;i++)M(E[i]);for(var n in w)w[n]=null;for(var a in w=null,en)en[a]=null;en=null});return{registerObject:function(e,t,r,i){if(w.w3&&e&&t){var n={};n.id=e,n.swfVersion=t,n.expressInstall=r,n.callbackFn=i,S[S.length]=n,U(e,!1)}else i&&i({success:!1,id:e})},getObjectById:function(e){if(w.w3)return L(e)},embedSWF:function(o,s,l,u,c,d,h,f,p,g){var m={success:!1,id:s};w.w3&&!(w.wk&&w.wk<312)&&o&&s&&l&&u&&c?(U(s,!1),r(function(){l+="",u+="";var e={};if(p&&typeof p===y)for(var t in p)e[t]=p[t];e.data=o,e.width=l,e.height=u;var r={};if(f&&typeof f===y)for(var i in f)r[i]=f[i];if(h&&typeof h===y)for(var n in h)typeof r.flashvars!=v?r.flashvars+="&"+n+"="+h[n]:r.flashvars=n+"="+h[n];if(j(c)){var a=O(e,r,s);e.id==s&&U(s,!0),m.success=!0,m.ref=a}else{if(d&&I())return e.data=d,void P(e,r,s,g);U(s,!0)}g&&g(m)})):g&&g(m)},switchOffAutoHideShow:function(){a=!1},ua:w,getFlashPlayerVersion:function(){return{major:w.pv[0],minor:w.pv[1],release:w.pv[2]}},hasFlashPlayerVersion:j,createSWF:function(e,t,r){return w.w3?O(e,t,r):void 0},showExpressInstall:function(e,t,r,i){w.w3&&I()&&P(e,t,r,i)},removeSWF:function(e){w.w3&&M(e)},createCSS:function(e,t,r,i){w.w3&&B(e,t,r,i)},addDomLoadEvent:r,addLoadEvent:C,getQueryParamValue:function(e){var t=_.location.search||_.location.hash;if(t){if(/\?/.test(t)&&(t=t.split("?")[1]),null==e)return H(t);for(var r=t.split("&"),i=0;i<r.length;i++)if(r[i].substring(0,r[i].indexOf("="))==e)return H(r[i].substring(1+r[i].indexOf("=")))}return""},expressInstallCallback:function(){if(k){var e=N(g);e&&l&&(e.parentNode.replaceChild(l,e),u&&(U(u,!0),w.ie&&w.win&&(l.style.display="block")),c&&c(d)),k=!1}}}}(),tn=en,rn=function(){function e(){_r(this,e),this.events={},this.videoEvents=["ready","metadata_update","abort","canplay","canplay_through","duration_change","emptied","ended","error","loaded_data","loaded_metadata","load_start","moz_audio_available","pause","play","playing","progress","rate_change","seeked","seeking","stalled","suspend","time_update","volume_change","waiting","autoplay_success","autoplay_fail","status_change","progress_click","progress_move","switch_button_click","switch_button_show","screen_status_change","update_controlbar","playback_rate_button_click"],this.playerEvents=["ready","metadata_update","time_update","emptied","full","loaded_video","mediatime","status_change","volume_change","switch_button_click","switch_button_show","screen_status_change","timer","update_controlbar"],this.chatEvents=["login_reply","message_reply","heartbeat_reply","message_recv","user_notification","speaking_changed","room_dismiss","user_kicked","bulk_exit_notification","user_forbidden_status","websocket_error","websocket_close","get_message_history","test"],this.boardEvents=["user_enter","login","begin","end","heartbeat","add_trace","erase_trace","page_change_notify","change_cdn_notify","document_info","error","pause","continue","room_info_change","get_increase_reply","begin_paper","video_type_change","scroll_change"]}return Cr(e,[{key:"on",value:function(e,t){var r=this;(""+e).split(",").forEach(function(e){r.type(e)&&"function"==typeof t&&(r.events[e]||(r.events[e]=[]),r.events[e].push(t))})}},{key:"trigger",value:function(e){for(var t=this,r=arguments.length,i=Array(1<r?r-1:0),n=1;n<r;n++)i[n-1]=arguments[n];(""+e).split(",").forEach(function(e){t.events[e]&&t.events[e].length&&t.events[e].forEach(function(e){return e.apply(void 0,i)})})}},{key:"type",value:function(e){return-1!=this.playerEvents.indexOf(e)?"flash":-1!=this.videoEvents.indexOf(e)?"html5":-1!=this.chatEvents.indexOf(e)?"chat":-1!=this.boardEvents.indexOf(e)?"board":"unknown"}},{key:"removeListener",value:function(e){this.events[e]&&this.events[e].length&&delete this.events[e]}},{key:"removeAllListeners",value:function(){this.events={}}}]),e}(),nn={debug:0,live:1,bufferTime:1.8,vol:1,meatadata:{},time:0,bufferLength:0,kbps:0,fps:0,rtime:0,_currentTime:0,__fluency:{totalEmptyCount:0,totalEmptyTime:0,currentEmptyTime:0,onStreamEmpty:function(e){this.totalEmptyCount+=1,this.currentEmptyTime=e},onStreamFull:function(e){0<this.currentEmptyTime&&(this.totalEmptyTime+=e-this.currentEmptyTime,this.currentEmptyTime=0)},calc:function(e){var t=4*this.totalEmptyCount+2*this.totalEmptyTime+e;return 0<t?100*e/t:0}}},an=function(){function a(e){_r(this,a),this.id=a.__id,a.__id+=1,Rr(!0,this,nn,e),this.events=new rn,this._lastVolume=this.vol,this.sunlandsPlayerUrl=this.swfPath+"?version=1.6.0",a.__players.push(this)}return Cr(a,[{key:"start",value:function(e){e&&(this.stream_url=e);var t=this,r={id:this.id,is_live:this.isLive,on_player_ready:a.onPlayerReady,on_player_metadata:a.onPlayerMetadata,on_player_timer:a.onPlayerTimer,on_player_empty:a.onPlayerEmpty,on_player_full:a.onPlayerFull,on_update_loaded_video:a.onUpdateLoadedVideo,on_update_media_time:a.onUpdateMediaTime,on_player_status:a.onPlayerStatus,debug:this.debug},i=document.createElement("div"),n="_sunlplayer"+this.id;return i.id=n,this.el.appendChild(i),tn.embedSWF(this.sunlandsPlayerUrl,n,this.width,this.height,"11.1.0","js/AdobeFlashPlayerInstall.swf",r,{IsAutoPlay:1,wmode:"transparent",allowFullScreen:"true",allowScriptAccess:"always"},{},function(e){e&&e.ref&&(e.ref.width="100%",e.ref.height="100%"),t.callback=e,window._sulplayer=t.constructor}),this}},{key:"setSrc",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.stop(),a.__players.push(this),e&&(this.streamUrl=e);var r=t.bufferTime;r&&(this.bufferTime=r),this.callback.ref.__play({url:this.streamUrl,width:this.width,height:this.height,buffer_time:this.bufferTime,volume:this.vol})}},{key:"stop",value:function(){var r=this;a.__players.some(function(e,t){return e.id===r.id&&(a.__players.splice(t,1),!0)}),this.callback&&this.callback.ref&&this.callback.ref.__stop()}},{key:"volume",value:function(e){return void 0!==e&&(this.vol=e,this.callback&&this.callback.ref&&this.callback.ref.__set_volume(e),0<e&&(this._lastVolume=e),this.events.trigger("volume_change",e)),this.vol}},{key:"muted",value:function(e){return void 0===e?!this.vol:(this.volume(e?0:this._lastVolume),!1)}},{key:"currentTime",value:function(e){return void 0!==e?(this._currentTime=e<0?0:e,this.callback.ref.__seek_video(this._currentTime),!1):this._currentTime}},{key:"duration",value:function(){return this._currentTime}},{key:"pause",value:function(){this.callback.ref.__pause()}},{key:"play",value:function(){this.callback.ref.__resume()}},{key:"fluency",value:function(){return this.__fluency.calc(this.rtime)}},{key:"emptyCount",value:function(){return this.__fluency.totalEmptyCount}},{key:"setDar",value:function(e,t){this.callback.ref.__set_dar(e,t)}},{key:"setFs",value:function(e,t){this.callback.ref.__set_fs(e,t)}},{key:"setBt",value:function(e){this.bufferTime=e,this.callback.ref.__set_bt(e)}},{key:"setSunlandsPlayerUrl",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};Kt(t,{_version:"1.6.0"});var r=Gt(t).map(function(e){return e+"="+encodeURIComponent(t[e])}).join("&");this.sunlandsPlayerUrl=e+"?"+r}},{key:"getPlayerId",value:function(){return"_sunlplayer"+this.id}},{key:"supportsNativeHls",value:function(){return!0}},{key:"dispose",value:function(){delete window._sulplayer,a.__id=100,a.__players=[],this.events.removeAllListeners()}},{key:"on",value:function(e,t){this.events.on(e,t)}},{key:"trigger",value:function(e){for(var t,r=arguments.length,i=Array(1<r?r-1:0),n=1;n<r;n++)i[n-1]=arguments[n];(t=this.events).trigger.apply(t,[e].concat(i))}},{key:"onPlayerReady",value:function(){this.trigger("ready")}},{key:"onPlayerMetadata",value:function(e){this.trigger("metadata_update",e)}},{key:"onPlayerTimer",value:function(e,t,r,i,n){this.trigger("timer",{time:e,bufferLength:t,kbps:r,fps:i,rtime:n})}},{key:"onPlayerEmpty",value:function(e){this.trigger("emptied",e)}},{key:"onPlayerFull",value:function(e){this.trigger("full",e)}},{key:"onUpdateLoadedVideo",value:function(e){this.trigger("loaded_video",e)}},{key:"onUpdateMediaTime",value:function(e){this.trigger("mediatime",e)}},{key:"onPlayerStatus",value:function(e){this.trigger("status_change",e)}}],[{key:"_getPlayer",value:function(t){var r=null;if(window._sulplayer.__players.some(function(e){return e.id===+t&&(r=e,!0)}),!r)throw Error("player not found. id="+t);return r}},{key:"onPlayerReady",value:function(e){window._sulplayer._getPlayer(e).onPlayerReady()}},{key:"onPlayerMetadata",value:function(e,t){var r=window._sulplayer._getPlayer(e);r.metadata=t,r.onPlayerMetadata(t)}},{key:"onPlayerTimer",value:function(e,t,r,i,n,a){var o=window._sulplayer._getPlayer(e),s=Math.max(0,r);s=Math.min(o.bufferTime,s),Kt(o,{time:Math.max(0,t),bufferLength:s,kbps:i,fps:n,rtime:a}),o.onPlayerTimer(t,r,i,n,a)}},{key:"onPlayerEmpty",value:function(e,t){var r=window._sulplayer._getPlayer(e);r.__fluency.onStreamEmpty(t),r.onPlayerEmpty(t)}},{key:"onPlayerFull",value:function(e,t){var r=window._sulplayer._getPlayer(e);r.__fluency.onStreamFull(t),r.onPlayerFull(t)}},{key:"onUpdateLoadedVideo",value:function(e,t){window._sulplayer._getPlayer(e).onUpdateLoadedVideo(t)}},{key:"onUpdateMediaTime",value:function(e,t){window._sulplayer._getPlayer(e).onUpdateMediaTime(t)}},{key:"onPlayerStatus",value:function(e,t){window._sulplayer._getPlayer(e).onPlayerStatus(t)}}]),a}();Rr(an,{__id:100,__players:[]});var on,sn,ln="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACEAAAAhCAYAAABX5MJvAAAAAXNSR0IArs4c6QAABV1JREFUWAm1V2tsFUUUntleQRssj/BKICREI4GIYjRBELUtCYIJwaL1/QNixIgoNlJN2z83/tDURyQgDYSiVRNDaoRAAwUkpcG0paXyDhoBjf7RmIJSoLR398zxOzN3b+8tt5Te9m663dndme98853vzM7VapBHlNk7sfHydOr2ZxoKZij2NRm/S1FwjZlO582aefK7ZzUNBlbfaueiz7vmUSxYadh/jonymHzFJsBJCmRsGw2Fd1eYYk1KmW2P5s7dEY1qM1CMAUkUbfIXIEiVIX+2BMFVIZILLEQIgRkkQCSZjAFBzcEFQ1TZuL6wWmvN/ZHpl0TxFh7tE30E4FcV+TolgFUBiiNQ+FwUESKiTvgsfK+NOcAj9Iof1y/+Kx2RtCSKvuaJ+qr5gci/LwRODpIcqO/7UCnX37eE8A+EqYPYX9aytbi5L5EbSCzfylNNwAcx+xkyIwFwM4tLb2dK/2lFx+CLs3h3BTPONYamGeMvUEQTTIC+kjJcJXWJVDFdxovCI18+fyyZSAqJ4loeEXSoVjb+nF7TiQExEys1NQFxA985bVf9W7onGShsF7x9+BGYdx28sAwktcNxnnFt06G8YH5rzcpz4ZhI2JCrf1F9oDiYw2xsYCupgbnZdDLzO3vKpmy7mcEE49D6x1AZqil/TX1+wOYbYExlYIRYSNd47dM24D0eYiWUgBEXBIYPmyCmXZ4hI6TH2ZFDetHusonHJchgjidK9o270nm1AWm6vzetzrxw+qqjtW9sFTwvBA2IK5BDjagyc/wJCerO0WphJgQEd/9niy+p27xFqI7z8AzwnMekrMlQ5bzi2juknyVRVM33IuBiCY5cWgJiKEhSurt00inpmOnRvHn5P6x4BVKCi/wBHycCje3x/3hacC0JjtEq62Zhig6ONf1c9+7kTZkGTx535KuXYWhTI0rIJBHAxiA2K6SfS4cx+SI/OsZPtJX6NDSO3Az1wOJdJYaXSVo1bMWZwrkvbcjzXqzisXgo6XAMpRQZ0pnbdww1cPL4tu2vtMMLJ22liBo2JT6pS5eUd10FWBUJ9SxpkHTAlESn95SN+TcZZDjanuJyWTicEmJ+U9VaH+30KIiNsq6V4CAST8tvwxG0L0b792v3epofQAmWQO4lp/ZF10qfCKaf6xanuAo2LdTVF2C47tt3lp4BlpyJI4JvgCd1K7kS18bNY+s30SvLjQgseM461qYCppSPFtPMLMdNgfdU7uhfbDVI+UgqcMU6cfdT0d/HpPTM4o1X95rughkviDklFbZCDEWuxTqfyWLcFGi7WKFsdiZVhiihDFMJPu05Kb2zdONWTGW+lTQkE8FeYNbFtpY3sxQ3BdaS2Fsx/QRS0ZAgYU1q14xPCksal6aMyMJNXAksGFq/B1OAi/OF+AMrW04QBNsL1u6fm4XYCcjEpkaeLCz/aRMHwWpRxG5Y7VcPJWtMN/acH44aEams3/hk2m1dAjGDRgqJJRvOjez+s6MJfnjQpcbtL8ONKrZ+56FO+UiaVNdYU9CdQby0Q1JISI/CiuYpdC3WACL3OCKyB8Cu2aqDMpaPnDFXQayNlX9GBVR3tHb1wbTot/jwBhIyLr/00GS+7h/A747Zdv1wO21LoJeQ287bnwVEa47tLMl4A5QwZjLpxo8L/s4bP+5hmHSzqOHKN66CW1HdyhpuBRWVJI8fbDstCQGpiz7U1bRl6esRVgvxW7PFVot84IQUTkfOXUF2SGbtl0Q4m8PVyxtavnhhPj5qhYheDWN2OGXiRGAQTfR+2D+Ta1pP3AwoGmWv/tctd1GsZxZ+qU2AKM3Hd607e7MxA737H/kueeJiYwVuAAAAAElFTkSuQmCC",un=Or.RoomStatus,cn=un.READY,dn=un.END,hn={live:(on={},Ar(on,-1,"直播暂未开始"),Ar(on,cn,"视频正在全力加载, 再等一会儿就好了~"),Ar(on,dn,"直播已结束~"),on),vod:Ar({},cn,"当前点播视频还未准备就绪!")},fn=function(){function e(){_r(this,e),this._options={sequence:null,imageSize:[768,1024],size:[768,1024],dataItem:{dataMap:{},info:{},pageInfo:{}},roomInfo:{},userInfo:{},reconnectTimer:null,operation:null,status:cn},this.events=new rn}return Cr(e,[{key:"init",value:function(){this._initDom(),this._initData()}},{key:"_initDom",value:function(){var e=this._options,t=e.el,r=yr(e.imageSize,2),i=r[0],n=r[1],a=Bi(t)?t:document.getElementById(t),o=Hi(),s=["defs-rect","clip-path","bg-rect","group"].map(function(e){return e+"-"+o}),l=yr(s,4),u=l[0],c=l[1],d=l[2],h=l[3],f='\n            <div class="sunl-board-container">\n                \x3c!-- poster --\x3e\n                <div class="sunl-board-poster poster-active">\n                    <div class="sunl-board-poster__container">\n                        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABYCAYAAAADWlKCAAAAAXNSR0IArs4c6QAAI65JREFUeAHtfQl4VdW59lp7OHNyMgdCCAmDIAgqqKgoVRH1OtVWpdp6kaEFgsNlure29bdp+9fethCsKFMFvXq1Fv9e7a3izKSCouAEyDyEQObkJDnDPmcP63+/nZzkJCQhQLC1T9bzrLOnNX7z+r619+HsnzyJESN80aqqyy3Ggm6H41NeWhr5e01ZCPEd9H0Bcgz5eeTxyH/mnEfx7Dyc36ng558yiZyc/hFdvzRUUXGRQ5JSmGWxcDR6Y2Nm5meKonzsLis78neY+Hvosw/yJ8jVyKPoCGS8iyMhqw/Hzz9V2u71np/ico1PZmyol3PVSJidKknMiWvNskzB2EFQ5lbN6/0i9fDhQEKxs3oK4P8AHWxArkWegkzc4kUmBF3xT8MhXzGWjwndrGvayEoA/hguQG2CJkiIUJuPDhwdnMteSRriFGKIHAzeEszM3KEqylZHWtoBvnMnAehsJhqKjCwhgy7YW8gXI3+O/K1vPIfsZCwNM7seM7sCwFbCAH69xyMskD8m2JJo5omJHhJECDo+1IGOYYqpl6654p71RW+sfB+XZyWBQy5CwweQQ8hjMMwt1BHuZ+BwTZtB04NvSlrPmCubsSsx3olAhD+KkzjQG4AQXZa7PzchmGpE2esTprGnLp9pyRn+paUzB33594AFEck3Lu1ibDSQ8e9AxB2Aul/DDOLIICzIptntOUnCZIplsD/dPE88ddtPWX3IlLjJ7h64ptbf7UZ6sOA3SodAyBYACTeDishEZISIjpICi6o7SQLiLFliq+94WKy9ZgqXgkEWrW0UVm5GulFXexfkyErGeRzX3WnyjMucEkIgJpTBELt1fr8rWF+vXc7YWbfp14Dg873eTG8oRPJ1HLSh0pXWJeiphBCIIQCzUwBBX7CI6mEr7/6V2Hjpd7hTj7JoVBdmTOd6KCjUzPTRBasOXXmIsU2dNnIWHnQ+YnT2mdvdzzTNqwTn2ZYQZJp5MFEXKNSJyVZHJWnVOE07crJxrRgzQ71457M5TNPCAGgYxreGjjuUK+vz811qfX0WM4w89DtQWNYAtJ/lNQyHrOtQvB1WazME4g/SI2YnekRFO/U+P1syeZHYNuoa7oyC1yTOguV1onZ/BU8dmCWS+mdwZlgRyxn7fem9Q8lo+1pSpwh5zemcmGxZNwEo9TAPS9qPBqwlm0BKKBZbe3Xn0oOtHHH5BedVH/gXX23VgKhu6WiHuCoEoDUCsQHQcYArrDbi9DphcQyCtZHLZDnVIQRsH8ZoHUEosIUQqN5pGMIDgEJPdClLgi6XiKrqCfNTdY1Vp/YXxdOL2VeDL2lCBtonhAAZAkjhvpxUkTYwmzMZNlgsejCpXFu8s2hEV4xJLfRI6lRk1VlWAHTjjlhW+T2GsepUesMyVD2cN/icBnfGhLxA6Yh+WjULq1xEdeYAkCn7CVIEcII6V2TWCGC7cAECYOBGRlbTCQnPCMhRRWEuXRduQoxlnYAYattW7CoZta3JCWQcyRkqiqc+zg73G9aKDCpimSwaRq/QKUYYdGOBVCzgwOUeWJ8tbkKJl1tbOntnBJMO0w90/ZMwY18mcV7w36pKC5eTps25uWnvpKVNLMvu++Ow6nswL1Q+Ir/hGNNB3jJkFcGbKJ2onliFlLLskIWpSqIRcr/RNAU9s7kBx04TEKM5HBzrDRZ2OoWFhtuzAhDVprozprE9+ReKRwufYiX9zoHOSDAJwB2mbgkrqtvN6EC0ZWIkBB3oFll1TMxbvm94mwbP0kWnCMHIBFeUVzBsQxLiOlKuHY0BdCSty8gY+lZ6+pTGYPD/mIp6RyC5b//MWIPIrz/aUoUYgYP64gn1mNslCye0UZQukKKg9iiQ0lqq6X5nv7T4CwMxDRBPmqrayCaIUnOKEBzjtlt2xsLs0+HjxW9mruSV6blc1U+UPnokykwDwpGoJmZyM0YsgtZwEBKXhSx/f/Dj++CRObupU5FF3d4TiZQ+53BsxCgmxNzusZ9EIjsbMcokzLkxJ0eNxmIj3xHicodl5VH5oOqK1vhzRJYWYEMCR2xqo/t2ApRVrNUMYg0kl1MSbhUzBiFHrVYUwM/EFUkSKoDdlsab6nX0S8o7CBaUgRQSY1DaXAKHyIbBVKGz9y66VSy9+1Eec3vw7ERkUJvRUOt9C3V1LcZUL3m+kNAmd7oydTN0J65OSXzb9U/hp0uEUDs8FnsD4mFMf8O4l6mq4bHJhgk5EJAUl0sCTZXFOH8TeUdFav/v9tNqCwYHjpw4BEBXRW+k0R0QUR44lKgQAZ1wlIi9MADpVRShdBcpGATxhWFJvF5yAvGy8JgxJmumeGXiNPb8HT/mlqQCQXZBKnxC0kNtLXhda6aceElYYsLhviRv2e7dJYXDPojf7unjSRFyDyzINzj/Y5Ik5cL5YsON5DxktClcrsPXHT9+DDfNJSPHjxxYX5Y/uK7EFr3xgcZp36Z2FHQ7ZdPpaBV/TQhJRIeNJB62LOEDYNFOm4e2DEq4KcFvK/tlofrBIR44EZNlpvgdzIV1djCrj/XJiMlyMOZhbqtDM8EepgVTWidFnjByPdIOIVQS5bjsuj3/6UMHDk8tKLcr9/BPm8mebtszZsxQv/v62/8+tKF0ANYNcVMVwkJiEUBQA9Q1nEdx9EsW6y9bLeKIpn1QV+HAaAt4GosM0ZVOR8pol6iHrCe6ptU4XBxMHui0vLPSmScnSZLdDg4V0ARXLqFHxEBcfcRzwQlsee0NrMxM5S7wI7QECjUnKHToD1HxxdGWMVHsxJnkEdnD+wI+cZJqLq+6GNe1vRms9vFtMy/qAGvxhk/v2KGiPtWmfn/06GUpwZpv1RlCVAmZVZoSq7RkVk0iBDkMrajDngUIuYbzJNkSMEhtYogxSdSiTPs+JUA2HWKrXyTCU2Ix7jMM7kH2Qse4SM9Aaav9nUzclsFd/WF36BoHU0GTOzjMESZ0wSwD6xbMcGzKfn6zbxuLwhm/K5rLo8wB5No8i1HAlG6IsFB1I6dzO9HRMnlSZgoMG4wtAX9oFMtiV3rYkKz6V5fsbT/uM70+Y4QcHjXqGklVbz8e0uTaqMmhS7iBmWEO9uzop3ma9libwQBOAexwJwzgNbRDiBOckY01RBKUtSsaZRxwjk+UYEPZ6ucSsZuyuJLOmTPZsp+behTkDkxAX0g2IGlNAzg7fTxFCfHrfNv4OPcecdxIZQf0PhijxGT8hmsaCSmtCKE+0Ik7w8cUh9IWITQQ8DOeD/SMu3tX8N1VPRrcOm2ElI8a5Z2ZmfmvsEOuxyJDEW43zEadGaDmFkqjwbdLBLkIuAQiX4C+eSPQFQRC4hD3gSuyHQ6sHiUbqS5NA3YJBa3JynYK89tZTHhkDmQwxQeEoAhoAYAyuBHTCIcChAKMWFx2OKBoFC4sheU6q/h3kz7ig9VysUfvxyqMFB4uq2GGhjVIyyjQF8SWOwlWGRwIbTiEmBmLyFBZpRQ+VsH1T/78RevIzvzstBBy8MILB+iWNcsly8M1AIvAhTUEc7rdNCkRAxDbTK7dOKk81UoFl9RBtEUgzgghaTBb07GuAHoIGYxkkCsWa8MhVhb0zW3ZiCqBtg2LuTIM8nDE8Um17AsSYSa4RYI5LKlOJjmAHKxU4JGxnw93l/Db/dsommhtOpSK9Z/ByX3SkjAv1UPGgacVIc3ICB45KrSaGhpzasolszaHP/6vVpu5pYHTOzllhBQlJ6fBtzU3x+PJwprB7pWmYeAcKoS7PR4oVklECSlE2YlU1zxGKt+kS7CegUgBDbMscIVfgXhISETmQEgLh1hpQAY4AwWxtLaYBC5zZUEznbhQb+qXuCUa4RiQKafkQfanwuZGYM6TDe7KZW5vGh+dHuLbzBGsNiyxcBjcTdKRRoGxy7DTPelJTQhpg4xaIhrGHU6naYXLYx+/eDRh2Gd02s6EOGlbHMi4o6yxMWVfYyPUd2uiuDUlWlT5/H6elpmJGaEEIaWTVK0zciFbA1WZJUNfdFBSYIHXdDu1GRkpoHQgw9bJTjxSbPB10IMF/SExxenFAkVIRoMmWNIAzn19OHelYfsDuFl2gbOdzJ+s8osvSOMjz02BJQ9Tm9pHstciEE825+DYxBlARvNcSayh5FhW1G3nQgfjbHvrpOuQxOI/w2odOmMMXBZsbyDAPVgnZLlcZH3aGwniZQkpbq+XZ+B5XXU1/ETt5DMKOhGPeDstn+/MHsxuCBxjo8OVIh1KmRbtWGdDoNnMYpuiUhLW27eAstOakYH6BDKnC7AiOmiCH06aErxSTFGcQvX44CtzQLQJph/bLwksndT8C5rkI6G5mQTiOC/o7+MZGW6xd1+9OFYe5jp8W/BxgVOkE5FhdwXuZCydHd9GtNluFE1jOdXfbiOERBUsmO/GOYE62lVXB0skQ/igPEnu45mAbrEhSUhxAlkZ2dmitrJS6AnKnpCxAy6WlYOu4PWqi7+ZMoD1i4bEZaFycU39MTYyVM1TUYYWbDC1mH4rkJEJ5dpMufFJys52MCBvlqQAEcngDDdEVXNJKgZutSoOcSwcWpESb6j5CDca87hkPnpkKsvOcol9B4K0RmGR48eYVpPAGS31qAMzynLGEE32SEqUOl01yMczNhnu8QI3zNEmErP1Bq+DnycbXlfyPcWABNIj8YbItydDL7jALQYULDKnaF6JJ00sPuca1uBwc/jBmIxyDUDqF54MIKc/X+fPZSWuFJZhacGciU7mGOBWSIEnijTqxZ1lkh6BjIfoANfKEE+OpGSbK2zit7kApAtEki1OykYEa8ExUSGl9LH1gAbLa23NECxe4aihgaMOR6OpyQ7uUYOisTGGjmEGAqFY9HIKDdDil+YmZNCzaVXpC899Pz7nMz12i0OKIKrgOR1NnclNw7b7JcQ0gPJ31dSIURkZzI04hQarKDERp8iYTHpmBo9WV4oDePzY0KtYlcvHVeKA5iSDimUKRaFsiSPZfCozdfOLecPfPDLoL65IiI3F49FOWcKqAwYBAAxYYNEGQwySQnFAPLkIEVD2xA2UE1PiNQyIOKdwiC+AlZq0cU3jNIHc2soyUbL7cxYI6FL64G/x9BGDuAU/mKnHhB6Jwc0ShjMyjACozkU41LlPJnEM3Ty3iaKrsiSquK4/BIrwQzQxP3Li/KiuCWopSEoSQ/x+Vh2FHmhukBjadorgWOb0i83+geIvUoo4QrG4eKHmsrYyAIKxWNjFFf5q/bqVB+KP6Hi8aIyH1VcOx3JyLPA4TEk2Hb6BkpCdHiDC1TSP9m1SRQzChJMR+wPbzhWLOzW7QARzx/L7D9zG6jR4Fo6VsJK9O1ltWSnmyFlGwQSmOpOYb2iuUJNgBFD7aM/uBj/n+kEIVQHtlU3vHdSj1XsUS96jJXuOsZUzT9ul0naQNIG2iT/idM5AbHU09ZCB4IUTVNTRvImFz01NFclQogbkP7kmqlUf25bUX7ybPoxtTcpj9Y4kLkVqhLd8N/oldCHRAVQLE7cMP681bOy3jbGijrqwi9PPodn5fRw51mR3ljJQgWaXYaVJCng3UQATzTe3YkaBEHjQZfjRFPRHO7bIdgtHTXY06Xzjwcp7aj/fvkutqzyGyDGGLgvJn3Wh6kkdAn+iztx90oR3QBaWRZatxvq6FDEu3cuGYo3y8kf72aa95Yg2lrIwdCAWM7UQbhuiQxrWsaIi8sOeUupSZK1Iz72kNlI/OoxQphNylZBB8KN5N4OzpTPE19m+QIDlpWXp+1ML1HdSBost/oGszIFoLZlCMBtl6D+mYKGluGCKxiCqbbkcBA2/m6wnrS/dsritD7yl9bYn6eePNIK1B7Iq9peQf4xElVBVeHwRYHG44H73IDvhbodic8GZJUUt8qexsqBTHKh3sx01Hraj1sP2BJL48Ua+5/C7S1ewMYgjD8tXWExRMlIuHOn0F9wtTAt6BkZFXZCZfVJZkktll2R4xHl+F3dDZsbAqsfqgmT+82RvLuSniIbDVeuiDv4JkNEqj9sOv8urThHyVG5ymkuTb89I6s/KtDqspkMmFFoQyjMMAgsiN4ArGkCEDWikHr03gLwaX8i9gL148e0/gnc3Qw6HhRrThaWDULAQBsUCOQrTPX7maKgwsE7Y6mWuteWbllQ1dDnMtg9FtO7GJI83qa4OzeGRiBlcixlMC5I4D9rLBgTA0KVi+lKcO351+LqsTw7pfY4GEfaNynAykieY1BWQyfSNjL0eZeBLymNWCLV873vjwG7QL00sFovEeIZhGLfmZElZbhV81jSVIFz01Y1hIA030GBSSoGSkpwnSorHn7Z/q0OEkKGxIsQnIZDkB/+yXHeGrgnP8qMseGhARYU2CSSNIXScNrzIfFfd9TxWAPczL2QJOdYxA1g6tOCiuDXszryoZEZXB94s/hwRyFNKtX+4Ig8qeKwO60iWVSHMpjh4E4ApKgk3vymgb61P5aixqe8vaw6yKffOktm2vp7oTtrDgL1MGBC4lgu9tOFcZRd7v3UIZbvX3yipngECsXRKZFV5s/2i0aXKnx6pZJkOVST7nCwj2cMq6zWumeBA6hzijEkG1Ig6KXf+Rv8PF45/paj7QU+7L/rpECGr09IuxQ7BCw24xrERGTFv67W7Kg7saKl1kpNg0W27PI+8/DeEFG9jOhCCEWPM3IoZwgxpmKTq1EffMTHzsukVVUUjTjHQI250qlzRdASi4KOKQsYTQMjNHjOkAMLhH+qSc/PIRysrWoapxHQzZyw2WxhCrfsKbAVvMEQswk0b2cqVLQq4z5z1+dgCMxFItqsSMpzJbuHNy4IXW2Z7yKgPabwOhtXxQJRpeuR/Y1FNIEJ5JfxlaU3Eh2CXqV//+6nPDnJNXb3VGXV+Uf/CD+paxnKSE8Jtm7QiJwfuOnY7sYATbAvw7b6tfNhbbQp14yJ8nv4WPHafM1hBRkgT0eM1lLmFCTF4Y41Q7ZCwIub6irZ3ezdHw6IrzsGi+XxQvz0Ch+wGoqGvMdhATLwVCMu/HvqfgZfbIINKCsnWTVrfi7iePgICC/VNI+B1pZKgslN+0XoXRM9dMA5gRpIxDeei2yF8g/qCoEh3WiwC4VSiQl/BuDFi0UO3ega+UfX4NWtTo9avITdf4KZZqhsR0Rg4JqBTB4Pevx9T9YeAmHuSpz83mK1Zk2h2xLtuc2zDIUXoGvsp74R7JIkQAhnfKFtJz3P2El2eWpo0yXQ8vva/Q19VcKMxMooWZS0JJG0EyoWa1i8FFDnb98vtLwUfGQ1Z3nkSa+6UA8eP3+SWZclEkMhuTXaK0kaDg1iP7Dyo/bVogx2sbGpkbFEy+6iIJCKWGgKGQ1PSskdz7A1grqodWyreWkivBNhJqXE7Yg4tTdhrI5haMBQIGTy+tpGdcMfIrA6BqxJdDw1WlP83aZLtNWI7l15N7W8cs+KTzQe2VuXQMhVbPM2IidAoXDhMMiXLdDTJwOb+OjuQOmpJy1JTx8HEnUzQJ5rwOdJWTSrfu7WlwGmeqPcsPx966QbB5YFAM6jTRjdT+5wjFKyYiQ6g9d8Nln70cmc2PHYOOtxq8BGvMzlTlX3YMKGy2mAD+3jfbsvQlcfvei74VcvwxvynX3HUzZN8KTucV99yPHL0+FjDVIaSpQfTC13FalhD4LfspUn1LXVwkjNn0zhJVSZTOd+wXOZKS7XNXq7HNEQIyuBfOwjv0H5T8h7eOclPb0D1eGpBCIkqSdMeAmjgPUJ8g/PXZ9bUvNJjPRYVKcr+nEtAsNdhid0Xy14meZOFs9/wpjFAH8An8aXDaHy2tujSDo2u3b/wT3c65EtMyyl8Dlhqio9v2bP//ZuWB55rGeeMFar05ZHZaHS4OmIMk7L7Mq20hFlqRlMRSY6BeJewP167t6VO/AQipd9HfR70FfTJd2Qkl2FAB+CR3B+NYeE+uV8tfEa0ujmryQZGEUi0b3p6IVzr2AcNb6sQG35YV/ciHvb8AO4sditOzxUQI9cKxZni7DeMSS4fuAbRxrJSZu79bJeeee4ToN4TxOSeRzOv9CrinjDcS3UhU5RWMX64ki+f/7+BT+NQki//6V2Q+VcT0zkvvsqKVh/EKyAOYbn6kX8AM9JfZCuvXR8v3/5Im+H8BV7Htlv61sAO6fn5t++w3bWtQ/pnZl6O3RyjCAKaaW6fXV//57OCDOr8pXkRGA1vsxkrtsoN4WvMUN2VLBL26ns+FVZNFYDmHK6Ubp+IMm+0GyuZlgd3Qm0eLDfk47U6JwkEQ+hylLMRolz20wlCcVxNu/GktCymN1Qgxg7RrcBmhA7Apt3NbNX1nSKD+tv/4JAOufOEsZylG/Ky9PR+cAhOq43FHBWhEKuMRAIfMvbRhrPBHYmT2PZqVOxYu1stuHJPbM8XY0WwEQsL0iVIkjRIFIzdzY5sbrPA8ntY8qHS2PhAGFETUAwsV7IV0icMdn224aDeqA78lmKZehUWJzGemqLA/vLANobd4AGpOw4xU13FPvsv4PofN8kjLeuyRk27AF5bElX0EmQm9vOWb4E/7+sYtrHjtQDPuWwAInh9mwQkoAzbE97fAuuCaz9meze0rBOu6u8YpkjWRTYymgdHbiws+fVNh8xd5pFNteLo+/tE6QcfW4O+vUW4zC+xMq1A+ZBwpa1hf7y6DYK/jvmdah+KFY1uAedfC9nlb7Lubda46QHGvlgC3X6qDZ5OeYU5NlqW0d+2wKgBeg1AUtxKlXY5yPmdeJuWMPJdkD723lMqhkwxKdDR2KKr2Bswe1vMW/a3mdi8z/aj/n4cvzFJ/gALXAhhPyTsINAmER9DZJTWITFwyb6vYyZm6aZq69IJ71vJysaWnCRtsGLKUXZ4A2DalMYXOHzYERWCE6YGKxH40lgYvrWYLAmHKTmr3ztolMbLflOPBH/2ELazQC7AJG1KpOlx3Yhd7x8WtZBt88N/oAPGJrE74f6pwlZEpDYc8g80zt6h9EKgFwK9EOiFQC8EeiHQC4FeCPRCoBcCvRDohUAvBHoh0AuBXgj0QqAXAr0Q6IVALwR6IdALgV4ItELADlC1XnbvbMrs4tkOWXlTtaRAyIo+7Ej2Fa387cyWTWez5izO12Lmt59ZuuAP7VucVrj4WtxTVy+b+3pHzwS3bml/H9ebn146/8/x+9PvXzzOMqxbVy+b9xDe4mrZqjN19qIFKINQcHMS4ksuO9eufuKB43SHnuP1gq2rnpyzKV7Evl+48Bc+xbFIUQw9EBE/e3r5/Ifvu++J9O7MbfbsJ33YKFsoBGL9+PoKNl584FXUp5YsefC0wt/N2zwSh3fyc7zl9J2YYeRELN2PgPYcvSH4RGItI2rhuxX8jsR7LefCxCYFa2zLdeIJnuEVhyxsKXk9MePtvx2JxUzTehhbpr43ffZjExLvI8h+N/Juqos3Z97EtpRsbED5kAjELofniN3/afrc4rQ29RifapqyB69HIpLNfkjPujO3GXMW9w2LyAf4yGAS3rErRp8vI8R/baMRe4baOJ1E0dozSmCxfYht951SuOjOZ5bNf+mMGkNltLd/1dJ5J+7Jam54xr/9IQ+vKw/C61Bz8fIlAa9lEwQVkbn8wVNL53zRXHzt1NkL8S0yMRPXP2m6x/9qamI5zvFWRXOiF1U7kBUnm1tMsx7FLvqnVy+d/1hzSx+tWbPmf9auL9n+o9mLL/jj0rmfxbvo7vG0OCSxcex5FYqqTgGn/Gba/UtyEp+djXNDN6ZhM9azyijvq+hz3Iz5CzO66gewzkW5lu0/eFF0BV7b9U0tXHRPV/XoWVdzK8LHAtDO7XnZ/ZcmtjMJm8xdwjtRtly2mEx81p3zM+YQ6uSpJQ+WTpu98OcQD6txeUN3Ou60jOCzwW2t1IuCeLvkPuicdwgIh8uL71VU5cqVM2fqU2ctfCkW5pNRpDjensmMOVNnLcImU3sH91gomL1SUkoL0CQDLxA6xXQ9ar0Pbtu08g//VhKv29Gxs7kdqSzuB76qLiqahD1LjE37j1VJIhj4Pp1HWRi7WTntpqyk61NJZ8wh8c5WL13wPCbfMK1w0X3xe6d5XAbRNzQxEzKorcNVxTdAjNTjRcw8KOjLoUDp7VFb5sf7guz5At8R2oK3dbdAlL6Ll0nH81Ckjc5Y+dhc7GRnD+kx4xnorA6EVby1pmNHc+O+lAAq9i8sXIoPqGC3KqdvhTIvZWz4uxEb/L/TtpXuXfUYQqg72cVn4a2juXgzaWj3uu+gFCDYwV37Ft7GIOAfhgi6lzIKjkFpN1ld8Tr4Ata6VcsWvPLM0rn/88zy+b+AVnrTtKJ3xZ/Hj8367tjU2cVz4/e6Oraf2+rfTad3Tw5oLELf9GVkZaLNYsowJjbQvdNJPYqQVYvn1eKzfPfjZclFpzOYrurAvOyDT2CNw7vy33t62YKZ8QxBvhCf4PhRZ3Wx93cbKHZQR8/9TukBUHkhkNaGgzoq29Hc8L7LT/E20Pzp9z0xIF6nqGg9PnYnOuwvXqarY4/okMQOyEKaUriQrC37HwwSn8XPsf3zAch/W97G70Hm/87e2wsdgmffa7lvn/BdmhX5EJT3Unv7nrv4nyxN/GrGj1f49fpg22q4shTlA64bvyTRNK2wRdXY5R57bG5g+n2LZkG8vG04YtxxQu22N9rPjbhw2n3FeHs6+hb0VhBzaDxcsS0Ptd53OaSFbWv3Xn2tEKC1Da1LvtZOezvrhUAvBHoh0AuBXgj0QqAXAr0Q6IXANxMCJ/XjnMq0phYWPwxf0gvwPR2kejNWrFD1T0O/x/dvF5KTju4tWPCstzpU9X9dwvObqBT+Gd1LTAg3RVYvm4+XuloT2fhWVPy89U7CGTy5Hsn1eFhEH4nfxSIQH2GSNya7xLrFi+dF6D4Fp/Bd+Bfiwap4WSzofqte6HvYdlbe99hYvHp9PV5cHIHA1yYuOV9d9eT9R7B4nIDX6G6N10k8otyG1U/Oeznx3pmc96jrBA7rIXBvfDs+oNhnoUsRjHrAMoyb4/fqwtVXAuhXxLjmw4r99sRAFJ3Dt9smvkH1khEvipeDy3srAD4pfo3vJK6nYFKbtgT/CP9Q+C91mlgX75eCV/jfwg5c9aLQuzukTJ9VfBc+qfE0fMSf4zNav7Pw3QHLir5HBMS542C8P/jQXPCf9Y1fK9z6qqWPHjjpUdcJvhz+OgBBcYbF9ti4mAg/ETyqFo6MgkL0/akJiPatbXrOQl0Fo+wy+Gmm8jfommIu+D+icGI9hIUHwm3Rvq2/gPo/nnrf4tFPPzl3e7ytzo6I+t0GcfEkqP2vzWW2IVSdWRuqnLZ62QK8kMwO0X14s4ehXJ/E/pvL98ihZznETf98zMeRg41GB8ftdfgk/q/hRhqNSJrcPOIJ+MIiOOHsJuoP3uC++AZgS3Cqqx7Beesglv6D3Prk96Kyzyyd95NmZHRVtUef9SiHkEcUkbhdRyq3X4I4wVeaCCetXj734NTChdvfWn/0Ymwc2Be2orm52fO2llQ8lg/RVYBg1J7EGSEA+benly5YkHivO+doK4P0AZWliODr60vG49trD69e2qTPTtYGAL9yeuHCSvy9xY+nzS4+D+N6HZ+Hfup0wrAn66ur5z2KkKaOQP2CXRsVkb4Igb5r3+P8LXwTbCJ2cfQH6b1dVMQtiBn6Yu4hCkR1NcBuP+NCA7tvofJoF0Eing69Qor4GbqHBGmJ7/G1Sygr+f2pYCb82xfiKDi8QnqjJlx1s2GZaxCT/zkI5E/tqp21y54VWTRMia+FzpgA5Q5xZf95O0SX9DYmPhHXE8ABTfqjh6eEb1kFCaCUKcKnXuD7V6DmYlu/NPV1DIr60sRup9xfPBLXWlHRVA0hg1d/WPjYKHq+cOHkEG07wodnJ+OP2eck1jnb5z2OkNVPzEEsmeeD5Cam+zLX0wTIDIZlkgnM3KC4sT3na0hkxmIctPtkIHWHQNVrGNMPZs0t7kfXFAPnpiiEmf6a/ZzzA4jH/7yo6Gl8yAKohB4BAknRH6Prryv1uMiijWtTZi1aB7GVT5QWnwji34Sc0SsXLahuuQcdgmDU3vh1/Ihv7l57ss0H8bJdHiW2Gd9BpRDrO3lZ81YdqVw0VIuI/dBpX1qNdfhyGn9X9Yjp1Iaa5fuJXh4sPlJR8xn0YA30COSY+NzllvDZl9501iBAFiBtnJtRtAJ/ydhxokBT3NLquMTZu/v/AS7NetM06a96AAAAAElFTkSuQmCC" alt="" class="poster-img">\n                        <p class="poster-text">'+this._getBoardTips()+'</p>\n                    </div>\n                </div>\n                <div class="sunl-loading">\n                    <img src="'+ln+'" class="sunl-loading-icon" />\n                    <div>课件加载中...</div>\n                </div>\n                \x3c!-- board --\x3e\n                <svg class="sunl-board-svg" xmlns="http://www.w3.org/2000/xmlns/" xlink="http://www.w3.org/1999/xlink" viewBox="0,0,'+i+","+n+'">\n                    <defs>\n                        <rect x="0" y="0" width="'+i+'" height="'+n+'" id="'+u+'"></rect>\n                        \x3c!-- clip area --\x3e\n                        <clipPath stroke-linejoin="round" stroke-linecap="round" id="'+c+'">\n                            <use xlink:href="#'+u+'"></use>\n                        </clipPath>\n                    </defs>\n                    \x3c!-- background color --\x3e\n                    <use xlink:href="#'+u+'" fill="none" id="'+d+'"></use>\n                    <g clip-path="url(#'+c+')">\n                      <g id="'+h+'" class="sunl-board-svg-group group-animation"></g>  \n                    </g>\n                </svg>\n            </div>\n        ';a.innerHTML=f,this.boardContainer=a.querySelector(".sunl-board-container"),this.poster=this.boardContainer.querySelector(".sunl-board-poster"),this.loading=this.poster.nextElementSibling,this.svgElement=this.loading.nextElementSibling;var p=this.svgElement.querySelector("defs");this.defsRect=p.querySelector("#"+u),this.bgRect=this.svgElement.querySelector("#"+d),this.groups=this.svgElement.querySelector("#"+h),this.elements={defs:p,groups:this.groups}}},{key:"_setSize",value:function(e,t){0!==e&&0!==t&&(2<arguments.length&&void 0!==arguments[2]&&arguments[2]||(this._options.size=[e,t]),this._options.imageSize=[e,t])}},{key:"_toggleGroupsClass",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=this.groups.getAttributeNS(null,"class");if(t){var r=t.trim().split(/\s+/).filter(Boolean);e?-1==r.indexOf("group-animation")&&r.push("group-animation"):r=r.filter(function(e){return"group-animation"!==e}),this.groups.setAttributeNS(null,"class",r.join(" "))}}},{key:"_getBoardStatus",value:function(){return this._options.status}},{key:"_filterTrace",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],r=this._options,i=yr(2<arguments.length&&void 0!==arguments[2]&&arguments[2]?r.imageSize:r.size,2),n=i[0],a=i[1],o=e.iId,s=e.lSequence,l=e.iType,u=e.penWidth,c=e.iColor,d=e.points,h=e.iDuration,f=e.sText,p=e.fontSize,g={};if(s&&null!=o&&""!==o){var m=(void 0===d?[]:d).map(function(e){return[e.x*n/1e4,e.y*a/1e4]}),v={penWidth:u,lineColor:Ni(c),duration:t?0:h};Rr(g,{iId:o,iType:l,point:m,lSequence:s,isInit:t,sText:f,fontSize:p,config:v})}return g}},{key:"_getBoardTips",value:function(){var e=this._options,t=e.status,r=hn[e.isLive?"live":"vod"],i=(r=void 0===r?{}:r)[void 0===t?-1:t];return void 0===i?"":i}},{key:"_setBoardTips",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];this.poster.querySelector(".poster-text").textContent=this._getBoardTips(),this.poster.classList[e?"add":"remove"]("poster-active")}},{key:"_reportMessage",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];if(this._options.debug){var i=yr(r?["","blue"]:["失败","red"],2);ji("info",["%c[图片加载"+i[0]+t.loadTime+"ms]:"+e,"color:"+i[1]],!0)}if(!(r&&t.loadTime<100)){var n=this._options,a=n.roomInfo,o=n.userInfo;$i(2,dr({uri:e,failMsg:r?"图片加载缓慢":"图片加载失败",loadTime:0,rid:(a=void 0===a?{}:a).iRoomId,uid:(o=void 0===o?{}:o).iUserId,biz:n.isLive?0:1},t))}}},{key:"on",value:function(e,t){this.events.on(e,t)}},{key:"trigger",value:function(e,t){this.events.trigger(e,t)}},{key:"getSvgComponent",value:function(){return this.svgElement}},{key:"dispose",value:function(){}}],[{key:"_cacheImage",value:function(e){if(!e)return null;var i,t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1]?e.replace(/^(http|https)?:?\/\//,"https://"):e;return i=t,new Ri(function(e,t){var r=new Image;r.onload=function(){return e(i)},r.onerror=function(){return t(i)},r.src=i})}}]),e}(),pn=Or.TraceType,gn=pn.TT_PATH,mn=pn.TT_SOLID_LINE,vn=pn.TT_DASH_LINE,yn=pn.TT_ARROW_LINE,_n=pn.TT_RECT,bn=pn.TT_ELLIPSE,Tn=pn.TT_TEXT;function Sn(t,e){var r,i,n=e.duration,a=void 0===n?1e3:n,o=e.penWidth,s=void 0===o?1:o,l=e.lineColor,u=void 0===l?"#990033":l,c=e.fillColor,d=void 0!==c&&c,h=e.strokeDasharray,f=void 0===h?"":h,p=e.fontSize,g=void 0===p?null:p,m=e.totalLength,v=void 0===m?0:m;if(g?t.style.cssText+="font-size:"+g+"px;fill:"+u+";":t.style.cssText="stroke:"+u+";fill:"+(d||"none")+";stroke-width:"+s+";stroke-dasharray:"+f+";",a)if(t.style.strokeDasharray=f||v+" "+v,r=!!document.documentMode,i=!r&&!!window.StyleMedia,r||i){var y=v,_=1e3*v/(60*a);!function e(){0<=y?(t.style.strokeDashoffset=y,y-=_,requestAnimationFrame(e)):t.style.strokeDashoffset=0}()}else t.style.cssText+="stroke-dashoffset:"+v+";animation: painting "+a+"ms ease-in both;"}function En(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",i=document.createElementNS("http://www.w3.org/2000/svg",e);i.textContent=r;var n={};switch(e){case"image":Rr(n,{height:0,width:0,x:0,y:0,preserveAspectRatio:"none meet"});break;case"marker":Rr(n,{orient:"auto",markerUnits:"strokeWidth"})}return Rr(n,t),Gt(n).forEach(function(e){i.setAttributeNS(null,e,n[e])}),i}function kn(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",r=2<arguments.length&&void 0!==arguments[2]&&arguments[2],i=e.defs,n=e.groups,a=r?i.childNodes:i.querySelectorAll('[data-id="'+t+'"]'),o=r?n.childNodes:n.querySelectorAll('[data-id="'+t+'"]');ur(a).filter(function(e){return 1===e.nodeType}).forEach(function(e){-1==["CLIPPATH","RECT"].indexOf(e.tagName.toUpperCase())&&i.removeChild(e)}),ur(o).filter(function(e){return"IMAGE"!==e.tagName.toUpperCase()}).forEach(function(e){return n.removeChild(e)})}function wn(e,t){var r=t.iId,i=t.iType,n=t.point,a=t.sText,o=t.fontSize,s=t.config,l=t.timeSec,u=t.imageSize,c=void 0===u?[]:u,d=e.defs,h=e.groups,f=[0],p=f[0],g=f[1],m={"data-id":r,"data-type":i,"data-index":t.index};switch(i){case gn:var v=n.concat([]);v="M  "+v.map(function(e){return e.join(" ")}).join(" L ");var y=En("path",dr({d:v,fill:"none","stroke-linejoin":"round","stroke-linecap":"round"},m));(g=h.appendChild(y)).getTotalLength||Rr(s,{duration:0});break;case mn:var _=yr(n,2),b=yr(_[0],2),T=b[0],S=b[1],E=yr(_[1],2),k=E[0],w=E[1],C=En("line",dr({x1:T,x2:k,y1:S,y2:w},m));(g=h.appendChild(C)).getTotalLength||(p=Math.sqrt((k-T)*(k-T)+(w-S)*(w-S)));break;case vn:var A=yr(n,2),L=yr(A[0],2),I=L[0],P=L[1],x=yr(A[1],2),R=x[0],O=x[1],D=En("line",dr({x1:I,x2:R,y1:P,y2:O},m));(g=h.appendChild(D)).getTotalLength||(p=Math.sqrt((R-I)*(R-I)+(O-P)*(O-P))),Rr(s,{strokeDasharray:10});break;case yn:var M=yr(n,2),N=yr(M[0],2),F=N[0],j=N[1],B=M[1],U=yr(B=void 0===B?[0,0]:B,2),H=U[0],G=U[1],q=yr(c,2),V=q[0],W=q[1],z=s.lineColor,K=s.penWidth,Y=(void 0===K?0:K)+3,X=Y+5,Q=Math.sqrt(Math.pow(H-F,2)+Math.pow(G-j,2))-.75*X,J=.5*Y,Z=En("line",dr({x1:F,x2:H,y1:j,y2:G,"marker-start":"url(#marker-start-"+r+")","marker-end":"url(#marker-end-"+r+")"},m));(g=h.appendChild(Z)).getTotalLength||(p=Math.sqrt((H-F)*(H-F)+(G-j)*(G-j)));var $={id:"marker-start-"+r,"data-id":r,refX:0,refY:J/2,markerWidth:V,markerHeight:W,fill:"none"},ee=En("marker",$),te=En("path",{d:"M0 "+J/2+" L"+Q+" 0 L"+Q+" "+J+" Z"});ee.appendChild(te);var re=En("marker",dr({},$,{id:"marker-end-"+r,refX:X,refY:Y/2})),ie=En("path",{d:"M"+X+" "+Y/2+" L0 0 L"+X/4+" "+Y/2+" L0 "+Y+" Z"});re.appendChild(ie),d.appendChild(ee),d.appendChild(re),s.penWidth=1,setTimeout(function(){te.style.cssText="fill: "+z,ie.style.cssText="fill: "+z},l);break;case _n:var ne=yr(n,2),ae=yr(ne[0],2),oe=ae[0],se=ae[1],le=yr(ne[1],2),ue=le[0],ce=le[1],de=Math.round(100*Math.abs(oe-ue))/100,he=Math.round(100*Math.abs(se-ce))/100,fe=En("rect",dr({x:Math.min(oe,ue),y:Math.min(se,ce),width:de,height:he,fill:"none","stroke-linejoin":"round","stroke-linecap":"round"},m));(g=h.appendChild(fe)).getTotalLength||(p=2*(de+he));break;case bn:var pe=yr(n,2),ge=yr(pe[0],2),me=ge[0],ve=ge[1],ye=yr(pe[1],2),_e=ye[0],be=ye[1],Te=Math.round(Math.abs(me-_e)/2*100)/100,Se=Math.round(Math.abs(ve-be)/2*100)/100,Ee=En("ellipse",dr({cx:Math.min(me,_e)+Te,cy:Math.min(ve,be)+Se,rx:Te,ry:Se,fill:"none"},m));if(!(g=h.appendChild(Ee)).getTotalLength){var ke=2*Math.min(Te,Se);p=2*Math.PI*ke+4*(2*Math.max(Te,Se)-ke)}break;case Tn:var we=yr(n,2),Ce=yr(we[0],2),Ae=Ce[0],Le=Ce[1],Ie=yr(we[1],2),Pe=Ie[1],xe=Math.min(Ae,Ie[0]),Re=Math.min(Le,Pe),Oe=Math.round(100*Math.abs(Le-Pe))/100,De=a.split("\n"),Me=De.length?Math.round(100*Oe/De.length)/100:Oe,Ne="",Fe=Math.round(50*(Me-o))/100;De.forEach(function(e,t){var r={x:xe,y:Math.round(100*(Re+Me*(t+1)))/100-Fe,style:"white-space: pre;"};t?Ne.appendChild(En("tspan",r,e)):Ne=En("text",dr({},r,m),e)}),g=h.appendChild(Ne),Rr(s,{fontSize:o,duration:0,penWidth:1})}return setTimeout(function(){g&&Sn(g,dr({},s,{totalLength:p}))},l),!1}var Cn,An,Ln,In,Pn=Or.ClientMsgType,xn=Pn.SMT_LOGIN_NOTIFY,Rn=Pn.SMT_BEGIN_LIVE,On=Pn.SMT_END_LIVE,Dn=Pn.SMT_HEARTBEAT,Mn=Pn.SMT_ADD_TRACE,Nn=Pn.SMT_ERASE_TRACE,Fn=Pn.SMT_PAGE_CHANGE_NOTIFY,jn=Pn.SMT_DOCUMENT_INFO,Bn=Pn.SMT_ERROR,Un=Pn.SMT_CHANGE_CDN_NOTIFY,Hn=Pn.SMT_PAUSE_LIVE_NOTIFY,Gn=Pn.SMT_CONTINUE_LIVE_NOTIFY,qn=Pn.SMT_BEGIN_PAPER_NOTIFY,Vn=Pn.SMT_SCROLL_POSITION,Wn=Pn.SMT_VIDEO_LOGIN_RES,zn=Pn.SMT_VIDEO_BATCH_RES,Kn=Pn.CMT_GET_PAGE,Yn=(Ar(sn={},Pn.SMT_LOGIN_REPLY,"login"),Ar(sn,xn,"user_enter"),Ar(sn,Rn,"begin"),Ar(sn,On,"end"),Ar(sn,Dn,"heartbeat"),Ar(sn,Mn,"add_trace"),Ar(sn,Nn,"erase_trace"),Ar(sn,Fn,"page_change_notify"),Ar(sn,jn,"dcument_info"),Ar(sn,Bn,"error"),Ar(sn,Un,"change_cdn_notify"),Ar(sn,Hn,"pause"),Ar(sn,Gn,"continue"),Ar(sn,qn,"begin_paper"),Ar(sn,Vn,"scroll_change"),Ar(sn,Wn,"login"),Ar(sn,zn,"get_increase_replay"),Ar(sn,Kn,"get_page"),sn),Xn=Or.RoomStatus,Qn=Xn.READY,Jn=Xn.LIVE,Zn=Xn.PAUSE,$n=Xn.END,ea=Or.ClientMsgType,ta=ea.SMT_LOGIN_REPLY,ra=ea.SMT_LOGIN_NOTIFY,ia=ea.SMT_BEGIN_LIVE,na=ea.SMT_END_LIVE,aa=ea.SMT_HEARTBEAT,oa=ea.SMT_ADD_TRACE,sa=ea.SMT_ERASE_TRACE,la=ea.SMT_PAGE_CHANGE_NOTIFY,ua=ea.SMT_DOCUMENT_INFO,ca=ea.SMT_ERROR,da=ea.SMT_CHANGE_CDN_NOTIFY,ha=ea.SMT_PAUSE_LIVE_NOTIFY,fa=ea.SMT_CONTINUE_LIVE_NOTIFY,pa=ea.SMT_BEGIN_PAPER_NOTIFY,ga=ea.SMT_SCROLL_POSITION,ma=Or.iErrorCode,va=function(e){function r(e){_r(this,r);var t=It(this,(r.__proto__||B(r)).call(this));return Rr(!0,t._options,{dataItem:{deleteCfg:{},changePage:{},scrollPage:{},scrollInfo:{},info:{}},status:Qn,showBoardTips:!0},e),t}return Ft(r,fn),Cr(r,[{key:"onPlayerMetadata",value:function(e){Rr(this._options,{sequence:e.sequence}),this._options.showBoardTips&&(this._options.showBoardTips=!1,this._setBoardTips(!1)),this._render()}},{key:"dispose",value:function(){var e=this._options,t=e.websocket,r=e.reconnectTimer;Ji({},!0),t&&t.close(),clearInterval(r),this.events.removeAllListeners()}},{key:"_resetParams",value:function(){Rr(this._options,{operation:null,reconnectCount:0,dataItem:{dataMap:{},deleteCfg:{},changePage:{},scrollPage:{},info:{},scrollInfo:{},imageInfo:{}}}),kn(this.elements,null,!0)}},{key:"_getDataListCfg",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=this._options.dataItem.dataMap,r=e.iId,i=this._filterTrace(e,1<arguments.length&&void 0!==arguments[1]&&arguments[1],arguments[2]);Gt(i).length&&(t[r]=t[r]||[],t[r].push(i))}},{key:"_filterPoints",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=this,i=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=2<arguments.length&&void 0!==arguments[2]&&arguments[2],t=this._options.dataItem,a=t.info,o=t.scrollInfo,s=e.iHeight,l=void 0===s?0:s,u=e.iWidth,c=void 0===u?0:u,d=e.iColor,h=void 0===d?0:d,f=e.sUrl,p=void 0===f?"":f,g=e.iTabulaHeight,m=e.iTabulaWidth,v=e.iCoursewareId,y=e.iPageId,_=e.iScrollPosition,b=void 0===_?0:_;this._setSize(c,l,n);var T=yr(p?[c,m?c*g/m:l]:[c,l],2),S=T[0],E=T[1];Rr(a,{url:p.replace(/^(http|https)?:?\/\//,"https://"),bgColor:p?"":Ni(h),width:c,height:l,boardHeight:E,boardWidth:S,isInit:i,scrollY:Math.round((l-E)*b)/100,pageId:y,courseId:v}),Rr(o,{width:c,height:l,boardHeight:E,boardWidth:S,pageId:y,courseId:v});var k=e.traces,w=void 0===k?{}:k;Gt(w).forEach(function(e){var t=w[e];r._getDataListCfg(void 0===t?{}:t,i,n)})}},{key:"_filterData",value:function(e,t){var r=this._options,i=r.sequence,n=r.debug;switch(t){case ta:this._resetParams();var a=e.iUserId,o=e.roomInfo,s=(o=void 0===o?{}:o).streamPullUrls,l=void 0===s?[]:s,u=o.sName,c=o.page,d=void 0===c?{}:c,h=o.iStatus,f=o.iImId,p=o.sTeacher;Rr(this._options,{roomInfo:e.roomInfo,userInfo:{iSex:e.iSex,iUserId:a}}),this._options.status=h,this._setBoardTips(),d.sUrl&&fn._cacheImage(d.sUrl),h!==Jn&&h!==Zn||(this._filterPoints(d,!0),this._render(!0),this._setBoardTips(!1)),ji("info",["%c[登录回复]:","color:green",e],n),this.trigger("room_info_change",{sName:u,streams:l,iImId:f,sTeacher:p,iUserId:a});break;case ra:ji("info",["%c[登录通知]:"+e.sUserName+"加入, 当前人数"+e.iUserCount,"color:green"],n);break;case ia:var g=e.lStartTime,m=e.sMsg;this._options.status=Jn,ji("info",["%c[上课通知]:"+g+" "+m,"color:green"],n);break;case na:var v=e.lEndTime,y=e.sMsg;this._options.status=$n,ji("info",["%c[下课通知]:"+v+" "+y,"color:green"],n);break;case aa:ji("info",["%c[心跳回复]:userCount "+e.iUserCount+" 人","color:green"],n);break;case oa:this._getDataListCfg(e),ji("info",["%c[增加轨迹]:ID "+e.iId+" 时间: "+e.lSequence+" 差值:"+(e.lSequence-i),"color:green"],n);break;case sa:var _=this._options.dataItem.deleteCfg,b=e.lSequence,T=e.traceIds,S=void 0===T?[]:T;_[b]=_[b]||[],_[b].push({lSequence:b,traceIds:S}),ji("info",["%c[删除轨迹]:IDs:"+S+" 时间: "+b+" 差值:"+(b-i),"color:green"],n);break;case la:var E=e.lSequence,k=e.iHeight,w=void 0===k?0:k,C=e.iWidth,A=void 0===C?0:C;fn._cacheImage(e.sUrl),this._setSize(A,w),E&&Rr(this._options.dataItem.changePage,Ar({},E,e)),ji("info",["%c[课件翻页]: "+e.lSequence+" 差值:"+(e.lSequence-i),"color:green"],n);break;case ua:ji("info",["%c[课件信息]: "+e,"color:green"],n);break;case ca:var L=e.operation,I=e.iCode;if(ji("error",["[错误信息]: "+e.sError+",operation: "+(this._options.operation=L)],n),I===ma.EC_KICK_BY_ADMIN)return void this.trigger("kicked");break;case da:var P=e.streamPullUrls,x=void 0===P?[]:P;ji("info",["%c[CDN地址切换]:"+i,"color:green",e],n),this.trigger("room_info_change",{streams:x});break;case ha:var R=e.lPauseTime,O=e.sMsg;this._options.status=Zn,ji("info",["%c[暂停上课]:"+R+" "+O,"color:green"],n);break;case fa:var D=e.lContinueTime,M=e.sMsg;this._options.status=Jn,ji("info",["%c[继续上课]:"+D+" "+M,"color:green"],n);break;case pa:ji("info",["%c[随堂考]:"+e.lSequence+" "+e.iPaperId,"color:green"],n);break;case ga:var N=e.lSequence,F=e.iScrollPosition;N&&Rr(this._options.dataItem.scrollPage,Ar({},N,e)),ji("info",["%c[滚动条位置]:"+N+" "+F+"%","color:green"],n)}this.trigger(Yn[t]||t,e)}},{key:"_initData",value:function(){var v=this;!function(e,t){var r=this,i=Ut({eType:Or.ClientMsgType.CMT_LOGIN_REQUEST,bytes:Ut({sToken:e.liveToken})}),n=new WebSocket(Zi("LIVE_ENTRY"));n.onmessage=function(e){t&&t.call(r,{e:e,websocket:n})},n.onerror=function(e){t&&t.call(r,{e:e,websocket:n})},n.onclose=function(e){t&&t.call(r,{e:e,websocket:n})},n.onopen=function(){return n.send(i)}}({liveToken:this._options.liveToken},function(e){var t=e.e,r=e.websocket;if(t.data){var i=v._options,n=i.isHeartBeatOn,a=i.debug,o=i.reconnectTimer,s=JSON.parse(t.data||"{}"),l=s.eType,u=JSON.parse(s.bytes||"{}");o&&(console.info("%c[重连成功]:","color:green"),clearInterval(o),v._options.reconnectTimer=null),n||Ji({websocket:r,time:28e3},!(v._options.isHeartBeatOn=!0),a),v._filterData(u,l)}else{var c=v._options,d=c.operation,h=c.reconnectTimer;if(Ji({},!0,c.debug),v._options.isHeartBeatOn=!1,!d||2!==d)return;if(!h){var f=3e3,p=0,g=0,m=0;console.error("[连接失败], 3s后进行重连..."),v._options.reconnectTimer=setInterval(function(){f<=(g+=1e3)-m&&(6e4<(f*=2)&&(f=6e4),m=g,p+=1,v._initData(),console.error("[重连失败], "+f/1e3+"s后进行第"+p+"次重连..."))},1e3)}}})}},{key:"_render",value:function(){var s=this,t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],e=this._options,r=e.dataItem,i=r.changePage,n=r.dataMap,a=r.deleteCfg,l=r.scrollPage,o=e.sequence,u=e.imageSize;Gt(i).sort(function(e,t){return+e-+t}).filter(function(e){return+e<=o}).forEach(function(r){var e=i[r],t=void 0===e?{}:e;Gt(n).forEach(function(e){var t=n[e];(void 0===t?[]:t).some(function(e){return+e.lSequence<=r})&&delete n[e]}),Gt(a).filter(function(e){return+e<=r}).forEach(function(e){return delete a[e]}),Gt(l).filter(function(e){return+e<=r}).forEach(function(e){return delete l[e]}),kn(s.elements,null,!0),s._filterPoints(t,!0,!0),delete i[r]});var c=this._options.dataItem,d=c.info,h=c.scrollInfo;if(Gt(d).length){var f=d.bgColor,p=d.url,g=void 0===p?"":p,m=d.width,v=d.height,y=d.boardWidth,_=d.boardHeight,b=d.scrollY,T=void 0===b?0:b,S=d.isInit,E=d.pageId,k=d.courseId;this.bgRect.style.fill=void 0===f?"":f,this.svgElement.setAttributeNS(null,"viewBox","0,0,"+y+","+_),this.defsRect.setAttributeNS(null,"width",m);var w=yr(_<=v?[0,_]:[T,v],2),C=w[0];this.defsRect.setAttributeNS(null,"height",w[1]),this.defsRect.setAttributeNS(null,"y",-C),this._toggleGroupsClass(!S),this.groups.setAttributeNS(null,"transform","translate(0, "+-T+")");var A=this.groups.querySelector("image");if(g&&this._imgUrl!==g){A=A||this.groups.appendChild(En("image")),this.loading.classList.add("waiting"),A.setAttributeNS(null,"height",v),A.setAttributeNS(null,"width",m),A.setAttributeNS("http://www.w3.org/1999/xlink","href",g);var L=Date.now();fn._cacheImage(g,!1).then(function(e){s.loading.classList.remove("waiting"),s._reportMessage(g,{loadTime:Date.now()-L,pageId:E,courseId:k})}).catch(function(e){s._reportMessage(g,{loadTime:Date.now()-L,pageId:E,courseId:k},!1)}).finally(function(e){t&&s._render()})}!g&&A&&A.setAttributeNS("http://www.w3.org/1999/xlink","href",""),this._imgUrl=g,this._options.dataItem.info={}}Gt(l).sort(function(e,t){return+e-+t}).filter(function(e){return+e<=o}).forEach(function(e){var t=l[e],r=void 0===t?{}:t,i=r.iScrollPosition,n=void 0===i?0:i,a=h.height,o=h.boardHeight;r.iPageId===h.pageId&&r.iCoursewareId===h.courseId&&(s._toggleGroupsClass(!0),s.groups.setAttributeNS(null,"transform","translate(0, "+-(Math.round((a-o)*n)/100)+")"));delete l[e]});var I=0;Gt(n).sort(function(e,t){return+e-+t}).forEach(function(e){var t=n[e],r=(void 0===t?[]:t).sort(function(e,t){return e.lSequence-t.lSequence}).filter(function(e,t){var r=e.config;return!(e.isInit||e.lSequence<=o)||(wn(s.elements,{iId:e.iId,iType:e.iType,point:e.point,idx:t,sText:e.sText,config:r,timeSec:I,fontSize:e.fontSize,imageSize:u}),I+=r.duration,!1)});r.length?n[e]=r:delete n[e]}),Gt(a).sort(function(e,t){return+e-+t}).filter(function(e){return+e<=o}).forEach(function(e){var t=a[e];(void 0===t?[]:t).forEach(function(e){return e.traceIds.forEach(function(e){return kn(s.elements,e)})}),delete a[e]})}}]),r}(),ya={40002:"Token无效",40004:"重新获取Token",2:"找不到房间",1:"接口参数错误",10013:"获取流回放地址失败",10027:"点播视频未准备好"},_a=Or.RoomStatus.LIVE,ba=Or.ClientMsgType,Ta=ba.SMT_LOGIN_NOTIFY,Sa=ba.SMT_BEGIN_LIVE,Ea=ba.SMT_END_LIVE,ka=ba.SMT_HEARTBEAT,wa=ba.SMT_ADD_TRACE,Ca=ba.SMT_ERASE_TRACE,Aa=ba.SMT_PAGE_CHANGE_NOTIFY,La=ba.SMT_DOCUMENT_INFO,Ia=ba.SMT_ERROR,Pa=ba.SMT_VIDEO_LOGIN_RES,xa=ba.SMT_VIDEO_BATCH_RES,Ra=ba.SMT_BEGIN_PAPER_NOTIFY,Oa=ba.SMT_SCROLL_POSITION,Da=["heartbeat","getincrmsg","getpage","login"].map(function(e){return Zi("VOD_ENTRY")+"/"+e}),Ma=yr(Da,4),Na=Ma[0],Fa=Ma[1],ja=Ma[2],Ba=Ma[3],Ua=function(e){function r(e){_r(this,r);var t=It(this,(r.__proto__||B(r)).call(this));return Rr(!0,t._options,{dataItem:{dataList:{},scrollPage:{},scrollInfo:{},imageInfo:{}},requestSeq:0,isInitPageData:!1,reconnectCount:0},e),t}return Ft(r,fn),Cr(r,[{key:"_heartBeat",value:function(){var o=this,e=this._options,t=e.liveToken,r=e.iRoomId,i=e._heatBeatTimer,n=e.debug;if(i&&clearTimeout(i),r){!function a(){if(ji("count",["[心跳次数(30s)]"],n),o._options.isHeartBeatOn){var e=o.getPlayerStatus()?1:0;Ui(Na,{data:Ut({token:{roomId:r,token:t,pausePlay:e}}),hasErr:!0}).then(function(e){var t=e.heartbeat;o._filterData(void 0===t?{}:t,ka),o._options._heatBeatTimer=setTimeout(a,3e4)}).catch(function(e){var t=e.err;if(t){var r=t.iCode,i=void 0===r?-1:r,n=t.operation;o._reconnectServer(t,"heartbeat"),ya[i]||2===n||(o._options._heatBeatTimer=setTimeout(a,3e4)),o.trigger("error",t)}})}}()}else console.error("无roomId")}},{key:"_fetchIncreaseData",value:function(){var r=this,e=this._options,t=e.liveToken,i=e.iRoomId,n=e.requestSeq;return ji("info",["%c[请求GetIncrease]: "+this._options.requestSeq,"color:green"],e.debug),Ui(Fa,{data:Ut({lSequence:n,iInterval:20,token:{roomId:i,token:t}}),hasErr:!0}).then(function(e){r._filterData(e,xa)}).catch(function(e){var t=e.err;t&&(r._reconnectServer(t,"increatedata"),r.trigger("error",t))})}},{key:"_fetchPageData",value:function(){var r=this,e=this._options,t=e.liveToken,i=e.iRoomId,n=e.sequence;return ji("info",["%c[请求GetPage]: "+n,"color:green"],e.debug),Ui(ja,{data:Ut({lSequence:n,token:{roomId:i,token:t}}),hasErr:!0}).then(function(e){r._filterData(e,Aa,!0)}).catch(function(e){var t=e.err;t&&(r._reconnectServer(t,"pagedata"),r.trigger("error",t))})}},{key:"_reconnectServer",value:function(){var e=this,t=arguments[1];2===(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).operation&&(this._options.reconnectTimer&&clearTimeout(this._options.reconnectTimer),this._options.reconnectTimer=setTimeout(function(){e._options.isHeartBeatOn=!1,e._options.reconnectCount+=1,e._options.reconnectCount<=3?(ji("info",["%c[点播HTTP重连"+t+"]: 第"+e._options.reconnectCount+"次","color:green"],!0),e._initData()):(ji("log",["%c"+t+"点播HTTP重连失败!","color:red"],!0),e._options.reconnectCount=0)},3e3))}},{key:"onPlayerMetadata",value:function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=arguments[1],i=e.sequence,n=e.seeked;if(i){Rr(this._options,{sequence:i});var a=!1;this._options.isInitPageData&&!n||(this._options.isInitPageData=!0,this._options.requestSeq=i,a=!0,this._fetchPageData().then(function(e){t._fetchIncreaseData(),r&&r()})),1e4<i-this._options.requestSeq&&!a&&(this._options.requestSeq+=2e4,this._fetchIncreaseData()),r||this._render()}}},{key:"onPlayerSeeked",value:function(){var e=this;this.onPlayerMetadata(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},function(){e._render()})}},{key:"dispose",value:function(){var e=this._options,t=e._heatBeatInterval,r=e._seekTimer;clearTimeout(e.reconnectTimer),clearTimeout(t),clearTimeout(r),this.events.removeAllListeners()}},{key:"_resetParams",value:function(){var e=dr({},0<arguments.length&&void 0!==arguments[0]&&arguments[0]?{operation:null,isInitPageData:!1,requestSeq:0}:{},{dataItem:{dataList:{},dataMap:{},scrollPage:{},scrollInfo:{},info:{},imageInfo:{}}});Rr(this._options,e),kn(this.elements,null,!0)}},{key:"_getDataListCfg",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=this._options.dataItem.dataList,r=e.iId,i=this._filterTrace(e,1<arguments.length&&void 0!==arguments[1]&&arguments[1],arguments[2]);Gt(i).length&&(t[r]=t[r]||[],t[r].push(i))}},{key:"_filterPoints",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=this,i=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=2<arguments.length&&void 0!==arguments[2]&&arguments[2],t=this._options.dataItem,a=t.info,o=t.scrollInfo,s=e.iHeight,l=void 0===s?0:s,u=e.iWidth,c=void 0===u?0:u,d=e.iColor,h=void 0===d?0:d,f=e.sUrl,p=void 0===f?"":f,g=e.iTabulaHeight,m=e.iTabulaWidth,v=e.iCoursewareId,y=e.iPageId,_=e.iScrollPosition,b=void 0===_?0:_;i&&(kn(this.elements,null,!0),this._options.dataItem.dataList={}),this._setSize(c,l,n);var T=yr(p?[c,m?c*g/m:l]:[c,l],2),S=T[0],E=T[1];Rr(a,{url:p.replace(/^(http|https)?:?\/\//,"https://"),bgColor:p?"":Ni(h),width:c,height:l,boardHeight:E,boardWidth:S,isInit:i,pageId:y,courseId:v,scrollY:Math.round((l-E)*b)/100}),Rr(o,{width:c,height:l,boardHeight:E,boardWidth:S,pageId:y,courseId:v});var k=e.traces,w=void 0===k?{}:k;Gt(w).forEach(function(e){var t=w[e];r._getDataListCfg(void 0===t?{}:t,i,n)})}},{key:"_filterData",value:function(e,t){var i=this,r=2<arguments.length&&void 0!==arguments[2]&&arguments[2],n=this._options,a=n.sequence,o=n.debug;switch(t){case Ta:ji("info",["%c[登录通知]:"+e.sUserName+"加入, 当前人数"+e.iUserCount,"color:green"],o);break;case Sa:ji("info",["%c[上课通知]:"+e.lStartTime+" "+e.sMsg,"color:green"],o);break;case Ea:ji("info",["%c[下课通知]:"+e.lEndTime+" "+e.sMsg,"color:green"],o);break;case ka:ji("info",["%c[心跳回复]:当前人数 "+e.iUserCount+" 人","color:green"],o);break;case wa:var s=this._options.dataItem.dataMap,l=e.lSequence,u=this._filterTrace(e);l&&Gt(u).length&&(s[l]=s[l]||[],s[l].push(dr({},u,{type:t})));break;case Ca:var c=this._options.dataItem.dataMap,d=e.lSequence,h=e.traceIds,f=void 0===h?[]:h;d&&(c[d]=c[d]||[],c[d].push({lSequence:d,traceIds:f,type:t}));break;case Aa:var p=e.page,g=void 0===p?e:p;if(fn._cacheImage(g.sUrl),r)this._resetParams(),this._filterPoints(g,!0),ji("info",["%c[GetPage返回]]:","color:green",e],o);else{var m=e.lSequence,v=e.iHeight,y=e.iWidth;this._setSize(void 0===y?0:y,void 0===v?0:v);var _=this._options.dataItem.dataMap;m&&(_[m]=_[m]||[],_[m].push(Rr(e,{type:t})))}break;case La:ji("info",["%c[课件信息]: "+e,"color:green"],o);break;case Ia:var b=e.operation;ji("error",["[错误信息]: "+e.sError+",operation: "+(this._options.operation=b)],o);break;case Pa:this._resetParams(!0),this._options.status=_a;var T=e.roomInfo,S=(T=void 0===T?{}:T).sName,E=T.iRoomId,k=T.page,w=T.iImId,C=T.sTeacher,A=e.videoPlayUrls,L=void 0===A?[]:A;this._options.iRoomId=E,this._filterPoints(k,!0),a||this._render(),ji("info",["%c[登录回复]:","color:green",e],o),this.trigger("room_info_change",{sName:S,streams:L,iImId:w,sTeacher:C,iRoomId:E});break;case xa:var I=e.sequenceMap,P=void 0===I?{}:I;Gt(P).forEach(function(e){var t=P[e];(void 0===t?[]:t).forEach(function(e){var t=e.eType,r=JSON.parse(e.bytes);i._filterData(r,t)})}),ji("info",["%c[GetIncrease返回]:","color:green",e],o);break;case Ra:ji("info",["%c[随堂考]:"+e.lSequence+" "+e.iPaperId,"color:green"],o);break;case Oa:var x=e.lSequence,R=e.iScrollPosition;x&&Rr(this._options.dataItem.scrollPage,Ar({},x,e)),ji("info",["%c[滚动条位置]:"+x+" "+R+"%","color:green"],o)}this.trigger(Yn[t]||t,e)}},{key:"_filterDataMap",value:function(e){var t=this,r=this._options,i=r.dataItem.dataList,n=r.debug,a=e.traceIds,o=void 0===a?[]:a,s=e.lSequence,l=e.iId;switch(e.type){case wa:i[l]=i[l]||[],i[l].push(e),ji("info",["%c[增加轨迹]:ID "+l+" 时间: "+s,"color:green"],n);break;case Ca:o.forEach(function(e){i[e]&&delete i[e],kn(t.elements,e)}),ji("info",["%c[删除轨迹]:IDs:"+o+" 时间: "+s,"color:green"],n);break;case Aa:this._filterPoints(e,!0,!0),ji("info",["%c[课件翻页]: "+s,"color:green",e],n)}}},{key:"_initData",value:function(){var r=this;Ui(Ba,{data:Ut({sToken:this._options.liveToken}),hasErr:!0}).then(function(e){r._filterData(e,Pa),0<r._options.reconnectCount&&ji("info",["%c[点播HTTP重连成功！]","color:green"],!(r._options.reconnectCount=0)),r._options.isHeartBeatOn=!0,r._heartBeat(),r._setBoardTips(!1)}).catch(function(e){var t=e.err;t&&(r.trigger("error",t),r._setBoardTips(!0),r._reconnectServer(t,"login"))})}},{key:"_render",value:function(){var s=this,e=this._options,t=e.dataItem,r=t.dataMap,l=t.scrollPage,i=e.sequence,n=e.imageSize;Gt(r).sort(function(e,t){return+e-+t}).filter(function(e){return+e<=i}).forEach(function(e){var t=r[e];(void 0===t?[]:t).forEach(function(e){return s._filterDataMap(e)}),delete r[e]});var a=this._options.dataItem,o=a.dataList,u=a.info,c=a.scrollInfo;if(Gt(u).length){var d=u.bgColor,h=u.url,f=void 0===h?"":h,p=u.width,g=u.height,m=u.boardWidth,v=u.boardHeight,y=u.scrollY,_=void 0===y?0:y,b=u.isInit,T=u.pageId,S=u.courseId;this.bgRect.style.fill=void 0===d?"":d;var E=yr(f?[m,v]:[p,g],2);this.svgElement.setAttributeNS(null,"viewBox","0,0,"+E[0]+","+E[1]),this.defsRect.setAttributeNS(null,"width",p);var k=yr(v<=g?[0,v]:[_,g],2),w=k[0];this.defsRect.setAttributeNS(null,"height",k[1]),this.defsRect.setAttributeNS(null,"y",-w),this._toggleGroupsClass(!b),this.groups.setAttributeNS(null,"transform","translate(0, "+-_+")");var C=this.groups.querySelector("image");if(f&&this._imgUrl!==f){C=C||this.groups.appendChild(En("image")),this.loading.classList.add("waiting"),C.setAttributeNS(null,"height",g),C.setAttributeNS(null,"width",p),C.setAttributeNS("http://www.w3.org/1999/xlink","href",f);var A=Date.now();fn._cacheImage(f,!1).then(function(e){s.loading.classList.remove("waiting"),s._reportMessage(f,{loadTime:Date.now()-A,pageId:T,courseId:S})}).catch(function(e){s._reportMessage(f,{loadTime:Date.now()-A,pageId:T,courseId:S},!1)})}!f&&C&&C.setAttributeNS("http://www.w3.org/1999/xlink","href",""),this._imgUrl=f,this._options.dataItem.info={}}Gt(l).sort(function(e,t){return+e-+t}).filter(function(e){return+e<=i}).forEach(function(e){var t=l[e],r=void 0===t?{}:t,i=r.iScrollPosition,n=void 0===i?0:i,a=c.height,o=c.boardHeight;r.iPageId===c.pageId&&r.iCoursewareId===c.courseId&&(s._toggleGroupsClass(!0),s.groups.setAttributeNS(null,"transform","translate(0, "+-(Math.round((a-o)*n)/100)+")"));delete l[e]});var L=0;Gt(o).forEach(function(e){var t=o[e];(void 0===t?[]:t).forEach(function(e,t){var r=e.config;wn(s.elements,{iId:e.iId,iType:e.iType,point:e.point,idx:t,sText:e.sText,config:r,timeSec:L,fontSize:e.fontSize,imageSize:n}),L+=r.duration}),delete o[e]})}}]),r}(),Ha={"[憨笑]":"hanxiao","[爱慕]":"aimu","[谄媚]":"chanmei","[OK]":"OK","[眩晕]":"xuanyun","[傲娇]":"aojiao","[委屈]":"weiqu","[你好]":"nihao","[帅气]":"shuaiqi","[汗颜]":"hanyan","[胜利]":"shengli","[泪奔]":"leiben","[害羞]":"haixiu","[惊吓]":"jingxia","[么么哒]":"memeda","[生气]":"shengqi","[尴尬]":"ganga","[美]":"mei","[吐血]":"tuxue","[蛋糕]":"dangao","[庆祝]":"qingzhu","[咖啡]":"kafei","[钻石]":"zuanshi","[甜甜圈]":"tiantianquan","[握拳]":"woquan","[送花]":"songhua","[撒花]":"sahua","[冰冻]":"bingdong","[金牌]":"jinpai","[中国好老师]":"zhongguohaolaoshi","[棒棒哒]":"bangbangda","[做鬼脸]":"zuoguilian","[握手]":"woshou","[帅]":"shuai","[心碎]":"xinsui","[嘴唇]":"zuichun","[爱心]":"aixin","[晚安]":"wanan","[钢笔]":"gangbi","[礼物]":"liwu","[疑问]":"yiwen","[我想静静]":"woxiangjingjing","[愤怒]":"fennu","[红包]":"hongbao","[困]":"kun","[强]":"qiang","[太阳]":"taiyang","[惊讶]":"jingya","[弱]":"ruo","[必胜]":"bisheng","[凋谢]":"diaoxie","[打哈欠]":"dahaqie","[耶]":"yeah"},Ga=Gt(Ha).reduce(function(e,t){return e[t]="https://assorted.sunlands.com/sl-emoji/"+Ha[t]+".png",e},{}),qa=(Ar(Cn={},2,"发送登录消息"),Ar(Cn,4,"发送聊天信息"),Ar(Cn,1,"发送心跳"),Ar(Cn,22,"发送获取禁言列表"),Ar(Cn,20,"发送修改公告"),Ar(Cn,16,"发送QA消息"),Ar(Cn,15,"发送请求，要求获取全员列表"),Ar(Cn,13,"设置学员发言状态"),Cn),Va=(Ar(An={},2,"登录消息回复"),Ar(An,4,"聊天信息确认回复"),Ar(An,1,"心跳回复"),Ar(An,16,"QA消息发送后确认回复"),Ar(An,13,"设置个人禁言状态确认回复"),Ar(An,5,"收到聊天消息"),Ar(An,10,"用户进/出"),Ar(An,8,"禁言状态变化"),Ar(An,11,"房间解散"),Ar(An,9,"当前用户因在在其他地方登陆被踢"),Ar(An,19,"用户被老师助教踢出"),Ar(An,12,"用户批量下线通知"),Ar(An,14,"当前用户禁言状态"),Ar(An,1e3,"WEBSOCKET出错"),Ar(An,1001,"WEBSOCKET关闭"),Ar(An,22,"房间禁言成员列表"),Ar(An,21,"房间公告栏更新"),Ar(An,17,"房间QA消息"),Ar(An,15,"房间全员在线列表"),An),Wa=(Ar(Ln={},2,"login"),Ar(Ln,4,"send_message_status"),Ar(Ln,1,"heartbeat"),Ar(Ln,16,"qa_messages_reply"),Ar(Ln,13,"set_user_speaking_reply"),Ar(Ln,5,"receive_message"),Ar(Ln,10,"user_notification"),Ar(Ln,8,"room_speaking_status"),Ar(Ln,11,"room_dismiss"),Ar(Ln,9,"user_kicked_for_new_login"),Ar(Ln,19,"user_kicked_notification"),Ar(Ln,12,"bulk_exit_notification"),Ar(Ln,14,"user_speaking_status"),Ar(Ln,1e3,"websocket_error"),Ar(Ln,1001,"websocket_close"),Ar(Ln,22,"room_no_speaking_list"),Ar(Ln,21,"room_announce_update"),Ar(Ln,17,"qa_messages"),Ar(Ln,15,"room_list"),Ln),za=qa,Ka=Va,Ya=Wa,Xa={"-1":"未知错误",0:"服务器返回正确",1:"数据库错误",2:"入参错误",3:"直播间不存在",4:"json解析错误",5:"直播间不存在该成员",6:"直播间禁言",7:"敏感词屏蔽",8:"非注册用户",9:"用户无操作权限",10:"直播间满员",11:"用戶被单独禁言",12:"学生已经被踢出直播间",13:"消息超过长度限制(140汉字)"},Qa=function(){function t(e){if(_r(this,t),this.liveId=0,this.userToken=null,this.url="",this.startTime=0,Rr(!(this.endTime=0),this,e),this.needReconnect=!0,this.websocket=null,this.reconnectTimes=0,this.emoji=Ga,this.selfId=null,!this.url)throw Error("必须传入聊天URL！");this.events=new rn}return Cr(t,[{key:"validateResponse",value:function(e){return!e.result||0===e.result||(this.debuger("warn","something wrong",Xa[e.result]||Xa[-1],e),!1)}},{key:"debuger",value:function(e){if(this.debug){for(var t,r=arguments.length,i=Array(1<r?r-1:0),n=1;n<r;n++)i[n-1]=arguments[n];(t=console)[e].apply(t,i)}}},{key:"getSLEmoji",value:function(){return this.emoji}},{key:"fetchHistoryChat",value:function(){var e=this.startTime,t=this.endTime;return Ui((this.url+"/h/get_live_message_history?live_id=:liveId&ts_lower_bound=:start&ts_upper_bound=:end").replace(/:liveId/,this.liveId).replace(/:start/,e).replace(/:end/,t),{type:"GET"})}},{key:"fetchRoomAnnounce",value:function(){return Ui((this.url+"/h/get_live_room_announce?live_id=:liveId").replace(/:liveId/,this.liveId),{type:"GET"})}},{key:"triggerEvent",value:function(e,t){this.events.trigger(e,t)}},{key:"triggerInitialDataEvent",value:function(e){var t=e.data,r=t.qaData;this.triggerEvent("initial_room_announce",{data:{announce:t.roomAnnounce||""}}),this.triggerEvent("initial_qa_list",{data:{qaData:r}})}},{key:"initLoginReply",value:function(e){2===e.cmd&&(this.selfId=e.data.userToken)}},{key:"connect",value:function(a){var o=this;this.websocket&&1===this.websocket.readyState&&this.websocket.close(),clearInterval(this.heartbeat),this.websocket=new WebSocket(this.url),this.websocket.onmessage=function(e){var t=JSON.parse(e.data),r=t.cmd,i=t.data,n=o.validateResponse(t);n&&2===r?(o.reconnectTimes=0,o.initLoginReply(t),o.startHeartbeat()):2===r?8!==t.result&&3!==t.result||(o.needReconnect=!1):9===r?o.needReconnect=!1:19===r&&1===i.action&&(o.needReconnect=!1),11===r&&(o.needReconnect=!1),2===r&&a&&a(),o.debuger("log","%cwss recv data","color:red",Ka[r]||"cmd="+r,t),o.triggerEvent(Ya[r]?r+","+Ya[r]:r,t),n&&2===r&&o.triggerInitialDataEvent(t)},this.websocket.onopen=function(e){o.sendLogin()},this.websocket.onerror=function(e){o.triggerEvent("websocket_error,1000",e),o.debuger("log","%cws error","color:red",Ya[1e3],e)},this.websocket.onclose=function(e){o.triggerEvent("websocket_close,1001",e),o.debuger("log","%cws close","color:red",Ya[1001],e),setTimeout(function(){o.needReconnect&&o.reconnectTimes<=8?(o.reconnectTimes+=1,setTimeout(function(){o.debuger("warn","reconnecting, times = ",o.reconnectTimes),o.connect()},1e3*Math.pow(2,o.reconnectTimes))):o.close()},500)}}},{key:"close",value:function(){this.needReconnect=!1,this.websocket&&1===this.websocket.readyState&&this.websocket.close(),clearInterval(this.heartbeat),this.events.removeAllListeners()}},{key:"dispose",value:function(){this.close()}},{key:"on",value:function(e,t){this.events.on(e,t)}},{key:"sendData",value:function(e,t){var r=Ut({cmd:e,data:t});this.debuger("log","%cws send data","color:green",za[e],r),this.websocket.send(r)}},{key:"sendHeartbeat",value:function(){this.sendData(1,{userToken:this.selfId,liveId:this.liveId})}},{key:"startHeartbeat",value:function(){var t=this;clearInterval(this.heartbeat),this.sendHeartbeat(),this.heartbeat=setInterval(function(e){t.sendHeartbeat()},2e4)}},{key:"sendLogin",value:function(){this.sendData(2,{userToken:this.userToken,liveId:this.liveId,terminalType:0})}},{key:"sendToGetForbidList",value:function(){this.sendData(22,{fromUserToken:this.selfId,liveId:this.liveId})}},{key:"sendToGetRoomList",value:function(){this.sendData(15,{fromUserToken:this.selfId,liveId:this.liveId})}},{key:"sendToUpdateAnnouncement",value:function(e){this.sendData(20,{userToken:this.selfId,liveId:this.liveId,announce:e})}},{key:"sendToSetSpeaking",value:function(e,t){this.sendData(13,{fromUserToken:this.selfId,liveId:this.liveId,forbiddenUserToken:e,status:t})}},{key:"sendQAMessage",value:function(e,t){this.sendData(16,{userToken:this.selfId,liveId:this.liveId,msgData:e,toToken:t})}},{key:"sendMessage",value:function(e){this.sendData(4,{userToken:this.selfId,liveId:this.liveId,msgData:""+e,msgType:1<arguments.length&&void 0!==arguments[1]?arguments[1]:1})}},{key:"loadAllMessages",value:function(t,r){if(!t||t&&"function"!=typeof t||r&&"function"!=typeof r)throw Error("arguments must be function");this.fetchHistoryChat().then(function(e){return t&&t(e)}).catch(function(e){return r&&r(e)})}},{key:"loadRoomAnnounce",value:function(t,r){if(!t||t&&"function"!=typeof t||r&&"function"!=typeof r)throw Error("arguments must be function");this.fetchRoomAnnounce().then(function(e){return t&&t(e)}).catch(function(e){return r&&r(e)})}}]),t}(),Ja="undefined"!=typeof window?window:void 0!==i?i:"undefined"!=typeof self?self:{},Za={},$a=Object.freeze({default:Za}),eo=void 0!==i?i:"undefined"!=typeof window?window:{};"undefined"!=typeof document?In=document:(In=eo["__GLOBAL_DOCUMENT_CACHE@4"])||(In=eo["__GLOBAL_DOCUMENT_CACHE@4"]=$a&&Za||$a);var to=In;var ro=function(e){for(var t="",r=0;r<arguments.length;r++)t+=e[r].replace(/\n\r?\s*/g,"")+(arguments[r+1]||"");return t},io=function(e){var t=no.call(e);return"[object Function]"===t||"function"==typeof e&&"[object RegExp]"!==t||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)},no=Object.prototype.toString;var ao=t(function(e,t){(t=e.exports=function(e){return e.replace(/^\s*|\s*$/g,"")}).left=function(e){return e.replace(/^\s*/,"")},t.right=function(e){return e.replace(/\s*$/,"")}}),oo=Function.prototype.toString,so=/^\s*class /,lo=function(e){try{var t=oo.call(e).replace(/\/\/.*\n/g,"").replace(/\/\*[.\s\S]*\*\//g,"").replace(/\n/gm," ").replace(/ {2}/g," ");return so.test(t)}catch(e){return!1}},uo=Object.prototype.toString,co="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,ho=function(e){if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if(co)return function(e){try{return!lo(e)&&(oo.call(e),!0)}catch(e){return!1}}(e);if(lo(e))return!1;var t=uo.call(e);return"[object Function]"===t||"[object GeneratorFunction]"===t},fo=Object.prototype.toString,po=Object.prototype.hasOwnProperty,go=function(e,t,r){if(!ho(t))throw new TypeError("iterator must be a function");var i;3<=arguments.length&&(i=r),"[object Array]"===fo.call(e)?function(e,t,r){for(var i=0,n=e.length;i<n;i++)po.call(e,i)&&(null==r?t(e[i],i,e):t.call(r,e[i],i,e))}(e,t,i):"string"==typeof e?function(e,t,r){for(var i=0,n=e.length;i<n;i++)null==r?t(e.charAt(i),i,e):t.call(r,e.charAt(i),i,e)}(e,t,i):function(e,t,r){for(var i in e)po.call(e,i)&&(null==r?t(e[i],i,e):t.call(r,e[i],i,e))}(e,t,i)},mo=function(e){if(!e)return{};var n={};return go(ao(e).split("\n"),function(e){var t=e.indexOf(":"),r=ao(e.slice(0,t)).toLowerCase(),i=ao(e.slice(t+1));void 0===n[r]?n[r]=i:"[object Array]"===Object.prototype.toString.call(n[r])?n[r].push(i):n[r]=[n[r],i]}),n},vo=function(){for(var e={},t=0;t<arguments.length;t++){var r=arguments[t];for(var i in r)yo.call(r,i)&&(e[i]=r[i])}return e},yo=Object.prototype.hasOwnProperty;var _o=To;function bo(e,t,r){var i=e;return io(t)?(r=t,"string"==typeof e&&(i={uri:e})):i=vo(t,{uri:e}),i.callback=r,i}function To(e,t,r){return So(t=bo(e,t,r))}function So(i){if(void 0===i.callback)throw Error("callback argument missing");var n=!1,a=function(e,t,r){n||(n=!0,i.callback(e,t,r))};function t(e){return clearTimeout(l),e instanceof Error||(e=Error(""+(e||"Unknown XMLHttpRequest Error"))),e.statusCode=0,a(e,g)}function e(){if(!o){var e;clearTimeout(l);var t=g,r=null;return 0!==(e=i.useXDR&&void 0===s.status?200:1223===s.status?204:s.status)?(t={body:function(){var e=void 0;if(e=s.response?s.response:s.responseText||function(e){if("document"===e.responseType)return e.responseXML;var t=e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName;return""!==e.responseType||t?null:e.responseXML}(s),p)try{e=JSON.parse(e)}catch(e){}return e}(),statusCode:e,method:c,headers:{},url:u,rawRequest:s},s.getAllResponseHeaders&&(t.headers=mo(s.getAllResponseHeaders()))):r=Error("Internal XMLHttpRequest Error"),a(r,t,t.body)}}var r,o,s=i.xhr||null;s||(s=i.cors||i.useXDR?new To.XDomainRequest:new To.XMLHttpRequest);var l,u=s.url=i.uri||i.url,c=s.method=i.method||"GET",d=i.body||i.data,h=s.headers=i.headers||{},f=!!i.sync,p=!1,g={body:void 0,headers:{},statusCode:0,method:c,url:u,rawRequest:s};if("json"in i&&!1!==i.json&&(p=!0,h.accept||h.Accept||(h.Accept="application/json"),"GET"!==c&&"HEAD"!==c&&(h["content-type"]||h["Content-Type"]||(h["Content-Type"]="application/json"),d=JSON.stringify(!0===i.json?d:i.json))),s.onreadystatechange=function(){4===s.readyState&&setTimeout(e,0)},s.onload=e,s.onerror=t,s.onprogress=function(){},s.onabort=function(){o=!0},s.ontimeout=t,s.open(c,u,!f,i.username,i.password),f||(s.withCredentials=!!i.withCredentials),!f&&0<i.timeout&&(l=setTimeout(function(){if(!o){o=!0,s.abort("timeout");var e=Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",t(e)}},i.timeout)),s.setRequestHeader)for(r in h)h.hasOwnProperty(r)&&s.setRequestHeader(r,h[r]);else if(i.headers&&!function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}(i.headers))throw Error("Headers cannot be set on an XDomainRequest object");return"responseType"in i&&(s.responseType=i.responseType),"beforeSend"in i&&"function"==typeof i.beforeSend&&i.beforeSend(s),s.send(d||null),s}To.XMLHttpRequest=Ja.XMLHttpRequest||function(){},To.XDomainRequest="withCredentials"in new To.XMLHttpRequest?To.XMLHttpRequest:Ja.XDomainRequest,function(e,t){for(var r=0;r<e.length;r++)t(e[r])}(["get","put","post","patch","head","delete"],function(i){To["delete"===i?"del":i]=function(e,t,r){return(t=bo(e,t,r)).method=i.toUpperCase(),So(t)}});var Eo=Object.create||function(){function t(){}return function(e){if(1!==arguments.length)throw Error("Object.create shim only accepts one parameter.");return t.prototype=e,new t}}();function ko(e,t){this.name="ParsingError",this.code=e.code,this.message=t||e.message}function wo(e){function t(e,t,r,i){return 3600*(0|e)+60*(0|t)+(0|r)+(0|i)/1e3}var r=e.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return r?r[3]?t(r[1],r[2],r[3].replace(":",""),r[4]):59<r[1]?t(r[1],r[2],0,r[4]):t(0,r[1],r[2],r[4]):null}function Co(){this.values=Eo(null)}function Ao(e,t,r,i){var n=i?e.split(i):[e];for(var a in n)if("string"==typeof n[a]){var o=n[a].split(r);if(2===o.length)t(o[0],o[1])}}function Lo(t,e,a){var r,i,o,n=t;function s(){var e=wo(t);if(null===e)throw new ko(ko.Errors.BadTimeStamp,"Malformed timestamp: "+n);return t=t.replace(/^[^\sa-zA-Z-]+/,""),e}function l(){t=t.replace(/^\s+/,"")}if(l(),e.startTime=s(),l(),"--\x3e"!==t.substr(0,3))throw new ko(ko.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '--\x3e'): "+n);t=t.substr(3),l(),e.endTime=s(),l(),r=t,i=e,o=new Co,Ao(r,function(e,t){switch(e){case"region":for(var r=a.length-1;0<=r;r--)if(a[r].id===t){o.set(e,a[r].region);break}break;case"vertical":o.alt(e,t,["rl","lr"]);break;case"line":var i=t.split(","),n=i[0];o.integer(e,n),o.percent(e,n)&&o.set("snapToLines",!1),o.alt(e,n,["auto"]),2===i.length&&o.alt("lineAlign",i[1],["start","middle","end"]);break;case"position":i=t.split(","),o.percent(e,i[0]),2===i.length&&o.alt("positionAlign",i[1],["start","middle","end"]);break;case"size":o.percent(e,t);break;case"align":o.alt(e,t,["start","middle","end","left","right"])}},/:/,/\s/),i.region=o.get("region",null),i.vertical=o.get("vertical",""),i.line=o.get("line","auto"),i.lineAlign=o.get("lineAlign","start"),i.snapToLines=o.get("snapToLines",!0),i.size=o.get("size",100),i.align=o.get("align","middle"),i.position=o.get("position",{start:0,left:0,middle:50,end:100,right:100},i.align),i.positionAlign=o.get("positionAlign",{start:"start",left:"start",middle:"middle",end:"end",right:"end"},i.align)}((ko.prototype=Eo(Error.prototype)).constructor=ko).Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}},Co.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,r){return r?this.has(e)?this.values[e]:t[r]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,r){for(var i=0;i<r.length;++i)if(t===r[i]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&0<=(t=parseFloat(t))&&t<=100)&&(this.set(e,t),!0)}};var Io={"&amp;":"&","&lt;":"<","&gt;":">","&lrm;":"‎","&rlm;":"‏","&nbsp;":" "},Po={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},xo={v:"title",lang:"lang"},Ro={rt:"ruby"};function Oo(a,r){function e(){if(!r)return null;var e,t=r.match(/^([^<]*)(<[^>]*>?)?/);return r=r.substr((e=t[1]?t[1]:t[2]).length),e}function t(e){return Io[e]}function i(e){for(;p=e.match(/&(amp|lt|gt|lrm|rlm|nbsp);/);)e=e.replace(p[0],t);return e}function n(e,t){var r=Po[e];if(!r)return null;var i=a.document.createElement(r);i.localName=r;var n=xo[e];return n&&t&&(i[n]=t.trim()),i}for(var o,s,l,u=a.document.createElement("div"),c=u,d=[];null!==(o=e());)if("<"!==o[0])c.appendChild(a.document.createTextNode(i(o)));else{if("/"===o[1]){d.length&&d[d.length-1]===o.substr(2).replace(">","")&&(d.pop(),c=c.parentNode);continue}var h,f=wo(o.substr(1,o.length-2));if(f){h=a.document.createProcessingInstruction("timestamp",f),c.appendChild(h);continue}var p=o.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!p)continue;if(!(h=n(p[1],p[3])))continue;if(s=c,Ro[(l=h).localName]&&Ro[l.localName]!==s.localName)continue;p[2]&&(h.className=p[2].substr(1).replace("."," ")),d.push(p[1]),c.appendChild(h),c=h}return u}var Do=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function Mo(e){for(var t=0;t<Do.length;t++){var r=Do[t];if(r[0]<=e&&e<=r[1])return!0}return!1}function No(){}function Fo(e,t,r){this.cue=t,this.cueDiv=Oo(e,t.text);var i={color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"};this.applyStyles(i,this.cueDiv),this.div=e.document.createElement("div"),i={direction:function(e){var t=[],r="";if(!e||!e.childNodes)return"ltr";function n(e,t){for(var r=t.childNodes.length-1;0<=r;r--)e.push(t.childNodes[r])}function a(e){if(!e||!e.length)return null;var t=e.pop(),r=t.textContent||t.innerText;if(r){var i=r.match(/^.*(\n|\r)/);return i?i[e.length=0]:r}return"ruby"===t.tagName?a(e):t.childNodes?(n(e,t),a(e)):void 0}for(n(t,e);r=a(t);)for(var i=0;i<r.length;i++)if(Mo(r.charCodeAt(i)))return"rtl";return"ltr"}(this.cueDiv),writingMode:""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:"middle"===t.align?"center":t.align,font:r.font,whiteSpace:"pre-line",position:"absolute"},this.applyStyles(i),this.div.appendChild(this.cueDiv);var n=0;switch(t.positionAlign){case"start":n=t.position;break;case"middle":n=t.position-t.size/2;break;case"end":n=t.position-t.size}this.applyStyles(""===t.vertical?{left:this.formatStyle(n,"%"),width:this.formatStyle(t.size,"%")}:{top:this.formatStyle(n,"%"),height:this.formatStyle(t.size,"%")}),this.move=function(e){this.applyStyles({top:this.formatStyle(e.top,"px"),bottom:this.formatStyle(e.bottom,"px"),left:this.formatStyle(e.left,"px"),right:this.formatStyle(e.right,"px"),height:this.formatStyle(e.height,"px"),width:this.formatStyle(e.width,"px")})}}function jo(e){var t,r,i,n;if(e.div){r=e.div.offsetHeight,i=e.div.offsetWidth,n=e.div.offsetTop;var a=(a=e.div.childNodes)&&(a=a[0])&&a.getClientRects&&a.getClientRects();e=e.div.getBoundingClientRect(),t=a?Math.max(a[0]&&a[0].height||0,e.height/a.length):0}this.left=e.left,this.right=e.right,this.top=e.top||n,this.height=e.height||r,this.bottom=e.bottom||n+(e.height||r),this.width=e.width||i,this.lineHeight=void 0!==t?t:e.lineHeight}function Bo(e,t,s,l){var r=new jo(t),i=t.cue,n=function(e){if("number"==typeof e.line&&(e.snapToLines||0<=e.line&&e.line<=100))return e.line;if(!e.track||!e.track.textTrackList||!e.track.textTrackList.mediaElement)return-1;for(var t=e.track,r=t.textTrackList,i=0,n=0;n<r.length&&r[n]!==t;n++)"showing"===r[n].mode&&i++;return-1*++i}(i),a=[];if(i.snapToLines){var o;switch(i.vertical){case"":a=["+y","-y"],o="height";break;case"rl":a=["+x","-x"],o="width";break;case"lr":a=["-x","+x"],o="width"}var u=r.lineHeight,c=u*Math.round(n),d=s[o]+u,h=a[0];d<Math.abs(c)&&(c=c<0?-1:1,c*=Math.ceil(d/u)*u),n<0&&(c+=""===i.vertical?s.height:s.width,a=a.reverse()),r.move(h,c)}else{var f=r.lineHeight/s.height*100;switch(i.lineAlign){case"middle":n-=f/2;break;case"end":n-=f}switch(i.vertical){case"":t.applyStyles({top:t.formatStyle(n,"%")});break;case"rl":t.applyStyles({left:t.formatStyle(n,"%")});break;case"lr":t.applyStyles({right:t.formatStyle(n,"%")})}a=["+y","-x","+x","-y"],r=new jo(t)}var p=function(e,t){for(var r,i=new jo(e),n=1,a=0;a<t.length;a++){for(;e.overlapsOppositeAxis(s,t[a])||e.within(s)&&e.overlapsAny(l);)e.move(t[a]);if(e.within(s))return e;var o=e.intersectPercentage(s);o<n&&(r=new jo(e),n=o),e=new jo(i)}return r||i}(r,a);t.move(p.toCSSCompatValues(s))}function Uo(){}No.prototype.applyStyles=function(e,t){for(var r in t=t||this.div,e)e.hasOwnProperty(r)&&(t.style[r]=e[r])},No.prototype.formatStyle=function(e,t){return 0===e?0:e+t},(Fo.prototype=Eo(No.prototype)).constructor=Fo,jo.prototype.move=function(e,t){switch(t=void 0!==t?t:this.lineHeight,e){case"+x":this.left+=t,this.right+=t;break;case"-x":this.left-=t,this.right-=t;break;case"+y":this.top+=t,this.bottom+=t;break;case"-y":this.top-=t,this.bottom-=t}},jo.prototype.overlaps=function(e){return this.left<e.right&&e.left<this.right&&this.top<e.bottom&&e.top<this.bottom},jo.prototype.overlapsAny=function(e){for(var t=0;t<e.length;t++)if(this.overlaps(e[t]))return!0;return!1},jo.prototype.within=function(e){return e.top<=this.top&&this.bottom<=e.bottom&&e.left<=this.left&&this.right<=e.right},jo.prototype.overlapsOppositeAxis=function(e,t){switch(t){case"+x":return this.left<e.left;case"-x":return e.right<this.right;case"+y":return this.top<e.top;case"-y":return e.bottom<this.bottom}},jo.prototype.intersectPercentage=function(e){return Math.max(0,Math.min(this.right,e.right)-Math.max(this.left,e.left))*Math.max(0,Math.min(this.bottom,e.bottom)-Math.max(this.top,e.top))/(this.height*this.width)},jo.prototype.toCSSCompatValues=function(e){return{top:this.top-e.top,bottom:e.bottom-this.bottom,left:this.left-e.left,right:e.right-this.right,height:this.height,width:this.width}},jo.getSimpleBoxPosition=function(e){var t=e.div?e.div.offsetHeight:e.tagName?e.offsetHeight:0,r=e.div?e.div.offsetWidth:e.tagName?e.offsetWidth:0,i=e.div?e.div.offsetTop:e.tagName?e.offsetTop:0;return{left:(e=e.div?e.div.getBoundingClientRect():e.tagName?e.getBoundingClientRect():e).left,right:e.right,top:e.top||i,height:e.height||t,bottom:e.bottom||i+(e.height||t),width:e.width||r}},Uo.StringDecoder=function(){return{decode:function(e){if(!e)return"";if("string"!=typeof e)throw Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}},Uo.convertCueToDOMTree=function(e,t){return e&&t?Oo(e,t):null};Uo.processCues=function(i,n,e){if(!i||!n||!e)return null;for(;e.firstChild;)e.removeChild(e.firstChild);var a=i.document.createElement("div");if(a.style.position="absolute",a.style.left="0",a.style.right="0",a.style.top="0",a.style.bottom="0",a.style.margin="1.5%",e.appendChild(a),function(e){for(var t=0;t<e.length;t++)if(e[t].hasBeenReset||!e[t].displayState)return!0;return!1}(n)){var o=[],s=jo.getSimpleBoxPosition(a),l={font:Math.round(.05*s.height*100)/100+"px sans-serif"};!function(){for(var e,t,r=0;r<n.length;r++)e=new Fo(i,t=n[r],l),a.appendChild(e.div),Bo(0,e,s,o),t.displayState=e.div,o.push(jo.getSimpleBoxPosition(e))}()}else for(var t=0;t<n.length;t++)a.appendChild(n[t].displayState)},(Uo.Parser=function(e,t,r){r||(r=t,t={}),t||(t={}),this.window=e,this.vttjs=t,this.state="INITIAL",this.buffer="",this.decoder=r||new TextDecoder("utf8"),this.regionList=[]}).prototype={reportOrThrowError:function(e){if(!(e instanceof ko))throw e;this.onparsingerror&&this.onparsingerror(e)},parse:function(e){var a=this;function t(){for(var e=a.buffer,t=0;t<e.length&&"\r"!==e[t]&&"\n"!==e[t];)++t;var r=e.substr(0,t);return"\r"===e[t]&&++t,"\n"===e[t]&&++t,a.buffer=e.substr(t),r}function r(e){e.match(/X-TIMESTAMP-MAP/)?Ao(e,function(e,t){switch(e){case"X-TIMESTAMP-MAP":r=t,i=new Co,Ao(r,function(e,t){switch(e){case"MPEGT":i.integer(e+"S",t);break;case"LOCA":i.set(e+"L",wo(t))}},/[^\d]:/,/,/),a.ontimestampmap&&a.ontimestampmap({MPEGTS:i.get("MPEGTS"),LOCAL:i.get("LOCAL")})}var r,i},/=/):Ao(e,function(e,t){switch(e){case"Region":!function(e){var n=new Co;if(Ao(e,function(e,t){switch(e){case"id":n.set(e,t);break;case"width":n.percent(e,t);break;case"lines":n.integer(e,t);break;case"regionanchor":case"viewportanchor":var r=t.split(",");if(2!==r.length)break;var i=new Co;if(i.percent("x",r[0]),i.percent("y",r[1]),!i.has("x")||!i.has("y"))break;n.set(e+"X",i.get("x")),n.set(e+"Y",i.get("y"));break;case"scroll":n.alt(e,t,["up"])}},/=/,/\s/),n.has("id")){var t=new(a.vttjs.VTTRegion||a.window.VTTRegion);t.width=n.get("width",100),t.lines=n.get("lines",3),t.regionAnchorX=n.get("regionanchorX",0),t.regionAnchorY=n.get("regionanchorY",100),t.viewportAnchorX=n.get("viewportanchorX",0),t.viewportAnchorY=n.get("viewportanchorY",100),t.scroll=n.get("scroll",""),a.onregion&&a.onregion(t),a.regionList.push({id:n.get("id"),region:t})}}(t)}},/:/)}e&&(a.buffer+=a.decoder.decode(e,{stream:!0}));try{var i;if("INITIAL"===a.state){if(!/\r\n|\n/.test(a.buffer))return this;var n=(i=t()).match(/^WEBVTT([ \t].*)?$/);if(!n||!n[0])throw new ko(ko.Errors.BadSignature);a.state="HEADER"}for(var o=!1;a.buffer;){if(!/\r\n|\n/.test(a.buffer))return this;switch(o?o=!1:i=t(),a.state){case"HEADER":/:/.test(i)?r(i):i||(a.state="ID");continue;case"NOTE":i||(a.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(i)){a.state="NOTE";break}if(!i)continue;if(a.cue=new(a.vttjs.VTTCue||a.window.VTTCue)(0,0,""),a.state="CUE",-1==i.indexOf("--\x3e")){a.cue.id=i;continue}case"CUE":try{Lo(i,a.cue,a.regionList)}catch(e){a.reportOrThrowError(e),a.cue=null,a.state="BADCUE";continue}a.state="CUETEXT";continue;case"CUETEXT":var s=-1!=i.indexOf("--\x3e");if(!i||s&&(o=!0)){a.oncue&&a.oncue(a.cue),a.cue=null,a.state="ID";continue}a.cue.text&&(a.cue.text+="\n"),a.cue.text+=i;continue;case"BADCUE":i||(a.state="ID");continue}}}catch(e){a.reportOrThrowError(e),"CUETEXT"===a.state&&a.cue&&a.oncue&&a.oncue(a.cue),a.cue=null,a.state="INITIAL"===a.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){var t=this;try{if(t.buffer+=t.decoder.decode(),(t.cue||"HEADER"===t.state)&&(t.buffer+="\n\n",t.parse()),"INITIAL"===t.state)throw new ko(ko.Errors.BadSignature)}catch(e){t.reportOrThrowError(e)}return t.onflush&&t.onflush(),this}};var Ho=Uo,Go={"":1,lr:1,rl:1},qo={start:1,middle:1,end:1,left:1,right:1};function Vo(e){return"string"==typeof e&&(!!qo[e.toLowerCase()]&&e.toLowerCase())}function Wo(e,t,r){var i="",n=this.hasBeenReset=!1,a=e,o=t,s=r,l=null,u="",c=!0,d="auto",h="start",f=50,p="middle",g=50,m="middle";Object.defineProperties(this,{id:{enumerable:!0,get:function(){return i},set:function(e){i=""+e}},pauseOnExit:{enumerable:!0,get:function(){return n},set:function(e){n=!!e}},startTime:{enumerable:!0,get:function(){return a},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");a=e,this.hasBeenReset=!0}},endTime:{enumerable:!0,get:function(){return o},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");o=e,this.hasBeenReset=!0}},text:{enumerable:!0,get:function(){return s},set:function(e){s=""+e,this.hasBeenReset=!0}},region:{enumerable:!0,get:function(){return l},set:function(e){l=e,this.hasBeenReset=!0}},vertical:{enumerable:!0,get:function(){return u},set:function(e){var t,r="string"==typeof(t=e)&&!!Go[t.toLowerCase()]&&t.toLowerCase();if(!1===r)throw new SyntaxError("An invalid or illegal string was specified.");u=r,this.hasBeenReset=!0}},snapToLines:{enumerable:!0,get:function(){return c},set:function(e){c=!!e,this.hasBeenReset=!0}},line:{enumerable:!0,get:function(){return d},set:function(e){if("number"!=typeof e&&"auto"!==e)throw new SyntaxError("An invalid number or illegal string was specified.");d=e,this.hasBeenReset=!0}},lineAlign:{enumerable:!0,get:function(){return h},set:function(e){var t=Vo(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");h=t,this.hasBeenReset=!0}},position:{enumerable:!0,get:function(){return f},set:function(e){if(e<0||100<e)throw Error("Position must be between 0 and 100.");f=e,this.hasBeenReset=!0}},positionAlign:{enumerable:!0,get:function(){return p},set:function(e){var t=Vo(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");p=t,this.hasBeenReset=!0}},size:{enumerable:!0,get:function(){return g},set:function(e){if(e<0||100<e)throw Error("Size must be between 0 and 100.");g=e,this.hasBeenReset=!0}},align:{enumerable:!0,get:function(){return m},set:function(e){var t=Vo(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");m=t,this.hasBeenReset=!0}}}),this.displayState=void 0}Wo.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)};var zo=Wo,Ko={"":!0,up:!0};function Yo(e){return"number"==typeof e&&0<=e&&e<=100}var Xo=function(){var t=100,r=3,i=0,n=100,a=0,o=100,s="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return t},set:function(e){if(!Yo(e))throw Error("Width must be between 0 and 100.");t=e}},lines:{enumerable:!0,get:function(){return r},set:function(e){if("number"!=typeof e)throw new TypeError("Lines must be set to a number.");r=e}},regionAnchorY:{enumerable:!0,get:function(){return n},set:function(e){if(!Yo(e))throw Error("RegionAnchorX must be between 0 and 100.");n=e}},regionAnchorX:{enumerable:!0,get:function(){return i},set:function(e){if(!Yo(e))throw Error("RegionAnchorY must be between 0 and 100.");i=e}},viewportAnchorY:{enumerable:!0,get:function(){return o},set:function(e){if(!Yo(e))throw Error("ViewportAnchorY must be between 0 and 100.");o=e}},viewportAnchorX:{enumerable:!0,get:function(){return a},set:function(e){if(!Yo(e))throw Error("ViewportAnchorX must be between 0 and 100.");a=e}},scroll:{enumerable:!0,get:function(){return s},set:function(e){var t,r="string"==typeof(t=e)&&!!Ko[t.toLowerCase()]&&t.toLowerCase();if(!1===r)throw new SyntaxError("An invalid or illegal string was specified.");s=r}}})},Qo=t(function(e){var t=e.exports={WebVTT:Ho,VTTCue:zo,VTTRegion:Xo};Ja.vttjs=t,Ja.WebVTT=t.WebVTT;var r=t.VTTCue,i=t.VTTRegion,n=Ja.VTTCue,a=Ja.VTTRegion;t.shim=function(){Ja.VTTCue=r,Ja.VTTRegion=i},t.restore=function(){Ja.VTTCue=n,Ja.VTTRegion=a},Ja.VTTCue||t.shim()}),Jo=function(e,t){var r,i=null;try{r=JSON.parse(e,t)}catch(e){i=e}return[i,r]};var Zo=t(function(e,t){var r,c,i,n,d;r=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/\;?#]*)?(.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,c=/^([^\/;?#]*)(.*)$/,i=/(?:\/|^)\.(?=\/)/g,n=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,e.exports=d={buildAbsoluteURL:function(e,t,r){if(r=r||{},e=e.trim(),!(t=t.trim())){if(!r.alwaysNormalize)return e;var i=d.parseURL(e);if(!i)throw Error("Error trying to parse base URL.");return i.path=d.normalizePath(i.path),d.buildURLFromParts(i)}var n=d.parseURL(t);if(!n)throw Error("Error trying to parse relative URL.");if(n.scheme)return r.alwaysNormalize?(n.path=d.normalizePath(n.path),d.buildURLFromParts(n)):t;var a=d.parseURL(e);if(!a)throw Error("Error trying to parse base URL.");if(!a.netLoc&&a.path&&"/"!==a.path[0]){var o=c.exec(a.path);a.netLoc=o[1],a.path=o[2]}a.netLoc&&!a.path&&(a.path="/");var s={scheme:a.scheme,netLoc:n.netLoc,path:null,params:n.params,query:n.query,fragment:n.fragment};if(!n.netLoc&&(s.netLoc=a.netLoc,"/"!==n.path[0]))if(n.path){var l=a.path,u=l.substring(0,1+l.lastIndexOf("/"))+n.path;s.path=d.normalizePath(u)}else s.path=a.path,n.params||(s.params=a.params,n.query||(s.query=a.query));return null===s.path&&(s.path=r.alwaysNormalize?d.normalizePath(n.path):n.path),d.buildURLFromParts(s)},parseURL:function(e){var t=r.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(i,"");e.length!==(e=e.replace(n,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}}}),$o=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},es=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},ts=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},rs=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},is=function(){function e(){$o(this,e),this.listeners={}}return e.prototype.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},e.prototype.off=function(e,t){if(!this.listeners[e])return!1;var r=this.listeners[e].indexOf(t);return this.listeners[e].splice(r,1),-1<r},e.prototype.trigger=function(e){var t=this.listeners[e],r=void 0,i=void 0,n=void 0;if(t)if(2===arguments.length)for(i=t.length,r=0;r<i;++r)t[r].call(this,arguments[1]);else for(n=Array.prototype.slice.call(arguments,1),i=t.length,r=0;r<i;++r)t[r].apply(this,n)},e.prototype.dispose=function(){this.listeners={}},e.prototype.pipe=function(t){this.on("data",function(e){t.push(e)})},e}(),ns=function(t){function r(){$o(this,r);var e=rs(this,t.call(this));return e.buffer="",e}return ts(r,t),r.prototype.push=function(e){var t=void 0;for(this.buffer+=e,t=this.buffer.indexOf("\n");-1<t;t=this.buffer.indexOf("\n"))this.trigger("data",this.buffer.substring(0,t)),this.buffer=this.buffer.substring(t+1)},r}(is),as=function(e){for(var t=e.split(/(?:^|,)((?:[^=]*)=(?:"[^"]*"|[^,]*))/),r={},i=t.length,n=void 0;i--;)""!==t[i]&&((n=/([^=]*)=(.*)/.exec(t[i]).slice(1))[0]=n[0].replace(/^\s+|\s+$/g,""),n[1]=n[1].replace(/^\s+|\s+$/g,""),n[1]=n[1].replace(/^['"](.*)['"]$/g,"$1"),r[n[0]]=n[1]);return r},os=function(t){function r(){$o(this,r);var e=rs(this,t.call(this));return e.customParsers=[],e}return ts(r,t),r.prototype.push=function(e){var t=void 0,r=void 0;if(0!==(e=e.replace(/^[\u0000\s]+|[\u0000\s]+$/g,"")).length)if("#"===e[0]){for(var i=0;i<this.customParsers.length;i++)if(this.customParsers[i].call(this,e))return;if(0==e.indexOf("#EXT"))if(e=e.replace("\r",""),t=/^#EXTM3U/.exec(e))this.trigger("data",{type:"tag",tagType:"m3u"});else{if(t=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(e))return r={type:"tag",tagType:"inf"},t[1]&&(r.duration=parseFloat(t[1])),t[2]&&(r.title=t[2]),void this.trigger("data",r);if(t=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(e))return r={type:"tag",tagType:"targetduration"},t[1]&&(r.duration=parseInt(t[1],10)),void this.trigger("data",r);if(t=/^#ZEN-TOTAL-DURATION:?([0-9.]*)?/.exec(e))return r={type:"tag",tagType:"totalduration"},t[1]&&(r.duration=parseInt(t[1],10)),void this.trigger("data",r);if(t=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(e))return r={type:"tag",tagType:"version"},t[1]&&(r.version=parseInt(t[1],10)),void this.trigger("data",r);if(t=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(e))return r={type:"tag",tagType:"media-sequence"},t[1]&&(r.number=parseInt(t[1],10)),void this.trigger("data",r);if(t=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(e))return r={type:"tag",tagType:"discontinuity-sequence"},t[1]&&(r.number=parseInt(t[1],10)),void this.trigger("data",r);if(t=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(e))return r={type:"tag",tagType:"playlist-type"},t[1]&&(r.playlistType=t[1]),void this.trigger("data",r);if(t=/^#EXT-X-BYTERANGE:?([0-9.]*)?@?([0-9.]*)?/.exec(e))return r={type:"tag",tagType:"byterange"},t[1]&&(r.length=parseInt(t[1],10)),t[2]&&(r.offset=parseInt(t[2],10)),void this.trigger("data",r);if(t=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(e))return r={type:"tag",tagType:"allow-cache"},t[1]&&(r.allowed=!/NO/.test(t[1])),void this.trigger("data",r);if(t=/^#EXT-X-MAP:?(.*)$/.exec(e)){if(r={type:"tag",tagType:"map"},t[1]){var n=as(t[1]);if(n.URI&&(r.uri=n.URI),n.BYTERANGE){var a=n.BYTERANGE.split("@"),o=a[0],s=a[1];r.byterange={},o&&(r.byterange.length=parseInt(o,10)),s&&(r.byterange.offset=parseInt(s,10))}}this.trigger("data",r)}else if(t=/^#EXT-X-STREAM-INF:?(.*)$/.exec(e)){if(r={type:"tag",tagType:"stream-inf"},t[1]){if(r.attributes=as(t[1]),r.attributes.RESOLUTION){var l=r.attributes.RESOLUTION.split("x"),u={};l[0]&&(u.width=parseInt(l[0],10)),l[1]&&(u.height=parseInt(l[1],10)),r.attributes.RESOLUTION=u}r.attributes.BANDWIDTH&&(r.attributes.BANDWIDTH=parseInt(r.attributes.BANDWIDTH,10)),r.attributes["PROGRAM-ID"]&&(r.attributes["PROGRAM-ID"]=parseInt(r.attributes["PROGRAM-ID"],10))}this.trigger("data",r)}else{if(t=/^#EXT-X-MEDIA:?(.*)$/.exec(e))return r={type:"tag",tagType:"media"},t[1]&&(r.attributes=as(t[1])),void this.trigger("data",r);if(t=/^#EXT-X-ENDLIST/.exec(e))this.trigger("data",{type:"tag",tagType:"endlist"});else if(t=/^#EXT-X-DISCONTINUITY/.exec(e))this.trigger("data",{type:"tag",tagType:"discontinuity"});else{if(t=/^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/.exec(e))return r={type:"tag",tagType:"program-date-time"},t[1]&&(r.dateTimeString=t[1],r.dateTimeObject=new Date(t[1])),void this.trigger("data",r);if(t=/^#EXT-X-KEY:?(.*)$/.exec(e))return r={type:"tag",tagType:"key"},t[1]&&(r.attributes=as(t[1]),r.attributes.IV&&("0x"===r.attributes.IV.substring(0,2).toLowerCase()&&(r.attributes.IV=r.attributes.IV.substring(2)),r.attributes.IV=r.attributes.IV.match(/.{8}/g),r.attributes.IV[0]=parseInt(r.attributes.IV[0],16),r.attributes.IV[1]=parseInt(r.attributes.IV[1],16),r.attributes.IV[2]=parseInt(r.attributes.IV[2],16),r.attributes.IV[3]=parseInt(r.attributes.IV[3],16),r.attributes.IV=new Uint32Array(r.attributes.IV))),void this.trigger("data",r);if(t=/^#EXT-X-START:?(.*)$/.exec(e))return r={type:"tag",tagType:"start"},t[1]&&(r.attributes=as(t[1]),r.attributes["TIME-OFFSET"]=parseFloat(r.attributes["TIME-OFFSET"]),r.attributes.PRECISE=/YES/.test(r.attributes.PRECISE)),void this.trigger("data",r);if(t=/^#EXT-X-CUE-OUT-CONT:?(.*)?$/.exec(e))return(r={type:"tag",tagType:"cue-out-cont"}).data=t[1]?t[1]:"",void this.trigger("data",r);if(t=/^#EXT-X-CUE-OUT:?(.*)?$/.exec(e))return(r={type:"tag",tagType:"cue-out"}).data=t[1]?t[1]:"",void this.trigger("data",r);if(t=/^#EXT-X-CUE-IN:?(.*)?$/.exec(e))return(r={type:"tag",tagType:"cue-in"}).data=t[1]?t[1]:"",void this.trigger("data",r);this.trigger("data",{type:"tag",data:e.slice(4)})}}}else this.trigger("data",{type:"comment",text:e.slice(1)})}else this.trigger("data",{type:"uri",uri:e})},r.prototype.addParser=function(e){var t=this,r=e.expression,i=e.customType,n=e.dataParser,a=e.segment;"function"!=typeof n&&(n=function(e){return e}),this.customParsers.push(function(e){if(r.exec(e))return t.trigger("data",{type:"custom",data:n(e),customType:i,segment:a}),!0})},r}(is),ss=function(t){function r(){$o(this,r);var e=rs(this,t.call(this));e.lineStream=new ns,e.parseStream=new os,e.lineStream.pipe(e.parseStream);var n=e,a=[],o={},s=void 0,l=void 0,u={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},c=0;return e.manifest={allowCache:!0,discontinuityStarts:[],segments:[]},e.parseStream.on("data",function(t){var r=void 0,i=void 0;({tag:function(){({"allow-cache":function(){this.manifest.allowCache=t.allowed,"allowed"in t||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange:function(){var e={};"length"in t&&((o.byterange=e).length=t.length,"offset"in t||(this.trigger("info",{message:"defaulting offset to zero"}),t.offset=0)),"offset"in t&&((o.byterange=e).offset=t.offset)},endlist:function(){this.manifest.endList=!0},inf:function(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),0<t.duration&&(o.duration=t.duration),0===t.duration&&(o.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=a},key:function(){t.attributes?"NONE"!==t.attributes.METHOD?t.attributes.URI?(t.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),l={method:t.attributes.METHOD||"AES-128",uri:t.attributes.URI},void 0!==t.attributes.IV&&(l.iv=t.attributes.IV)):this.trigger("warn",{message:"ignoring key declaration without URI"}):l=null:this.trigger("warn",{message:"ignoring key declaration without attribute list"})},"media-sequence":function(){isFinite(t.number)?this.manifest.mediaSequence=t.number:this.trigger("warn",{message:"ignoring invalid media sequence: "+t.number})},"discontinuity-sequence":function(){isFinite(t.number)?(this.manifest.discontinuitySequence=t.number,c=t.number):this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+t.number})},"playlist-type":function(){/VOD|EVENT/.test(t.playlistType)?this.manifest.playlistType=t.playlistType:this.trigger("warn",{message:"ignoring unknown playlist type: "+t.playlist})},map:function(){s={},t.uri&&(s.uri=t.uri),t.byterange&&(s.byterange=t.byterange)},"stream-inf":function(){this.manifest.playlists=a,this.manifest.mediaGroups=this.manifest.mediaGroups||u,t.attributes?(o.attributes||(o.attributes={}),es(o.attributes,t.attributes)):this.trigger("warn",{message:"ignoring empty stream-inf attributes"})},media:function(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||u,t.attributes&&t.attributes.TYPE&&t.attributes["GROUP-ID"]&&t.attributes.NAME){var e=this.manifest.mediaGroups[t.attributes.TYPE];e[t.attributes["GROUP-ID"]]=e[t.attributes["GROUP-ID"]]||{},r=e[t.attributes["GROUP-ID"]],(i={default:/yes/i.test(t.attributes.DEFAULT)}).autoselect=!!i.default||/yes/i.test(t.attributes.AUTOSELECT),t.attributes.LANGUAGE&&(i.language=t.attributes.LANGUAGE),t.attributes.URI&&(i.uri=t.attributes.URI),t.attributes["INSTREAM-ID"]&&(i.instreamId=t.attributes["INSTREAM-ID"]),t.attributes.CHARACTERISTICS&&(i.characteristics=t.attributes.CHARACTERISTICS),t.attributes.FORCED&&(i.forced=/yes/i.test(t.attributes.FORCED)),r[t.attributes.NAME]=i}else this.trigger("warn",{message:"ignoring incomplete or missing media group"})},discontinuity:function(){c+=1,o.discontinuity=!0,this.manifest.discontinuityStarts.push(a.length)},"program-date-time":function(){void 0===this.manifest.dateTimeString&&(this.manifest.dateTimeString=t.dateTimeString,this.manifest.dateTimeObject=t.dateTimeObject),o.dateTimeString=t.dateTimeString,o.dateTimeObject=t.dateTimeObject},targetduration:function(){!isFinite(t.duration)||t.duration<0?this.trigger("warn",{message:"ignoring invalid target duration: "+t.duration}):this.manifest.targetDuration=t.duration},totalduration:function(){!isFinite(t.duration)||t.duration<0?this.trigger("warn",{message:"ignoring invalid total duration: "+t.duration}):this.manifest.totalDuration=t.duration},start:function(){t.attributes&&!isNaN(t.attributes["TIME-OFFSET"])?this.manifest.start={timeOffset:t.attributes["TIME-OFFSET"],precise:t.attributes.PRECISE}:this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"})},"cue-out":function(){o.cueOut=t.data},"cue-out-cont":function(){o.cueOutCont=t.data},"cue-in":function(){o.cueIn=t.data}}[t.tagType]||function(){}).call(n)},uri:function(){o.uri=t.uri,a.push(o),!this.manifest.targetDuration||"duration"in o||(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),o.duration=this.manifest.targetDuration),l&&(o.key=l),o.timeline=c,s&&(o.map=s),o={}},comment:function(){},custom:function(){t.segment?(o.custom=o.custom||{},o.custom[t.customType]=t.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[t.customType]=t.data)}})[t.type].call(n)}),e}return ts(r,t),r.prototype.push=function(e){this.lineStream.push(e)},r.prototype.end=function(){this.lineStream.push("\n")},r.prototype.addParser=function(e){this.parseStream.addParser(e)},r}(is),ls=function(e){var t,r=e.attributes,i=e.segments,n={attributes:(t={NAME:r.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:r.width,height:r.height},CODECS:r.codecs,BANDWIDTH:r.bandwidth},t["PROGRAM-ID"]=1,t),uri:"",endList:"static"===(r.type||"static"),timeline:r.periodIndex,resolvedUri:"",targetDuration:r.duration,segments:i,mediaSequence:i.length?i[0].number:1};return r.contentProtection&&(n.contentProtection=r.contentProtection),n},us="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cs=function(e){return!!e&&"object"===(void 0===e?"undefined":us(e))},ds=function i(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.reduce(function(t,r){return Object.keys(r).forEach(function(e){t[e]=Array.isArray(t[e])&&Array.isArray(r[e])?t[e].concat(r[e]):cs(t[e])&&cs(r[e])?i(t[e],r[e]):r[e]}),t},{})},hs=function(e,t){return/^[a-z]+:/i.test(t)?t:(/\/\//i.test(e)||(e=Zo.buildAbsoluteURL(Ja.location.href,e)),Zo.buildAbsoluteURL(e,t))},fs=function(e){var t=e.baseUrl,r=e.source,i=void 0===r?"":r,n=e.range,a=void 0===n?"":n,o={uri:i,resolvedUri:hs((void 0===t?"":t)||"",i)};if(a){var s=a.split("-"),l=parseInt(s[0],10);o.byterange={length:parseInt(s[1],10)-l,offset:l}}return o},ps=function(e,t){for(var r,i,n,a,o=e.type,s=void 0===o?"static":o,l=e.minimumUpdatePeriod,u=void 0===l?0:l,c=e.media,d=void 0===c?"":c,h=e.sourceDuration,f=e.timescale,p=void 0===f?1:f,g=e.startNumber,m=void 0===g?1:g,v=e.periodIndex,y=[],_=-1,b=0;b<t.length;b++){var T=t[b],S=T.d,E=T.r||0,k=T.t||0;_<0&&(_=k),k&&_<k&&(_=k);var w=void 0;if(E<0){var C=b+1;w=C===t.length?"dynamic"===s&&0<u&&0<d.indexOf("$Number$")?Math.ceil(((((r=e).NOW+r.clientOffset)/1e3+(void 0===(a=r.minimumUpdatePeriod)?0:a)-(r.availabilityStartTime+(void 0===(n=r.start)?0:n)))*(void 0===(i=r.timescale)?1:i)-_)/S):(h*p-_)/S:(t[C].t-_)/S}else w=E+1;for(var A=m+y.length+w,L=m+y.length;L<A;)y.push({number:L,duration:S/p,time:_,timeline:v}),_+=S,L++}return y},gs=function(e){return e.reduce(function(e,t){return e.concat(t)},[])},ms=function(e){if(!e.length)return[];for(var t=[],r=0;r<e.length;r++)t.push(e[r]);return t},vs={static:function(e){var t=e.timescale;return{start:0,end:Math.ceil(e.sourceDuration/(e.duration/(void 0===t?1:t)))}},dynamic:function(e){var t=e.timescale,r=void 0===t?1:t,i=e.duration,n=e.start,a=e.minimumUpdatePeriod,o=e.timeShiftBufferDepth,s=void 0===o?1/0:o,l=(e.NOW+e.clientOffset)/1e3,u=e.availabilityStartTime+(void 0===n?0:n),c=Math.ceil((l+(void 0===a?0:a)-u)*r/i),d=Math.floor((l-u-s)*r/i),h=Math.floor((l-u)*r/i);return{start:Math.max(0,d),end:Math.min(c,h)}}},ys=function(e){var a,t=e.type,r=void 0===t?"static":t,i=e.duration,n=e.timescale,o=void 0===n?1:n,s=e.sourceDuration,l=vs[r](e),u=function(e,t){for(var r=[],i=e;i<t;i++)r.push(i);return r}(l.start,l.end).map((a=e,function(e,t){var r=a.duration,i=a.timescale,n=a.startNumber;return{number:(void 0===n?1:n)+e,duration:r/(void 0===i?1:i),timeline:a.periodIndex,time:t*r}}));if("static"===r){var c=u.length-1;u[c].duration=s-i/o*c}return u},_s=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g,bs=function(e,t){return e.replace(_s,(a=t,function(e,t,r,i){if("$$"===e)return"$";if(void 0===a[t])return e;var n=""+a[t];return"RepresentationID"===t?n:(i=r?parseInt(i,10):1)<=n.length?n:""+Array(i-n.length+1).join("0")+n}));var a},Ts=function(r,e){var t,i,n={RepresentationID:r.id,Bandwidth:r.bandwidth||0},a=r.initialization,o=void 0===a?{sourceURL:"",range:""}:a,s=fs({baseUrl:r.baseUrl,source:bs(o.sourceURL,n),range:o.range});return(i=e,(t=r).duration||i?t.duration?ys(t):ps(t,i):[{number:t.startNumber||1,duration:t.sourceDuration,time:0,timeline:t.periodIndex}]).map(function(e){n.Number=e.number,n.Time=e.time;var t=bs(r.media||"",n);return{uri:t,timeline:e.timeline,duration:e.duration,resolvedUri:hs(r.baseUrl||"",t),map:s,number:e.number}})},Ss="INVALID_NUMBER_OF_PERIOD",Es="DASH_EMPTY_MANIFEST",ks="DASH_INVALID_XML",ws="NO_BASE_URL",Cs="SEGMENT_TIME_UNSPECIFIED",As="UNSUPPORTED_UTC_TIMING_SCHEME",Ls=function(l,e){var t=l.duration,r=l.segmentUrls,i=void 0===r?[]:r;if(!t&&!e||t&&e)throw Error(Cs);var n=i.map(function(e){return r=e,o=fs({baseUrl:i=(t=l).baseUrl,source:(a=void 0===(n=t.initialization)?{}:n).sourceURL,range:a.range}),(s=fs({baseUrl:i,source:r.media,range:r.mediaRange})).map=o,s;var t,r,i,n,a,o,s}),a=void 0;return t&&(a=ys(l)),e&&(a=ps(l,e)),a.map(function(e,t){if(n[t]){var r=n[t];return r.timeline=e.timeline,r.duration=e.duration,r.number=e.number,r}}).filter(function(e){return e})},Is=function(e){var t=e.baseUrl,r=e.initialization,i=void 0===r?{}:r,n=e.sourceDuration,a=e.timescale,o=void 0===a?1:a,s=e.indexRange,l=void 0===s?"":s,u=e.duration;if(!t)throw Error(ws);var c=fs({baseUrl:t,source:i.sourceURL,range:i.range}),d=fs({baseUrl:t,source:t,range:l});if(d.map=c,u){var h=ys(e);h.length&&(d.duration=h[0].duration,d.timeline=h[0].timeline)}else n&&(d.duration=n/o,d.timeline=0);return d.number=0,[d]},Ps=function(e){var t=e.attributes,r=e.segmentInfo,i=void 0,n=void 0;if(r.template?(n=Ts,i=ds(t,r.template)):r.base?(n=Is,i=ds(t,r.base)):r.list&&(n=Ls,i=ds(t,r.list)),!n)return{attributes:t};var a=n(i,r.timeline);if(i.duration){var o=i.timescale;i.duration=i.duration/(void 0===o?1:o)}else i.duration=a.length?a.reduce(function(e,t){return Math.max(e,Math.ceil(t.duration))},0):0;return{attributes:i,segments:a}},xs=function(e,t){return ms(e.childNodes).filter(function(e){return e.tagName===t})},Rs=function(e){return e.textContent.trim()},Os=function(e){var t=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/.exec(e);if(!t)return 0;var r=t.slice(1),i=r[1],n=r[2],a=r[3],o=r[4],s=r[5];return 31536e3*parseFloat(r[0]||0)+2592e3*parseFloat(i||0)+86400*parseFloat(n||0)+3600*parseFloat(a||0)+60*parseFloat(o||0)+parseFloat(s||0)},Ds={mediaPresentationDuration:function(e){return Os(e)},availabilityStartTime:function(e){return/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(t=e)&&(t+="Z"),Date.parse(t)/1e3;var t},minimumUpdatePeriod:function(e){return Os(e)},timeShiftBufferDepth:function(e){return Os(e)},start:function(e){return Os(e)},width:function(e){return parseInt(e,10)},height:function(e){return parseInt(e,10)},bandwidth:function(e){return parseInt(e,10)},startNumber:function(e){return parseInt(e,10)},timescale:function(e){return parseInt(e,10)},duration:function(e){var t=parseInt(e,10);return isNaN(t)?Os(e):t},d:function(e){return parseInt(e,10)},t:function(e){return parseInt(e,10)},r:function(e){return parseInt(e,10)},DEFAULT:function(e){return e}},Ms=function(e){return e&&e.attributes?ms(e.attributes).reduce(function(e,t){return e[t.name]=(Ds[t.name]||Ds.DEFAULT)(t.value),e},{}):{}};var Ns,Fs,js={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"},Bs=function(e,r){return r.length?gs(e.map(function(t){return r.map(function(e){return hs(t,Rs(e))})})):e},Us=function(e){var t=xs(e,"SegmentTemplate")[0],r=xs(e,"SegmentList")[0],i=r&&xs(r,"SegmentURL").map(function(e){return ds({tag:"SegmentURL"},Ms(e))}),n=xs(e,"SegmentBase")[0],a=r||t,o=a&&xs(a,"SegmentTimeline")[0],s=r||n||t,l=s&&xs(s,"Initialization")[0],u=t&&Ms(t);u&&l?u.initialization=l&&Ms(l):u&&u.initialization&&(u.initialization={sourceURL:u.initialization});var c={template:u,timeline:o&&xs(o,"S").map(function(e){return Ms(e)}),list:r&&ds(Ms(r),{segmentUrls:i,initialization:Ms(l)}),base:n&&ds(Ms(n),{initialization:Ms(l)})};return Object.keys(c).forEach(function(e){c[e]||delete c[e]}),c},Hs=function(e){return e.reduce(function(e,t){var r=Ms(t),i=js[r.schemeIdUri];if(i){e[i]={attributes:r};var n=xs(t,"cenc:pssh")[0];if(n){var a=Rs(n),o=a&&function(e){for(var t=Ja.atob(e),r=new Uint8Array(t.length),i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(a);e[i].pssh=o}}return e},{})},Gs=function(f,p,g){return function(e){var t=Ms(e),r=Bs(p,xs(e,"BaseURL")),i=xs(e,"Role")[0],n={role:Ms(i)},a=ds(f,t,n),o=Hs(xs(e,"ContentProtection"));Object.keys(o).length&&(a=ds(a,{contentProtection:o}));var s,l,u,c=Us(e),d=xs(e,"Representation"),h=ds(g,c);return gs(d.map((s=a,l=r,u=h,function(e){var t=xs(e,"BaseURL"),r=Bs(l,t),i=ds(s,Ms(e)),n=Us(e);return r.map(function(e){return{segmentInfo:ds(u,n),attributes:ds(i,{baseUrl:e})}})})))}},qs=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=t.manifestUri,i=void 0===r?"":r,n=t.NOW,a=void 0===n?Date.now():n,o=t.clientOffset,s=void 0===o?0:o,l=xs(e,"Period");if(1!==l.length)throw Error(Ss);var u,c,d=Ms(e),h=Bs([i],xs(e,"BaseURL"));return d.sourceDuration=d.mediaPresentationDuration||0,d.NOW=a,d.clientOffset=s,gs(l.map((u=d,c=h,function(e,t){var r=Bs(c,xs(e,"BaseURL")),i=Ms(e),n=ds(u,i,{periodIndex:t}),a=xs(e,"AdaptationSet"),o=Us(e);return gs(a.map(Gs(n,r,o)))})))},Vs=function(e){if(""===e)throw Error(Es);var t=(new Ja.DOMParser).parseFromString(e,"application/xml"),r=t&&"MPD"===t.documentElement.tagName?t.documentElement:null;if(!r||r&&0<r.getElementsByTagName("parsererror").length)throw Error(ks);return r},Ws=function(e,t){return function(e){var t;if(!e.length)return{};var r=e[0].attributes,i=r.sourceDuration,n=r.minimumUpdatePeriod,a=void 0===n?0:n,o=e.filter(function(e){var t=e.attributes;return"video/mp4"===t.mimeType||"video"===t.contentType}).map(ls),s=e.filter(function(e){var t=e.attributes;return"audio/mp4"===t.mimeType||"audio"===t.contentType}),l=e.filter(function(e){var t=e.attributes;return"text/vtt"===t.mimeType||"text"===t.contentType}),u={allowCache:!0,discontinuityStarts:[],segments:[],endList:!0,mediaGroups:(t={AUDIO:{},VIDEO:{}},t["CLOSED-CAPTIONS"]={},t.SUBTITLES={},t),uri:"",duration:i,playlists:o,minimumUpdatePeriod:1e3*a};return s.length&&(u.mediaGroups.AUDIO.audio=s.reduce(function(e,t){var r,i,n,a,o,s=t.attributes.role&&t.attributes.role.value||"main",l=t.attributes.lang||"",u="main";return l&&(u=t.attributes.lang+" ("+s+")"),e[u]&&t.attributes.bandwidth<e[u].playlists[0].attributes.BANDWIDTH||(e[u]={language:l,autoselect:!0,default:"main"===s,playlists:[(r=t,n=r.attributes,a=r.segments,o={attributes:(i={NAME:n.id,BANDWIDTH:n.bandwidth,CODECS:n.codecs},i["PROGRAM-ID"]=1,i),uri:"",endList:"static"===(n.type||"static"),timeline:n.periodIndex,resolvedUri:"",targetDuration:n.duration,segments:a,mediaSequence:a.length?a[0].number:1},n.contentProtection&&(o.contentProtection=n.contentProtection),o)],uri:""}),e},{})),l.length&&(u.mediaGroups.SUBTITLES.subs=l.reduce(function(e,t){var r,i,n,a,o=t.attributes.lang||"text";return e[o]||(e[o]={language:o,default:!1,autoselect:!1,playlists:[(r=t,n=r.attributes,a=r.segments,void 0===a&&(a=[{uri:n.baseUrl,timeline:n.periodIndex,resolvedUri:n.baseUrl||"",duration:n.sourceDuration,number:0}],n.duration=n.sourceDuration),{attributes:(i={NAME:n.id,BANDWIDTH:n.bandwidth},i["PROGRAM-ID"]=1,i),uri:"",endList:"static"===(n.type||"static"),timeline:n.periodIndex,resolvedUri:n.baseUrl||"",targetDuration:n.duration,segments:a,mediaSequence:a.length?a[0].number:1})],uri:""}),e},{})),u}(qs(Vs(e),t).map(Ps))},zs=function(e){return function(e){var t=xs(e,"UTCTiming")[0];if(!t)return null;var r=Ms(t);switch(r.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":r.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":r.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":r.method="DIRECT",r.value=Date.parse(r.value);break;case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":default:throw Error(As)}return r}(Vs(e))},Ks=function(e){return e>>>0};Ns=function(e,t){var r,i,n,a,o,s=[];if(!t.length)return null;for(r=0;r<e.byteLength;)i=Ks(e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]),n=Fs(e.subarray(r+4,r+8)),a=1<i?r+i:e.byteLength,n===t[0]&&(1===t.length?s.push(e.subarray(r+8,a)):(o=Ns(e.subarray(r+8,a),t.slice(1))).length&&(s=s.concat(o))),r=a;return s};Fs=function(e){var t="";return t+=String.fromCharCode(e[0]),t+=String.fromCharCode(e[1]),t+=String.fromCharCode(e[2]),t+=String.fromCharCode(e[3])};var Ys=function(e){return Ns(e,["moov","trak"]).reduce(function(e,t){var r,i,n,a;return(r=Ns(t,["tkhd"])[0])?(n=Ks(r[i=0===r[0]?12:20]<<24|r[i+1]<<16|r[i+2]<<8|r[i+3]),(a=Ns(t,["mdia","mdhd"])[0])?(e[n]=Ks(a[i=0===a[0]?12:20]<<24|a[i+1]<<16|a[i+2]<<8|a[i+3]),e):null):null},{})},Xs=function(n,e){var t,r,i;return t=Ns(e,["moof","traf"]),r=[].concat.apply([],t.map(function(i){return Ns(i,["tfhd"]).map(function(e){var t,r;return t=Ks(e[4]<<24|e[5]<<16|e[6]<<8|e[7]),r=n[t]||9e4,(Ns(i,["tfdt"]).map(function(e){var t,r;return t=e[0],r=Ks(e[4]<<24|e[5]<<16|e[6]<<8|e[7]),1===t&&(r*=4294967296,r+=Ks(e[8]<<24|e[9]<<16|e[10]<<8|e[11])),r})[0]||1/0)/r})})),i=Math.min.apply(null,r),isFinite(i)?i:0},Qs=27,Js=15,Zs=21,$s=function(){this.init=function(){var a={};this.on=function(e,t){a[e]||(a[e]=[]),a[e]=a[e].concat(t)},this.off=function(e,t){var r;return!!a[e]&&(r=a[e].indexOf(t),a[e]=a[e].slice(),a[e].splice(r,1),-1<r)},this.trigger=function(e){var t,r,i,n;if(t=a[e])if(2===arguments.length)for(i=t.length,r=0;r<i;++r)t[r].call(this,arguments[1]);else{for(n=[],r=arguments.length,r=1;r<arguments.length;++r)n.push(arguments[r]);for(i=t.length,r=0;r<i;++r)t[r].apply(this,n)}},this.dispose=function(){a={}}}};$s.prototype.pipe=function(t){return this.on("data",function(e){t.push(e)}),this.on("done",function(e){t.flush(e)}),t},$s.prototype.push=function(e){this.trigger("data",e)},$s.prototype.flush=function(e){this.trigger("done",e)};var el=function(e,t){var r=1;for(t<e&&(r=-1);4294967296<Math.abs(t-e);)e+=8589934592*r;return e},tl=function(e){var t,r;tl.prototype.init.call(this),this.type_=e,this.push=function(e){e.type===this.type_&&(void 0===r&&(r=e.dts),e.dts=el(e.dts,r),e.pts=el(e.pts,r),t=e.dts,this.trigger("data",e))},this.flush=function(){r=t,this.trigger("done")},this.discontinuity=function(){t=r=void 0}};tl.prototype=new $s;var rl=function(e){var t=31&e[1];return t<<=8,t|=e[2]},il=function(e){return!!(64&e[1])},nl=function(e){var t=0;return 1<(48&e[3])>>>4&&(t+=e[4]+1),t},al=function(e){switch(e){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}},ol=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],sl=function(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]},ll={parseId3TagSize:function(e,t){var r=e[t+6]<<21|e[t+7]<<14|e[t+8]<<7|e[t+9];return(16&e[t+5])>>4?r+20:r+10},parseAdtsSize:function(e,t){return 6144&e[t+3]|e[t+4]<<3|(224&e[t+5])>>5},parseType:function(e,t){return 73===e[t]&&68===e[t+1]&&51===e[t+2]?"timed-metadata":!0&e[t]&&240==(240&e[t+1])?"audio":null},parseSampleRate:function(e){for(var t=0;t+5<e.length;){if(255===e[t]&&240==(246&e[t+1]))return ol[(60&e[t+2])>>>2];t++}return null},parseAacTimestamp:function(e){var t,r,i;t=10,64&e[5]&&(t+=4,t+=sl(e.subarray(10,14)));do{if((r=sl(e.subarray(t+4,t+8)))<1)return null;if("PRIV"===String.fromCharCode(e[t],e[t+1],e[t+2],e[t+3])){i=e.subarray(t+10,t+r+10);for(var n=0;n<i.byteLength;n++)if(0===i[n]){if("com.apple.streaming.transportStreamTimestamp"!==unescape(function(e,t,r){var i,n="";for(i=t;i<r;i++)n+="%"+("00"+e[i].toString(16)).slice(-2);return n}(i,0,n)))break;var a=i.subarray(n+1),o=(1&a[3])<<30|a[4]<<22|a[5]<<14|a[6]<<6|a[7]>>>2;return o*=4,o+=3&a[7]}}t+=10,t+=r}while(t<e.byteLength);return null}},ul=el,cl={};cl.ts={parseType:function(e,t){var r=rl(e);return 0===r?"pat":r===t?"pmt":t?"pes":null},parsePat:function(e){var t=il(e),r=4+nl(e);return t&&(r+=e[r]+1),(31&e[r+10])<<8|e[r+11]},parsePmt:function(e){var t={},r=il(e),i=4+nl(e);if(r&&(i+=e[i]+1),1&e[i+5]){var n;n=3+((15&e[i+1])<<8|e[i+2])-4;for(var a=12+((15&e[i+10])<<8|e[i+11]);a<n;){var o=i+a;t[(31&e[o+1])<<8|e[o+2]]=e[o],a+=5+((15&e[o+3])<<8|e[o+4])}return t}},parsePayloadUnitStartIndicator:il,parsePesType:function(e,t){switch(t[rl(e)]){case Qs:return"video";case Js:return"audio";case Zs:return"timed-metadata";default:return null}},parsePesTime:function(e){if(!il(e))return null;var t=4+nl(e);if(e.byteLength<=t)return null;var r,i=null;return 192&(r=e[t+7])&&((i={}).pts=(14&e[t+9])<<27|(255&e[t+10])<<20|(254&e[t+11])<<12|(255&e[t+12])<<5|(254&e[t+13])>>>3,i.pts*=4,i.pts+=(6&e[t+13])>>>1,i.dts=i.pts,64&r&&(i.dts=(14&e[t+14])<<27|(255&e[t+15])<<20|(254&e[t+16])<<12|(255&e[t+17])<<5|(254&e[t+18])>>>3,i.dts*=4,i.dts+=(6&e[t+18])>>>1)),i},videoPacketContainsKeyFrame:function(e){for(var t=4+nl(e),r=e.subarray(t),i=0,n=0,a=!1;n<r.byteLength-3;n++)if(1===r[n+2]){i=n+5;break}for(;i<r.byteLength;)switch(r[i]){case 0:if(0!==r[i-1]){i+=2;break}if(0!==r[i-2]){i++;break}for(n+3!==i-2&&"slice_layer_without_partitioning_rbsp_idr"===al(31&r[n+3])&&(a=!0);1!==r[++i]&&i<r.length;);n=i-2,i+=3;break;case 1:if(0!==r[i-1]||0!==r[i-2]){i+=3;break}"slice_layer_without_partitioning_rbsp_idr"===al(31&r[n+3])&&(a=!0),n=i-2,i+=3;break;default:i+=3}return r=r.subarray(n),i-=n,n=0,r&&3<r.byteLength&&"slice_layer_without_partitioning_rbsp_idr"===al(31&r[n+3])&&(a=!0),a}},cl.aac=ll;var dl=188,hl=function(e,t,r){for(var i,n,a,o,s=0,l=dl,u=!1;l<e.byteLength;)if(71!==e[s]||71!==e[l])s++,l++;else{switch(i=e.subarray(s,l),cl.ts.parseType(i,t.pid)){case"pes":n=cl.ts.parsePesType(i,t.table),a=cl.ts.parsePayloadUnitStartIndicator(i),"audio"===n&&a&&(o=cl.ts.parsePesTime(i))&&(o.type="audio",r.audio.push(o),u=!0)}if(u)break;s+=dl,l+=dl}for(s=(l=e.byteLength)-dl,u=!1;0<=s;)if(71!==e[s]||71!==e[l])s--,l--;else{switch(i=e.subarray(s,l),cl.ts.parseType(i,t.pid)){case"pes":n=cl.ts.parsePesType(i,t.table),a=cl.ts.parsePayloadUnitStartIndicator(i),"audio"===n&&a&&(o=cl.ts.parsePesTime(i))&&(o.type="audio",r.audio.push(o),u=!0)}if(u)break;s-=dl,l-=dl}},fl=function(e,t,r){for(var i,n,a,o,s,l,u,c=0,d=dl,h=!1,f={data:[],size:0};d<e.byteLength;)if(71!==e[c]||71!==e[d])c++,d++;else{switch(i=e.subarray(c,d),cl.ts.parseType(i,t.pid)){case"pes":if(n=cl.ts.parsePesType(i,t.table),a=cl.ts.parsePayloadUnitStartIndicator(i),"video"===n&&(a&&!h&&(o=cl.ts.parsePesTime(i))&&(o.type="video",r.video.push(o),h=!0),!r.firstKeyFrame)){if(a&&0!==f.size){for(s=new Uint8Array(f.size),l=0;f.data.length;)u=f.data.shift(),s.set(u,l),l+=u.byteLength;cl.ts.videoPacketContainsKeyFrame(s)&&(r.firstKeyFrame=cl.ts.parsePesTime(s),r.firstKeyFrame.type="video"),f.size=0}f.data.push(i),f.size+=i.byteLength}}if(h&&r.firstKeyFrame)break;c+=dl,d+=dl}for(c=(d=e.byteLength)-dl,h=!1;0<=c;)if(71!==e[c]||71!==e[d])c--,d--;else{switch(i=e.subarray(c,d),cl.ts.parseType(i,t.pid)){case"pes":n=cl.ts.parsePesType(i,t.table),a=cl.ts.parsePayloadUnitStartIndicator(i),"video"===n&&a&&(o=cl.ts.parsePesTime(i))&&(o.type="video",r.video.push(o),h=!0)}if(h)break;c-=dl,d-=dl}},pl=function(e){var t={pid:null,table:null},r={};for(var i in function(e,t){for(var r,i=0,n=dl;n<e.byteLength;)if(71!==e[i]||71!==e[n])i++,n++;else{switch(r=e.subarray(i,n),cl.ts.parseType(r,t.pid)){case"pat":t.pid||(t.pid=cl.ts.parsePat(r));break;case"pmt":t.table||(t.table=cl.ts.parsePmt(r))}if(t.pid&&t.table)return;i+=dl,n+=dl}}(e,t),t.table){if(t.table.hasOwnProperty(i))switch(t.table[i]){case Qs:r.video=[],fl(e,t,r),0===r.video.length&&delete r.video;break;case Js:r.audio=[],hl(e,t,r),0===r.audio.length&&delete r.audio}}return r},gl=function(e,t){var r,i;return(i=73===(r=e)[0]&&68===r[1]&&51===r[2]?function(e){for(var t,r=!1,i=0,n=null,a=null,o=0,s=0;3<=e.length-s;){switch(cl.aac.parseType(e,s)){case"timed-metadata":if(e.length-s<10){r=!0;break}if(o=cl.aac.parseId3TagSize(e,s),e.length<o){r=!0;break}null===a&&(t=e.subarray(s,s+o),a=cl.aac.parseAacTimestamp(t)),s+=o;break;case"audio":if(e.length-s<7){r=!0;break}if(o=cl.aac.parseAdtsSize(e,s),e.length<o){r=!0;break}null===n&&(t=e.subarray(s,s+o),n=cl.aac.parseSampleRate(t)),i++,s+=o;break;default:s++}if(r)return null}if(null===n||null===a)return null;var l=9e4/n;return{audio:[{type:"audio",dts:a,pts:a},{type:"audio",dts:a+1024*i*l,pts:a+1024*i*l}]}}(e):pl(e))&&(i.audio||i.video)?(function(e,t){if(e.audio&&e.audio.length){var r=t;void 0===r&&(r=e.audio[0].dts),e.audio.forEach(function(e){e.dts=ul(e.dts,r),e.pts=ul(e.pts,r),e.dtsTime=e.dts/9e4,e.ptsTime=e.pts/9e4})}if(e.video&&e.video.length){var i=t;if(void 0===i&&(i=e.video[0].dts),e.video.forEach(function(e){e.dts=ul(e.dts,i),e.pts=ul(e.pts,i),e.dtsTime=e.dts/9e4,e.ptsTime=e.pts/9e4}),e.firstKeyFrame){var n=e.firstKeyFrame;n.dts=ul(n.dts,i),n.pts=ul(n.pts,i),n.dtsTime=n.dts/9e4,n.ptsTime=n.dts/9e4}}}(i,t),i):null};var ml=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},vl=function(){function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}}(),yl=null,_l=function(){function c(e){ml(this,c),yl||(yl=function(){var e=[[[],[],[],[],[]],[[],[],[],[],[]]],t=e[0],r=e[1],i=t[4],n=r[4],a=void 0,o=void 0,s=void 0,l=[],u=[],c=void 0,d=void 0,h=void 0,f=void 0,p=void 0;for(a=0;a<256;a++)u[(l[a]=a<<1^283*(a>>7))^a]=a;for(o=s=0;!i[o];o^=c||1,s=u[s]||1)for(p=16843009*l[d=l[c=l[n[i[o]=h=(h=s^s<<1^s<<2^s<<3^s<<4)>>8^255&h^99]=o]]]^65537*d^257*c^16843008*o,f=257*l[h]^16843008*h,a=0;a<4;a++)t[a][o]=f=f<<24^f>>>8,r[a][h]=p=p<<24^p>>>8;for(a=0;a<5;a++)t[a]=t[a].slice(0),r[a]=r[a].slice(0);return e}()),this._tables=[[yl[0][0].slice(),yl[0][1].slice(),yl[0][2].slice(),yl[0][3].slice(),yl[0][4].slice()],[yl[1][0].slice(),yl[1][1].slice(),yl[1][2].slice(),yl[1][3].slice(),yl[1][4].slice()]];var t=void 0,r=void 0,i=void 0,n=void 0,a=void 0,o=this._tables[0][4],s=this._tables[1],l=e.length,u=1;if(4!==l&&6!==l&&8!==l)throw Error("Invalid aes key size");for(n=e.slice(0),this._key=[n,a=[]],t=l;t<4*l+28;t++)i=n[t-1],(t%l==0||8===l&&t%l==4)&&(i=o[i>>>24]<<24^o[i>>16&255]<<16^o[i>>8&255]<<8^o[255&i],t%l==0&&(i=i<<8^i>>>24^u<<24,u=u<<1^283*(u>>7))),n[t]=n[t-l]^i;for(r=0;t;r++,t--)i=n[3&r?t:t-4],a[r]=t<=4||r<4?i:s[0][o[i>>>24]]^s[1][o[i>>16&255]]^s[2][o[i>>8&255]]^s[3][o[255&i]]}return c.prototype.decrypt=function(e,t,r,i,n,a){var o=this._key[1],s=e^o[0],l=i^o[1],u=r^o[2],c=t^o[3],d=void 0,h=void 0,f=void 0,p=o.length/4-2,g=void 0,m=4,v=this._tables[1],y=v[0],_=v[1],b=v[2],T=v[3],S=v[4];for(g=0;g<p;g++)d=y[s>>>24]^_[l>>16&255]^b[u>>8&255]^T[255&c]^o[m],h=y[l>>>24]^_[u>>16&255]^b[c>>8&255]^T[255&s]^o[m+1],f=y[u>>>24]^_[c>>16&255]^b[s>>8&255]^T[255&l]^o[m+2],c=y[c>>>24]^_[s>>16&255]^b[l>>8&255]^T[255&u]^o[m+3],m+=4,s=d,l=h,u=f;for(g=0;g<4;g++)n[(3&-g)+a]=S[s>>>24]<<24^S[l>>16&255]<<16^S[u>>8&255]<<8^S[255&c]^o[m++],d=s,s=l,l=u,u=c,c=d},c}(),bl=function(){function e(){ml(this,e),this.listeners={}}return e.prototype.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},e.prototype.off=function(e,t){if(!this.listeners[e])return!1;var r=this.listeners[e].indexOf(t);return this.listeners[e].splice(r,1),-1<r},e.prototype.trigger=function(e){var t=this.listeners[e];if(t)if(2===arguments.length)for(var r=t.length,i=0;i<r;++i)t[i].call(this,arguments[1]);else for(var n=Array.prototype.slice.call(arguments,1),a=t.length,o=0;o<a;++o)t[o].apply(this,n)},e.prototype.dispose=function(){this.listeners={}},e.prototype.pipe=function(t){this.on("data",function(e){t.push(e)})},e}(),Tl=function(t){function r(){ml(this,r);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,t.call(this,bl));return e.jobs=[],e.delay=1,e.timeout_=null,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(r,t),r.prototype.processJob_=function(){this.jobs.shift()(),this.timeout_=this.jobs.length?setTimeout(this.processJob_.bind(this),this.delay):null},r.prototype.push=function(e){this.jobs.push(e),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))},r}(bl),Sl=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},El=function(e,t,r){var i=new Int32Array(e.buffer,e.byteOffset,e.byteLength>>2),n=new _l(Array.prototype.slice.call(t)),a=new Uint8Array(e.byteLength),o=new Int32Array(a.buffer),s=void 0,l=void 0,u=void 0,c=void 0,d=void 0,h=void 0,f=void 0,p=void 0,g=void 0;for(s=r[0],l=r[1],u=r[2],c=r[3],g=0;g<i.length;g+=4)d=Sl(i[g]),h=Sl(i[g+1]),f=Sl(i[g+2]),p=Sl(i[g+3]),n.decrypt(d,h,f,p,o,g),o[g]=Sl(o[g]^s),o[g+1]=Sl(o[g+1]^l),o[g+2]=Sl(o[g+2]^u),o[g+3]=Sl(o[g+3]^c),s=d,l=h,u=f,c=p;return a},kl=function(){function l(e,t,r,i){ml(this,l);var n=l.STEP,a=new Int32Array(e.buffer),o=new Uint8Array(e.byteLength),s=0;for(this.asyncStream_=new Tl,this.asyncStream_.push(this.decryptChunk_(a.subarray(s,s+n),t,r,o)),s=n;s<a.length;s+=n)r=new Uint32Array([Sl(a[s-4]),Sl(a[s-3]),Sl(a[s-2]),Sl(a[s-1])]),this.asyncStream_.push(this.decryptChunk_(a.subarray(s,s+n),t,r,o));this.asyncStream_.push(function(){var e;i(null,(e=o).subarray(0,e.byteLength-e[e.byteLength-1]))})}return l.prototype.decryptChunk_=function(t,r,i,n){return function(){var e=El(t,r,i);n.set(e,t.byteOffset)}},vl(l,null,[{key:"STEP",get:function(){return 32e3}}]),l}(),wl=void 0,Cl="info",Al=[],Ll=function(e,t){var r=wl.levels[Cl],i=RegExp("^("+r+")$");if("log"!==e&&t.unshift(e.toUpperCase()+":"),Al&&Al.push([].concat(t)),t.unshift("VIDEOJS:"),Ja.console){var n=Ja.console[e];n||"debug"!==e||(n=Ja.console.info||Ja.console.log),n&&r&&i.test(e)&&n[Array.isArray(t)?"apply":"call"](Ja.console,t)}};(wl=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];Ll("log",t)}).levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:Cl},wl.level=function(e){if("string"==typeof e){if(!wl.levels.hasOwnProperty(e))throw Error('"'+e+'" in not a valid log level');Cl=e}return Cl},wl.history=function(){return Al?[].concat(Al):[]},wl.history.clear=function(){Al&&(Al.length=0)},wl.history.disable=function(){null!==Al&&(Al.length=0,Al=null)},wl.history.enable=function(){null===Al&&(Al=[])},wl.error=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return Ll("error",t)},wl.warn=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return Ll("warn",t)},wl.debug=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return Ll("debug",t)};var Il=wl,Pl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xl=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},Rl=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},Ol=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},Dl=function(e,t){return e.raw=t,e},Ml=Object.prototype.toString,Nl=function(e){return Bl(e)?Object.keys(e):[]};function Fl(t,r){Nl(t).forEach(function(e){return r(t[e],e)})}function jl(r){for(var e=arguments.length,t=Array(1<e?e-1:0),i=1;i<e;i++)t[i-1]=arguments[i];return Object.assign?Object.assign.apply(Object,[r].concat(t)):(t.forEach(function(e){e&&Fl(e,function(e,t){r[t]=e})}),r)}function Bl(e){return!!e&&"object"===(void 0===e?"undefined":Pl(e))}function Ul(e){return Bl(e)&&"[object Object]"===Ml.call(e)&&e.constructor===Object}function Hl(e,t){if(!e||!t)return"";if("function"!=typeof Ja.getComputedStyle)return"";var r=Ja.getComputedStyle(e);return r?r[t]:""}var Gl=Dl(["Setting attributes in the second argument of createEl()\n                has been deprecated. Use the third argument instead.\n                createEl(type, properties, attributes). Attempting to set "," to ","."],["Setting attributes in the second argument of createEl()\n                has been deprecated. Use the third argument instead.\n                createEl(type, properties, attributes). Attempting to set "," to ","."]);function ql(e){return"string"==typeof e&&/\S/.test(e)}function Vl(e){if(/\s/.test(e))throw Error("class has illegal whitespace characters")}function Wl(){return to===Ja.document}function zl(e){return Bl(e)&&1===e.nodeType}function Kl(){try{return Ja.parent!==Ja.self}catch(e){return!0}}function Yl(i){return function(e,t){if(!ql(e))return to[i](null);ql(t)&&(t=to.querySelector(t));var r=zl(t)?t:to;return r[i]&&r[i](e)}}function Xl(){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},e=arguments[3],i=to.createElement(0<arguments.length&&void 0!==arguments[0]?arguments[0]:"div");return Object.getOwnPropertyNames(r).forEach(function(e){var t=r[e];-1!=e.indexOf("aria-")||"role"===e||"type"===e?(Il.warn(ro(Gl,e,t)),i.setAttribute(e,t)):"textContent"===e?Ql(i,t):i[e]=t}),Object.getOwnPropertyNames(t).forEach(function(e){i.setAttribute(e,t[e])}),e&&gu(i,e),i}function Ql(e,t){return void 0===e.textContent?e.innerText=t:e.textContent=t,e}function Jl(e,t){t.firstChild?t.insertBefore(e,t.firstChild):t.appendChild(e)}function Zl(e,t){return Vl(t),e.classList?e.classList.contains(t):(r=t,RegExp("(^|\\s)"+r+"($|\\s)")).test(e.className);var r}function $l(e,t){return e.classList?e.classList.add(t):Zl(e,t)||(e.className=(e.className+" "+t).trim()),e}function eu(e,t){return e.classList?e.classList.remove(t):(Vl(t),e.className=e.className.split(/\s+/).filter(function(e){return e!==t}).join(" ")),e}function tu(e,t,r){var i=Zl(e,t);if("function"==typeof r&&(r=r(e,t)),"boolean"!=typeof r&&(r=!i),r!==i)return r?$l(e,t):eu(e,t),e}function ru(r,i){Object.getOwnPropertyNames(i).forEach(function(e){var t=i[e];null==t||!1===t?r.removeAttribute(e):r.setAttribute(e,!0===t?"":t)})}function iu(e){var t={},r=",autoplay,controls,playsinline,loop,muted,default,defaultMuted,";if(e&&e.attributes&&0<e.attributes.length)for(var i=e.attributes,n=i.length-1;0<=n;n--){var a=i[n].name,o=i[n].value;"boolean"!=typeof e[a]&&-1==r.indexOf(","+a+",")||(o=null!==o),t[a]=o}return t}function nu(e,t){return e.getAttribute(t)}function au(e,t,r){e.setAttribute(t,r)}function ou(e,t){e.removeAttribute(t)}function su(){to.body.focus(),to.onselectstart=function(){return!1}}function lu(){to.onselectstart=function(){return!0}}function uu(e){if(e&&e.getBoundingClientRect&&e.parentNode){var t=e.getBoundingClientRect(),r={};return["bottom","height","left","right","top","width"].forEach(function(e){void 0!==t[e]&&(r[e]=t[e])}),r.height||(r.height=parseFloat(Hl(e,"height"))),r.width||(r.width=parseFloat(Hl(e,"width"))),r}}function cu(e){var t=void 0;if(e.getBoundingClientRect&&e.parentNode&&(t=e.getBoundingClientRect()),!t)return{left:0,top:0};var r=to.documentElement,i=to.body,n=t.top+(Ja.pageYOffset||i.scrollTop)-(r.clientTop||i.clientTop||0);return{left:Math.round(t.left+(Ja.pageXOffset||i.scrollLeft)-(r.clientLeft||i.clientLeft||0)),top:Math.round(n)}}function du(e,t){var r={},i=cu(e),n=e.offsetWidth,a=e.offsetHeight,o=i.left,s=t.pageY,l=t.pageX;return t.changedTouches&&(l=t.changedTouches[0].pageX,s=t.changedTouches[0].pageY),r.y=Math.max(0,Math.min(1,(i.top-s+a)/a)),r.x=Math.max(0,Math.min(1,(l-o)/n)),r}function hu(e){return Bl(e)&&3===e.nodeType}function fu(e){for(;e.firstChild;)e.removeChild(e.firstChild);return e}function pu(e){return"function"==typeof e&&(e=e()),(Array.isArray(e)?e:[e]).map(function(e){return"function"==typeof e&&(e=e()),zl(e)||hu(e)?e:"string"==typeof e&&/\S/.test(e)?to.createTextNode(e):void 0}).filter(function(e){return e})}function gu(t,e){return pu(e).forEach(function(e){return t.appendChild(e)}),t}function mu(e,t){return gu(fu(e),t)}function vu(e){return void 0===e.button&&void 0===e.buttons||(0===e.button&&void 0===e.buttons||0===e.button&&1===e.buttons)}var yu=Yl("querySelector"),_u=Yl("querySelectorAll"),bu=Object.freeze({isReal:Wl,isEl:zl,isInFrame:Kl,createEl:Xl,textContent:Ql,prependTo:Jl,hasClass:Zl,addClass:$l,removeClass:eu,toggleClass:tu,setAttributes:ru,getAttributes:iu,getAttribute:nu,setAttribute:au,removeAttribute:ou,blockTextSelection:su,unblockTextSelection:lu,getBoundingClientRect:uu,findPosition:cu,getPointerPosition:du,isTextNode:hu,emptyEl:fu,normalizeContent:pu,appendContent:gu,insertContent:mu,isSingleLeftClick:vu,$:yu,$$:_u}),Tu=1;function Su(){return Tu++}var Eu={},ku="vdata"+(new Date).getTime();function wu(e){var t=e[ku];return t||(t=e[ku]=Su()),Eu[t]||(Eu[t]={}),Eu[t]}function Cu(e){var t=e[ku];return!!t&&!!Object.getOwnPropertyNames(Eu[t]).length}function Au(t){var e=t[ku];if(e){delete Eu[e];try{delete t[ku]}catch(e){t.removeAttribute?t.removeAttribute(ku):t[ku]=null}}}function Lu(e,t){var r=wu(e);0===r.handlers[t].length&&(delete r.handlers[t],e.removeEventListener?e.removeEventListener(t,r.dispatcher,!1):e.detachEvent&&e.detachEvent("on"+t,r.dispatcher)),Object.getOwnPropertyNames(r.handlers).length<=0&&(delete r.handlers,delete r.dispatcher,delete r.disabled),0===Object.getOwnPropertyNames(r).length&&Au(e)}function Iu(t,r,e,i){e.forEach(function(e){t(r,e,i)})}function Pu(e){function t(){return!0}function r(){return!1}if(!e||!e.isPropagationStopped){var i=e||Ja.event;for(var n in e={},i)"layerX"!==n&&"layerY"!==n&&"keyLocation"!==n&&"webkitMovementX"!==n&&"webkitMovementY"!==n&&("returnValue"===n&&i.preventDefault||(e[n]=i[n]));if(e.target||(e.target=e.srcElement||to),e.relatedTarget||(e.relatedTarget=e.fromElement===e.target?e.toElement:e.fromElement),e.preventDefault=function(){i.preventDefault&&i.preventDefault(),e.returnValue=!1,e.defaultPrevented=!(i.returnValue=!1)},e.defaultPrevented=!1,e.stopPropagation=function(){i.stopPropagation&&i.stopPropagation(),i.cancelBubble=e.cancelBubble=!0,e.isPropagationStopped=t},e.isPropagationStopped=r,e.stopImmediatePropagation=function(){i.stopImmediatePropagation&&i.stopImmediatePropagation(),e.isImmediatePropagationStopped=t,e.stopPropagation()},e.isImmediatePropagationStopped=r,null!=e.clientX){var a=to.documentElement,o=to.body;e.pageX=e.clientX+(a&&a.scrollLeft||o&&o.scrollLeft||0)-(a&&a.clientLeft||o&&o.clientLeft||0),e.pageY=e.clientY+(a&&a.scrollTop||o&&o.scrollTop||0)-(a&&a.clientTop||o&&o.clientTop||0)}e.which=e.charCode||e.keyCode,null!=e.button&&(e.button=1&e.button?0:4&e.button?1:2&e.button?2:0)}return e}var xu=!1;!function(){try{var e=Object.defineProperty({},"passive",{get:function(){xu=!0}});Ja.addEventListener("test",null,e),Ja.removeEventListener("test",null,e)}catch(e){}}();var Ru=["touchstart","touchmove"];function Ou(o,e,t){if(Array.isArray(e))return Iu(Ou,o,e,t);var s=wu(o);if(s.handlers||(s.handlers={}),s.handlers[e]||(s.handlers[e]=[]),t.guid||(t.guid=Su()),s.handlers[e].push(t),s.dispatcher||(s.disabled=!1,s.dispatcher=function(e,t){if(!s.disabled){e=Pu(e);var r=s.handlers[e.type];if(r)for(var i=r.slice(0),n=0,a=i.length;n<a&&!e.isImmediatePropagationStopped();n++)try{i[n].call(o,e,t)}catch(e){Il.error(e)}}}),1===s.handlers[e].length)if(o.addEventListener){var r=!1;xu&&-1<Ru.indexOf(e)&&(r={passive:!0}),o.addEventListener(e,s.dispatcher,r)}else o.attachEvent&&o.attachEvent("on"+e,s.dispatcher)}function Du(e,t,r){if(Cu(e)){var i=wu(e);if(i.handlers){if(Array.isArray(t))return Iu(Du,e,t,r);var n=function(e,t){i.handlers[t]=[],Lu(e,t)};if(void 0!==t){var a=i.handlers[t];if(a)if(r){if(r.guid)for(var o=0;o<a.length;o++)a[o].guid===r.guid&&a.splice(o--,1);Lu(e,t)}else n(e,t)}else for(var s in i.handlers)Object.prototype.hasOwnProperty.call(i.handlers||{},s)&&n(e,s)}}}function Mu(e,t,r){var i=Cu(e)?wu(e):{},n=e.parentNode||e.ownerDocument;if("string"==typeof t?t={type:t,target:e}:t.target||(t.target=e),t=Pu(t),i.dispatcher&&i.dispatcher.call(e,t,r),n&&!t.isPropagationStopped()&&!0===t.bubbles)Mu(n,t,r);else if(!n&&!t.defaultPrevented){var a=wu(t.target);t.target[t.type]&&(a.disabled=!0,"function"==typeof t.target[t.type]&&t.target[t.type](),a.disabled=!1)}return!t.defaultPrevented}function Nu(t,r,i){if(Array.isArray(r))return Iu(Nu,t,r,i);var e=function e(){Du(t,r,e),i.apply(this,arguments)};e.guid=i.guid=i.guid||Su(),Ou(t,r,e)}var Fu=Object.freeze({fixEvent:Pu,on:Ou,off:Du,trigger:Mu,one:Nu}),ju=!1,Bu=void 0,Uu=function(){if(Wl()&&!1!==Bu.options.autoSetup){var e=Array.prototype.slice.call(to.getElementsByTagName("video")),t=Array.prototype.slice.call(to.getElementsByTagName("audio")),r=Array.prototype.slice.call(to.getElementsByTagName("video-js")),i=e.concat(t,r);if(i&&0<i.length)for(var n=0,a=i.length;n<a;n++){var o=i[n];if(!o||!o.getAttribute){Hu(1);break}void 0===o.player&&null!==o.getAttribute("data-setup")&&Bu(o)}else ju||Hu(1)}};function Hu(e,t){t&&(Bu=t),Ja.setTimeout(Uu,e)}Wl()&&"complete"===to.readyState?ju=!0:Nu(Ja,"load",function(){ju=!0});var Gu=function(e){var t=to.createElement("style");return t.className=e,t},qu=function(e,t){e.styleSheet?e.styleSheet.cssText=t:e.textContent=t},Vu=function(e,t,r){t.guid||(t.guid=Su());var i=function(){return t.apply(e,arguments)};return i.guid=r?r+"_"+t.guid:t.guid,i},Wu=function(t,r){var i=Date.now();return function(){var e=Date.now();r<=e-i&&(t.apply(void 0,arguments),i=e)}},zu=function(){};zu.prototype.allowedEvents_={},zu.prototype.addEventListener=zu.prototype.on=function(e,t){var r=this.addEventListener;this.addEventListener=function(){},Ou(this,e,t),this.addEventListener=r},zu.prototype.removeEventListener=zu.prototype.off=function(e,t){Du(this,e,t)},zu.prototype.one=function(e,t){var r=this.addEventListener;this.addEventListener=function(){},Nu(this,e,t),this.addEventListener=r},zu.prototype.dispatchEvent=zu.prototype.trigger=function(e){var t=e.type||e;"string"==typeof e&&(e={type:t}),e=Pu(e),this.allowedEvents_[t]&&this["on"+t]&&this["on"+t](e),Mu(this,e)};var Ku=function(t){return t instanceof zu||!!t.eventBusEl_&&["on","one","off","trigger"].every(function(e){return"function"==typeof t[e]})},Yu=function(e){return"string"==typeof e&&/\S/.test(e)||Array.isArray(e)&&!!e.length},Xu=function(e){if(!e.nodeName&&!Ku(e))throw Error("Invalid target; must be a DOM node or evented object.")},Qu=function(e){if(!Yu(e))throw Error("Invalid event type; must be a non-empty string or array.")},Ju=function(e){if("function"!=typeof e)throw Error("Invalid listener; must be a function.")},Zu=function(e,t){var r=t.length<3||t[0]===e||t[0]===e.eventBusEl_,i=void 0,n=void 0,a=void 0;return a=r?(i=e.eventBusEl_,3<=t.length&&t.shift(),n=t[0],t[1]):(i=t[0],n=t[1],t[2]),Xu(i),Qu(n),Ju(a),{isTargetingSelf:r,target:i,type:n,listener:a=Vu(e,a)}},$u=function(e,t,r,i){Xu(e),e.nodeName?Fu[t](e,r,i):e[t](r,i)},ec={on:function(){for(var e=this,t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];var n=Zu(this,r),a=n.isTargetingSelf,o=n.target,s=n.type,l=n.listener;if($u(o,"on",s,l),!a){var u=function(){return e.off(o,s,l)};u.guid=l.guid;var c=function(){return e.off("dispose",u)};c.guid=l.guid,$u(this,"on","dispose",u),$u(o,"on","dispose",c)}},one:function(){for(var n=this,e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=Zu(this,t),a=i.target,o=i.type,s=i.listener;if(i.isTargetingSelf)$u(a,"one",o,s);else{var l=function e(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];n.off(a,o,e),s.apply(null,r)};l.guid=s.guid,$u(a,"one",o,l)}},off:function(e,t,r){if(!e||Yu(e))Du(this.eventBusEl_,e,t);else{var i=e,n=t;Xu(i),Qu(n),Ju(r),r=Vu(this,r),this.off("dispose",r),i.nodeName?(Du(i,n,r),Du(i,"dispose",r)):Ku(i)&&(i.off(n,r),i.off("dispose",r))}},trigger:function(e,t){return Mu(this.eventBusEl_,e,t)}};function tc(e){var t=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).eventBusKey;if(t){if(!e[t].nodeName)throw Error('The eventBusKey "'+t+'" does not refer to an element.');e.eventBusEl_=e[t]}else e.eventBusEl_=Xl("span",{className:"vjs-event-bus"});return jl(e,ec),e.on("dispose",function(){e.off(),Ja.setTimeout(function(){e.eventBusEl_=null},0)}),e}var rc={state:{},setState:function(e){var r=this;"function"==typeof e&&(e=e());var i=void 0;return Fl(e,function(e,t){r.state[t]!==e&&((i=i||{})[t]={from:r.state[t],to:e}),r.state[t]=e}),i&&Ku(this)&&this.trigger({changes:i,type:"statechanged"}),i}};function ic(e,t){return jl(e,rc),e.state=jl({},e.state,t),"function"==typeof e.handleStateChanged&&Ku(e)&&e.on("statechanged",e.handleStateChanged),e}function nc(e){return"string"!=typeof e?e:e.charAt(0).toUpperCase()+e.slice(1)}function ac(){for(var r={},e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return t.forEach(function(e){e&&Fl(e,function(e,t){r[t]=Ul(e)?(Ul(r[t])||(r[t]={}),ac(r[t],e)):e})}),r}var oc=function(){function l(e,t,r){if(xl(this,l),this.player_=!e&&this.play?e=this:e,this.options_=ac({},this.options_),t=this.options_=ac(this.options_,t),this.id_=t.id||t.el&&t.el.id,!this.id_){var i=e&&e.id&&e.id()||"no_player";this.id_=i+"_component_"+Su()}this.name_=t.name||null,t.el?this.el_=t.el:!1!==t.createEl&&(this.el_=this.createEl()),!1!==t.evented&&tc(this,{eventBusKey:this.el_?"el_":null}),ic(this,this.constructor.defaultState),this.children_=[],this.childIndex_={},!(this.childNameIndex_={})!==t.initChildren&&this.initChildren(),this.ready(r),!1!==t.reportTouchActivity&&this.enableTouchActivity()}return l.prototype.dispose=function(){if(this.trigger({type:"dispose",bubbles:!1}),this.children_)for(var e=this.children_.length-1;0<=e;e--)this.children_[e].dispose&&this.children_[e].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.el_&&(this.el_.parentNode&&this.el_.parentNode.removeChild(this.el_),Au(this.el_),this.el_=null),this.player_=null},l.prototype.player=function(){return this.player_},l.prototype.options=function(e){return Il.warn("this.options() has been deprecated and will be moved to the constructor in 6.0"),e&&(this.options_=ac(this.options_,e)),this.options_},l.prototype.el=function(){return this.el_},l.prototype.createEl=function(e,t,r){return Xl(e,t,r)},l.prototype.localize=function(e,n){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:e,r=this.player_.language&&this.player_.language(),i=this.player_.languages&&this.player_.languages(),a=i&&i[r],o=r&&r.split("-")[0],s=i&&i[o],l=t;return a&&a[e]?l=a[e]:s&&s[e]&&(l=s[e]),n&&(l=l.replace(/\{(\d+)\}/g,function(e,t){var r=n[t-1],i=r;return void 0===r&&(i=e),i})),l},l.prototype.contentEl=function(){return this.contentEl_||this.el_},l.prototype.id=function(){return this.id_},l.prototype.name=function(){return this.name_},l.prototype.children=function(){return this.children_},l.prototype.getChildById=function(e){return this.childIndex_[e]},l.prototype.getChild=function(e){if(e)return e=nc(e),this.childNameIndex_[e]},l.prototype.addChild=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:this.children_.length,i=void 0,n=void 0;if("string"==typeof e){n=nc(e);var a=t.componentClass||n;t.name=n;var o=l.getComponent(a);if(!o)throw Error("Component "+a+" does not exist");if("function"!=typeof o)return null;i=new o(this.player_||this,t)}else i=e;if(this.children_.splice(r,0,i),"function"==typeof i.id&&(this.childIndex_[i.id()]=i),(n=n||i.name&&nc(i.name()))&&(this.childNameIndex_[n]=i),"function"==typeof i.el&&i.el()){var s=this.contentEl().children[r]||null;this.contentEl().insertBefore(i.el(),s)}return i},l.prototype.removeChild=function(e){if("string"==typeof e&&(e=this.getChild(e)),e&&this.children_){for(var t=!1,r=this.children_.length-1;0<=r;r--)if(this.children_[r]===e){t=!0,this.children_.splice(r,1);break}if(t){this.childIndex_[e.id()]=null,this.childNameIndex_[e.name()]=null;var i=e.el();i&&i.parentNode===this.contentEl()&&this.contentEl().removeChild(e.el())}}},l.prototype.initChildren=function(){var n=this,i=this.options_.children;if(i){var a=this.options_,e=void 0,r=l.getComponent("Tech");(e=Array.isArray(i)?i:Object.keys(i)).concat(Object.keys(this.options_).filter(function(t){return!e.some(function(e){return"string"==typeof e?t===e:t===e.name})})).map(function(e){var t=void 0,r=void 0;return r="string"==typeof e?i[t=e]||n.options_[t]||{}:(t=e.name,e),{name:t,opts:r}}).filter(function(e){var t=l.getComponent(e.opts.componentClass||nc(e.name));return t&&!r.isTech(t)}).forEach(function(e){var t=e.name,r=e.opts;if(void 0!==a[t]&&(r=a[t]),!1!==r){!0===r&&(r={}),r.playerOptions=n.options_.playerOptions;var i=n.addChild(t,r);i&&(n[t]=i)}})}},l.prototype.buildCSSClass=function(){return""},l.prototype.ready=function(e){if(e)return this.isReady_?void(1<arguments.length&&void 0!==arguments[1]&&arguments[1]?e.call(this):this.setTimeout(e,1)):(this.readyQueue_=this.readyQueue_||[],void this.readyQueue_.push(e))},l.prototype.triggerReady=function(){this.isReady_=!0,this.setTimeout(function(){var e=this.readyQueue_;this.readyQueue_=[],e&&0<e.length&&e.forEach(function(e){e.call(this)},this),this.trigger("ready")},1)},l.prototype.$=function(e,t){return yu(e,t||this.contentEl())},l.prototype.$$=function(e,t){return _u(e,t||this.contentEl())},l.prototype.hasClass=function(e){return Zl(this.el_,e)},l.prototype.addClass=function(e){$l(this.el_,e)},l.prototype.removeClass=function(e){eu(this.el_,e)},l.prototype.toggleClass=function(e,t){tu(this.el_,e,t)},l.prototype.show=function(){this.removeClass("vjs-hidden")},l.prototype.hide=function(){this.addClass("vjs-hidden")},l.prototype.lockShowing=function(){this.addClass("vjs-lock-showing")},l.prototype.unlockShowing=function(){this.removeClass("vjs-lock-showing")},l.prototype.getAttribute=function(e){return nu(this.el_,e)},l.prototype.setAttribute=function(e,t){au(this.el_,e,t)},l.prototype.removeAttribute=function(e){ou(this.el_,e)},l.prototype.width=function(e,t){return this.dimension("width",e,t)},l.prototype.height=function(e,t){return this.dimension("height",e,t)},l.prototype.dimensions=function(e,t){this.width(e,!0),this.height(t)},l.prototype.dimension=function(e,t,r){if(void 0!==t)return null!==t&&t==t||(t=0),this.el_.style[e]=-1!=(""+t).indexOf("%")||-1!=(""+t).indexOf("px")?t:"auto"===t?"":t+"px",void(r||this.trigger("componentresize"));if(!this.el_)return 0;var i=this.el_.style[e],n=i.indexOf("px");return parseInt(-1!==n?i.slice(0,n):this.el_["offset"+nc(e)],10)},l.prototype.currentDimension=function(e){var t=0;if("width"!==e&&"height"!==e)throw Error("currentDimension only accepts width or height value");if("function"==typeof Ja.getComputedStyle){var r=Ja.getComputedStyle(this.el_);t=r.getPropertyValue(e)||r[e]}if(0===(t=parseFloat(t))){var i="offset"+nc(e);t=this.el_[i]}return t},l.prototype.currentDimensions=function(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}},l.prototype.currentWidth=function(){return this.currentDimension("width")},l.prototype.currentHeight=function(){return this.currentDimension("height")},l.prototype.focus=function(){this.el_.focus()},l.prototype.blur=function(){this.el_.blur()},l.prototype.emitTapEvents=function(){var t=0,i=null,n=void 0;this.on("touchstart",function(e){1===e.touches.length&&(i={pageX:e.touches[0].pageX,pageY:e.touches[0].pageY},t=(new Date).getTime(),n=!0)}),this.on("touchmove",function(e){if(1<e.touches.length)n=!1;else if(i){var t=e.touches[0].pageX-i.pageX,r=e.touches[0].pageY-i.pageY;10<Math.sqrt(t*t+r*r)&&(n=!1)}});var e=function(){n=!1};this.on("touchleave",e),this.on("touchcancel",e),this.on("touchend",function(e){!(i=null)===n&&((new Date).getTime()-t<200&&(e.preventDefault(),this.trigger("tap")))})},l.prototype.enableTouchActivity=function(){if(this.player()&&this.player().reportUserActivity){var t=Vu(this.player(),this.player().reportUserActivity),r=void 0;this.on("touchstart",function(){t(),this.clearInterval(r),r=this.setInterval(t,250)});var e=function(e){t(),this.clearInterval(r)};this.on("touchmove",t),this.on("touchend",e),this.on("touchcancel",e)}},l.prototype.setTimeout=function(e,t){var r,i,n=this;return e=Vu(this,e),r=Ja.setTimeout(function(){n.off("dispose",i),e()},t),(i=function(){return n.clearTimeout(r)}).guid="vjs-timeout-"+r,this.on("dispose",i),r},l.prototype.clearTimeout=function(e){Ja.clearTimeout(e);var t=function(){};return t.guid="vjs-timeout-"+e,this.off("dispose",t),e},l.prototype.setInterval=function(e,t){var r=this;e=Vu(this,e);var i=Ja.setInterval(e,t),n=function(){return r.clearInterval(i)};return n.guid="vjs-interval-"+i,this.on("dispose",n),i},l.prototype.clearInterval=function(e){Ja.clearInterval(e);var t=function(){};return t.guid="vjs-interval-"+e,this.off("dispose",t),e},l.prototype.requestAnimationFrame=function(e){var t,r,i=this;return this.supportsRaf_?(e=Vu(this,e),t=Ja.requestAnimationFrame(function(){i.off("dispose",r),e()}),(r=function(){return i.cancelAnimationFrame(t)}).guid="vjs-raf-"+t,this.on("dispose",r),t):this.setTimeout(e,1e3/60)},l.prototype.cancelAnimationFrame=function(e){if(this.supportsRaf_){Ja.cancelAnimationFrame(e);var t=function(){};return t.guid="vjs-raf-"+e,this.off("dispose",t),e}return this.clearTimeout(e)},l.registerComponent=function(e,t){if("string"!=typeof e||!e)throw Error('Illegal component name, "'+e+'"; must be a non-empty string.');var r=l.getComponent("Tech"),i=r&&r.isTech(t),n=l===t||l.prototype.isPrototypeOf(t.prototype);if(i||!n){throw Error('Illegal component, "'+e+'"; '+(i?"techs must be registered using Tech.registerTech()":"must be a Component subclass")+".")}e=nc(e),l.components_||(l.components_={});var a=l.getComponent("Player");if("Player"===e&&a&&a.players){var o=a.players,s=Object.keys(o);if(o&&0<s.length&&s.map(function(e){return o[e]}).every(Boolean))throw Error("Can not register Player component after player has been created.")}return l.components_[e]=t},l.getComponent=function(e){if(e)return e=nc(e),l.components_&&l.components_[e]?l.components_[e]:void 0},l}();oc.prototype.supportsRaf_="function"==typeof Ja.requestAnimationFrame&&"function"==typeof Ja.cancelAnimationFrame,oc.registerComponent("Component",oc);var sc,lc,uc,cc,dc=Ja.navigator&&Ja.navigator.userAgent||"",hc=/AppleWebKit\/([\d.]+)/i.exec(dc),fc=hc?parseFloat(hc.pop()):null,pc=/iPad/i.test(dc),gc=/iPhone/i.test(dc)&&!pc,mc=/iPod/i.test(dc),vc=gc||pc||mc,yc=(sc=dc.match(/OS (\d+)_/i))&&sc[1]?sc[1]:null,_c=/Android/i.test(dc),bc=function(){var e=dc.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e)return null;var t=e[1]&&parseFloat(e[1]);return t&&(e[2]&&parseFloat(e[2]))?parseFloat(e[1]+"."+e[2]):t||null}(),Tc=_c&&bc<5&&fc<537,Sc=/Firefox/i.test(dc),Ec=/Edge/i.test(dc),kc=!Ec&&(/Chrome/i.test(dc)||/CriOS/i.test(dc)),wc=(lc=dc.match(/(Chrome|CriOS)\/(\d+)/))&&lc[2]?parseFloat(lc[2]):null,Cc=(uc=/MSIE\s(\d+)\.\d/.exec(dc),!(cc=uc&&parseFloat(uc[1]))&&/Trident\/7.0/i.test(dc)&&/rv:11.0/.test(dc)&&(cc=11),cc),Ac=/Safari/i.test(dc)&&!kc&&!_c&&!Ec,Lc=(Ac||vc)&&!kc,Ic=Wl()&&("ontouchstart"in Ja||Ja.navigator.maxTouchPoints||Ja.DocumentTouch&&Ja.document instanceof Ja.DocumentTouch),Pc=Object.freeze({IS_IPAD:pc,IS_IPHONE:gc,IS_IPOD:mc,IS_IOS:vc,IOS_VERSION:yc,IS_ANDROID:_c,ANDROID_VERSION:bc,IS_NATIVE_ANDROID:Tc,IS_FIREFOX:Sc,IS_EDGE:Ec,IS_CHROME:kc,CHROME_VERSION:wc,IE_VERSION:Cc,IS_SAFARI:Ac,IS_ANY_SAFARI:Lc,TOUCH_ENABLED:Ic});function xc(e,t,r,i){return function(e,t,r){if("number"!=typeof t||t<0||r<t)throw Error("Failed to execute '"+e+"' on 'TimeRanges': The index provided ("+t+") is non-numeric or out of bounds (0-"+r+").")}(e,i,r.length-1),r[i][t]}function Rc(e){return void 0===e||0===e.length?{length:0,start:function(){throw Error("This TimeRanges object is empty")},end:function(){throw Error("This TimeRanges object is empty")}}:{length:e.length,start:xc.bind(null,"start",0,e),end:xc.bind(null,"end",1,e)}}function Oc(e,t){return Array.isArray(e)?Rc(e):void 0===e||void 0===t?Rc():Rc([[e,t]])}function Dc(e,t){var r=0,i=void 0,n=void 0;if(!t)return 0;e&&e.length||(e=Oc(0,0));for(var a=0;a<e.length;a++)i=e.start(a),t<(n=e.end(a))&&(n=t),r+=n-i;return r/t}for(var Mc={},Nc=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],Fc=Nc[0],jc=void 0,Bc=0;Bc<Nc.length;Bc++)if(Nc[Bc][1]in to){jc=Nc[Bc];break}if(jc)for(var Uc=0;Uc<jc.length;Uc++)Mc[Fc[Uc]]=jc[Uc];function Hc(e){if(e instanceof Hc)return e;"number"==typeof e?this.code=e:"string"==typeof e?this.message=e:Bl(e)&&("number"==typeof e.code&&(this.code=e.code),jl(this,e)),this.message||(this.message=Hc.defaultMessages[this.code]||"")}Hc.prototype.code=0,Hc.prototype.message="",Hc.prototype.status=null,Hc.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],Hc.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(var Gc=0;Gc<Hc.errorTypes.length;Gc++)Hc[Hc.errorTypes[Gc]]=Gc,Hc.prototype[Hc.errorTypes[Gc]]=Gc;function qc(e){return null!=e&&"function"==typeof e.then}function Vc(e){qc(e)&&e.then(null,function(e){})}var Wc=function(i){return["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce(function(e,t,r){return i[t]&&(e[t]=i[t]),e},{cues:i.cues&&Array.prototype.map.call(i.cues,function(e){return{startTime:e.startTime,endTime:e.endTime,text:e.text,id:e.id}})})},zc=function(e){var t=e.$$("track"),r=Array.prototype.map.call(t,function(e){return e.track});return Array.prototype.map.call(t,function(e){var t=Wc(e.track);return e.src&&(t.src=e.src),t}).concat(Array.prototype.filter.call(e.textTracks(),function(e){return-1==r.indexOf(e)}).map(Wc))},Kc=function(e,r){return e.forEach(function(e){var t=r.addRemoteTextTrack(e).track;!e.src&&e.cues&&e.cues.forEach(function(e){return t.addCue(e)})}),r.textTracks()},Yc="vjs-modal-dialog",Xc=function(i){function n(e,t){xl(this,n);var r=Ol(this,i.call(this,e,t));return r.opened_=r.hasBeenOpened_=r.hasBeenFilled_=!1,r.closeable(!r.options_.uncloseable),r.content(r.options_.content),r.contentEl_=Xl("div",{className:Yc+"-content"},{role:"document"}),r.descEl_=Xl("p",{className:Yc+"-description vjs-control-text",id:r.el().getAttribute("aria-describedby")}),Ql(r.descEl_,r.description()),r.el_.appendChild(r.descEl_),r.el_.appendChild(r.contentEl_),r}return Rl(n,i),n.prototype.createEl=function(){return i.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":this.id()+"_description","aria-hidden":"true","aria-label":this.label(),role:"dialog"})},n.prototype.dispose=function(){this.contentEl_=null,this.descEl_=null,this.previouslyActiveEl_=null,i.prototype.dispose.call(this)},n.prototype.buildCSSClass=function(){return Yc+" vjs-hidden "+i.prototype.buildCSSClass.call(this)},n.prototype.handleKeyPress=function(e){27===e.which&&this.closeable()&&this.close()},n.prototype.label=function(){return this.localize(this.options_.label||"Modal Window")},n.prototype.description=function(){var e=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(e+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),e},n.prototype.open=function(){if(!this.opened_){var e=this.player();this.trigger("beforemodalopen"),this.opened_=!0,(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_)&&this.fill(),this.wasPlaying_=!e.paused(),this.options_.pauseOnOpen&&this.wasPlaying_&&e.pause(),this.closeable()&&this.on(this.el_.ownerDocument,"keydown",Vu(this,this.handleKeyPress)),this.hadControls_=e.controls(),e.controls(!1),this.show(),this.conditionalFocus_(),this.el().setAttribute("aria-hidden","false"),this.trigger("modalopen"),this.hasBeenOpened_=!0}},n.prototype.opened=function(e){return"boolean"==typeof e&&this[e?"open":"close"](),this.opened_},n.prototype.close=function(){if(this.opened_){var e=this.player();this.trigger("beforemodalclose"),this.opened_=!1,this.wasPlaying_&&this.options_.pauseOnOpen&&e.play(),this.closeable()&&this.off(this.el_.ownerDocument,"keydown",Vu(this,this.handleKeyPress)),this.hadControls_&&e.controls(!0),this.hide(),this.el().setAttribute("aria-hidden","true"),this.trigger("modalclose"),this.conditionalBlur_(),this.options_.temporary&&this.dispose()}},n.prototype.closeable=function(e){if("boolean"==typeof e){var t=this.closeable_=!!e,r=this.getChild("closeButton");if(t&&!r){var i=this.contentEl_;this.contentEl_=this.el_,r=this.addChild("closeButton",{controlText:"Close Modal Dialog"}),this.contentEl_=i,this.on(r,"close",this.close)}!t&&r&&(this.off(r,"close",this.close),this.removeChild(r),r.dispose())}return this.closeable_},n.prototype.fill=function(){this.fillWith(this.content())},n.prototype.fillWith=function(e){var t=this.contentEl(),r=t.parentNode,i=t.nextSibling;this.trigger("beforemodalfill"),this.hasBeenFilled_=!0,r.removeChild(t),this.empty(),mu(t,e),this.trigger("modalfill"),i?r.insertBefore(t,i):r.appendChild(t);var n=this.getChild("closeButton");n&&r.appendChild(n.el_)},n.prototype.empty=function(){this.trigger("beforemodalempty"),fu(this.contentEl()),this.trigger("modalempty")},n.prototype.content=function(e){return void 0!==e&&(this.content_=e),this.content_},n.prototype.conditionalFocus_=function(){var e=to.activeElement,t=this.player_.el_;this.previouslyActiveEl_=null,(t.contains(e)||t===e)&&(this.previouslyActiveEl_=e,this.focus(),this.on(to,"keydown",this.handleKeyDown))},n.prototype.conditionalBlur_=function(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null),this.off(to,"keydown",this.handleKeyDown)},n.prototype.handleKeyDown=function(e){if(9===e.which){for(var t=this.focusableEls_(),r=this.el_.querySelector(":focus"),i=void 0,n=0;n<t.length;n++)if(r===t[n]){i=n;break}to.activeElement===this.el_&&(i=0),e.shiftKey&&0===i?(t[t.length-1].focus(),e.preventDefault()):e.shiftKey||i!==t.length-1||(t[0].focus(),e.preventDefault())}},n.prototype.focusableEls_=function(){var e=this.el_.querySelectorAll("*");return Array.prototype.filter.call(e,function(e){return(e instanceof Ja.HTMLAnchorElement||e instanceof Ja.HTMLAreaElement)&&e.hasAttribute("href")||(e instanceof Ja.HTMLInputElement||e instanceof Ja.HTMLSelectElement||e instanceof Ja.HTMLTextAreaElement||e instanceof Ja.HTMLButtonElement)&&!e.hasAttribute("disabled")||e instanceof Ja.HTMLIFrameElement||e instanceof Ja.HTMLObjectElement||e instanceof Ja.HTMLEmbedElement||e.hasAttribute("tabindex")&&-1!==e.getAttribute("tabindex")||e.hasAttribute("contenteditable")})},n}(oc);Xc.prototype.options_={pauseOnOpen:!0,temporary:!0},oc.registerComponent("ModalDialog",Xc);var Qc=function(i){function n(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];xl(this,n);var t=Ol(this,i.call(this));t.tracks_=[],Object.defineProperty(t,"length",{get:function(){return this.tracks_.length}});for(var r=0;r<e.length;r++)t.addTrack(e[r]);return t}return Rl(n,i),n.prototype.addTrack=function(e){var t=this.tracks_.length;""+t in this||Object.defineProperty(this,t,{get:function(){return this.tracks_[t]}}),-1==this.tracks_.indexOf(e)&&(this.tracks_.push(e),this.trigger({track:e,type:"addtrack"}))},n.prototype.removeTrack=function(e){for(var t=void 0,r=0,i=this.length;r<i;r++)if(this[r]===e){(t=this[r]).off&&t.off(),this.tracks_.splice(r,1);break}t&&this.trigger({track:t,type:"removetrack"})},n.prototype.getTrackById=function(e){for(var t=null,r=0,i=this.length;r<i;r++){var n=this[r];if(n.id===e){t=n;break}}return t},n}(zu);for(var Jc in Qc.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack"},Qc.prototype.allowedEvents_)Qc.prototype["on"+Jc]=null;var Zc=function(e,t){for(var r=0;r<e.length;r++)Object.keys(e[r]).length&&t.id!==e[r].id&&(e[r].enabled=!1)},$c=function(i){function n(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];xl(this,n);for(var t=e.length-1;0<=t;t--)if(e[t].enabled){Zc(e,e[t]);break}var r=Ol(this,i.call(this,e));return r.changing_=!1,r}return Rl(n,i),n.prototype.addTrack=function(e){var t=this;e.enabled&&Zc(this,e),i.prototype.addTrack.call(this,e),e.addEventListener&&e.addEventListener("enabledchange",function(){t.changing_||(t.changing_=!0,Zc(t,e),t.changing_=!1,t.trigger("change"))})},n}(Qc),ed=function(e,t){for(var r=0;r<e.length;r++)Object.keys(e[r]).length&&t.id!==e[r].id&&(e[r].selected=!1)},td=function(i){function n(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];xl(this,n);for(var t=e.length-1;0<=t;t--)if(e[t].selected){ed(e,e[t]);break}var r=Ol(this,i.call(this,e));return r.changing_=!1,Object.defineProperty(r,"selectedIndex",{get:function(){for(var e=0;e<this.length;e++)if(this[e].selected)return e;return-1},set:function(){}}),r}return Rl(n,i),n.prototype.addTrack=function(e){var t=this;e.selected&&ed(this,e),i.prototype.addTrack.call(this,e),e.addEventListener&&e.addEventListener("selectedchange",function(){t.changing_||(t.changing_=!0,ed(t,e),t.changing_=!1,t.trigger("change"))})},n}(Qc),rd=function(t){function e(){return xl(this,e),Ol(this,t.apply(this,arguments))}return Rl(e,t),e.prototype.addTrack=function(e){t.prototype.addTrack.call(this,e),e.addEventListener("modechange",Vu(this,function(){this.trigger("change")}));-1==["metadata","chapters"].indexOf(e.kind)&&e.addEventListener("modechange",Vu(this,function(){this.trigger("selectedlanguagechange")}))},e}(Qc),id=function(){function i(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];xl(this,i),this.trackElements_=[],Object.defineProperty(this,"length",{get:function(){return this.trackElements_.length}});for(var t=0,r=e.length;t<r;t++)this.addTrackElement_(e[t])}return i.prototype.addTrackElement_=function(e){var t=this.trackElements_.length;""+t in this||Object.defineProperty(this,t,{get:function(){return this.trackElements_[t]}}),-1==this.trackElements_.indexOf(e)&&this.trackElements_.push(e)},i.prototype.getTrackElementByTrack_=function(e){for(var t=void 0,r=0,i=this.trackElements_.length;r<i;r++)if(e===this.trackElements_[r].track){t=this.trackElements_[r];break}return t},i.prototype.removeTrackElement_=function(e){for(var t=0,r=this.trackElements_.length;t<r;t++)if(e===this.trackElements_[t]){this.trackElements_.splice(t,1);break}},i}(),nd=function(){function t(e){xl(this,t),t.prototype.setCues_.call(this,e),Object.defineProperty(this,"length",{get:function(){return this.length_}})}return t.prototype.setCues_=function(e){var t=this.length||0,r=0,i=e.length;this.cues_=e,this.length_=e.length;var n=function(e){""+e in this||Object.defineProperty(this,""+e,{get:function(){return this.cues_[e]}})};if(t<i)for(r=t;r<i;r++)n.call(this,r)},t.prototype.getCueById=function(e){for(var t=null,r=0,i=this.length;r<i;r++){var n=this[r];if(n.id===e){t=n;break}}return t},t}(),ad={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},od={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},sd={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},ld={disabled:"disabled",hidden:"hidden",showing:"showing"},ud=function(a){function o(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};xl(this,o);var t=Ol(this,a.call(this)),r={id:e.id||"vjs_track_"+Su(),kind:e.kind||"",label:e.label||"",language:e.language||""},i=function(e){Object.defineProperty(t,e,{get:function(){return r[e]},set:function(){}})};for(var n in r)i(n);return t}return Rl(o,a),o}(zu),cd=function(e){var t=["protocol","hostname","port","pathname","search","hash","host"],r=to.createElement("a");r.href=e;var i=""===r.host&&"file:"!==r.protocol,n=void 0;i&&((n=to.createElement("div")).innerHTML='<a href="'+e+'"></a>',r=n.firstChild,n.setAttribute("style","display:none; position:absolute;"),to.body.appendChild(n));for(var a={},o=0;o<7;o++)a[t[o]]=r[t[o]];return"http:"===a.protocol&&(a.host=a.host.replace(/:80$/,"")),"https:"===a.protocol&&(a.host=a.host.replace(/:443$/,"")),a.protocol||(a.protocol=Ja.location.protocol),i&&to.body.removeChild(n),a},dd=function(e){if(!e.match(/^https?:\/\//)){var t=to.createElement("div");t.innerHTML='<a href="'+e+'">x</a>',e=t.firstChild.href}return e},hd=function(e){if("string"==typeof e){var t=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/i.exec(e);if(t)return t.pop().toLowerCase()}return""},fd=function(e){var t=Ja.location,r=cd(e);return(":"===r.protocol?t.protocol:r.protocol)+r.host!==t.protocol+t.host},pd=Object.freeze({parseUrl:cd,getAbsoluteURL:dd,getFileExtension:hd,isCrossOrigin:fd}),gd=function(e,t){var r=new Ja.WebVTT.Parser(Ja,Ja.vttjs,Ja.WebVTT.StringDecoder()),i=[];r.oncue=function(e){t.addCue(e)},r.onparsingerror=function(e){i.push(e)},r.onflush=function(){t.trigger({type:"loadeddata",target:t})},r.parse(e),0<i.length&&(Ja.console&&Ja.console.groupCollapsed&&Ja.console.groupCollapsed("Text Track parsing errors for "+t.src),i.forEach(function(e){return Il.error(e)}),Ja.console&&Ja.console.groupEnd&&Ja.console.groupEnd()),r.flush()},md=function(u){function c(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(xl(this,c),!e.tech)throw Error("A tech was not provided.");var t=ac(e,{kind:sd[e.kind]||"subtitles",language:e.language||e.srclang||""}),r=ld[t.mode]||"disabled",i=t.default;"metadata"!==t.kind&&"chapters"!==t.kind||(r="hidden");var n=Ol(this,u.call(this,t));n.tech_=t.tech,n.cues_=[],n.activeCues_=[];var a=new nd(n.cues_),o=new nd(n.activeCues_),s=!1,l=Vu(n,function(){s&&(this.trigger("cuechange"),s=!1)});return"disabled"!==r&&n.tech_.ready(function(){n.tech_.on("timeupdate",l)},!0),Object.defineProperties(n,{default:{get:function(){return i},set:function(){}},mode:{get:function(){return r},set:function(e){var t=this;ld[e]&&("showing"===(r=e)&&this.tech_.ready(function(){t.tech_.on("timeupdate",l)},!0),this.trigger("modechange"))}},cues:{get:function(){return this.loaded_?a:null},set:function(){}},activeCues:{get:function(){if(!this.loaded_)return null;if(0===this.cues.length)return o;for(var e=this.tech_.currentTime(),t=[],r=0,i=this.cues.length;r<i;r++){var n=this.cues[r];n.startTime<=e&&e<=n.endTime?t.push(n):n.startTime===n.endTime&&n.startTime<=e&&e<=n.startTime+.5&&t.push(n)}if(s=!1,t.length!==this.activeCues_.length)s=!0;else for(var a=0;a<t.length;a++)-1==this.activeCues_.indexOf(t[a])&&(s=!0);return this.activeCues_=t,o.setCues_(this.activeCues_),o},set:function(){}}}),t.src?(n.src=t.src,function(e,n){var t={uri:e},r=fd(e);r&&(t.cors=r),_o(t,Vu(this,function(e,t,r){if(e)return Il.error(e,t);if(n.loaded_=!0,"function"!=typeof Ja.WebVTT){if(n.tech_){var i=function(){return gd(r,n)};n.tech_.on("vttjsloaded",i),n.tech_.on("vttjserror",function(){Il.error("vttjs failed to load, stopping trying to process "+n.src),n.tech_.off("vttjsloaded",i)})}}else gd(r,n)}))}(t.src,n)):n.loaded_=!0,n}return Rl(c,u),c.prototype.addCue=function(e){var t=e;if(Ja.vttjs&&!(e instanceof Ja.vttjs.VTTCue)){for(var r in t=new Ja.vttjs.VTTCue(e.startTime,e.endTime,e.text),e)r in t||(t[r]=e[r]);t.id=e.id,t.originalCue_=e}for(var i=this.tech_.textTracks(),n=0;n<i.length;n++)i[n]!==this&&i[n].removeCue(t);this.cues_.push(t),this.cues.setCues_(this.cues_)},c.prototype.removeCue=function(e){for(var t=this.cues_.length;t--;){var r=this.cues_[t];if(r===e||r.originalCue_&&r.originalCue_===e){this.cues_.splice(t,1),this.cues.setCues_(this.cues_);break}}},c}(ud);md.prototype.allowedEvents_={cuechange:"cuechange"};var vd=function(n){function a(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};xl(this,a);var t=ac(e,{kind:od[e.kind]||""}),r=Ol(this,n.call(this,t)),i=!1;return Object.defineProperty(r,"enabled",{get:function(){return i},set:function(e){"boolean"==typeof e&&e!==i&&(i=e,this.trigger("enabledchange"))}}),t.enabled&&(r.enabled=t.enabled),r.loaded_=!0,r}return Rl(a,n),a}(ud),yd=function(n){function a(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};xl(this,a);var t=ac(e,{kind:ad[e.kind]||""}),r=Ol(this,n.call(this,t)),i=!1;return Object.defineProperty(r,"selected",{get:function(){return i},set:function(e){"boolean"==typeof e&&e!==i&&(i=e,this.trigger("selectedchange"))}}),t.selected&&(r.selected=t.selected),r}return Rl(a,n),a}(ud),_d=function(n){function a(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};xl(this,a);var t=Ol(this,n.call(this)),r=void 0,i=new md(e);return t.kind=i.kind,t.src=i.src,t.srclang=i.language,t.label=i.label,t.default=i.default,Object.defineProperties(t,{readyState:{get:function(){return r}},track:{get:function(){return i}}}),r=0,i.addEventListener("loadeddata",function(){r=2,t.trigger({type:"load",target:t})}),t}return Rl(a,n),a}(zu);_d.prototype.allowedEvents_={load:"load"},_d.NONE=0,_d.LOADING=1,_d.LOADED=2,_d.ERROR=3;var bd={audio:{ListClass:$c,TrackClass:vd,capitalName:"Audio"},video:{ListClass:td,TrackClass:yd,capitalName:"Video"},text:{ListClass:rd,TrackClass:md,capitalName:"Text"}};Object.keys(bd).forEach(function(e){bd[e].getterName=e+"Tracks",bd[e].privateName=e+"Tracks_"});var Td={remoteText:{ListClass:rd,TrackClass:md,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:id,TrackClass:_d,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}},Sd=ac(bd,Td);Td.names=Object.keys(Td),bd.names=Object.keys(bd),Sd.names=[].concat(Td.names).concat(bd.names);var Ed=function(t){function n(){var r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};xl(this,n),r.reportTouchActivity=!1;var i=Ol(this,t.call(this,null,r,e));return i.hasStarted_=!1,i.on("playing",function(){this.hasStarted_=!0}),i.on("loadstart",function(){this.hasStarted_=!1}),Sd.names.forEach(function(e){var t=Sd[e];r&&r[t.getterName]&&(i[t.privateName]=r[t.getterName])}),i.featuresProgressEvents||i.manualProgressOn(),i.featuresTimeupdateEvents||i.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach(function(e){!1===r["native"+e+"Tracks"]&&(i["featuresNative"+e+"Tracks"]=!1)}),!1===r.nativeCaptions||!1===r.nativeTextTracks?i.featuresNativeTextTracks=!1:!0!==r.nativeCaptions&&!0!==r.nativeTextTracks||(i.featuresNativeTextTracks=!0),i.featuresNativeTextTracks||i.emulateTextTracks(),i.autoRemoteTextTracks_=new Sd.text.ListClass,i.initTrackListeners(),r.nativeControlsForTouch||i.emitTapEvents(),i.constructor&&(i.name_=i.constructor.name||"Unknown Tech"),i}return Rl(n,t),n.prototype.triggerSourceset=function(e){var t=this;this.isReady_||this.one("ready",function(){return t.setTimeout(function(){return t.triggerSourceset(e)},1)}),this.trigger({src:e,type:"sourceset"})},n.prototype.manualProgressOn=function(){this.on("durationchange",this.onDurationChange),this.manualProgress=!0,this.one("ready",this.trackProgress)},n.prototype.manualProgressOff=function(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange)},n.prototype.trackProgress=function(e){this.stopTrackingProgress(),this.progressInterval=this.setInterval(Vu(this,function(){var e=this.bufferedPercent();this.bufferedPercent_!==e&&this.trigger("progress"),1===(this.bufferedPercent_=e)&&this.stopTrackingProgress()}),500)},n.prototype.onDurationChange=function(e){this.duration_=this.duration()},n.prototype.buffered=function(){return Oc(0,0)},n.prototype.bufferedPercent=function(){return Dc(this.buffered(),this.duration_)},n.prototype.stopTrackingProgress=function(){this.clearInterval(this.progressInterval)},n.prototype.manualTimeUpdatesOn=function(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime),this.on("pause",this.stopTrackingCurrentTime)},n.prototype.manualTimeUpdatesOff=function(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime),this.off("pause",this.stopTrackingCurrentTime)},n.prototype.trackCurrentTime=function(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},250)},n.prototype.stopTrackingCurrentTime=function(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},n.prototype.dispose=function(){this.clearTracks(bd.names),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),t.prototype.dispose.call(this)},n.prototype.clearTracks=function(e){var n=this;(e=[].concat(e)).forEach(function(e){for(var t=n[e+"Tracks"]()||[],r=t.length;r--;){var i=t[r];"text"===e&&n.removeRemoteTextTrack(i),t.removeTrack(i)}})},n.prototype.cleanupAutoTextTracks=function(){for(var e=this.autoRemoteTextTracks_||[],t=e.length;t--;){this.removeRemoteTextTrack(e[t])}},n.prototype.reset=function(){},n.prototype.error=function(e){return void 0!==e&&(this.error_=new Hc(e),this.trigger("error")),this.error_},n.prototype.played=function(){return this.hasStarted_?Oc(0,0):Oc()},n.prototype.setCurrentTime=function(){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},n.prototype.initTrackListeners=function(){var i=this;bd.names.forEach(function(e){var t=function(){i.trigger(e+"trackchange")},r=i[bd[e].getterName]();r.addEventListener("removetrack",t),r.addEventListener("addtrack",t),i.on("dispose",function(){r.removeEventListener("removetrack",t),r.removeEventListener("addtrack",t)})})},n.prototype.addWebVttScript_=function(){var e=this;if(!Ja.WebVTT)if(to.body.contains(this.el())){if(!this.options_["vtt.js"]&&Ul(Qo)&&0<Object.keys(Qo).length)return void this.trigger("vttjsloaded");var t=to.createElement("script");t.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js",t.onload=function(){e.trigger("vttjsloaded")},t.onerror=function(){e.trigger("vttjserror")},this.on("dispose",function(){t.onload=null,t.onerror=null}),Ja.WebVTT=!0,this.el().parentNode.appendChild(t)}else this.ready(this.addWebVttScript_)},n.prototype.emulateTextTracks=function(){var e=this,r=this.textTracks(),t=this.remoteTextTracks(),i=function(e){return r.addTrack(e.track)},n=function(e){return r.removeTrack(e.track)};t.on("addtrack",i),t.on("removetrack",n),this.addWebVttScript_();var a=function(){return e.trigger("texttrackchange")},o=function(){a();for(var e=0;e<r.length;e++){var t=r[e];t.removeEventListener("cuechange",a),"showing"===t.mode&&t.addEventListener("cuechange",a)}};o(),r.addEventListener("change",o),r.addEventListener("addtrack",o),r.addEventListener("removetrack",o),this.on("dispose",function(){t.off("addtrack",i),t.off("removetrack",n),r.removeEventListener("change",o),r.removeEventListener("addtrack",o),r.removeEventListener("removetrack",o);for(var e=0;e<r.length;e++){r[e].removeEventListener("cuechange",a)}})},n.prototype.addTextTrack=function(e,t,r){if(!e)throw Error("TextTrack kind is required but was not provided");return function(e,t,r,i){var n=4<arguments.length&&void 0!==arguments[4]?arguments[4]:{},a=e.textTracks();n.kind=t,r&&(n.label=r),i&&(n.language=i),n.tech=e;var o=new Sd.text.TrackClass(n);return a.addTrack(o),o}(this,e,t,r)},n.prototype.createRemoteTextTrack=function(e){var t=ac(e,{tech:this});return new Td.remoteTextEl.TrackClass(t)},n.prototype.addRemoteTextTrack=function(){var e=this,t=arguments[1],r=this.createRemoteTextTrack(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{});return!0!==t&&!1!==t&&(Il.warn('Calling addRemoteTextTrack without explicitly setting the "manualCleanup" parameter to `true` is deprecated and default to `false` in future version of video.js'),t=!0),this.remoteTextTrackEls().addTrackElement_(r),this.remoteTextTracks().addTrack(r.track),!0!==t&&this.ready(function(){return e.autoRemoteTextTracks_.addTrack(r.track)}),r},n.prototype.removeRemoteTextTrack=function(e){var t=this.remoteTextTrackEls().getTrackElementByTrack_(e);this.remoteTextTrackEls().removeTrackElement_(t),this.remoteTextTracks().removeTrack(e),this.autoRemoteTextTracks_.removeTrack(e)},n.prototype.getVideoPlaybackQuality=function(){return{}},n.prototype.setPoster=function(){},n.prototype.playsinline=function(){},n.prototype.setPlaysinline=function(){},n.prototype.overrideNativeAudioTracks=function(){},n.prototype.overrideNativeVideoTracks=function(){},n.prototype.canPlayType=function(){return""},n.canPlayType=function(){return""},n.canPlaySource=function(e,t){return n.canPlayType(e.type)},n.isTech=function(e){return e.prototype instanceof n||e instanceof n||e===n},n.registerTech=function(e,t){if(n.techs_||(n.techs_={}),!n.isTech(t))throw Error("Tech "+e+" must be a Tech");if(!n.canPlayType)throw Error("Techs must have a static canPlayType method on them");if(!n.canPlaySource)throw Error("Techs must have a static canPlaySource method on them");return e=nc(e),n.techs_[e]=t,"Tech"!==e&&n.defaultTechOrder_.push(e),t},n.getTech=function(e){if(e)return e=nc(e),n.techs_&&n.techs_[e]?n.techs_[e]:Ja&&Ja.videojs&&Ja.videojs[e]?(Il.warn("The "+e+" tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)"),Ja.videojs[e]):void 0},n}(oc);Sd.names.forEach(function(e){var t=Sd[e];Ed.prototype[t.getterName]=function(){return this[t.privateName]=this[t.privateName]||new t.ListClass,this[t.privateName]}}),Ed.prototype.featuresVolumeControl=!0,Ed.prototype.featuresMuteControl=!0,Ed.prototype.featuresFullscreenResize=!1,Ed.prototype.featuresPlaybackRate=!1,Ed.prototype.featuresProgressEvents=!1,Ed.prototype.featuresSourceset=!1,Ed.prototype.featuresTimeupdateEvents=!1,Ed.prototype.featuresNativeTextTracks=!1,Ed.withSourceHandlers=function(n){n.registerSourceHandler=function(e,t){var r=n.sourceHandlers;r||(r=n.sourceHandlers=[]),void 0===t&&(t=r.length),r.splice(t,0,e)},n.canPlayType=function(e){for(var t=n.sourceHandlers||[],r=void 0,i=0;i<t.length;i++)if(r=t[i].canPlayType(e))return r;return""},n.selectSourceHandler=function(e,t){for(var r=n.sourceHandlers||[],i=0;i<r.length;i++)if(r[i].canHandleSource(e,t))return r[i];return null},n.canPlaySource=function(e,t){var r=n.selectSourceHandler(e,t);return r?r.canHandleSource(e,t):""};["seekable","seeking","duration"].forEach(function(e){var t=this[e];"function"==typeof t&&(this[e]=function(){return this.sourceHandler_&&this.sourceHandler_[e]?this.sourceHandler_[e].apply(this.sourceHandler_,arguments):t.apply(this,arguments)})},n.prototype),n.prototype.setSource=function(e){var t=n.selectSourceHandler(e,this.options_);t||(n.nativeSourceHandler?t=n.nativeSourceHandler:Il.error("No source handler found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler),t!==n.nativeSourceHandler&&(this.currentSource_=e),this.sourceHandler_=t.handleSource(e,this,this.options_),this.on("dispose",this.disposeSourceHandler)},n.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null),this.cleanupAutoTextTracks(),this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}},oc.registerComponent("Tech",Ed),Ed.registerTech("Tech",Ed),Ed.defaultTechOrder_=[];var kd={},wd={},Cd={};function Ad(e,t,r){e.setTimeout(function(){return function r(){var i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];var n=arguments[2];var a=arguments[3];var o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:[];var s=5<arguments.length&&void 0!==arguments[5]&&arguments[5];var t=e[0],l=e.slice(1);if("string"==typeof t)r(i,kd[t],n,a,o,s);else if(t){var u=Od(a,t);if(!u.setSource)return o.push(u),r(i,l,n,a,o,s);u.setSource(jl({},i),function(e,t){if(e)return r(i,l,n,a,o,s);o.push(u),r(t,i.type===t.type?l:kd[t.type],n,a,o,s)})}else l.length?r(i,l,n,a,o,s):s?n(i,o):r(i,kd["*"],n,a,o,!0)}(t,kd[t.type],r,e)},1)}function Ld(e,t,r){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,n="call"+nc(r),a=e.reduce(Rd(n),i),o=a===Cd,s=o?null:t[r](a);return function(e,t,r,i){for(var n=e.length-1;0<=n;n--){var a=e[n];a[t]&&a[t](i,r)}}(e,r,s,o),s}var Id={buffered:1,currentTime:1,duration:1,seekable:1,played:1,paused:1},Pd={setCurrentTime:1},xd={play:1,pause:1};function Rd(r){return function(e,t){return e===Cd?Cd:t[r]?t[r](e):e}}function Od(e,t){var r=wd[e.id()],i=null;if(null==r)return i=t(e),wd[e.id()]=[[t,i]],i;for(var n=0;n<r.length;n++){var a=r[n];a[0]===t&&(i=a[1])}return null===i&&(i=t(e),r.push([t,i])),i}var Dd={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",mp3:"audio/mpeg",aac:"audio/aac",oga:"audio/ogg",m3u8:"application/x-mpegURL"},Md=function(){var e=hd(0<arguments.length&&void 0!==arguments[0]?arguments[0]:"");return Dd[e.toLowerCase()]||""};function Nd(e){var t=Md(e.src);return!e.type&&t&&(e.type=t),e}var Fd=function(u){function c(e,t,r){xl(this,c);var i=ac({createEl:!1},t),n=Ol(this,u.call(this,e,i,r));if(t.playerOptions.sources&&0!==t.playerOptions.sources.length)e.src(t.playerOptions.sources);else for(var a=0,o=t.playerOptions.techOrder;a<o.length;a++){var s=nc(o[a]),l=Ed.getTech(s);if(s||(l=oc.getComponent(s)),l&&l.isSupported()){e.loadTech_(s);break}}return n}return Rl(c,u),c}(oc);oc.registerComponent("MediaLoader",Fd);var jd=function(n){function i(e,t){xl(this,i);var r=Ol(this,n.call(this,e,t));return r.emitTapEvents(),r.enable(),r}return Rl(i,n),i.prototype.createEl=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"div",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};t=jl({innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder"></span>',className:this.buildCSSClass(),tabIndex:0},t),"button"===e&&Il.error("Creating a ClickableComponent with an HTML element of "+e+" is not supported; use a Button instead."),r=jl({role:"button"},r),this.tabIndex_=t.tabIndex;var i=n.prototype.createEl.call(this,e,t,r);return this.createControlTextEl(i),i},i.prototype.dispose=function(){this.controlTextEl_=null,n.prototype.dispose.call(this)},i.prototype.createControlTextEl=function(e){return this.controlTextEl_=Xl("span",{className:"vjs-control-text"},{"aria-live":"polite"}),e&&e.appendChild(this.controlTextEl_),this.controlText(this.controlText_,e),this.controlTextEl_},i.prototype.controlText=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.el();if(void 0===e)return this.controlText_||"Need Text";var r=this.localize(e);this.controlText_=e,Ql(this.controlTextEl_,r),this.nonIconControl||t.setAttribute("title",r)},i.prototype.buildCSSClass=function(){return"vjs-control vjs-button "+n.prototype.buildCSSClass.call(this)},i.prototype.enable=function(){this.enabled_||(this.enabled_=!0,this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),void 0!==this.tabIndex_&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on(["tap","click"],this.handleClick),this.on("focus",this.handleFocus),this.on("blur",this.handleBlur))},i.prototype.disable=function(){this.enabled_=!1,this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),void 0!==this.tabIndex_&&this.el_.removeAttribute("tabIndex"),this.off(["tap","click"],this.handleClick),this.off("focus",this.handleFocus),this.off("blur",this.handleBlur)},i.prototype.handleClick=function(e){},i.prototype.handleFocus=function(e){Ou(to,"keydown",Vu(this,this.handleKeyPress))},i.prototype.handleKeyPress=function(e){32===e.which||13===e.which?(e.preventDefault(),this.trigger("click")):n.prototype.handleKeyPress&&n.prototype.handleKeyPress.call(this,e)},i.prototype.handleBlur=function(e){Du(to,"keydown",Vu(this,this.handleKeyPress))},i}(oc);oc.registerComponent("ClickableComponent",jd);var Bd=function(i){function n(e,t){xl(this,n);var r=Ol(this,i.call(this,e,t));return r.update(),e.on("posterchange",Vu(r,r.update)),r}return Rl(n,i),n.prototype.dispose=function(){this.player().off("posterchange",this.update),i.prototype.dispose.call(this)},n.prototype.createEl=function(){return Xl("div",{className:"vjs-poster",tabIndex:-1})},n.prototype.update=function(e){var t=this.player().poster();this.setSrc(t),t?this.show():this.hide()},n.prototype.setSrc=function(e){var t="";e&&(t='url("'+e+'")'),this.el_.style.backgroundImage=t},n.prototype.handleClick=function(e){this.player_.controls()&&(this.player_.paused()?Vc(this.player_.play()):this.player_.pause())},n}(jd);oc.registerComponent("PosterImage",Bd);var Ud="#222",Hd={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function Gd(e,t){var r=void 0;if(4===e.length)r=e[1]+e[1]+e[2]+e[2]+e[3]+e[3];else{if(7!==e.length)throw Error("Invalid color code provided, "+e+"; must be formatted as e.g. #f0e or #f604e2.");r=e.slice(1)}return"rgba("+parseInt(r.slice(0,2),16)+","+parseInt(r.slice(2,4),16)+","+parseInt(r.slice(4,6),16)+","+t+")"}function qd(e,t,r){try{e.style[t]=r}catch(e){return}}var Vd=function(n){function a(r,e,t){xl(this,a);var i=Ol(this,n.call(this,r,e,t));return r.on("loadstart",Vu(i,i.toggleDisplay)),r.on("texttrackchange",Vu(i,i.updateDisplay)),r.on("loadstart",Vu(i,i.preselectTrack)),r.ready(Vu(i,function(){if(r.tech_&&r.tech_.featuresNativeTextTracks)this.hide();else{r.on("fullscreenchange",Vu(this,this.updateDisplay));for(var e=this.options_.playerOptions.tracks||[],t=0;t<e.length;t++)this.player_.addRemoteTextTrack(e[t],!0);this.preselectTrack()}})),i}return Rl(a,n),a.prototype.preselectTrack=function(){for(var e={captions:1,subtitles:1},t=this.player_.textTracks(),r=this.player_.cache_.selectedLanguage,i=void 0,n=void 0,a=void 0,o=0;o<t.length;o++){var s=t[o];r&&r.enabled&&r.language===s.language?s.kind===r.kind?a=s:a||(a=s):r&&!r.enabled?n=i=a=null:s.default&&("descriptions"!==s.kind||i?s.kind in e&&!n&&(n=s):i=s)}a?a.mode="showing":n?n.mode="showing":i&&(i.mode="showing")},a.prototype.toggleDisplay=function(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()},a.prototype.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"},{"aria-live":"off","aria-atomic":"true"})},a.prototype.clearDisplay=function(){"function"==typeof Ja.WebVTT&&Ja.WebVTT.processCues(Ja,[],this.el_)},a.prototype.updateDisplay=function(){var e=this.player_.textTracks();this.clearDisplay();for(var t=null,r=null,i=e.length;i--;){var n=e[i];"showing"===n.mode&&("descriptions"===n.kind?t=n:r=n)}r?("off"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","off"),this.updateForTrack(r)):t&&("assertive"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","assertive"),this.updateForTrack(t))},a.prototype.updateForTrack=function(e){if("function"==typeof Ja.WebVTT&&e.activeCues){for(var t=[],r=0;r<e.activeCues.length;r++)t.push(e.activeCues[r]);if(Ja.WebVTT.processCues(Ja,t,this.el_),this.player_.textTrackSettings)for(var i=this.player_.textTrackSettings.getValues(),n=t.length;n--;){var a=t[n];if(a){var o=a.displayState;if(i.color&&(o.firstChild.style.color=i.color),i.textOpacity&&qd(o.firstChild,"color",Gd(i.color||"#fff",i.textOpacity)),i.backgroundColor&&(o.firstChild.style.backgroundColor=i.backgroundColor),i.backgroundOpacity&&qd(o.firstChild,"backgroundColor",Gd(i.backgroundColor||"#000",i.backgroundOpacity)),i.windowColor&&(i.windowOpacity?qd(o,"backgroundColor",Gd(i.windowColor,i.windowOpacity)):o.style.backgroundColor=i.windowColor),i.edgeStyle&&("dropshadow"===i.edgeStyle?o.firstChild.style.textShadow="2px 2px 3px #222, 2px 2px 4px #222, 2px 2px 5px "+Ud:"raised"===i.edgeStyle?o.firstChild.style.textShadow="1px 1px #222, 2px 2px #222, 3px 3px "+Ud:"depressed"===i.edgeStyle?o.firstChild.style.textShadow="1px 1px #ccc, 0 1px #ccc, -1px -1px #222, 0 -1px "+Ud:"uniform"===i.edgeStyle&&(o.firstChild.style.textShadow="0 0 4px #222, 0 0 4px #222, 0 0 4px #222, 0 0 4px "+Ud)),i.fontPercent&&1!==i.fontPercent){var s=Ja.parseFloat(o.style.fontSize);o.style.fontSize=s*i.fontPercent+"px",o.style.height="auto",o.style.top="auto",o.style.bottom="2px"}i.fontFamily&&"default"!==i.fontFamily&&("small-caps"===i.fontFamily?o.firstChild.style.fontVariant="small-caps":o.firstChild.style.fontFamily=Hd[i.fontFamily])}}}},a}(oc);oc.registerComponent("TextTrackDisplay",Vd);var Wd=function(n){function e(){return xl(this,e),Ol(this,n.apply(this,arguments))}return Rl(e,n),e.prototype.createEl=function(){var e=this.player_.isAudio(),t=this.localize(e?"Audio Player":"Video Player"),r=Xl("span",{className:"vjs-control-text",innerHTML:this.localize("{1} is loading.",[t])}),i=n.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner",dir:"ltr"});return i.appendChild(r),i},e}(oc);oc.registerComponent("LoadingSpinner",Wd);var zd=function(t){function e(){return xl(this,e),Ol(this,t.apply(this,arguments))}return Rl(e,t),e.prototype.createEl=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};e="button",t=jl({innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder"></span>',className:this.buildCSSClass()},t),r=jl({type:"button"},r);var i=oc.prototype.createEl.call(this,"button",t,r);return this.createControlTextEl(i),i},e.prototype.addChild=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return Il.warn("Adding an actionable (user controllable) child to a Button ("+this.constructor.name+") is not supported; use a ClickableComponent instead."),oc.prototype.addChild.call(this,e,t)},e.prototype.enable=function(){t.prototype.enable.call(this),this.el_.removeAttribute("disabled")},e.prototype.disable=function(){t.prototype.disable.call(this),this.el_.setAttribute("disabled","disabled")},e.prototype.handleKeyPress=function(e){32!==e.which&&13!==e.which&&t.prototype.handleKeyPress.call(this,e)},e}(jd);oc.registerComponent("Button",zd);var Kd=function(i){function n(e,t){xl(this,n);var r=Ol(this,i.call(this,e,t));return r.mouseused_=!1,r.on("mousedown",r.handleMouseDown),r}return Rl(n,i),n.prototype.buildCSSClass=function(){return"vjs-big-play-button"},n.prototype.handleClick=function(e){var t=this.player_.play();if(this.mouseused_&&e.clientX&&e.clientY)Vc(t);else{var r=this.player_.getChild("controlBar"),i=r&&r.getChild("playToggle");if(i){var n=function(){return i.focus()};qc(t)?t.then(n,function(){}):this.setTimeout(n,1)}else this.player_.focus()}},n.prototype.handleKeyPress=function(e){this.mouseused_=!1,i.prototype.handleKeyPress.call(this,e)},n.prototype.handleMouseDown=function(e){this.mouseused_=!0},n}(zd);Kd.prototype.controlText_="Play Video",oc.registerComponent("BigPlayButton",Kd);var Yd=function(i){function n(e,t){xl(this,n);var r=Ol(this,i.call(this,e,t));return r.controlText(t&&t.controlText||r.localize("Close")),r}return Rl(n,i),n.prototype.buildCSSClass=function(){return"vjs-close-button "+i.prototype.buildCSSClass.call(this)},n.prototype.handleClick=function(e){this.trigger({type:"close",bubbles:!1})},n}(zd);oc.registerComponent("CloseButton",Yd);var Xd=function(i){function n(e,t){xl(this,n);var r=Ol(this,i.call(this,e,t));return r.on(e,"play",r.handlePlay),r.on(e,"pause",r.handlePause),r.on(e,"ended",r.handleEnded),r}return Rl(n,i),n.prototype.buildCSSClass=function(){return"vjs-play-control "+i.prototype.buildCSSClass.call(this)},n.prototype.handleClick=function(e){this.player_.paused()?this.player_.play():this.player_.pause()},n.prototype.handleSeeked=function(e){this.removeClass("vjs-ended"),this.player_.paused()?this.handlePause(e):this.handlePlay(e)},n.prototype.handlePlay=function(e){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.controlText("Pause")},n.prototype.handlePause=function(e){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.controlText("Play")},n.prototype.handleEnded=function(e){this.removeClass("vjs-playing"),this.addClass("vjs-ended"),this.controlText("Replay"),this.one(this.player_,"seeked",this.handleSeeked)},n}(zd);Xd.prototype.controlText_="Play",oc.registerComponent("PlayToggle",Xd);var Qd=function(e,t){var r=Math.floor((e=e<0?0:e)%60),i=Math.floor(e/60%60),n=Math.floor(e/3600),a=Math.floor(t/60%60),o=Math.floor(t/3600);return(isNaN(e)||e===1/0)&&(n=i=r="-"),(n=0<n||0<o?n+":":"")+(i=((n||10<=a)&&i<10?"0"+i:i)+":")+(r=r<10?"0"+r:r)},Jd=Qd;function Zd(e){return Jd(e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:e)}var $d=function(i){function n(e,t){xl(this,n);var r=Ol(this,i.call(this,e,t));return r.throttledUpdateContent=Wu(Vu(r,r.updateContent),25),r.on(e,"timeupdate",r.throttledUpdateContent),r}return Rl(n,i),n.prototype.createEl=function(e){var t=this.buildCSSClass(),r=i.prototype.createEl.call(this,"div",{className:t+" vjs-time-control vjs-control",innerHTML:'<span class="vjs-control-text">'+this.localize(this.labelText_)+" </span>"});return this.contentEl_=Xl("span",{className:t+"-display"},{"aria-live":"off"}),this.updateTextNode_(),r.appendChild(this.contentEl_),r},n.prototype.dispose=function(){this.contentEl_=null,this.textNode_=null,i.prototype.dispose.call(this)},n.prototype.updateTextNode_=function(){if(this.contentEl_){for(;this.contentEl_.firstChild;)this.contentEl_.removeChild(this.contentEl_.firstChild);this.textNode_=to.createTextNode(this.formattedTime_||this.formatTime_(0)),this.contentEl_.appendChild(this.textNode_)}},n.prototype.formatTime_=function(e){return Zd(e)},n.prototype.updateFormattedTime_=function(e){var t=this.formatTime_(e);t!==this.formattedTime_&&(this.formattedTime_=t,this.requestAnimationFrame(this.updateTextNode_))},n.prototype.updateContent=function(e){},n}(oc);$d.prototype.labelText_="Time",$d.prototype.controlText_="Time",oc.registerComponent("TimeDisplay",$d);var eh=function(i){function n(e,t){xl(this,n);var r=Ol(this,i.call(this,e,t));return r.on(e,"ended",r.handleEnded),r}return Rl(n,i),n.prototype.buildCSSClass=function(){return"vjs-current-time"},n.prototype.updateContent=function(e){var t=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();this.updateFormattedTime_(t)},n.prototype.handleEnded=function(e){this.player_.duration()&&this.updateFormattedTime_(this.player_.duration())},n}($d);eh.prototype.labelText_="Current Time",eh.prototype.controlText_="Current Time",oc.registerComponent("CurrentTimeDisplay",eh);var th=function(i){function n(e,t){xl(this,n);var r=Ol(this,i.call(this,e,t));return r.on(e,"durationchange",r.updateContent),r.on(e,"loadedmetadata",r.throttledUpdateContent),r}return Rl(n,i),n.prototype.buildCSSClass=function(){return"vjs-duration"},n.prototype.updateContent=function(e){var t=this.player_.duration();t&&this.duration_!==t&&(this.duration_=t,this.updateFormattedTime_(t))},n}($d);th.prototype.labelText_="Duration",th.prototype.controlText_="Duration",oc.registerComponent("DurationDisplay",th);var rh=function(e){function t(){return xl(this,t),Ol(this,e.apply(this,arguments))}return Rl(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-time-control vjs-time-divider",innerHTML:"<div><span>/</span></div>"})},t}(oc);oc.registerComponent("TimeDivider",rh);var ih=function(i){function n(e,t){xl(this,n);var r=Ol(this,i.call(this,e,t));return r.on(e,"durationchange",r.throttledUpdateContent),r.on(e,"ended",r.handleEnded),r}return Rl(n,i),n.prototype.buildCSSClass=function(){return"vjs-remaining-time"},n.prototype.formatTime_=function(e){return"-"+i.prototype.formatTime_.call(this,e)},n.prototype.updateContent=function(e){this.player_.duration()&&this.updateFormattedTime_(this.player_.remainingTimeDisplay?this.player_.remainingTimeDisplay():this.player_.remainingTime())},n.prototype.handleEnded=function(e){this.player_.duration()&&this.updateFormattedTime_(0)},n}($d);ih.prototype.labelText_="Remaining Time",ih.prototype.controlText_="Remaining Time",oc.registerComponent("RemainingTimeDisplay",ih);var nh=function(i){function n(e,t){xl(this,n);var r=Ol(this,i.call(this,e,t));return r.updateShowing(),r.on(r.player(),"durationchange",r.updateShowing),r}return Rl(n,i),n.prototype.createEl=function(){var e=i.prototype.createEl.call(this,"div",{className:"vjs-live-control vjs-control"});return this.contentEl_=Xl("div",{className:"vjs-live-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Stream Type")+" </span>"+this.localize("LIVE")},{"aria-live":"off"}),e.appendChild(this.contentEl_),e},n.prototype.dispose=function(){this.contentEl_=null,i.prototype.dispose.call(this)},n.prototype.updateShowing=function(e){this.player().duration()===1/0?this.show():this.hide()},n}(oc);oc.registerComponent("LiveDisplay",nh);var ah=function(i){function n(e,t){xl(this,n);var r=Ol(this,i.call(this,e,t));return r.bar=r.getChild(r.options_.barName),r.vertical(!!r.options_.vertical),r.enable(),r}return Rl(n,i),n.prototype.enabled=function(){return this.enabled_},n.prototype.enable=function(){this.enabled()||(this.on("mousedown",this.handleMouseDown),this.on("touchstart",this.handleMouseDown),this.on("focus",this.handleFocus),this.on("blur",this.handleBlur),this.on("click",this.handleClick),this.on(this.player_,"controlsvisible",this.update),this.playerEvent&&this.on(this.player_,this.playerEvent,this.update),this.removeClass("disabled"),this.setAttribute("tabindex",0),this.enabled_=!0)},n.prototype.disable=function(){if(this.enabled()){var e=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown),this.off("touchstart",this.handleMouseDown),this.off("focus",this.handleFocus),this.off("blur",this.handleBlur),this.off("click",this.handleClick),this.off(this.player_,"controlsvisible",this.update),this.off(e,"mousemove",this.handleMouseMove),this.off(e,"mouseup",this.handleMouseUp),this.off(e,"touchmove",this.handleMouseMove),this.off(e,"touchend",this.handleMouseUp),this.removeAttribute("tabindex"),this.addClass("disabled"),this.playerEvent&&this.off(this.player_,this.playerEvent,this.update),this.enabled_=!1}},n.prototype.createEl=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return t.className=t.className+" vjs-slider",t=jl({tabIndex:0},t),r=jl({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},r),i.prototype.createEl.call(this,e,t,r)},n.prototype.handleMouseDown=function(e){var t=this.bar.el_.ownerDocument;"mousedown"===e.type&&e.preventDefault(),"touchstart"!==e.type||kc||e.preventDefault(),su(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(t,"mousemove",this.handleMouseMove),this.on(t,"mouseup",this.handleMouseUp),this.on(t,"touchmove",this.handleMouseMove),this.on(t,"touchend",this.handleMouseUp),this.handleMouseMove(e)},n.prototype.handleMouseMove=function(e){},n.prototype.handleMouseUp=function(){var e=this.bar.el_.ownerDocument;lu(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(e,"mousemove",this.handleMouseMove),this.off(e,"mouseup",this.handleMouseUp),this.off(e,"touchmove",this.handleMouseMove),this.off(e,"touchend",this.handleMouseUp),this.update()},n.prototype.update=function(){if(this.el_){var e=this.getPercent(),t=this.bar;if(t){("number"!=typeof e||e!=e||e<0||e===1/0)&&(e=0);var r=(100*e).toFixed(2)+"%",i=t.el().style;return this.vertical()?i.height=r:i.width=r,e}}},n.prototype.calculateDistance=function(e){var t=du(this.el_,e);return this.vertical()?t.y:t.x},n.prototype.handleFocus=function(){this.on(this.bar.el_.ownerDocument,"keydown",this.handleKeyPress)},n.prototype.handleKeyPress=function(e){37===e.which||40===e.which?(e.preventDefault(),this.stepBack()):38!==e.which&&39!==e.which||(e.preventDefault(),this.stepForward())},n.prototype.handleBlur=function(){this.off(this.bar.el_.ownerDocument,"keydown",this.handleKeyPress)},n.prototype.handleClick=function(e){e.stopImmediatePropagation(),e.preventDefault()},n.prototype.vertical=function(e){if(void 0===e)return this.vertical_||!1;this.vertical_=!!e,this.addClass(this.vertical_?"vjs-slider-vertical":"vjs-slider-horizontal")},n}(oc);oc.registerComponent("Slider",ah);var oh=function(i){function n(e,t){xl(this,n);var r=Ol(this,i.call(this,e,t));return r.partEls_=[],r.on(e,"progress",r.update),r}return Rl(n,i),n.prototype.createEl=function(){return i.prototype.createEl.call(this,"div",{className:"vjs-load-progress",innerHTML:'<span class="vjs-control-text"><span>'+this.localize("Loaded")+"</span>: 0%</span>"})},n.prototype.dispose=function(){this.partEls_=null,i.prototype.dispose.call(this)},n.prototype.update=function(e){var t=this.player_.buffered(),r=this.player_.duration(),i=this.player_.bufferedEnd(),n=this.partEls_,a=function(e,t){var r=e/t||0;return 100*(1<=r?1:r)+"%"};this.el_.style.width=a(i,r);for(var o=0;o<t.length;o++){var s=t.start(o),l=t.end(o),u=n[o];u||(u=this.el_.appendChild(Xl()),n[o]=u),u.style.left=a(s,i),u.style.width=a(l-s,i)}for(var c=n.length;t.length<c;c--)this.el_.removeChild(n[c-1]);n.length=t.length},n}(oc);oc.registerComponent("LoadProgressBar",oh);var sh=function(e){function t(){return xl(this,t),Ol(this,e.apply(this,arguments))}return Rl(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-time-tooltip"})},t.prototype.update=function(e,t,r){var i=uu(this.el_),n=uu(this.player_.el()),a=e.width*t;if(n&&i){var o=e.left-n.left+a,s=e.width-a+(n.right-e.right),l=i.width/2;o<l?l+=l-o:s<l&&(l=s),l<0?l=0:i.width<l&&(l=i.width),this.el_.style.right="-"+l+"px",Ql(this.el_,r)}},t}(oc);oc.registerComponent("TimeTooltip",sh);var lh=function(e){function t(){return xl(this,t),Ol(this,e.apply(this,arguments))}return Rl(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-play-progress vjs-slider-bar",innerHTML:'<span class="vjs-control-text"><span>'+this.localize("Progress")+"</span>: 0%</span>"})},t.prototype.update=function(r,i){var n=this;this.rafId_&&this.cancelAnimationFrame(this.rafId_),this.rafId_=this.requestAnimationFrame(function(){var e=Zd(n.player_.scrubbing()?n.player_.getCache().currentTime:n.player_.currentTime(),n.player_.duration()),t=n.getChild("timeTooltip");t&&t.update(r,i,e)})},t}(oc);lh.prototype.options_={children:[]},vc||_c||lh.prototype.options_.children.push("timeTooltip"),oc.registerComponent("PlayProgressBar",lh);var uh=function(i){function n(e,t){xl(this,n);var r=Ol(this,i.call(this,e,t));return r.update=Wu(Vu(r,r.update),25),r}return Rl(n,i),n.prototype.createEl=function(){return i.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"})},n.prototype.update=function(r,i){var n=this;this.rafId_&&this.cancelAnimationFrame(this.rafId_),this.rafId_=this.requestAnimationFrame(function(){var e=n.player_.duration(),t=Zd(i*e,e);n.el_.style.left=r.width*i+"px",n.getChild("timeTooltip").update(r,i,t)})},n}(oc);uh.prototype.options_={children:["timeTooltip"]},oc.registerComponent("MouseTimeDisplay",uh);var ch=function(i){function n(e,t){xl(this,n);var r=Ol(this,i.call(this,e,t));return r.setEventHandlers_(),r}return Rl(n,i),n.prototype.setEventHandlers_=function(){var e=this;this.update=Wu(Vu(this,this.update),30),this.on(this.player_,"timeupdate",this.update),this.on(this.player_,"ended",this.handleEnded),this.updateInterval=null,this.on(this.player_,["playing"],function(){e.clearInterval(e.updateInterval),e.updateInterval=e.setInterval(function(){e.requestAnimationFrame(function(){e.update()})},30)}),this.on(this.player_,["ended","pause","waiting"],function(){e.clearInterval(e.updateInterval)}),this.on(this.player_,["timeupdate","ended"],this.update)},n.prototype.createEl=function(){return i.prototype.createEl.call(this,"div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})},n.prototype.update_=function(e,t){var r=this.player_.duration();this.el_.setAttribute("aria-valuenow",(100*t).toFixed(2)),this.el_.setAttribute("aria-valuetext",this.localize("progress bar timing: currentTime={1} duration={2}",[Zd(e,r),Zd(r,r)],"{1} of {2}")),this.bar.update(uu(this.el_),t)},n.prototype.update=function(e){var t=i.prototype.update.call(this);return this.update_(this.getCurrentTime_(),t),t},n.prototype.getCurrentTime_=function(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()},n.prototype.handleEnded=function(e){this.update_(this.player_.duration(),1)},n.prototype.getPercent=function(){var e=this.getCurrentTime_()/this.player_.duration();return 1<=e?1:e||0},n.prototype.handleMouseDown=function(e){vu(e)&&(e.stopPropagation(),this.player_.scrubbing(!0),this.videoWasPlaying=!this.player_.paused(),this.player_.pause(),i.prototype.handleMouseDown.call(this,e))},n.prototype.handleMouseMove=function(e){if(vu(e)){var t=this.calculateDistance(e)*this.player_.duration();t===this.player_.duration()&&(t-=.1),this.player_.currentTime(t)}},n.prototype.enable=function(){i.prototype.enable.call(this);var e=this.getChild("mouseTimeDisplay");e&&e.show()},n.prototype.disable=function(){i.prototype.disable.call(this);var e=this.getChild("mouseTimeDisplay");e&&e.hide()},n.prototype.handleMouseUp=function(e){i.prototype.handleMouseUp.call(this,e),e&&e.stopPropagation(),this.player_.scrubbing(!1),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0}),this.videoWasPlaying&&Vc(this.player_.play())},n.prototype.stepForward=function(){this.player_.currentTime(this.player_.currentTime()+5)},n.prototype.stepBack=function(){this.player_.currentTime(this.player_.currentTime()-5)},n.prototype.handleAction=function(e){this.player_.paused()?this.player_.play():this.player_.pause()},n.prototype.handleKeyPress=function(e){32===e.which||13===e.which?(e.preventDefault(),this.handleAction(e)):i.prototype.handleKeyPress&&i.prototype.handleKeyPress.call(this,e)},n}(ah);ch.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"},vc||_c||ch.prototype.options_.children.splice(1,0,"mouseTimeDisplay"),ch.prototype.playerEvent="timeupdate",oc.registerComponent("SeekBar",ch);var dh=function(i){function n(e,t){xl(this,n);var r=Ol(this,i.call(this,e,t));return r.handleMouseMove=Wu(Vu(r,r.handleMouseMove),25),r.throttledHandleMouseSeek=Wu(Vu(r,r.handleMouseSeek),25),r.enable(),r}return Rl(n,i),n.prototype.createEl=function(){return i.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control"})},n.prototype.handleMouseMove=function(e){var t=this.getChild("seekBar");if(t){var r=t.getChild("mouseTimeDisplay"),i=t.el(),n=uu(i),a=du(i,e).x;1<a?a=1:a<0&&(a=0),r&&r.update(n,a)}},n.prototype.handleMouseSeek=function(e){var t=this.getChild("seekBar");t&&t.handleMouseMove(e)},n.prototype.enabled=function(){return this.enabled_},n.prototype.disable=function(){this.children().forEach(function(e){return e.disable&&e.disable()}),this.enabled()&&(this.off(["mousedown","touchstart"],this.handleMouseDown),this.off(this.el_,"mousemove",this.handleMouseMove),this.handleMouseUp(),this.addClass("disabled"),this.enabled_=!1)},n.prototype.enable=function(){this.children().forEach(function(e){return e.enable&&e.enable()}),this.enabled()||(this.on(["mousedown","touchstart"],this.handleMouseDown),this.on(this.el_,"mousemove",this.handleMouseMove),this.removeClass("disabled"),this.enabled_=!0)},n.prototype.handleMouseDown=function(e){var t=this.el_.ownerDocument,r=this.getChild("seekBar");r&&r.handleMouseDown(e),this.on(t,"mousemove",this.throttledHandleMouseSeek),this.on(t,"touchmove",this.throttledHandleMouseSeek),this.on(t,"mouseup",this.handleMouseUp),this.on(t,"touchend",this.handleMouseUp)},n.prototype.handleMouseUp=function(e){var t=this.el_.ownerDocument,r=this.getChild("seekBar");r&&r.handleMouseUp(e),this.off(t,"mousemove",this.throttledHandleMouseSeek),this.off(t,"touchmove",this.throttledHandleMouseSeek),this.off(t,"mouseup",this.handleMouseUp),this.off(t,"touchend",this.handleMouseUp)},n}(oc);dh.prototype.options_={children:["seekBar"]},oc.registerComponent("ProgressControl",dh);var hh=function(i){function n(e,t){xl(this,n);var r=Ol(this,i.call(this,e,t));return r.on(e,"fullscreenchange",r.handleFullscreenChange),!1===to[Mc.fullscreenEnabled]&&r.disable(),r}return Rl(n,i),n.prototype.buildCSSClass=function(){return"vjs-fullscreen-control "+i.prototype.buildCSSClass.call(this)},n.prototype.handleFullscreenChange=function(e){this.player_.isFullscreen()?this.controlText("Non-Fullscreen"):this.controlText("Fullscreen")},n.prototype.handleClick=function(e){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()},n}(zd);hh.prototype.controlText_="Fullscreen",oc.registerComponent("FullscreenToggle",hh);var fh=function(e){function t(){return xl(this,t),Ol(this,e.apply(this,arguments))}return Rl(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-volume-level",innerHTML:'<span class="vjs-control-text"></span>'})},t}(oc);oc.registerComponent("VolumeLevel",fh);var ph=function(i){function n(e,t){xl(this,n);var r=Ol(this,i.call(this,e,t));return r.on("slideractive",r.updateLastVolume_),r.on(e,"volumechange",r.updateARIAAttributes),e.ready(function(){return r.updateARIAAttributes()}),r}return Rl(n,i),n.prototype.createEl=function(){return i.prototype.createEl.call(this,"div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})},n.prototype.handleMouseDown=function(e){vu(e)&&i.prototype.handleMouseDown.call(this,e)},n.prototype.handleMouseMove=function(e){vu(e)&&(this.checkMuted(),this.player_.volume(this.calculateDistance(e)))},n.prototype.checkMuted=function(){this.player_.muted()&&this.player_.muted(!1)},n.prototype.getPercent=function(){return this.player_.muted()?0:this.player_.volume()},n.prototype.stepForward=function(){this.checkMuted(),this.player_.volume(this.player_.volume()+.1)},n.prototype.stepBack=function(){this.checkMuted(),this.player_.volume(this.player_.volume()-.1)},n.prototype.updateARIAAttributes=function(e){var t=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",t),this.el_.setAttribute("aria-valuetext",t+"%")},n.prototype.volumeAsPercentage_=function(){return Math.round(100*this.player_.volume())},n.prototype.updateLastVolume_=function(){var e=this,t=this.player_.volume();this.one("sliderinactive",function(){0===e.player_.volume()&&e.player_.lastVolume_(t)})},n}(ah);ph.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"},ph.prototype.playerEvent="volumechange",oc.registerComponent("VolumeBar",ph);var gh=function(a){function o(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};xl(this,o),t.vertical=t.vertical||!1,(void 0===t.volumeBar||Ul(t.volumeBar))&&(t.volumeBar=t.volumeBar||{},t.volumeBar.vertical=t.vertical);var r,i,n=Ol(this,a.call(this,e,t));return r=n,(i=e).tech_&&!i.tech_.featuresVolumeControl&&r.addClass("vjs-hidden"),r.on(i,"loadstart",function(){i.tech_.featuresVolumeControl?r.removeClass("vjs-hidden"):r.addClass("vjs-hidden")}),n.throttledHandleMouseMove=Wu(Vu(n,n.handleMouseMove),25),n.on("mousedown",n.handleMouseDown),n.on("touchstart",n.handleMouseDown),n.on(n.volumeBar,["focus","slideractive"],function(){n.volumeBar.addClass("vjs-slider-active"),n.addClass("vjs-slider-active"),n.trigger("slideractive")}),n.on(n.volumeBar,["blur","sliderinactive"],function(){n.volumeBar.removeClass("vjs-slider-active"),n.removeClass("vjs-slider-active"),n.trigger("sliderinactive")}),n}return Rl(o,a),o.prototype.createEl=function(){var e="vjs-volume-horizontal";return this.options_.vertical&&(e="vjs-volume-vertical"),a.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control "+e})},o.prototype.handleMouseDown=function(e){var t=this.el_.ownerDocument;this.on(t,"mousemove",this.throttledHandleMouseMove),this.on(t,"touchmove",this.throttledHandleMouseMove),this.on(t,"mouseup",this.handleMouseUp),this.on(t,"touchend",this.handleMouseUp)},o.prototype.handleMouseUp=function(e){var t=this.el_.ownerDocument;this.off(t,"mousemove",this.throttledHandleMouseMove),this.off(t,"touchmove",this.throttledHandleMouseMove),this.off(t,"mouseup",this.handleMouseUp),this.off(t,"touchend",this.handleMouseUp)},o.prototype.handleMouseMove=function(e){this.volumeBar.handleMouseMove(e)},o}(oc);gh.prototype.options_={children:["volumeBar"]},oc.registerComponent("VolumeControl",gh);var mh=function(a){function o(e,t){xl(this,o);var r,i,n=Ol(this,a.call(this,e,t));return r=n,(i=e).tech_&&!i.tech_.featuresMuteControl&&r.addClass("vjs-hidden"),r.on(i,"loadstart",function(){i.tech_.featuresMuteControl?r.removeClass("vjs-hidden"):r.addClass("vjs-hidden")}),n.on(e,["loadstart","volumechange"],n.update),n}return Rl(o,a),o.prototype.buildCSSClass=function(){return"vjs-mute-control "+a.prototype.buildCSSClass.call(this)},o.prototype.handleClick=function(e){var t=this.player_.volume(),r=this.player_.lastVolume_();0===t?(this.player_.volume(r<.1?.1:r),this.player_.muted(!1)):this.player_.muted(!this.player_.muted())},o.prototype.update=function(e){this.updateIcon_(),this.updateControlText_()},o.prototype.updateIcon_=function(){var e=this.player_.volume(),t=3;vc&&this.player_.muted(this.player_.tech_.el_.muted),0===e||this.player_.muted()?t=0:e<.33?t=1:e<.67&&(t=2);for(var r=0;r<4;r++)eu(this.el_,"vjs-vol-"+r);$l(this.el_,"vjs-vol-"+t)},o.prototype.updateControlText_=function(){var e=this.player_.muted()||0===this.player_.volume()?"Unmute":"Mute";this.controlText()!==e&&this.controlText(e)},o}(zd);mh.prototype.controlText_="Mute",oc.registerComponent("MuteToggle",mh);var vh=function(i){function n(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};xl(this,n),t.inline=void 0===t.inline||t.inline,(void 0===t.volumeControl||Ul(t.volumeControl))&&(t.volumeControl=t.volumeControl||{},t.volumeControl.vertical=!t.inline);var r=Ol(this,i.call(this,e,t));return r.on(e,["loadstart"],r.volumePanelState_),r.on(r.volumeControl,["slideractive"],r.sliderActive_),r.on(r.volumeControl,["sliderinactive"],r.sliderInactive_),r}return Rl(n,i),n.prototype.sliderActive_=function(){this.addClass("vjs-slider-active")},n.prototype.sliderInactive_=function(){this.removeClass("vjs-slider-active")},n.prototype.volumePanelState_=function(){this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-hidden"),this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-mute-toggle-only")},n.prototype.createEl=function(){var e="vjs-volume-panel-horizontal";return this.options_.inline||(e="vjs-volume-panel-vertical"),i.prototype.createEl.call(this,"div",{className:"vjs-volume-panel vjs-control "+e})},n}(oc);vh.prototype.options_={children:["muteToggle","volumeControl"]},oc.registerComponent("VolumePanel",vh);var yh=function(i){function n(e,t){xl(this,n);var r=Ol(this,i.call(this,e,t));return t&&(r.menuButton_=t.menuButton),r.focusedChild_=-1,r.on("keydown",r.handleKeyPress),r}return Rl(n,i),n.prototype.addItem=function(t){this.addChild(t),t.on("click",Vu(this,function(e){this.menuButton_&&(this.menuButton_.unpressButton(),"CaptionSettingsMenuItem"!==t.name()&&this.menuButton_.focus())}))},n.prototype.createEl=function(){this.contentEl_=Xl(this.options_.contentElType||"ul",{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu");var e=i.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});return e.appendChild(this.contentEl_),Ou(e,"click",function(e){e.preventDefault(),e.stopImmediatePropagation()}),e},n.prototype.dispose=function(){this.contentEl_=null,i.prototype.dispose.call(this)},n.prototype.handleKeyPress=function(e){37===e.which||40===e.which?(e.preventDefault(),this.stepForward()):38!==e.which&&39!==e.which||(e.preventDefault(),this.stepBack())},n.prototype.stepForward=function(){var e=0;void 0!==this.focusedChild_&&(e=this.focusedChild_+1),this.focus(e)},n.prototype.stepBack=function(){var e=0;void 0!==this.focusedChild_&&(e=this.focusedChild_-1),this.focus(e)},n.prototype.focus=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=this.children().slice();t.length&&t[0].className&&/vjs-menu-title/.test(t[0].className)&&t.shift(),0<t.length&&(e<0?e=0:t.length<=e&&(e=t.length-1),t[this.focusedChild_=e].el_.focus())},n}(oc);oc.registerComponent("Menu",yh);var _h=function(n){function a(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};xl(this,a);var r=Ol(this,n.call(this,e,t));r.menuButton_=new zd(e,t),r.menuButton_.controlText(r.controlText_),r.menuButton_.el_.setAttribute("aria-haspopup","true");var i=zd.prototype.buildCSSClass();return r.menuButton_.el_.className=r.buildCSSClass()+" "+i,r.menuButton_.removeClass("vjs-control"),r.addChild(r.menuButton_),r.update(),r.enabled_=!0,r.on(r.menuButton_,"tap",r.handleClick),r.on(r.menuButton_,"click",r.handleClick),r.on(r.menuButton_,"focus",r.handleFocus),r.on(r.menuButton_,"blur",r.handleBlur),r.on("keydown",r.handleSubmenuKeyPress),r}return Rl(a,n),a.prototype.update=function(){var e=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu)),this.menu=e,this.addChild(e),this.buttonPressed_=!1,this.menuButton_.el_.setAttribute("aria-expanded","false"),this.items&&this.items.length<=this.hideThreshold_?this.hide():this.show()},a.prototype.createMenu=function(){var e=new yh(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title){var t=Xl("li",{className:"vjs-menu-title",innerHTML:nc(this.options_.title),tabIndex:-1});this.hideThreshold_+=1,e.children_.unshift(t),Jl(t,e.contentEl())}if(this.items=this.createItems(),this.items)for(var r=0;r<this.items.length;r++)e.addItem(this.items[r]);return e},a.prototype.createItems=function(){},a.prototype.createEl=function(){return n.prototype.createEl.call(this,"div",{className:this.buildWrapperCSSClass()},{})},a.prototype.buildWrapperCSSClass=function(){var e="vjs-menu-button";return"vjs-menu-button "+(e+=!0===this.options_.inline?"-inline":"-popup")+" "+zd.prototype.buildCSSClass()+" "+n.prototype.buildCSSClass.call(this)},a.prototype.buildCSSClass=function(){var e="vjs-menu-button";return"vjs-menu-button "+(e+=!0===this.options_.inline?"-inline":"-popup")+" "+n.prototype.buildCSSClass.call(this)},a.prototype.controlText=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.menuButton_.el();return this.menuButton_.controlText(e,t)},a.prototype.handleClick=function(e){this.one(this.menu.contentEl(),"mouseleave",Vu(this,function(e){this.unpressButton(),this.el_.blur()})),this.buttonPressed_?this.unpressButton():this.pressButton()},a.prototype.focus=function(){this.menuButton_.focus()},a.prototype.blur=function(){this.menuButton_.blur()},a.prototype.handleFocus=function(){Ou(to,"keydown",Vu(this,this.handleKeyPress))},a.prototype.handleBlur=function(){Du(to,"keydown",Vu(this,this.handleKeyPress))},a.prototype.handleKeyPress=function(e){27===e.which||9===e.which?(this.buttonPressed_&&this.unpressButton(),9!==e.which&&(e.preventDefault(),this.menuButton_.el_.focus())):38!==e.which&&40!==e.which||this.buttonPressed_||(this.pressButton(),e.preventDefault())},a.prototype.handleSubmenuKeyPress=function(e){27!==e.which&&9!==e.which||(this.buttonPressed_&&this.unpressButton(),9!==e.which&&(e.preventDefault(),this.menuButton_.el_.focus()))},a.prototype.pressButton=function(){if(this.enabled_){if(this.buttonPressed_=!0,this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),vc&&Kl())return;this.menu.focus()}},a.prototype.unpressButton=function(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","false"))},a.prototype.disable=function(){this.unpressButton(),this.enabled_=!1,this.addClass("vjs-disabled"),this.menuButton_.disable()},a.prototype.enable=function(){this.enabled_=!0,this.removeClass("vjs-disabled"),this.menuButton_.enable()},a}(oc);oc.registerComponent("MenuButton",_h);var bh=function(a){function o(e,t){xl(this,o);var r=t.tracks,i=Ol(this,a.call(this,e,t));if(i.items.length<=1&&i.hide(),!r)return Ol(i);var n=Vu(i,i.update);return r.addEventListener("removetrack",n),r.addEventListener("addtrack",n),i.player_.on("ready",n),i.player_.on("dispose",function(){r.removeEventListener("removetrack",n),r.removeEventListener("addtrack",n)}),i}return Rl(o,a),o}(_h);oc.registerComponent("TrackButton",bh);var Th=function(i){function n(e,t){xl(this,n);var r=Ol(this,i.call(this,e,t));return r.selectable=t.selectable,r.isSelected_=t.selected||!1,r.multiSelectable=t.multiSelectable,r.selected(r.isSelected_),r.el_.setAttribute("role",r.selectable?r.multiSelectable?"menuitemcheckbox":"menuitemradio":"menuitem"),r}return Rl(n,i),n.prototype.createEl=function(e,t,r){return this.nonIconControl=!0,i.prototype.createEl.call(this,"li",jl({className:"vjs-menu-item",innerHTML:'<span class="vjs-menu-item-text">'+this.localize(this.options_.label)+"</span>",tabIndex:-1},t),r)},n.prototype.handleClick=function(e){this.selected(!0)},n.prototype.selected=function(e){this.selectable&&(this.isSelected_=e?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),!1))},n}(jd);oc.registerComponent("MenuItem",Th);var Sh=function(l){function u(e,t){xl(this,u);var r=t.track,i=e.textTracks();t.label=r.label||r.language||"Unknown",t.selected="showing"===r.mode;var n=Ol(this,l.call(this,e,t));n.track=r;var a=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];n.handleTracksChange.apply(n,t)},o=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];n.handleSelectedLanguageChange.apply(n,t)};if(e.on(["loadstart","texttrackchange"],a),i.addEventListener("change",a),i.addEventListener("selectedlanguagechange",o),n.on("dispose",function(){e.off(["loadstart","texttrackchange"],a),i.removeEventListener("change",a),i.removeEventListener("selectedlanguagechange",o)}),void 0===i.onchange){var s=void 0;n.on(["tap","click"],function(){if("object"!==Pl(Ja.Event))try{s=new Ja.Event("change")}catch(e){}s||(s=to.createEvent("Event")).initEvent("change",!0,!0),i.dispatchEvent(s)})}return n.handleTracksChange(),n}return Rl(u,l),u.prototype.handleClick=function(e){var t=this.track.kind,r=this.track.kinds,i=this.player_.textTracks();if(r||(r=[t]),l.prototype.handleClick.call(this,e),i)for(var n=0;n<i.length;n++){var a=i[n];a===this.track&&-1<r.indexOf(a.kind)?"showing"!==a.mode&&(a.mode="showing"):"disabled"!==a.mode&&(a.mode="disabled")}},u.prototype.handleTracksChange=function(e){var t="showing"===this.track.mode;t!==this.isSelected_&&this.selected(t)},u.prototype.handleSelectedLanguageChange=function(e){if("showing"===this.track.mode){var t=this.player_.cache_.selectedLanguage;if(t&&t.enabled&&t.language===this.track.language&&t.kind!==this.track.kind)return;this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind}}},u.prototype.dispose=function(){this.track=null,l.prototype.dispose.call(this)},u}(Th);oc.registerComponent("TextTrackMenuItem",Sh);var Eh=function(r){function i(e,t){return xl(this,i),t.track={player:e,kind:t.kind,kinds:t.kinds,default:!1,mode:"disabled"},t.kinds||(t.kinds=[t.kind]),t.track.label=t.label?t.label:t.kinds.join(" and ")+" off",t.selectable=!0,t.multiSelectable=!1,Ol(this,r.call(this,e,t))}return Rl(i,r),i.prototype.handleTracksChange=function(e){for(var t=this.player().textTracks(),r=!0,i=0,n=t.length;i<n;i++){var a=t[i];if(-1<this.options_.kinds.indexOf(a.kind)&&"showing"===a.mode){r=!1;break}}r!==this.isSelected_&&this.selected(r)},i.prototype.handleSelectedLanguageChange=function(e){for(var t=this.player().textTracks(),r=!0,i=0,n=t.length;i<n;i++){var a=t[i];if(-1<["captions","descriptions","subtitles"].indexOf(a.kind)&&"showing"===a.mode){r=!1;break}}r&&(this.player_.cache_.selectedLanguage={enabled:!1})},i}(Sh);oc.registerComponent("OffTextTrackMenuItem",Eh);var kh=function(r){function i(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return xl(this,i),t.tracks=e.textTracks(),Ol(this,r.call(this,e,t))}return Rl(i,r),i.prototype.createItems=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Sh,r=void 0;this.label_&&(r=this.label_+" off"),e.push(new Eh(this.player_,{kinds:this.kinds_,kind:this.kind_,label:r})),this.hideThreshold_+=1;var i=this.player_.textTracks();Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]);for(var n=0;n<i.length;n++){var a=i[n];if(-1<this.kinds_.indexOf(a.kind)){var o=new t(this.player_,{track:a,selectable:!0,multiSelectable:!1});o.addClass("vjs-"+a.kind+"-menu-item"),e.push(o)}}return e},i}(bh);oc.registerComponent("TextTrackButton",kh);var wh=function(o){function s(e,t){xl(this,s);var r=t.track,i=t.cue,n=e.currentTime();t.selectable=!0,t.multiSelectable=!1,t.label=i.text,t.selected=i.startTime<=n&&n<i.endTime;var a=Ol(this,o.call(this,e,t));return a.track=r,a.cue=i,r.addEventListener("cuechange",Vu(a,a.update)),a}return Rl(s,o),s.prototype.handleClick=function(e){o.prototype.handleClick.call(this),this.player_.currentTime(this.cue.startTime),this.update(this.cue.startTime)},s.prototype.update=function(e){var t=this.cue,r=this.player_.currentTime();this.selected(t.startTime<=r&&r<t.endTime)},s}(Th);oc.registerComponent("ChaptersTrackMenuItem",wh);var Ch=function(i){function n(e,t,r){return xl(this,n),Ol(this,i.call(this,e,t,r))}return Rl(n,i),n.prototype.buildCSSClass=function(){return"vjs-chapters-button "+i.prototype.buildCSSClass.call(this)},n.prototype.buildWrapperCSSClass=function(){return"vjs-chapters-button "+i.prototype.buildWrapperCSSClass.call(this)},n.prototype.update=function(e){this.track_&&(!e||"addtrack"!==e.type&&"removetrack"!==e.type)||this.setTrack(this.findChaptersTrack()),i.prototype.update.call(this)},n.prototype.setTrack=function(e){if(this.track_!==e){if(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_){var t=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);t&&t.removeEventListener("load",this.updateHandler_),this.track_=null}if(this.track_=e,this.track_){this.track_.mode="hidden";var r=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);r&&r.addEventListener("load",this.updateHandler_)}}},n.prototype.findChaptersTrack=function(){for(var e=this.player_.textTracks()||[],t=e.length-1;0<=t;t--){var r=e[t];if(r.kind===this.kind_)return r}},n.prototype.getMenuCaption=function(){return this.track_&&this.track_.label?this.track_.label:this.localize(nc(this.kind_))},n.prototype.createMenu=function(){return this.options_.title=this.getMenuCaption(),i.prototype.createMenu.call(this)},n.prototype.createItems=function(){var e=[];if(!this.track_)return e;var t=this.track_.cues;if(!t)return e;for(var r=0,i=t.length;r<i;r++){var n=new wh(this.player_,{track:this.track_,cue:t[r]});e.push(n)}return e},n}(kh);Ch.prototype.kind_="chapters",Ch.prototype.controlText_="Chapters",oc.registerComponent("ChaptersButton",Ch);var Ah=function(o){function s(e,t,r){xl(this,s);var i=Ol(this,o.call(this,e,t,r)),n=e.textTracks(),a=Vu(i,i.handleTracksChange);return n.addEventListener("change",a),i.on("dispose",function(){n.removeEventListener("change",a)}),i}return Rl(s,o),s.prototype.handleTracksChange=function(e){for(var t=this.player().textTracks(),r=!1,i=0,n=t.length;i<n;i++){var a=t[i];if(a.kind!==this.kind_&&"showing"===a.mode){r=!0;break}}r?this.disable():this.enable()},s.prototype.buildCSSClass=function(){return"vjs-descriptions-button "+o.prototype.buildCSSClass.call(this)},s.prototype.buildWrapperCSSClass=function(){return"vjs-descriptions-button "+o.prototype.buildWrapperCSSClass.call(this)},s}(kh);Ah.prototype.kind_="descriptions",Ah.prototype.controlText_="Descriptions",oc.registerComponent("DescriptionsButton",Ah);var Lh=function(i){function n(e,t,r){return xl(this,n),Ol(this,i.call(this,e,t,r))}return Rl(n,i),n.prototype.buildCSSClass=function(){return"vjs-subtitles-button "+i.prototype.buildCSSClass.call(this)},n.prototype.buildWrapperCSSClass=function(){return"vjs-subtitles-button "+i.prototype.buildWrapperCSSClass.call(this)},n}(kh);Lh.prototype.kind_="subtitles",Lh.prototype.controlText_="Subtitles",oc.registerComponent("SubtitlesButton",Lh);var Ih=function(i){function n(e,t){xl(this,n),t.track={player:e,kind:t.kind,label:t.kind+" settings",selectable:!1,default:!1,mode:"disabled"},t.selectable=!1,t.name="CaptionSettingsMenuItem";var r=Ol(this,i.call(this,e,t));return r.addClass("vjs-texttrack-settings"),r.controlText(", opens "+t.kind+" settings dialog"),r}return Rl(n,i),n.prototype.handleClick=function(e){this.player().getChild("textTrackSettings").open()},n}(Sh);oc.registerComponent("CaptionSettingsMenuItem",Ih);var Ph=function(i){function n(e,t,r){return xl(this,n),Ol(this,i.call(this,e,t,r))}return Rl(n,i),n.prototype.buildCSSClass=function(){return"vjs-captions-button "+i.prototype.buildCSSClass.call(this)},n.prototype.buildWrapperCSSClass=function(){return"vjs-captions-button "+i.prototype.buildWrapperCSSClass.call(this)},n.prototype.createItems=function(){var e=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(e.push(new Ih(this.player_,{kind:this.kind_})),this.hideThreshold_+=1),i.prototype.createItems.call(this,e)},n}(kh);Ph.prototype.kind_="captions",Ph.prototype.controlText_="Captions",oc.registerComponent("CaptionsButton",Ph);var xh=function(n){function e(){return xl(this,e),Ol(this,n.apply(this,arguments))}return Rl(e,n),e.prototype.createEl=function(e,t,r){var i='<span class="vjs-menu-item-text">'+this.localize(this.options_.label);return"captions"===this.options_.track.kind&&(i+='\n        <span aria-hidden="true" class="vjs-icon-placeholder"></span>\n        <span class="vjs-control-text"> '+this.localize("Captions")+"</span>\n      "),n.prototype.createEl.call(this,e,jl({innerHTML:i+="</span>"},t),r)},e}(Sh);oc.registerComponent("SubsCapsMenuItem",xh);var Rh=function(i){function n(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};xl(this,n);var r=Ol(this,i.call(this,e,t));return r.label_="subtitles",-1<["en","en-us","en-ca","fr-ca"].indexOf(r.player_.language_)&&(r.label_="captions"),r.menuButton_.controlText(nc(r.label_)),r}return Rl(n,i),n.prototype.buildCSSClass=function(){return"vjs-subs-caps-button "+i.prototype.buildCSSClass.call(this)},n.prototype.buildWrapperCSSClass=function(){return"vjs-subs-caps-button "+i.prototype.buildWrapperCSSClass.call(this)},n.prototype.createItems=function(){var e=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(e.push(new Ih(this.player_,{kind:this.label_})),this.hideThreshold_+=1),e=i.prototype.createItems.call(this,e,xh)},n}(kh);Rh.prototype.kinds_=["captions","subtitles"],Rh.prototype.controlText_="Subtitles",oc.registerComponent("SubsCapsButton",Rh);var Oh=function(o){function s(e,t){xl(this,s);var r=t.track,i=e.audioTracks();t.label=r.label||r.language||"Unknown",t.selected=r.enabled;var n=Ol(this,o.call(this,e,t));n.track=r,n.addClass("vjs-"+r.kind+"-menu-item");var a=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];n.handleTracksChange.apply(n,t)};return i.addEventListener("change",a),n.on("dispose",function(){i.removeEventListener("change",a)}),n}return Rl(s,o),s.prototype.createEl=function(e,t,r){var i='<span class="vjs-menu-item-text">'+this.localize(this.options_.label);return"main-desc"===this.options_.track.kind&&(i+='\n        <span aria-hidden="true" class="vjs-icon-placeholder"></span>\n        <span class="vjs-control-text"> '+this.localize("Descriptions")+"</span>\n      "),o.prototype.createEl.call(this,e,jl({innerHTML:i+="</span>"},t),r)},s.prototype.handleClick=function(e){var t=this.player_.audioTracks();o.prototype.handleClick.call(this,e);for(var r=0;r<t.length;r++){var i=t[r];i.enabled=i===this.track}},s.prototype.handleTracksChange=function(e){this.selected(this.track.enabled)},s}(Th);oc.registerComponent("AudioTrackMenuItem",Oh);var Dh=function(r){function i(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return xl(this,i),t.tracks=e.audioTracks(),Ol(this,r.call(this,e,t))}return Rl(i,r),i.prototype.buildCSSClass=function(){return"vjs-audio-button "+r.prototype.buildCSSClass.call(this)},i.prototype.buildWrapperCSSClass=function(){return"vjs-audio-button "+r.prototype.buildWrapperCSSClass.call(this)},i.prototype.createItems=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];this.hideThreshold_=1;for(var t=this.player_.audioTracks(),r=0;r<t.length;r++){e.push(new Oh(this.player_,{track:t[r],selectable:!0,multiSelectable:!1}))}return e},i}(bh);Dh.prototype.controlText_="Audio Track",oc.registerComponent("AudioTrackButton",Dh);var Mh=function(a){function o(e,t){xl(this,o);var r=t.rate,i=parseFloat(r,10);t.label=r,t.selected=1===i,t.selectable=!0,t.multiSelectable=!1;var n=Ol(this,a.call(this,e,t));return n.label=r,n.rate=i,n.on(e,"ratechange",n.update),n}return Rl(o,a),o.prototype.handleClick=function(e){a.prototype.handleClick.call(this),this.player().playbackRate(this.rate)},o.prototype.update=function(e){this.selected(this.player().playbackRate()===this.rate)},o}(Th);Mh.prototype.contentElType="button",oc.registerComponent("PlaybackRateMenuItem",Mh);var Nh=function(i){function n(e,t){xl(this,n);var r=Ol(this,i.call(this,e,t));return r.updateVisibility(),r.updateLabel(),r.on(e,"loadstart",r.updateVisibility),r.on(e,"ratechange",r.updateLabel),r}return Rl(n,i),n.prototype.createEl=function(){var e=i.prototype.createEl.call(this);return this.labelEl_=Xl("div",{className:"vjs-playback-rate-value",innerHTML:"1x"}),e.appendChild(this.labelEl_),e},n.prototype.dispose=function(){this.labelEl_=null,i.prototype.dispose.call(this)},n.prototype.buildCSSClass=function(){return"vjs-playback-rate "+i.prototype.buildCSSClass.call(this)},n.prototype.buildWrapperCSSClass=function(){return"vjs-playback-rate "+i.prototype.buildWrapperCSSClass.call(this)},n.prototype.createMenu=function(){var e=new yh(this.player()),t=this.playbackRates();if(t)for(var r=t.length-1;0<=r;r--)e.addChild(new Mh(this.player(),{rate:t[r]+"x"}));return e},n.prototype.updateARIAAttributes=function(){this.el().setAttribute("aria-valuenow",this.player().playbackRate())},n.prototype.handleClick=function(e){for(var t=this.player().playbackRate(),r=this.playbackRates(),i=r[0],n=0;n<r.length;n++)if(t<r[n]){i=r[n];break}this.player().playbackRate(i)},n.prototype.playbackRates=function(){return this.options_.playbackRates||this.options_.playerOptions&&this.options_.playerOptions.playbackRates},n.prototype.playbackRateSupported=function(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&0<this.playbackRates().length},n.prototype.updateVisibility=function(e){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")},n.prototype.updateLabel=function(e){this.playbackRateSupported()&&(this.labelEl_.innerHTML=this.player().playbackRate()+"x")},n}(_h);Nh.prototype.controlText_="Playback Rate",oc.registerComponent("PlaybackRateMenuButton",Nh);var Fh=function(e){function t(){return xl(this,t),Ol(this,e.apply(this,arguments))}return Rl(t,e),t.prototype.buildCSSClass=function(){return"vjs-spacer "+e.prototype.buildCSSClass.call(this)},t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:this.buildCSSClass()})},t}(oc);oc.registerComponent("Spacer",Fh);var jh=function(t){function e(){return xl(this,e),Ol(this,t.apply(this,arguments))}return Rl(e,t),e.prototype.buildCSSClass=function(){return"vjs-custom-control-spacer "+t.prototype.buildCSSClass.call(this)},e.prototype.createEl=function(){var e=t.prototype.createEl.call(this,{className:this.buildCSSClass()});return e.innerHTML=" ",e},e}(Fh);oc.registerComponent("CustomControlSpacer",jh);var Bh=function(e){function t(){return xl(this,t),Ol(this,e.apply(this,arguments))}return Rl(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-control-bar",dir:"ltr"})},t}(oc);Bh.prototype.options_={children:["playToggle","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","fullscreenToggle"]},oc.registerComponent("ControlBar",Bh);var Uh=function(i){function n(e,t){xl(this,n);var r=Ol(this,i.call(this,e,t));return r.on(e,"error",r.open),r}return Rl(n,i),n.prototype.buildCSSClass=function(){return"vjs-error-display "+i.prototype.buildCSSClass.call(this)},n.prototype.content=function(){var e=this.player().error();return e?this.localize(e.message):""},n}(Xc);Uh.prototype.options_=ac(Xc.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0}),oc.registerComponent("ErrorDisplay",Uh);var Hh="vjs-text-track-settings",Gh=["#000","Black"],qh=["#00F","Blue"],Vh=["#0FF","Cyan"],Wh=["#0F0","Green"],zh=["#F0F","Magenta"],Kh=["#F00","Red"],Yh=["#FFF","White"],Xh=["#FF0","Yellow"],Qh=["1","Opaque"],Jh=["0.5","Semi-Transparent"],Zh=["0","Transparent"],$h={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[Gh,Yh,Kh,Wh,qh,Xh,zh,Vh]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Transparency",options:[Qh,Jh,Zh]},color:{selector:".vjs-fg-color > select",id:"captions-foreground-color-%s",label:"Color",options:[Yh,Gh,Kh,Wh,qh,Xh,zh,Vh]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:function(e){return"1.00"===e?null:+e}},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Transparency",options:[Qh,Jh]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Transparency",options:[Zh,Jh,Qh]}};function ef(e,t){if(t&&(e=t(e)),e&&"none"!==e)return e}$h.windowColor.options=$h.backgroundColor.options;var tf=function(i){function n(e,t){xl(this,n),t.temporary=!1;var r=Ol(this,i.call(this,e,t));return r.updateDisplay=Vu(r,r.updateDisplay),r.fill(),r.hasBeenOpened_=r.hasBeenFilled_=!0,r.endDialog=Xl("p",{className:"vjs-control-text",textContent:r.localize("End of dialog window.")}),r.el().appendChild(r.endDialog),r.setDefaults(),void 0===t.persistTextTrackSettings&&(r.options_.persistTextTrackSettings=r.options_.playerOptions.persistTextTrackSettings),r.on(r.$(".vjs-done-button"),"click",function(){r.saveSettings(),r.close()}),r.on(r.$(".vjs-default-button"),"click",function(){r.setDefaults(),r.updateDisplay()}),Fl($h,function(e){r.on(r.$(e.selector),"change",r.updateDisplay)}),r.options_.persistTextTrackSettings&&r.restoreSettings(),r}return Rl(n,i),n.prototype.dispose=function(){this.endDialog=null,i.prototype.dispose.call(this)},n.prototype.createElSelect_=function(e){var r=this,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"label",n=$h[e],a=n.id.replace("%s",this.id_),o=[t,a].join(" ").trim();return["<"+i+' id="'+a+'" class="'+("label"===i?"vjs-label":"")+'">',this.localize(n.label),"</"+i+">",'<select aria-labelledby="'+o+'">'].concat(n.options.map(function(e){var t=a+"-"+e[1].replace(/\W+/g,"");return'<option id="'+t+'" value="'+e[0]+'" aria-labelledby="'+o+" "+t+'">'+r.localize(e[1])+"</option>"})).concat("</select>").join("")},n.prototype.createElFgColor_=function(){var e="captions-text-legend-"+this.id_;return'<fieldset class="vjs-fg-color vjs-track-setting"><legend id="'+e+'">'+this.localize("Text")+"</legend>"+this.createElSelect_("color",e)+'<span class="vjs-text-opacity vjs-opacity">'+this.createElSelect_("textOpacity",e)+"</span></fieldset>"},n.prototype.createElBgColor_=function(){var e="captions-background-"+this.id_;return'<fieldset class="vjs-bg-color vjs-track-setting"><legend id="'+e+'">'+this.localize("Background")+"</legend>"+this.createElSelect_("backgroundColor",e)+'<span class="vjs-bg-opacity vjs-opacity">'+this.createElSelect_("backgroundOpacity",e)+"</span></fieldset>"},n.prototype.createElWinColor_=function(){var e="captions-window-"+this.id_;return'<fieldset class="vjs-window-color vjs-track-setting"><legend id="'+e+'">'+this.localize("Window")+"</legend>"+this.createElSelect_("windowColor",e)+'<span class="vjs-window-opacity vjs-opacity">'+this.createElSelect_("windowOpacity",e)+"</span></fieldset>"},n.prototype.createElColors_=function(){return Xl("div",{className:"vjs-track-settings-colors",innerHTML:""+this.createElFgColor_()+this.createElBgColor_()+this.createElWinColor_()})},n.prototype.createElFont_=function(){return Xl("div",{className:"vjs-track-settings-font",innerHTML:'<fieldset class="vjs-font-percent vjs-track-setting">'+this.createElSelect_("fontPercent","","legend")+'</fieldset><fieldset class="vjs-edge-style vjs-track-setting">'+this.createElSelect_("edgeStyle","","legend")+'</fieldset><fieldset class="vjs-font-family vjs-track-setting">'+this.createElSelect_("fontFamily","","legend")+"</fieldset>"})},n.prototype.createElControls_=function(){var e=this.localize("restore all settings to the default values");return Xl("div",{className:"vjs-track-settings-controls",innerHTML:'<button class="vjs-default-button" title="'+e+'">'+this.localize("Reset")+'<span class="vjs-control-text"> '+e+'</span></button><button class="vjs-done-button">'+this.localize("Done")+"</button>"})},n.prototype.content=function(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]},n.prototype.label=function(){return this.localize("Caption Settings Dialog")},n.prototype.description=function(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")},n.prototype.buildCSSClass=function(){return i.prototype.buildCSSClass.call(this)+" vjs-text-track-settings"},n.prototype.getValues=function(){var a=this;return function(r,i){var e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;return Nl(r).reduce(function(e,t){return i(e,r[t],t)},e)}($h,function(e,t,r){var i,n=ef((i=a.$(t.selector)).options[i.options.selectedIndex].value,t.parser);return void 0!==n&&(e[r]=n),e},{})},n.prototype.setValues=function(r){var i=this;Fl($h,function(e,t){!function(e,t,r){if(t)for(var i=0;i<e.options.length;i++)if(ef(e.options[i].value,r)===t){e.selectedIndex=i;break}}(i.$(e.selector),r[t],e.parser)})},n.prototype.setDefaults=function(){var r=this;Fl($h,function(e){var t=e.hasOwnProperty("default")?e.default:0;r.$(e.selector).selectedIndex=t})},n.prototype.restoreSettings=function(){var e=void 0;try{e=JSON.parse(Ja.localStorage.getItem(Hh))}catch(e){Il.warn(e)}e&&this.setValues(e)},n.prototype.saveSettings=function(){if(this.options_.persistTextTrackSettings){var e=this.getValues();try{Object.keys(e).length?Ja.localStorage.setItem(Hh,JSON.stringify(e)):Ja.localStorage.removeItem(Hh)}catch(e){Il.warn(e)}}},n.prototype.updateDisplay=function(){var e=this.player_.getChild("textTrackDisplay");e&&e.updateDisplay()},n.prototype.conditionalBlur_=function(){this.previouslyActiveEl_=null,this.off(to,"keydown",this.handleKeyDown);var e=this.player_.controlBar,t=e&&e.subsCapsButton,r=e&&e.captionsButton;t?t.focus():r&&r.focus()},n}(Xc);oc.registerComponent("TextTrackSettings",tf);var rf=function(a){function o(e,t){xl(this,o);var r=t.ResizeObserver||Ja.ResizeObserver;null===t.ResizeObserver&&(r=!1);var i=ac({createEl:!r},t),n=Ol(this,a.call(this,e,i));return n.ResizeObserver=t.ResizeObserver||Ja.ResizeObserver,n.loadListener_=null,n.resizeObserver_=null,n.debouncedHandler_=function(i,n,a){var o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:Ja,s=void 0;return function(){var e=this,t=arguments,r=function(){r=s=null,a||i.apply(e,t)};!s&&a&&i.apply(e,t),o.clearTimeout(s),s=o.setTimeout(r,n)}}(function(){n.resizeHandler()},100,!1,e),r?(n.resizeObserver_=new n.ResizeObserver(n.debouncedHandler_),n.resizeObserver_.observe(e.el())):(n.loadListener_=function(){n.el_.contentWindow&&Ou(n.el_.contentWindow,"resize",n.debouncedHandler_),n.off("load",n.loadListener_)},n.on("load",n.loadListener_)),n}return Rl(o,a),o.prototype.createEl=function(){return a.prototype.createEl.call(this,"iframe",{className:"vjs-resize-manager"})},o.prototype.resizeHandler=function(){this.player_.trigger("playerresize")},o.prototype.dispose=function(){this.resizeObserver_&&(this.player_.el()&&this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect()),this.el_&&this.el_.contentWindow&&Du(this.el_.contentWindow,"resize",this.debouncedHandler_),this.loadListener_&&this.off("load",this.loadListener_),this.ResizeObserver=null,this.resizeObserver=null,this.debouncedHandler_=null,this.loadListener_=null},o}(oc);oc.registerComponent("ResizeManager",rf);var nf=function(e){var t=e.el();if(t.hasAttribute("src"))return e.triggerSourceset(t.src),!0;var r=e.$$("source"),i=[],n="";if(!r.length)return!1;for(var a=0;a<r.length;a++){var o=r[a].src;o&&-1==i.indexOf(o)&&i.push(o)}return!!i.length&&(1===i.length&&(n=i[0]),e.triggerSourceset(n),!0)},af=Object.defineProperty({},"innerHTML",{get:function(){return this.cloneNode(!0).innerHTML},set:function(e){var t=to.createElement(this.nodeName.toLowerCase());t.innerHTML=e;for(var r=to.createDocumentFragment();t.childNodes.length;)r.appendChild(t.childNodes[0]);return this.innerText="",Ja.Element.prototype.appendChild.call(this,r),this.innerHTML}}),of=function(e,t){for(var r={},i=0;i<e.length&&!((r=Object.getOwnPropertyDescriptor(e[i],t))&&r.set&&r.get);i++);return r.enumerable=!0,r.configurable=!0,r},sf=function(a){var o=a.el();if(!o.resetSourceWatch_){var t={},e=of([a.el(),Ja.HTMLMediaElement.prototype,Ja.Element.prototype,af],"innerHTML"),r=function(n){return function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=n.apply(o,t);return nf(a),i}};["append","appendChild","insertAdjacentHTML"].forEach(function(e){o[e]&&(t[e]=o[e],o[e]=r(t[e]))}),Object.defineProperty(o,"innerHTML",ac(e,{set:r(e.set)})),o.resetSourceWatch_=function(){o.resetSourceWatch_=null,Object.keys(t).forEach(function(e){o[e]=t[e]}),Object.defineProperty(o,"innerHTML",e)},a.one("sourceset",o.resetSourceWatch_)}},lf=Object.defineProperty({},"src",{get:function(){return this.hasAttribute("src")?dd(Ja.Element.prototype.getAttribute.call(this,"src")):""},set:function(e){return Ja.Element.prototype.setAttribute.call(this,"src",e),e}}),uf=function(i){if(i.featuresSourceset){var n=i.el();if(!n.resetSourceset_){var r=of([i.el(),Ja.HTMLMediaElement.prototype,lf],"src"),a=n.setAttribute,t=n.load;Object.defineProperty(n,"src",ac(r,{set:function(e){var t=r.set.call(n,e);return i.triggerSourceset(n.src),t}})),n.setAttribute=function(e,t){var r=a.call(n,e,t);return/src/i.test(e)&&i.triggerSourceset(n.src),r},n.load=function(){var e=t.call(n);return nf(i)||(i.triggerSourceset(""),sf(i)),e},n.currentSrc?i.triggerSourceset(n.currentSrc):nf(i)||sf(i),n.resetSourceset_=function(){n.resetSourceset_=null,n.load=t,n.setAttribute=a,Object.defineProperty(n,"src",r),n.resetSourceWatch_&&n.resetSourceWatch_()}}}},cf=Dl(["Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\n            This may prevent text tracks from loading."],["Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\n            This may prevent text tracks from loading."]),df=function(c){function d(e,t){xl(this,d);var r=Ol(this,c.call(this,e,t)),i=e.source,n=!1;if(i&&(r.el_.currentSrc!==i.src||e.tag&&3===e.tag.initNetworkState_)?r.setSource(i):r.handleLateInit_(r.el_),e.enableSourceset&&r.setupSourcesetHandling_(),r.el_.hasChildNodes()){for(var a=r.el_.childNodes,o=a.length,s=[];o--;){var l=a[o];"track"===l.nodeName.toLowerCase()&&(r.featuresNativeTextTracks?(r.remoteTextTrackEls().addTrackElement_(l),r.remoteTextTracks().addTrack(l.track),r.textTracks().addTrack(l.track),n||r.el_.hasAttribute("crossorigin")||!fd(l.src)||(n=!0)):s.push(l))}for(var u=0;u<s.length;u++)r.el_.removeChild(s[u])}return r.proxyNativeTracks_(),r.featuresNativeTextTracks&&n&&Il.warn(ro(cf)),r.restoreMetadataTracksInIOSNativePlayer_(),(Ic||gc||Tc)&&!0===e.nativeControlsForTouch&&r.setControls(!0),r.proxyWebkitFullscreen_(),r.triggerReady(),r}return Rl(d,c),d.prototype.dispose=function(){this.el_&&this.el_.resetSourceset_&&this.el_.resetSourceset_(),d.disposeMediaElement(this.el_),this.options_=null,c.prototype.dispose.call(this)},d.prototype.setupSourcesetHandling_=function(){uf(this)},d.prototype.restoreMetadataTracksInIOSNativePlayer_=function(){var i=this.textTracks(),n=void 0,e=function(){n=[];for(var e=0;e<i.length;e++){var t=i[e];"metadata"===t.kind&&n.push({track:t,storedMode:t.mode})}};e(),i.addEventListener("change",e),this.on("dispose",function(){return i.removeEventListener("change",e)});var t=function e(){for(var t=0;t<n.length;t++){var r=n[t];"disabled"===r.track.mode&&r.track.mode!==r.storedMode&&(r.track.mode=r.storedMode)}i.removeEventListener("change",e)};this.on("webkitbeginfullscreen",function(){i.removeEventListener("change",e),i.removeEventListener("change",t),i.addEventListener("change",t)}),this.on("webkitendfullscreen",function(){i.removeEventListener("change",e),i.addEventListener("change",e),i.removeEventListener("change",t)})},d.prototype.overrideNative_=function(e,t){var r=this;if(t===this["featuresNative"+e+"Tracks"]){var i=e.toLowerCase();this[i+"TracksListeners_"]&&Object.keys(this[i+"TracksListeners_"]).forEach(function(e){r.el()[i+"Tracks"].removeEventListener(e,r[i+"TracksListeners_"][e])}),this["featuresNative"+e+"Tracks"]=!t,this[i+"TracksListeners_"]=null,this.proxyNativeTracksForType_(i)}},d.prototype.overrideNativeAudioTracks=function(e){this.overrideNative_("Audio",e)},d.prototype.overrideNativeVideoTracks=function(e){this.overrideNative_("Video",e)},d.prototype.proxyNativeTracksForType_=function(e){var i=this,t=bd[e],n=this.el()[t.getterName],a=this[t.getterName]();if(this["featuresNative"+t.capitalName+"Tracks"]&&n&&n.addEventListener){var o={change:function(e){a.trigger({type:"change",target:a,currentTarget:a,srcElement:a})},addtrack:function(e){a.addTrack(e.track)},removetrack:function(e){a.removeTrack(e.track)}},r=function(){for(var e=[],t=0;t<a.length;t++){for(var r=!1,i=0;i<n.length;i++)if(n[i]===a[t]){r=!0;break}r||e.push(a[t])}for(;e.length;)a.removeTrack(e.shift())};Object.keys(this[t.getterName+"Listeners_"]=o).forEach(function(t){var r=o[t];n.addEventListener(t,r),i.on("dispose",function(e){return n.removeEventListener(t,r)})}),this.on("loadstart",r),this.on("dispose",function(e){return i.off("loadstart",r)})}},d.prototype.proxyNativeTracks_=function(){var t=this;bd.names.forEach(function(e){t.proxyNativeTracksForType_(e)})},d.prototype.createEl=function(){var e=this.options_.tag;if(!e||!this.options_.playerElIngest&&!this.movingMediaElementInDOM){if(e){var t=e.cloneNode(!0);e.parentNode&&e.parentNode.insertBefore(t,e),d.disposeMediaElement(e),e=t}else{e=to.createElement("video");var r=ac({},this.options_.tag&&iu(this.options_.tag));Ic&&!0===this.options_.nativeControlsForTouch||delete r.controls,ru(e,jl(r,{id:this.options_.techId,class:"vjs-tech"}))}e.playerId=this.options_.playerId}void 0!==this.options_.preload&&au(e,"preload",this.options_.preload);for(var i=["loop","muted","playsinline","autoplay"],n=0;n<i.length;n++){var a=i[n],o=this.options_[a];void 0!==o&&(o?au(e,a,a):ou(e,a),e[a]=o)}return e},d.prototype.handleLateInit_=function(e){if(0!==e.networkState&&3!==e.networkState){if(0===e.readyState){var t=!1,r=function(){t=!0};this.on("loadstart",r);var i=function(){t||this.trigger("loadstart")};return this.on("loadedmetadata",i),void this.ready(function(){this.off("loadstart",r),this.off("loadedmetadata",i),t||this.trigger("loadstart")})}var n=["loadstart"];n.push("loadedmetadata"),2<=e.readyState&&n.push("loadeddata"),3<=e.readyState&&n.push("canplay"),4<=e.readyState&&n.push("canplaythrough"),this.ready(function(){n.forEach(function(e){this.trigger(e)},this)})}},d.prototype.setCurrentTime=function(e){try{this.el_.currentTime=e}catch(e){Il(e,"Video is not ready. (Video.js)")}},d.prototype.duration=function(){var t=this;if(this.el_.duration===1/0&&_c&&kc&&0===this.el_.currentTime){return this.on("timeupdate",function e(){0<t.el_.currentTime&&(t.el_.duration===1/0&&t.trigger("durationchange"),t.off("timeupdate",e))}),NaN}return this.el_.duration||NaN},d.prototype.width=function(){return this.el_.offsetWidth},d.prototype.height=function(){return this.el_.offsetHeight},d.prototype.proxyWebkitFullscreen_=function(){var e=this;if("webkitDisplayingFullscreen"in this.el_){var t=function(){this.trigger("fullscreenchange",{isFullscreen:!1})},r=function(){"webkitPresentationMode"in this.el_&&"picture-in-picture"!==this.el_.webkitPresentationMode&&(this.one("webkitendfullscreen",t),this.trigger("fullscreenchange",{isFullscreen:!0}))};this.on("webkitbeginfullscreen",r),this.on("dispose",function(){e.off("webkitbeginfullscreen",r),e.off("webkitendfullscreen",t)})}},d.prototype.supportsFullScreen=function(){if("function"==typeof this.el_.webkitEnterFullScreen){var e=Ja.navigator&&Ja.navigator.userAgent||"";if(/Android/.test(e)||!/Chrome|Mac OS X 10.5/.test(e))return!0}return!1},d.prototype.enterFullScreen=function(){var e=this.el_;e.paused&&e.networkState<=e.HAVE_METADATA?(this.el_.play(),this.setTimeout(function(){e.pause(),e.webkitEnterFullScreen()},0)):e.webkitEnterFullScreen()},d.prototype.exitFullScreen=function(){this.el_.webkitExitFullScreen()},d.prototype.src=function(e){if(void 0===e)return this.el_.src;this.setSrc(e)},d.prototype.reset=function(){d.resetMediaElement(this.el_)},d.prototype.currentSrc=function(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc},d.prototype.setControls=function(e){this.el_.controls=!!e},d.prototype.addTextTrack=function(e,t,r){return this.featuresNativeTextTracks?this.el_.addTextTrack(e,t,r):c.prototype.addTextTrack.call(this,e,t,r)},d.prototype.createRemoteTextTrack=function(e){if(!this.featuresNativeTextTracks)return c.prototype.createRemoteTextTrack.call(this,e);var t=to.createElement("track");return e.kind&&(t.kind=e.kind),e.label&&(t.label=e.label),(e.language||e.srclang)&&(t.srclang=e.language||e.srclang),e.default&&(t.default=e.default),e.id&&(t.id=e.id),e.src&&(t.src=e.src),t},d.prototype.addRemoteTextTrack=function(e,t){var r=c.prototype.addRemoteTextTrack.call(this,e,t);return this.featuresNativeTextTracks&&this.el().appendChild(r),r},d.prototype.removeRemoteTextTrack=function(e){if(c.prototype.removeRemoteTextTrack.call(this,e),this.featuresNativeTextTracks)for(var t=this.$$("track"),r=t.length;r--;)e!==t[r]&&e!==t[r].track||this.el().removeChild(t[r])},d.prototype.getVideoPlaybackQuality=function(){if("function"==typeof this.el().getVideoPlaybackQuality)return this.el().getVideoPlaybackQuality();var e={};return void 0!==this.el().webkitDroppedFrameCount&&void 0!==this.el().webkitDecodedFrameCount&&(e.droppedVideoFrames=this.el().webkitDroppedFrameCount,e.totalVideoFrames=this.el().webkitDecodedFrameCount),Ja.performance&&"function"==typeof Ja.performance.now?e.creationTime=Ja.performance.now():Ja.performance&&Ja.performance.timing&&"number"==typeof Ja.performance.timing.navigationStart&&(e.creationTime=Ja.Date.now()-Ja.performance.timing.navigationStart),e},d}(Ed);if(Wl()){df.TEST_VID=to.createElement("video");var hf=to.createElement("track");hf.kind="captions",hf.srclang="en",hf.label="English",df.TEST_VID.appendChild(hf)}df.isSupported=function(){try{df.TEST_VID.volume=.5}catch(e){return!1}return!(!df.TEST_VID||!df.TEST_VID.canPlayType)},df.canPlayType=function(e){return df.TEST_VID.canPlayType(e)},df.canPlaySource=function(e,t){return df.canPlayType(e.type)},df.canControlVolume=function(){try{var e=df.TEST_VID.volume;return df.TEST_VID.volume=e/2+.1,e!==df.TEST_VID.volume}catch(e){return!1}},df.canMuteVolume=function(){try{var e=df.TEST_VID.muted;return df.TEST_VID.muted=!e,df.TEST_VID.muted?au(df.TEST_VID,"muted","muted"):ou(df.TEST_VID,"muted"),e!==df.TEST_VID.muted}catch(e){return!1}},df.canControlPlaybackRate=function(){if(_c&&kc&&wc<58)return!1;try{var e=df.TEST_VID.playbackRate;return df.TEST_VID.playbackRate=e/2+.1,e!==df.TEST_VID.playbackRate}catch(e){return!1}},df.canOverrideAttributes=function(){try{var e=function(){};Object.defineProperty(to.createElement("video"),"src",{get:e,set:e}),Object.defineProperty(to.createElement("audio"),"src",{get:e,set:e}),Object.defineProperty(to.createElement("video"),"innerHTML",{get:e,set:e}),Object.defineProperty(to.createElement("audio"),"innerHTML",{get:e,set:e})}catch(e){return!1}return!0},df.supportsNativeTextTracks=function(){return Lc||vc&&kc},df.supportsNativeVideoTracks=function(){return!(!df.TEST_VID||!df.TEST_VID.videoTracks)},df.supportsNativeAudioTracks=function(){return!(!df.TEST_VID||!df.TEST_VID.audioTracks)},df.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"],df.prototype.featuresVolumeControl=df.canControlVolume(),df.prototype.featuresMuteControl=df.canMuteVolume(),df.prototype.featuresPlaybackRate=df.canControlPlaybackRate(),df.prototype.featuresSourceset=df.canOverrideAttributes(),df.prototype.movingMediaElementInDOM=!vc,df.prototype.featuresFullscreenResize=!0,df.prototype.featuresProgressEvents=!0,df.prototype.featuresTimeupdateEvents=!0,df.prototype.featuresNativeTextTracks=df.supportsNativeTextTracks(),df.prototype.featuresNativeVideoTracks=df.supportsNativeVideoTracks(),df.prototype.featuresNativeAudioTracks=df.supportsNativeAudioTracks();var ff=df.TEST_VID&&df.TEST_VID.constructor.prototype.canPlayType,pf=/^application\/(?:x-|vnd\.apple\.)mpegurl/i;df.patchCanPlayType=function(){4<=bc&&!Sc&&!kc&&(df.TEST_VID.constructor.prototype.canPlayType=function(e){return e&&pf.test(e)?"maybe":ff.call(this,e)})},df.unpatchCanPlayType=function(){var e=df.TEST_VID.constructor.prototype.canPlayType;return df.TEST_VID.constructor.prototype.canPlayType=ff,e},df.patchCanPlayType(),df.disposeMediaElement=function(e){if(e){for(e.parentNode&&e.parentNode.removeChild(e);e.hasChildNodes();)e.removeChild(e.firstChild);e.removeAttribute("src"),"function"==typeof e.load&&function(){try{e.load()}catch(e){}}()}},df.resetMediaElement=function(e){if(e){for(var t=e.querySelectorAll("source"),r=t.length;r--;)e.removeChild(t[r]);e.removeAttribute("src"),"function"==typeof e.load&&function(){try{e.load()}catch(e){}}()}},["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach(function(e){df.prototype[e]=function(){return this.el_[e]||this.el_.hasAttribute(e)}}),["muted","defaultMuted","autoplay","loop","playsinline"].forEach(function(t){df.prototype["set"+nc(t)]=function(e){(this.el_[t]=e)?this.el_.setAttribute(t,t):this.el_.removeAttribute(t)}}),["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","played","networkState","readyState","videoWidth","videoHeight"].forEach(function(e){df.prototype[e]=function(){return this.el_[e]}}),["volume","src","poster","preload","playbackRate","defaultPlaybackRate"].forEach(function(t){df.prototype["set"+nc(t)]=function(e){this.el_[t]=e}}),["pause","load","play"].forEach(function(e){df.prototype[e]=function(){return this.el_[e]()}}),Ed.withSourceHandlers(df),df.nativeSourceHandler={},df.nativeSourceHandler.canPlayType=function(e){try{return df.TEST_VID.canPlayType(e)}catch(e){return""}},df.nativeSourceHandler.canHandleSource=function(e,t){if(e.type)return df.nativeSourceHandler.canPlayType(e.type);if(e.src){var r=hd(e.src);return df.nativeSourceHandler.canPlayType("video/"+r)}return""},df.nativeSourceHandler.handleSource=function(e,t,r){t.setSrc(e.src)},df.nativeSourceHandler.dispose=function(){},df.registerSourceHandler(df.nativeSourceHandler),Ed.registerTech("Html5",df);var gf=Dl(["\n        Using the tech directly can be dangerous. I hope you know what you're doing.\n        See https://github.com/videojs/video.js/issues/2617 for more info.\n      "],["\n        Using the tech directly can be dangerous. I hope you know what you're doing.\n        See https://github.com/videojs/video.js/issues/2617 for more info.\n      "]),mf=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"],vf={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"},yf=function(c){function u(e,t,r){if(xl(this,u),e.id=e.id||t.id||"vjs_video_"+Su(),(t=jl(u.getTagSettings(e),t)).initChildren=!1,t.createEl=!1,t.evented=!1,t.reportTouchActivity=!1,!t.language)if("function"==typeof e.closest){var i=e.closest("[lang]");i&&i.getAttribute&&(t.language=i.getAttribute("lang"))}else for(var n=e;n&&1===n.nodeType;){if(iu(n).hasOwnProperty("lang")){t.language=n.getAttribute("lang");break}n=n.parentNode}var a=Ol(this,c.call(this,null,t,r));if(a.isPosterFromTech_=!1,a.queuedCallbacks_=[],a.isReady_=!1,a.hasStarted_=!1,a.userActive_=!1,!a.options_||!a.options_.techOrder||!a.options_.techOrder.length)throw Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");if(a.tag=e,a.tagAttributes=e&&iu(e),a.language(a.options_.language),t.languages){var o={};Object.getOwnPropertyNames(t.languages).forEach(function(e){o[e.toLowerCase()]=t.languages[e]}),a.languages_=o}else a.languages_=u.prototype.options_.languages;a.cache_={},a.poster_=t.poster||"",a.controls_=!!t.controls,e.controls=!(a.cache_.lastVolume=1),e.removeAttribute("controls"),e.hasAttribute("autoplay")?a.options_.autoplay=!0:a.autoplay(a.options_.autoplay),a.scrubbing_=!1,a.el_=a.createEl(),a.cache_.lastPlaybackRate=a.defaultPlaybackRate(),tc(a,{eventBusKey:"el_"});var s=ac(a.options_);if(t.plugins){var l=t.plugins;Object.keys(l).forEach(function(e){if("function"!=typeof this[e])throw Error('plugin "'+e+'" does not exist');this[e](l[e])},a)}a.options_.playerOptions=s,a.middleware_=[],a.initChildren(),a.isAudio("audio"===e.nodeName.toLowerCase()),a.controls()?a.addClass("vjs-controls-enabled"):a.addClass("vjs-controls-disabled"),a.el_.setAttribute("role","region"),a.isAudio()?a.el_.setAttribute("aria-label",a.localize("Audio Player")):a.el_.setAttribute("aria-label",a.localize("Video Player")),a.isAudio()&&a.addClass("vjs-audio"),a.flexNotSupported_()&&a.addClass("vjs-no-flex"),vc||a.addClass("vjs-workinghover");return(u.players[a.id_]=a).addClass("vjs-v7"),a.userActive(!0),a.reportUserActivity(),a.one("play",a.listenForUserActivity_),a.on("fullscreenchange",a.handleFullscreenChange_),a.on("stageclick",a.handleStageClick_),a.changingSrc_=!1,a.playWaitingForReady_=!1,a.playOnLoadstart_=null,a}return Rl(u,c),u.prototype.dispose=function(){this.trigger("dispose"),this.off("dispose"),this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null),u.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=!1,this.poster_=""),this.playerElIngest_&&(this.playerElIngest_=null),this.tag&&(this.tag=null),wd[this.id()]=null,c.prototype.dispose.call(this)},u.prototype.createEl=function(){var t=this.tag,r=void 0,e=this.playerElIngest_=t.parentNode&&t.parentNode.hasAttribute&&t.parentNode.hasAttribute("data-vjs-player"),i="video-js"===this.tag.tagName.toLowerCase();e?r=this.el_=t.parentNode:i||(r=this.el_=c.prototype.createEl.call(this,"div"));var n=iu(t);if(i){for(r=this.el_=t,t=this.tag=to.createElement("video");r.children.length;)t.appendChild(r.firstChild);Zl(r,"video-js")||$l(r,"video-js"),r.appendChild(t),e=this.playerElIngest_=r,Object.keys(r).forEach(function(e){t[e]=r[e]})}if(t.setAttribute("tabindex","-1"),Cc&&t.setAttribute("role","application"),t.removeAttribute("width"),t.removeAttribute("height"),Object.getOwnPropertyNames(n).forEach(function(e){i&&"class"===e||r.setAttribute(e,n[e]),i&&t.setAttribute(e,n[e])}),t.playerId=t.id,t.id+="_html5_api",t.className="vjs-tech",t.player=r.player=this,this.addClass("vjs-paused"),!0!==Ja.VIDEOJS_NO_DYNAMIC_STYLE){this.styleEl_=Gu("vjs-styles-dimensions");var a=yu(".vjs-styles-defaults"),o=yu("head");o.insertBefore(this.styleEl_,a?a.nextSibling:o.firstChild)}this.width(this.options_.width),this.height(this.options_.height),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio);for(var s=t.getElementsByTagName("a"),l=0;l<s.length;l++){var u=s.item(l);$l(u,"vjs-hidden"),u.setAttribute("hidden","hidden")}return t.initNetworkState_=t.networkState,t.parentNode&&!e&&t.parentNode.insertBefore(r,t),Jl(t,r),this.children_.unshift(t),this.el_.setAttribute("lang",this.language_),this.el_=r},u.prototype.width=function(e){return this.dimension("width",e)},u.prototype.height=function(e){return this.dimension("height",e)},u.prototype.dimension=function(e,t){var r=e+"_";if(void 0===t)return this[r]||0;if(""===t)return this[r]=void 0,void this.updateStyleEl_();var i=parseFloat(t);isNaN(i)?Il.error('Improper value "'+t+'" supplied for for '+e):(this[r]=i,this.updateStyleEl_())},u.prototype.fluid=function(e){if(void 0===e)return!!this.fluid_;this.fluid_=!!e,e?this.addClass("vjs-fluid"):this.removeClass("vjs-fluid"),this.updateStyleEl_()},u.prototype.aspectRatio=function(e){if(void 0===e)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(e))throw Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=e,this.fluid(!0),this.updateStyleEl_()},u.prototype.updateStyleEl_=function(){if(!0!==Ja.VIDEOJS_NO_DYNAMIC_STYLE){var e=void 0,t=void 0,r=void 0,i=(void 0!==this.aspectRatio_&&"auto"!==this.aspectRatio_?this.aspectRatio_:0<this.videoWidth()?this.videoWidth()+":"+this.videoHeight():"16:9").split(":"),n=i[1]/i[0];e=void 0!==this.width_?this.width_:void 0!==this.height_?this.height_/n:this.videoWidth()||300,t=void 0!==this.height_?this.height_:e*n,r=/^[^a-zA-Z]/.test(this.id())?"dimensions-"+this.id():this.id()+"-dimensions",this.addClass(r),qu(this.styleEl_,"\n      ."+r+" {\n        width: "+e+"px;\n        height: "+t+"px;\n      }\n\n      ."+r+".vjs-fluid {\n        padding-top: "+100*n+"%;\n      }\n    ")}else{var a="number"==typeof this.width_?this.width_:this.options_.width,o="number"==typeof this.height_?this.height_:this.options_.height,s=this.tech_&&this.tech_.el();s&&(0<=a&&(s.width=a),0<=o&&(s.height=o))}},u.prototype.loadTech_=function(e,t){var r=this;this.tech_&&this.unloadTech_();var i=nc(e),n=e.charAt(0).toLowerCase()+e.slice(1);"Html5"!==i&&this.tag&&(Ed.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=i,this.isReady_=!1;var a={source:t,autoplay:"string"!=typeof this.autoplay()&&this.autoplay(),nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:this.id()+"_"+i+"_api",playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset};Sd.names.forEach(function(e){var t=Sd[e];a[t.getterName]=r[t.privateName]}),jl(a,this.options_[i]),jl(a,this.options_[n]),jl(a,this.options_[e.toLowerCase()]),this.tag&&(a.tag=this.tag),t&&t.src===this.cache_.src&&0<this.cache_.currentTime&&(a.startTime=this.cache_.currentTime);var o=Ed.getTech(e);if(!o)throw Error("No Tech named '"+i+"' exists! '"+i+"' should be registered using videojs.registerTech()'");this.tech_=new o(a),this.tech_.ready(Vu(this,this.handleTechReady_),!0),Kc(this.textTracksJson_||[],this.tech_),mf.forEach(function(e){r.on(r.tech_,e,r["handleTech"+nc(e)+"_"])}),Object.keys(vf).forEach(function(t){r.on(r.tech_,t,function(e){0===r.tech_.playbackRate()&&r.tech_.seeking()?r.queuedCallbacks_.push({callback:r["handleTech"+vf[t]+"_"].bind(r),event:e}):r["handleTech"+vf[t]+"_"](e)})}),this.on(this.tech_,"loadstart",this.handleTechLoadStart_),this.on(this.tech_,"sourceset",this.handleTechSourceset_),this.on(this.tech_,"waiting",this.handleTechWaiting_),this.on(this.tech_,"ended",this.handleTechEnded_),this.on(this.tech_,"seeking",this.handleTechSeeking_),this.on(this.tech_,"play",this.handleTechPlay_),this.on(this.tech_,"firstplay",this.handleTechFirstPlay_),this.on(this.tech_,"pause",this.handleTechPause_),this.on(this.tech_,"durationchange",this.handleTechDurationChange_),this.on(this.tech_,"fullscreenchange",this.handleTechFullscreenChange_),this.on(this.tech_,"error",this.handleTechError_),this.on(this.tech_,"loadedmetadata",this.updateStyleEl_),this.on(this.tech_,"posterchange",this.handleTechPosterChange_),this.on(this.tech_,"textdata",this.handleTechTextData_),this.on(this.tech_,"ratechange",this.handleTechRateChange_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode===this.el()||"Html5"===i&&this.tag||Jl(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)},u.prototype.unloadTech_=function(){var r=this;Sd.names.forEach(function(e){var t=Sd[e];r[t.privateName]=r[t.getterName]()}),this.textTracksJson_=zc(this.tech_),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1,this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange")),this.isPosterFromTech_=!1},u.prototype.tech=function(e){return void 0===e&&Il.warn(ro(gf)),this.tech_},u.prototype.addTechControlsListeners_=function(){this.removeTechControlsListeners_(),this.on(this.tech_,"mousedown",this.handleTechClick_),this.on(this.tech_,"dblclick",this.handleTechDoubleClick_),this.on(this.tech_,"touchstart",this.handleTechTouchStart_),this.on(this.tech_,"touchmove",this.handleTechTouchMove_),this.on(this.tech_,"touchend",this.handleTechTouchEnd_),this.on(this.tech_,"tap",this.handleTechTap_)},u.prototype.removeTechControlsListeners_=function(){this.off(this.tech_,"tap",this.handleTechTap_),this.off(this.tech_,"touchstart",this.handleTechTouchStart_),this.off(this.tech_,"touchmove",this.handleTechTouchMove_),this.off(this.tech_,"touchend",this.handleTechTouchEnd_),this.off(this.tech_,"mousedown",this.handleTechClick_),this.off(this.tech_,"dblclick",this.handleTechDoubleClick_)},u.prototype.handleTechReady_=function(){this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_()},u.prototype.handleTechLoadStart_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-seeking"),this.error(null),this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):(this.trigger("loadstart"),this.trigger("firstplay")),this.manualAutoplay_(this.autoplay())},u.prototype.manualAutoplay_=function(t){var r=this;if(this.tech_&&"string"==typeof t){var e=function(){var t=r.muted();r.muted(!0);var e=r.play();if(e&&e.then&&e.catch)return e.catch(function(e){r.muted(t)})},i=void 0;if("any"===t?(i=this.play())&&i.then&&i.catch&&i.catch(function(){return e()}):i="muted"===t?e():this.play(),i&&i.then&&i.catch)return i.then(function(){r.trigger({type:"autoplay-success",autoplay:t})}).catch(function(e){r.trigger({type:"autoplay-failure",autoplay:t})})}},u.prototype.updateSourceCaches_=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=e,r="";"string"!=typeof t&&(t=e.src,r=e.type),this.cache_.source=this.cache_.source||{},this.cache_.sources=this.cache_.sources||[],t&&!r&&(r=function(e,t){if(!t)return"";if(e.cache_.source.src===t&&e.cache_.source.type)return e.cache_.source.type;var r=e.cache_.sources.filter(function(e){return e.src===t});if(r.length)return r[0].type;for(var i=e.$$("source"),n=0;n<i.length;n++){var a=i[n];if(a.type&&a.src&&a.src===t)return a.type}return Md(t)}(this,t)),this.cache_.source=ac({},e,{src:t,type:r});for(var i=this.cache_.sources.filter(function(e){return e.src&&e.src===t}),n=[],a=this.$$("source"),o=[],s=0;s<a.length;s++){var l=iu(a[s]);n.push(l),l.src&&l.src===t&&o.push(l.src)}o.length&&!i.length?this.cache_.sources=n:i.length||(this.cache_.sources=[this.cache_.source]),this.cache_.src=t},u.prototype.handleTechSourceset_=function(e){var r=this;if(!this.changingSrc_&&(this.updateSourceCaches_(e.src),!e.src)){this.tech_.one(["sourceset","loadstart"],function e(t){"sourceset"!==t.type&&r.updateSourceCaches_(r.techGet_("currentSrc")),r.tech_.off(["sourceset","loadstart"],e)})}this.trigger({src:e.src,type:"sourceset"})},u.prototype.hasStarted=function(e){if(void 0===e)return this.hasStarted_;e!==this.hasStarted_&&(this.hasStarted_=e,this.hasStarted_?(this.addClass("vjs-has-started"),this.trigger("firstplay")):this.removeClass("vjs-has-started"))},u.prototype.handleTechPlay_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")},u.prototype.handleTechRateChange_=function(){0<this.tech_.playbackRate()&&0===this.cache_.lastPlaybackRate&&(this.queuedCallbacks_.forEach(function(e){return e.callback(e.event)}),this.queuedCallbacks_=[]),this.cache_.lastPlaybackRate=this.tech_.playbackRate(),this.trigger("ratechange")},u.prototype.handleTechWaiting_=function(){var e=this;this.addClass("vjs-waiting"),this.trigger("waiting"),this.one("timeupdate",function(){return e.removeClass("vjs-waiting")})},u.prototype.handleTechCanPlay_=function(){this.removeClass("vjs-waiting"),this.trigger("canplay")},u.prototype.handleTechCanPlayThrough_=function(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")},u.prototype.handleTechPlaying_=function(){this.removeClass("vjs-waiting"),this.trigger("playing")},u.prototype.handleTechSeeking_=function(){this.addClass("vjs-seeking"),this.trigger("seeking")},u.prototype.handleTechSeeked_=function(){this.removeClass("vjs-seeking"),this.trigger("seeked")},u.prototype.handleTechFirstPlay_=function(){this.options_.starttime&&(Il.warn("Passing the `starttime` option to the player will be deprecated in 6.0"),this.currentTime(this.options_.starttime)),this.addClass("vjs-has-started"),this.trigger("firstplay")},u.prototype.handleTechPause_=function(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")},u.prototype.handleTechEnded_=function(){this.addClass("vjs-ended"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")},u.prototype.handleTechDurationChange_=function(){this.duration(this.techGet_("duration"))},u.prototype.handleTechClick_=function(e){vu(e)&&this.controls_&&(this.paused()?Vc(this.play()):this.pause())},u.prototype.handleTechDoubleClick_=function(t){this.controls_&&(Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),function(e){return e.contains(t.target)})||(this.isFullscreen()?this.exitFullscreen():this.requestFullscreen()))},u.prototype.handleTechTap_=function(){this.userActive(!this.userActive())},u.prototype.handleTechTouchStart_=function(){this.userWasActive=this.userActive()},u.prototype.handleTechTouchMove_=function(){this.userWasActive&&this.reportUserActivity()},u.prototype.handleTechTouchEnd_=function(e){e.preventDefault()},u.prototype.handleFullscreenChange_=function(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")},u.prototype.handleStageClick_=function(){this.reportUserActivity()},u.prototype.handleTechFullscreenChange_=function(e,t){t&&this.isFullscreen(t.isFullscreen),this.trigger("fullscreenchange")},u.prototype.handleTechError_=function(){var e=this.tech_.error();this.error(e)},u.prototype.handleTechTextData_=function(){var e=null;1<arguments.length&&(e=arguments[1]),this.trigger("textdata",e)},u.prototype.getCache=function(){return this.cache_},u.prototype.techCall_=function(r,i){this.ready(function(){if(r in Pd)return t=i,this.tech_[e=r](this.middleware_.reduce(Rd(e),t));if(r in xd)return Ld(this.middleware_,this.tech_,r,i);var e,t;try{this.tech_&&this.tech_[r](i)}catch(e){throw Il(e),e}},!0)},u.prototype.techGet_=function(t){if(this.tech_&&this.tech_.isReady_){if(t in Id)return e=this.tech_,this.middleware_.reduceRight(Rd(r=t),e[r]());if(t in xd)return Ld(this.middleware_,this.tech_,t);var e,r;try{return this.tech_[t]()}catch(e){if(void 0===this.tech_[t])throw Il("Video.js: "+t+" method not defined for "+this.techName_+" playback technology.",e),e;if("TypeError"===e.name)throw Il("Video.js: "+t+" unavailable on "+this.techName_+" playback technology element.",e),this.tech_.isReady_=!1,e;throw Il(e),e}}},u.prototype.play=function(){var e=this;if(this.playOnLoadstart_&&this.off("loadstart",this.playOnLoadstart_),this.isReady_){if(!this.changingSrc_&&(this.src()||this.currentSrc()))return this.techGet_("play");this.playOnLoadstart_=function(){e.playOnLoadstart_=null,Vc(e.play())},this.one("loadstart",this.playOnLoadstart_)}else{if(this.playWaitingForReady_)return;this.playWaitingForReady_=!0,this.ready(function(){e.playWaitingForReady_=!1,Vc(e.play())})}},u.prototype.pause=function(){this.techCall_("pause")},u.prototype.paused=function(){return!1!==this.techGet_("paused")},u.prototype.played=function(){return this.techGet_("played")||Oc(0,0)},u.prototype.scrubbing=function(e){if(void 0===e)return this.scrubbing_;this.scrubbing_=!!e,e?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")},u.prototype.currentTime=function(e){return void 0!==e?(e<0&&(e=0),void this.techCall_("setCurrentTime",e)):(this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime)},u.prototype.duration=function(e){if(void 0===e)return void 0!==this.cache_.duration?this.cache_.duration:NaN;(e=parseFloat(e))<0&&(e=1/0),e!==this.cache_.duration&&((this.cache_.duration=e)===1/0?this.addClass("vjs-live"):this.removeClass("vjs-live"),this.trigger("durationchange"))},u.prototype.remainingTime=function(){return this.duration()-this.currentTime()},u.prototype.remainingTimeDisplay=function(){return Math.floor(this.duration())-Math.floor(this.currentTime())},u.prototype.buffered=function(){var e=this.techGet_("buffered");return e&&e.length||(e=Oc(0,0)),e},u.prototype.bufferedPercent=function(){return Dc(this.buffered(),this.duration())},u.prototype.bufferedEnd=function(){var e=this.buffered(),t=this.duration(),r=e.end(e.length-1);return t<r&&(r=t),r},u.prototype.volume=function(e){var t=void 0;return void 0!==e?(this.cache_.volume=t=Math.max(0,Math.min(1,parseFloat(e))),this.techCall_("setVolume",t),void(0<t&&this.lastVolume_(t))):(t=parseFloat(this.techGet_("volume")),isNaN(t)?1:t)},u.prototype.muted=function(e){if(void 0===e)return this.techGet_("muted")||!1;this.techCall_("setMuted",e)},u.prototype.defaultMuted=function(e){return void 0!==e?this.techCall_("setDefaultMuted",e):this.techGet_("defaultMuted")||!1},u.prototype.lastVolume_=function(e){if(void 0===e||0===e)return this.cache_.lastVolume;this.cache_.lastVolume=e},u.prototype.supportsFullScreen=function(){return this.techGet_("supportsFullScreen")||!1},u.prototype.isFullscreen=function(e){if(void 0===e)return!!this.isFullscreen_;this.isFullscreen_=!!e},u.prototype.requestFullscreen=function(){var r=Mc;this.isFullscreen(!0),r.requestFullscreen?(Ou(to,r.fullscreenchange,Vu(this,function e(t){this.isFullscreen(to[r.fullscreenElement]),!1===this.isFullscreen()&&Du(to,r.fullscreenchange,e),this.trigger("fullscreenchange")})),this.el_[r.requestFullscreen]()):this.tech_.supportsFullScreen()?this.techCall_("enterFullScreen"):(this.enterFullWindow(),this.trigger("fullscreenchange"))},u.prototype.exitFullscreen=function(){var e=Mc;this.isFullscreen(!1),e.requestFullscreen?to[e.exitFullscreen]():this.tech_.supportsFullScreen()?this.techCall_("exitFullScreen"):(this.exitFullWindow(),this.trigger("fullscreenchange"))},u.prototype.enterFullWindow=function(){this.isFullWindow=!0,this.docOrigOverflow=to.documentElement.style.overflow,Ou(to,"keydown",Vu(this,this.fullWindowOnEscKey)),to.documentElement.style.overflow="hidden",$l(to.body,"vjs-full-window"),this.trigger("enterFullWindow")},u.prototype.fullWindowOnEscKey=function(e){27===e.keyCode&&(!0===this.isFullscreen()?this.exitFullscreen():this.exitFullWindow())},u.prototype.exitFullWindow=function(){this.isFullWindow=!1,Du(to,"keydown",this.fullWindowOnEscKey),to.documentElement.style.overflow=this.docOrigOverflow,eu(to.body,"vjs-full-window"),this.trigger("exitFullWindow")},u.prototype.canPlayType=function(e){for(var t=void 0,r=0,i=this.options_.techOrder;r<i.length;r++){var n=i[r],a=Ed.getTech(n);if(a||(a=oc.getComponent(n)),a){if(a.isSupported()&&(t=a.canPlayType(e)))return t}else Il.error('The "'+n+'" tech is undefined. Skipped browser support check for that tech.')}return""},u.prototype.selectSource=function(e){var r,i=this,t=this.options_.techOrder.map(function(e){return[e,Ed.getTech(e)]}).filter(function(e){var t=e[0],r=e[1];return r?r.isSupported():(Il.error('The "'+t+'" tech is undefined. Skipped browser support check for that tech.'),!1)}),n=function(e,r,i){var n=void 0;return e.some(function(t){return r.some(function(e){if(n=i(t,e))return!0})}),n},a=function(e,t){var r=e[0];if(e[1].canPlaySource(t,i.options_[r.toLowerCase()]))return{source:t,tech:r}};return(this.options_.sourceOrder?n(e,t,(r=a,function(e,t){return r(t,e)})):n(t,e,a))||!1},u.prototype.src=function(e){var i=this;if(void 0===e)return this.cache_.src||"";var n=function t(e){if(Array.isArray(e)){var r=[];e.forEach(function(e){e=t(e),Array.isArray(e)?r=r.concat(e):Bl(e)&&r.push(e)}),e=r}else e="string"==typeof e&&e.trim()?[Nd({src:e})]:Bl(e)&&"string"==typeof e.src&&e.src&&e.src.trim()?[Nd(e)]:[];return e}(e);n.length?(this.changingSrc_=!0,this.cache_.sources=n,this.updateSourceCaches_(n[0]),Ad(this,n[0],function(e,t){var r;if(i.middleware_=t,i.cache_.sources=n,i.updateSourceCaches_(e),i.src_(e))return 1<n.length?i.src(n.slice(1)):(i.changingSrc_=!1,i.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0),void i.triggerReady());r=i.tech_,t.forEach(function(e){return e.setTech&&e.setTech(r)})})):this.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0)},u.prototype.src_=function(e){var t,r=this,i=this.selectSource([e]);return!i||(t=this.techName_,nc(i.tech)!==nc(t)?(this.changingSrc_=!0,this.loadTech_(i.tech,i.source),this.tech_.ready(function(){r.changingSrc_=!1})):this.ready(function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",e):this.techCall_("src",e.src),this.changingSrc_=!1},!0),!1)},u.prototype.load=function(){this.techCall_("load")},u.prototype.reset=function(){this.loadTech_(this.options_.techOrder[0],null),this.techCall_("reset")},u.prototype.currentSources=function(){var e=this.currentSource(),t=[];return 0!==Object.keys(e).length&&t.push(e),this.cache_.sources||t},u.prototype.currentSource=function(){return this.cache_.source||{}},u.prototype.currentSrc=function(){return this.currentSource()&&this.currentSource().src||""},u.prototype.currentType=function(){return this.currentSource()&&this.currentSource().type||""},u.prototype.preload=function(e){return void 0!==e?(this.techCall_("setPreload",e),void(this.options_.preload=e)):this.techGet_("preload")},u.prototype.autoplay=function(e){if(void 0===e)return this.options_.autoplay||!1;var t=void 0;"string"==typeof e&&/(any|play|muted)/.test(e)?(this.options_.autoplay=e,this.manualAutoplay_(e),t=!1):this.options_.autoplay=!!e,t=t||this.options_.autoplay,this.tech_&&this.techCall_("setAutoplay",t)},u.prototype.playsinline=function(e){return void 0!==e?(this.techCall_("setPlaysinline",e),this.options_.playsinline=e,this):this.techGet_("playsinline")},u.prototype.loop=function(e){return void 0!==e?(this.techCall_("setLoop",e),void(this.options_.loop=e)):this.techGet_("loop")},u.prototype.poster=function(e){if(void 0===e)return this.poster_;e||(e=""),e!==this.poster_&&(this.poster_=e,this.techCall_("setPoster",e),this.isPosterFromTech_=!1,this.trigger("posterchange"))},u.prototype.handleTechPosterChange_=function(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){var e=this.tech_.poster()||"";e!==this.poster_&&(this.poster_=e,this.isPosterFromTech_=!0,this.trigger("posterchange"))}},u.prototype.controls=function(e){if(void 0===e)return!!this.controls_;this.controls_!==(e=!!e)&&(this.controls_=e,this.usingNativeControls()&&this.techCall_("setControls",e),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))},u.prototype.usingNativeControls=function(e){if(void 0===e)return!!this.usingNativeControls_;this.usingNativeControls_!==(e=!!e)&&(this.usingNativeControls_=e,this.usingNativeControls_?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))},u.prototype.error=function(e){return void 0===e?this.error_||null:null===e?(this.error_=e,this.removeClass("vjs-error"),void(this.errorDisplay&&this.errorDisplay.close())):(this.error_=new Hc(e),this.addClass("vjs-error"),Il.error("(CODE:"+this.error_.code+" "+Hc.errorTypes[this.error_.code]+")",this.error_.message,this.error_),void this.trigger("error"))},u.prototype.reportUserActivity=function(e){this.userActivity_=!0},u.prototype.userActive=function(e){if(void 0===e)return this.userActive_;if((e=!!e)!==this.userActive_){if(this.userActive_=e,this.userActive_)return this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),void this.trigger("useractive");this.tech_&&this.tech_.one("mousemove",function(e){e.stopPropagation(),e.preventDefault()}),this.userActivity_=!1,this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive")}},u.prototype.listenForUserActivity_=function(){var t=void 0,r=void 0,i=void 0,n=Vu(this,this.reportUserActivity);this.on("mousedown",function(){n(),this.clearInterval(t),t=this.setInterval(n,250)}),this.on("mousemove",function(e){e.screenX===r&&e.screenY===i||(r=e.screenX,i=e.screenY,n())}),this.on("mouseup",function(e){n(),this.clearInterval(t)}),this.on("keydown",n),this.on("keyup",n);var a=void 0;this.setInterval(function(){if(this.userActivity_){this.userActivity_=!1,this.userActive(!0),this.clearTimeout(a);var e=this.options_.inactivityTimeout;e<=0||(a=this.setTimeout(function(){this.userActivity_||this.userActive(!1)},e))}},250)},u.prototype.playbackRate=function(e){if(void 0===e)return this.tech_&&this.tech_.featuresPlaybackRate?this.cache_.lastPlaybackRate||this.techGet_("playbackRate"):1;this.techCall_("setPlaybackRate",e)},u.prototype.defaultPlaybackRate=function(e){return void 0!==e?this.techCall_("setDefaultPlaybackRate",e):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1},u.prototype.isAudio=function(e){if(void 0===e)return!!this.isAudio_;this.isAudio_=!!e},u.prototype.addTextTrack=function(e,t,r){if(this.tech_)return this.tech_.addTextTrack(e,t,r)},u.prototype.addRemoteTextTrack=function(e,t){if(this.tech_)return this.tech_.addRemoteTextTrack(e,t)},u.prototype.removeRemoteTextTrack=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).track;if(this.tech_)return this.tech_.removeRemoteTextTrack(void 0===e?arguments[0]:e)},u.prototype.getVideoPlaybackQuality=function(){return this.techGet_("getVideoPlaybackQuality")},u.prototype.videoWidth=function(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0},u.prototype.videoHeight=function(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0},u.prototype.language=function(e){if(void 0===e)return this.language_;this.language_=(e+"").toLowerCase()},u.prototype.languages=function(){return ac(u.prototype.options_.languages,this.languages_)},u.prototype.toJSON=function(){var e=ac(this.options_),t=e.tracks;e.tracks=[];for(var r=0;r<t.length;r++){var i=t[r];(i=ac(i)).player=void 0,e.tracks[r]=i}return e},u.prototype.createModal=function(e,t){var r=this;(t=t||{}).content=e||"";var i=new Xc(this,t);return this.addChild(i),i.on("dispose",function(){r.removeChild(i)}),i.open(),i},u.getTagSettings=function(e){var t={sources:[],tracks:[]},r=iu(e),i=r["data-setup"];if(Zl(e,"vjs-fluid")&&(r.fluid=!0),null!==i){var n=Jo(i||"{}"),a=n[0],o=n[1];a&&Il.error(a),jl(r,o)}if(jl(t,r),e.hasChildNodes())for(var s=e.childNodes,l=0,u=s.length;l<u;l++){var c=s[l],d=c.nodeName.toLowerCase();"source"===d?t.sources.push(iu(c)):"track"===d&&t.tracks.push(iu(c))}return t},u.prototype.flexNotSupported_=function(){var e=to.createElement("i");return!("flexBasis"in e.style||"webkitFlexBasis"in e.style||"mozFlexBasis"in e.style||"msFlexBasis"in e.style||"msFlexOrder"in e.style)},u}(oc);Sd.names.forEach(function(e){var t=Sd[e];yf.prototype[t.getterName]=function(){return this.tech_?this.tech_[t.getterName]():(this[t.privateName]=this[t.privateName]||new t.ListClass,this[t.privateName])}}),yf.players={};var _f=Ja.navigator;yf.prototype.options_={techOrder:Ed.defaultTechOrder_,html5:{},flash:{},inactivityTimeout:2e3,playbackRates:[],children:["mediaLoader","posterImage","textTrackDisplay","loadingSpinner","bigPlayButton","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:_f&&(_f.languages&&_f.languages[0]||_f.userLanguage||_f.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media."},["ended","seeking","seekable","networkState","readyState"].forEach(function(e){yf.prototype[e]=function(){return this.techGet_(e)}}),mf.forEach(function(e){yf.prototype["handleTech"+nc(e)+"_"]=function(){return this.trigger(e)}}),oc.registerComponent("Player",yf);var bf="plugin",Tf="activePlugins_",Sf={},Ef=function(e){return Sf.hasOwnProperty(e)},kf=function(e){return Ef(e)?Sf[e]:void 0},wf=function(e,t){e[Tf]=e[Tf]||{},e[Tf][t]=!0},Cf=function(e,t,r){var i=(r?"before":"")+"pluginsetup";e.trigger(i,t),e.trigger(i+":"+t.name,t)},Af=function(n,a){return a.prototype.name=n,function(){Cf(this,{name:n,plugin:a,instance:null},!0);for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=new(Function.prototype.bind.apply(a,[null].concat([this].concat(t))));return this[n]=function(){return i},Cf(this,i.getEventHash()),i}},Lf=function(){function a(e){if(xl(this,a),this.constructor===a)throw Error("Plugin must be sub-classed; not directly instantiated.");this.player=e,tc(this),delete this.trigger,ic(this,this.constructor.defaultState),wf(e,this.name),this.dispose=Vu(this,this.dispose),e.on("dispose",this.dispose)}return a.prototype.version=function(){return this.constructor.VERSION},a.prototype.getEventHash=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return e.name=this.name,e.plugin=this.constructor,e.instance=this,e},a.prototype.trigger=function(e){return Mu(this.eventBusEl_,e,this.getEventHash(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}))},a.prototype.handleStateChanged=function(e){},a.prototype.dispose=function(){var e=this.name,t=this.player;this.trigger("dispose"),this.off(),t.off("dispose",this.dispose),t[Tf][e]=!1,this.player=this.state=null,t[e]=Af(e,Sf[e])},a.isBasic=function(e){var t="string"==typeof e?kf(e):e;return"function"==typeof t&&!a.prototype.isPrototypeOf(t.prototype)},a.registerPlugin=function(e,t){if("string"!=typeof e)throw Error('Illegal plugin name, "'+e+'", must be a string, was '+(void 0===e?"undefined":Pl(e))+".");if(Ef(e))Il.warn('A plugin named "'+e+'" already exists. You may want to avoid re-registering plugins!');else if(yf.prototype.hasOwnProperty(e))throw Error('Illegal plugin name, "'+e+'", cannot share a name with an existing player method!');if("function"!=typeof t)throw Error('Illegal plugin for "'+e+'", must be a function, was '+(void 0===t?"undefined":Pl(t))+".");var r,i,n;return Sf[e]=t,e!==bf&&(yf.prototype[e]=a.isBasic(t)?(r=e,n=function(){Cf(this,{name:r,plugin:i,instance:null},!0);var e=i.apply(this,arguments);return wf(this,r),Cf(this,{name:r,plugin:i,instance:e}),e},Object.keys(i=t).forEach(function(e){n[e]=i[e]}),n):Af(e,t)),t},a.deregisterPlugin=function(e){if(e===bf)throw Error("Cannot de-register base plugin.");Ef(e)&&(delete Sf[e],delete yf.prototype[e])},a.getPlugins=function(){var r=void 0;return(0<arguments.length&&void 0!==arguments[0]?arguments[0]:Object.keys(Sf)).forEach(function(e){var t=kf(e);t&&((r=r||{})[e]=t)}),r},a.getPluginVersion=function(e){var t=kf(e);return t&&t.VERSION||""},a}();Lf.getPlugin=kf,Lf.BASE_PLUGIN_NAME=bf,Lf.registerPlugin(bf,Lf),yf.prototype.usingPlugin=function(e){return!!this[Tf]&&!0===this[Tf][e]},yf.prototype.hasPlugin=function(e){return!!Ef(e)};var If=function(e){return 0==e.indexOf("#")?e.slice(1):e};function Pf(e,r,t){var i=Pf.getPlayer(e);if(i)return r&&Il.warn('Player "'+e+'" is already initialised. Options will not be applied.'),t&&i.ready(t),i;var n="string"==typeof e?yu("#"+If(e)):e;if(!zl(n))throw new TypeError("The element or ID supplied is not valid. (videojs)");to.body.contains(n)||Il.warn("The element supplied is not included in the DOM"),r=r||{},Pf.hooks("beforesetup").forEach(function(e){var t=e(n,ac(r));Bl(t)&&!Array.isArray(t)?r=ac(r,t):Il.error("please return an object in beforesetup hooks")});var a=oc.getComponent("Player");return i=new a(n,r,t),Pf.hooks("setup").forEach(function(e){return e(i)}),i}if(Pf.hooks_={},Pf.hooks=function(e,t){return Pf.hooks_[e]=Pf.hooks_[e]||[],t&&(Pf.hooks_[e]=Pf.hooks_[e].concat(t)),Pf.hooks_[e]},Pf.hook=function(e,t){Pf.hooks(e,t)},Pf.hookOnce=function(r,e){Pf.hooks(r,[].concat(e).map(function(t){return function e(){return Pf.removeHook(r,e),t.apply(void 0,arguments)}}))},Pf.removeHook=function(e,t){var r=Pf.hooks(e).indexOf(t);return!(r<=-1)&&((Pf.hooks_[e]=Pf.hooks_[e].slice()).splice(r,1),!0)},!0!==Ja.VIDEOJS_NO_DYNAMIC_STYLE&&Wl()){var xf=yu(".vjs-styles-defaults");if(!xf){xf=Gu("vjs-styles-defaults");var Rf=yu("head");Rf&&Rf.insertBefore(xf,Rf.firstChild),qu(xf,"\n      .video-js {\n        width: 300px;\n        height: 150px;\n      }\n\n      .vjs-fluid {\n        padding-top: 56.25%\n      }\n    ")}}Hu(1,Pf),Pf.VERSION="7.1.0",Pf.options=yf.prototype.options_,Pf.getPlayers=function(){return yf.players},Pf.getPlayer=function(e){var t=yf.players,r=void 0;if("string"==typeof e){var i=If(e),n=t[i];if(n)return n;r=yu("#"+i)}else r=e;if(zl(r)){var a=r.player,o=r.playerId;if(a||t[o])return a||t[o]}},Pf.getAllPlayers=function(){return Object.keys(yf.players).map(function(e){return yf.players[e]}).filter(Boolean)},Pf.players=yf.players,Pf.getComponent=oc.getComponent,Pf.registerComponent=function(e,t){Ed.isTech(t)&&Il.warn("The "+e+" tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)"),oc.registerComponent.call(oc,e,t)},Pf.getTech=Ed.getTech,Pf.registerTech=Ed.registerTech,Pf.use=function(e,t){kd[e]=kd[e]||[],kd[e].push(t)},Object.defineProperty(Pf,"middleware",{value:{},writeable:!1,enumerable:!0}),Object.defineProperty(Pf.middleware,"TERMINATOR",{value:Cd,writeable:!1,enumerable:!0}),Pf.browser=Pc,Pf.TOUCH_ENABLED=Ic,Pf.extend=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=function(){e.apply(this,arguments)},i={};for(var n in"object"===(void 0===t?"undefined":Pl(t))?(t.constructor!==Object.prototype.constructor&&(r=t.constructor),i=t):"function"==typeof t&&(r=t),function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":Pl(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.super_=t)}(r,e),i)i.hasOwnProperty(n)&&(r.prototype[n]=i[n]);return r},Pf.mergeOptions=ac,Pf.bind=Vu,Pf.registerPlugin=Lf.registerPlugin,Pf.plugin=function(e,t){return Il.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"),Lf.registerPlugin(e,t)},Pf.getPlugins=Lf.getPlugins,Pf.getPlugin=Lf.getPlugin,Pf.getPluginVersion=Lf.getPluginVersion,Pf.addLanguage=function(e,t){var r;return(Pf.options.languages=ac(Pf.options.languages,((r={})[e=(""+e).toLowerCase()]=t,r)))[e]},Pf.log=Il,Pf.createTimeRange=Pf.createTimeRanges=Oc,Pf.formatTime=Zd,Pf.setFormatTime=function(e){Jd=e},Pf.resetFormatTime=function(){Jd=Qd},Pf.parseUrl=cd,Pf.isCrossOrigin=fd,Pf.EventTarget=zu,Pf.on=Ou,Pf.one=Nu,Pf.off=Du,Pf.trigger=Mu,Pf.xhr=_o,Pf.TextTrack=md,Pf.AudioTrack=vd,Pf.VideoTrack=yd,["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach(function(e){Pf[e]=function(){return Il.warn("videojs."+e+"() is deprecated; use videojs.dom."+e+"() instead"),bu[e].apply(null,arguments)}}),Pf.computedStyle=Hl,Pf.dom=bu,Pf.url=pd;var Of=function(e,t){return/^[a-z]+:/i.test(t)?t:(/\/\//i.test(e)||(e=Zo.buildAbsoluteURL(Ja.location.href,e)),Zo.buildAbsoluteURL(e,t))},Df=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},Mf=function(){function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}}(),Nf=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":Pl(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},Ff=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":Pl(t))&&"function"!=typeof t?e:t},jf=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],i=!0,n=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);i=!0);}catch(e){n=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(n)throw a}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},Bf=Pf.mergeOptions,Uf=Pf.EventTarget,Hf=Pf.log,Gf=function(i,n){["AUDIO","SUBTITLES"].forEach(function(e){for(var t in i.mediaGroups[e])for(var r in i.mediaGroups[e][t]){n(i.mediaGroups[e][t][r],e,t,r)}})},qf=function(e,t){var r=Bf(e,{}),i=r.playlists[t.uri];if(!i)return null;if(i.segments&&t.segments&&i.segments.length===t.segments.length&&i.mediaSequence===t.mediaSequence)return null;var n=Bf(i,t);i.segments&&(n.segments=function(e,t,r){for(var i=t.slice(),n=Math.min(e.length,t.length+(r=r||0)),a=r;a<n;a++)i[a-r]=Bf(e[a],i[a-r]);return i}(i.segments,t.segments,t.mediaSequence-i.mediaSequence)),n.segments.forEach(function(e){var t,r;r=n.resolvedUri,(t=e).resolvedUri||(t.resolvedUri=Of(r,t.uri)),t.key&&!t.key.resolvedUri&&(t.key.resolvedUri=Of(r,t.key.uri)),t.map&&!t.map.resolvedUri&&(t.map.resolvedUri=Of(r,t.map.uri))});for(var a=0;a<r.playlists.length;a++)r.playlists[a].uri===t.uri&&(r.playlists[a]=n);return r.playlists[t.uri]=n,r},Vf=function(e){for(var t=e.playlists.length;t--;){var r=e.playlists[t];(e.playlists[r.uri]=r).resolvedUri=Of(e.uri,r.uri),r.id=t,r.attributes||(r.attributes={},Hf.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute."))}},Wf=function(t){Gf(t,function(e){e.uri&&(e.resolvedUri=Of(t.uri,e.uri))})},zf=function(e,t){var r=e.segments[e.segments.length-1];return t&&r&&r.duration?1e3*r.duration:500*(e.targetDuration||10)},Kf=function(e){function n(e,t,r){Df(this,n);var i=Ff(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));if(i.srcUrl=e,i.hls_=t,i.withCredentials=r,!i.srcUrl)throw Error("A non-empty playlist URL is required");return i.state="HAVE_NOTHING",i.on("mediaupdatetimeout",function(){"HAVE_METADATA"===i.state&&(i.state="HAVE_CURRENT_METADATA",i.request=i.hls_.xhr({uri:Of(i.master.uri,i.media().uri),withCredentials:i.withCredentials},function(e,t){if(i.request)return e?i.playlistRequestError(i.request,i.media().uri,"HAVE_METADATA"):void i.haveMetadata(i.request,i.media().uri)}))}),i}return Nf(n,Uf),Mf(n,[{key:"playlistRequestError",value:function(e,t,r){this.request=null,r&&(this.state=r),this.error={playlist:this.master.playlists[t],status:e.status,message:"HLS playlist request error at URL: "+t,responseText:e.responseText,code:500<=e.status?4:2},this.trigger("error")}},{key:"haveMetadata",value:function(e,t){var r=this;this.request=null,this.state="HAVE_METADATA";var i=new ss;i.push(e.responseText),i.end(),i.manifest.uri=t,i.manifest.attributes=i.manifest.attributes||{};var n=qf(this.master,i.manifest);this.targetDuration=i.manifest.targetDuration,n?(this.master=n,this.media_=this.master.playlists[i.manifest.uri]):this.trigger("playlistunchanged"),this.media().endList||(Ja.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=Ja.setTimeout(function(){r.trigger("mediaupdatetimeout")},zf(this.media(),!!n))),this.trigger("loadedplaylist")}},{key:"dispose",value:function(){this.stopRequest(),Ja.clearTimeout(this.mediaUpdateTimeout)}},{key:"stopRequest",value:function(){if(this.request){var e=this.request;e.onreadystatechange=this.request=null,e.abort()}}},{key:"media",value:function(r){var i=this;if(!r)return this.media_;if("HAVE_NOTHING"===this.state)throw Error("Cannot switch media playlist from "+this.state);var n=this.state;if("string"==typeof r){if(!this.master.playlists[r])throw Error("Unknown playlist URI: "+r);r=this.master.playlists[r]}var e=!this.media_||r.uri!==this.media_.uri;if(this.master.playlists[r.uri].endList)return this.request&&(this.request.onreadystatechange=null,this.request.abort(),this.request=null),this.state="HAVE_METADATA",this.media_=r,void(e&&(this.trigger("mediachanging"),this.trigger("mediachange")));if(e){if(this.state="SWITCHING_MEDIA",this.request){if(Of(this.master.uri,r.uri)===this.request.url)return;this.request.onreadystatechange=null,this.request.abort(),this.request=null}this.media_&&this.trigger("mediachanging"),this.request=this.hls_.xhr({uri:Of(this.master.uri,r.uri),withCredentials:this.withCredentials},function(e,t){if(i.request){if(e)return i.playlistRequestError(i.request,r.uri,n);i.haveMetadata(t,r.uri),i.trigger("HAVE_MASTER"===n?"loadedmetadata":"mediachange")}})}}},{key:"pause",value:function(){this.stopRequest(),Ja.clearTimeout(this.mediaUpdateTimeout),"HAVE_NOTHING"===this.state&&(this.started=!1),"SWITCHING_MEDIA"===this.state?this.state=this.media_?"HAVE_METADATA":"HAVE_MASTER":"HAVE_CURRENT_METADATA"===this.state&&(this.state="HAVE_METADATA")}},{key:"load",value:function(e){var t=this;Ja.clearTimeout(this.mediaUpdateTimeout);var r=this.media();e?this.mediaUpdateTimeout=Ja.setTimeout(function(){return t.load()},r?r.targetDuration/2*1e3:5e3):this.started?this.trigger(r&&!r.endList?"mediaupdatetimeout":"loadedplaylist"):this.start()}},{key:"start",value:function(){var i=this;this.started=!0,this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},function(e,t){if(i.request){if(i.request=null,e)return i.error={status:t.status,message:"HLS playlist request error at URL: "+i.srcUrl,responseText:t.responseText,code:2},"HAVE_NOTHING"===i.state&&(i.started=!1),i.trigger("error");var r=new ss;return r.push(t.responseText),r.end(),i.state="HAVE_MASTER",r.manifest.uri=i.srcUrl,r.manifest.playlists?(i.master=r.manifest,Vf(i.master),Wf(i.master),i.trigger("loadedplaylist"),void(i.request||i.media(r.manifest.playlists[0]))):(i.master={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:Ja.location.href,playlists:[{uri:i.srcUrl,id:0}]},i.master.playlists[i.srcUrl]=i.master.playlists[0],i.master.playlists[0].resolvedUri=i.srcUrl,i.master.playlists[0].attributes=i.master.playlists[0].attributes||{},i.haveMetadata(t,i.srcUrl),i.trigger("loadedmetadata"))}})}}]),n}(),Yf=Pf.createTimeRange,Xf=function(e,t,r){var i,n;return void 0===t&&(t=e.mediaSequence+e.segments.length),t<e.mediaSequence?0:(i=function(e,t){var r=0,i=t-e.mediaSequence,n=e.segments[i];if(n){if(void 0!==n.start)return{result:n.start,precise:!0};if(void 0!==n.end)return{result:n.end-n.duration,precise:!0}}for(;i--;){if(void 0!==(n=e.segments[i]).end)return{result:r+n.end,precise:!0};if(r+=n.duration,void 0!==n.start)return{result:r+n.start,precise:!0}}return{result:r,precise:!1}}(e,t)).precise?i.result:(n=function(e,t){for(var r=0,i=void 0,n=t-e.mediaSequence;n<e.segments.length;n++){if(void 0!==(i=e.segments[n]).start)return{result:i.start-r,precise:!0};if(r+=i.duration,void 0!==i.end)return{result:i.end-r,precise:!0}}return{result:-1,precise:!1}}(e,t)).precise?n.result:i.result+r},Qf=function(e,t,r){if(!e)return 0;if("number"!=typeof r&&(r=0),void 0===t){if(e.totalDuration)return e.totalDuration;if(!e.endList)return Ja.Infinity}return Xf(e,t,r)},Jf=function(e,t,r){var i=0;if(r<t){var n=[r,t];t=n[0],r=n[1]}if(t<0){for(var a=t;a<Math.min(0,r);a++)i+=e.targetDuration;t=0}for(var o=t;o<r;o++)i+=e.segments[o].duration;return i},Zf=function(e){if(!e.segments.length)return 0;for(var t=e.segments.length-1,r=e.segments[t].duration||e.targetDuration,i=r+2*e.targetDuration;t--&&!(i<=(r+=e.segments[t].duration)););return Math.max(0,t)},$f=function(e,t,r){if(!e||!e.segments)return null;if(e.endList)return Qf(e);if(null===t)return null;t=t||0;var i=r?Zf(e):e.segments.length;return Xf(e,e.mediaSequence+i,t)},ep=function(e){return e-Math.floor(e)==0},tp=function(e,t){if(ep(t))return t+.1*e;for(var r=(""+t).split(".")[1].length,i=1;i<=r;i++){var n=Math.pow(10,i),a=t*n;if(ep(a)||i===r)return(a+e)/n}},rp=tp.bind(null,1),ip=tp.bind(null,-1),np=function(e){return e.excludeUntil&&e.excludeUntil>Date.now()},ap=function(e){return e.excludeUntil&&e.excludeUntil===1/0},op=function(e){var t=np(e);return!e.disabled&&!t},sp=function(e,t){return t.attributes&&t.attributes[e]},lp=function(e,t){if(1===e.playlists.length)return!0;var r=t.attributes.BANDWIDTH||Number.MAX_VALUE;return 0===e.playlists.filter(function(e){return!!op(e)&&(e.attributes.BANDWIDTH||0)<r}).length},up={duration:Qf,seekable:function(e,t){var r=t||0,i=$f(e,t,!0);return null===i?Yf():Yf(r,i)},safeLiveIndex:Zf,getMediaInfoForTime:function(e,t,r,i){var n=void 0,a=e.segments.length,o=t-i;if(o<0){if(0<r)for(n=r-1;0<=n;n--)if(0<(o+=ip(e.segments[n].duration)))return{mediaIndex:n,startTime:i-Jf(e,r,n)};return{mediaIndex:0,startTime:t}}if(r<0){for(n=r;n<0;n++)if((o-=e.targetDuration)<0)return{mediaIndex:0,startTime:t};r=0}for(n=r;n<a;n++)if((o-=rp(e.segments[n].duration))<0)return{mediaIndex:n,startTime:i+Jf(e,r,n)};return{mediaIndex:a-1,startTime:t}},isEnabled:op,isDisabled:function(e){return e.disabled},isBlacklisted:np,isIncompatible:ap,playlistEnd:$f,isAes:function(e){for(var t=0;t<e.segments.length;t++)if(e.segments[t].key)return!0;return!1},isFmp4:function(e){for(var t=0;t<e.segments.length;t++)if(e.segments[t].map)return!0;return!1},hasAttribute:sp,estimateSegmentRequestTime:function(e,t,r){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;return sp("BANDWIDTH",r)?(e*r.attributes.BANDWIDTH-8*i)/t:NaN},isLowestEnabledRendition:lp},cp=Pf.xhr,dp=Pf.mergeOptions,hp=function(){return function e(t,i){t=dp({timeout:45e3},t);var r=e.beforeRequest||Pf.Hls.xhr.beforeRequest;if(r&&"function"==typeof r){var n=r(t);n&&(t=n)}var a=cp(t,function(e,t){var r=a.response;!e&&r&&(a.responseTime=Date.now(),a.roundTripTime=a.responseTime-a.requestTime,a.bytesReceived=r.byteLength||r.length,a.bandwidth||(a.bandwidth=Math.floor(a.bytesReceived/a.roundTripTime*8*1e3))),t.headers&&(a.responseHeaders=t.headers),e&&"ETIMEDOUT"===e.code&&(a.timedout=!0),e||a.aborted||200===t.statusCode||206===t.statusCode||0===t.statusCode||(e=Error("XHR Failed with a response of: "+(a&&(r||a.responseText)))),i(e,a)}),o=a.abort;return a.abort=function(){return a.aborted=!0,o.apply(a,arguments)},a.uri=t.uri,a.requestTime=Date.now(),a}},fp=function(e,t){var r=e.toString(16);return"00".substring(0,2-r.length)+r+(t%2?" ":"")},pp=function(e){return 32<=e&&e<126?String.fromCharCode(e):"."},gp=function(r){var i={};return Object.keys(r).forEach(function(e){var t=r[e];i[e]=ArrayBuffer.isView(t)?{bytes:t.buffer,byteOffset:t.byteOffset,byteLength:t.byteLength}:t}),i},mp=function(e){var t=e.byterange||{length:1/0,offset:0};return[t.length,t.offset,e.resolvedUri].join(",")},vp=function(e){for(var t=Array.prototype.slice.call(e),r="",i=0;i<t.length/16;i++)r+=t.slice(16*i,16*i+16).map(fp).join("")+" "+t.slice(16*i,16*i+16).map(pp).join("")+"\n";return r},yp=Object.freeze({createTransferableMessage:gp,initSegmentId:mp,hexDump:vp,tagDump:function(e){return vp(e.bytes)},textRanges:function(e){var t,r,i="",n=void 0;for(n=0;n<e.length;n++)i+=(t=e).start(r=n)+"-"+t.end(r)+" ";return i}}),_p=1/30,bp=function(e,t){var r=[],i=void 0;if(e&&e.length)for(i=0;i<e.length;i++)t(e.start(i),e.end(i))&&r.push([e.start(i),e.end(i)]);return Pf.createTimeRanges(r)},Tp=function(e,r){return bp(e,function(e,t){return e-_p<=r&&r<=t+_p})},Sp=function(e,t){return bp(e,function(e){return t<=e-_p})},Ep=function(e){var t=[];if(!e||!e.length)return"";for(var r=0;r<e.length;r++)t.push(e.start(r)+" => "+e.end(r));return t.join(", ")},kp=function(e){for(var t=[],r=0;r<e.length;r++)t.push({start:e.start(r),end:e.end(r)});return t},wp=function(e,t,r){var i=void 0,n=void 0;if(r&&r.cues)for(i=r.cues.length;i--;)(n=r.cues[i]).startTime<=t&&e<=n.endTime&&r.removeCue(n)},Cp=function(e){return isNaN(e)||Math.abs(e)==1/0?Number.MAX_VALUE:e},Ap=function(e,t,r){var n=Ja.WebKitDataCue||Ja.VTTCue;if(t&&t.forEach(function(e){this.inbandTextTracks_[e.stream].addCue(new n(e.startTime+this.timestampOffset,e.endTime+this.timestampOffset,e.text))},e),r){var i=Cp(e.mediaSource_.duration);if(r.forEach(function(e){var i=e.cueTime+this.timestampOffset;e.frames.forEach(function(e){var t,r=new n(i,i,e.value||e.url||e.data||"");r.frame=e,r.value=e,Object.defineProperties((t=r).frame,{id:{get:function(){return Pf.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),t.value.key}},value:{get:function(){return Pf.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),t.value.data}},privateData:{get:function(){return Pf.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),t.value.data}}}),this.metadataTrack_.addCue(r)},this)},e),e.metadataTrack_&&e.metadataTrack_.cues&&e.metadataTrack_.cues.length){for(var a=e.metadataTrack_.cues,o=[],s=0;s<a.length;s++)a[s]&&o.push(a[s]);var l=o.reduce(function(e,t){var r=e[t.startTime]||[];return r.push(t),e[t.startTime]=r,e},{}),u=Object.keys(l).sort(function(e,t){return+e-+t});u.forEach(function(e,t){var r=+u[t+1]||i;l[e].forEach(function(e){e.endTime=r})})}}},Lp="undefined"!=typeof window?window:{},Ip="undefined"==typeof Symbol?"__target":Symbol(),Pp="application/javascript",xp=Lp.BlobBuilder||Lp.WebKitBlobBuilder||Lp.MozBlobBuilder||Lp.MSBlobBuilder,Rp=Lp.URL||Lp.webkitURL||Rp&&Rp.msURL,Op=Lp.Worker;function Dp(n,a){return function(e){var t=this;if(!a)return new Op(n);if(Op&&!e){var r=jp((""+a).replace(/^function.+?{/,"").slice(0,-1));return this[Ip]=new Op(r),function(e,t){if(!e||!t)return;var r=e.terminate;e.objURL=t,e.terminate=function(){e.objURL&&Rp.revokeObjectURL(e.objURL),r.call(e)}}(this[Ip],r),this[Ip]}var i={postMessage:function(e){t.onmessage&&setTimeout(function(){t.onmessage({data:e,target:i})})}};a.call(i),this.postMessage=function(e){setTimeout(function(){i.onmessage({data:e,target:t})})},this.isThisThread=!0}}if(Op){var Mp,Np=jp("self.onmessage = function () {}"),Fp=new Uint8Array(1);try{(Mp=new Op(Np)).postMessage(Fp,[Fp.buffer])}catch(e){Op=null}finally{Rp.revokeObjectURL(Np),Mp&&Mp.terminate()}}function jp(t){try{return Rp.createObjectURL(new Blob([t],{type:Pp}))}catch(e){var r=new xp;return r.append(t),Rp.createObjectURL(r.getBlob(type))}}var Bp=new Dp("./transmuxer-worker.worker.js",function(rt,e){var it=this;!function(){var s,t,r,n,a,i,e,o,l,u,c,d,h,f,p,g,m,v,y,_,b,T,S,E,k,w,C,A,L,I,P,x,R,O,D,M,N,F,j,B,U=void 0!==rt?rt:"undefined"!=typeof global?global:void 0!==it?it:{},H=void 0!==rt?rt:void 0!==U?U:void 0!==it?it:{};!function(){var e;if(T={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},"undefined"!=typeof Uint8Array){for(e in T)T.hasOwnProperty(e)&&(T[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);S=new Uint8Array([105,115,111,109]),k=new Uint8Array([97,118,99,49]),E=new Uint8Array([0,0,0,1]),w=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),C=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),A={video:w,audio:C},P=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),I=new Uint8Array([0,0,0,0,0,0,0,0]),x=new Uint8Array([0,0,0,0,0,0,0,0]),R=x,O=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),D=x,L=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}}(),s=function(e){var t,r,i=[],n=0;for(t=1;t<arguments.length;t++)i.push(arguments[t]);for(t=i.length;t--;)n+=i[t].byteLength;for(r=new Uint8Array(n+8),new DataView(r.buffer,r.byteOffset,r.byteLength).setUint32(0,r.byteLength),r.set(e,4),t=0,n=8;t<i.length;t++)r.set(i[t],n),n+=i[t].byteLength;return r},t=function(){return s(T.dinf,s(T.dref,P))},r=function(e){return s(T.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,e.audioobjecttype<<3|e.samplingfrequencyindex>>>1,e.samplingfrequencyindex<<7|e.channelcount<<3,6,1,2]))},p=function(e){return s(T.hdlr,A[e])},f=function(e){var t=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,e.duration>>>24&255,e.duration>>>16&255,e.duration>>>8&255,255&e.duration,85,196,0,0]);return e.samplerate&&(t[12]=e.samplerate>>>24&255,t[13]=e.samplerate>>>16&255,t[14]=e.samplerate>>>8&255,t[15]=255&e.samplerate),s(T.mdhd,t)},h=function(e){return s(T.mdia,f(e),p(e.type),i(e))},a=function(e){return s(T.mfhd,new Uint8Array([0,0,0,0,(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e]))},i=function(e){return s(T.minf,"video"===e.type?s(T.vmhd,L):s(T.smhd,I),t(),m(e))},e=function(e,t){for(var r=[],i=t.length;i--;)r[i]=y(t[i]);return s.apply(null,[T.moof,a(e)].concat(r))},o=function(e){for(var t=e.length,r=[];t--;)r[t]=c(e[t]);return s.apply(null,[T.moov,u(4294967295)].concat(r).concat(l(e)))},l=function(e){for(var t=e.length,r=[];t--;)r[t]=_(e[t]);return s.apply(null,[T.mvex].concat(r))},u=function(e){var t=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return s(T.mvhd,t)},g=function(e){var t,r,i=e.samples||[],n=new Uint8Array(4+i.length);for(r=0;r<i.length;r++)n[r+4]=(t=i[r].flags).dependsOn<<4|t.isDependedOn<<2|t.hasRedundancy;return s(T.sdtp,n)},m=function(e){return s(T.stbl,v(e),s(T.stts,D),s(T.stsc,R),s(T.stsz,O),s(T.stco,x))},v=function(e){return s(T.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),"video"===e.type?M(e):N(e))},M=function(e){var t,r=e.sps||[],i=e.pps||[],n=[],a=[];for(t=0;t<r.length;t++)n.push((65280&r[t].byteLength)>>>8),n.push(255&r[t].byteLength),n=n.concat(Array.prototype.slice.call(r[t]));for(t=0;t<i.length;t++)a.push((65280&i[t].byteLength)>>>8),a.push(255&i[t].byteLength),a=a.concat(Array.prototype.slice.call(i[t]));return s(T.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&e.width)>>8,255&e.width,(65280&e.height)>>8,255&e.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s(T.avcC,new Uint8Array([1,e.profileIdc,e.profileCompatibility,e.levelIdc,255].concat([r.length]).concat(n).concat([i.length]).concat(a))),s(T.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])))},N=function(e){return s(T.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&e.channelcount)>>8,255&e.channelcount,(65280&e.samplesize)>>8,255&e.samplesize,0,0,0,0,(65280&e.samplerate)>>8,255&e.samplerate,0,0]),r(e))},d=function(e){var t=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,0,(4278190080&e.duration)>>24,(16711680&e.duration)>>16,(65280&e.duration)>>8,255&e.duration,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(65280&e.width)>>8,255&e.width,0,0,(65280&e.height)>>8,255&e.height,0,0]);return s(T.tkhd,t)},y=function(e){var t,r,i,n,a,o;return t=s(T.tfhd,new Uint8Array([0,0,0,58,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),a=Math.floor(e.baseMediaDecodeTime/4294967296),o=Math.floor(e.baseMediaDecodeTime%4294967296),r=s(T.tfdt,new Uint8Array([1,0,0,0,a>>>24&255,a>>>16&255,a>>>8&255,255&a,o>>>24&255,o>>>16&255,o>>>8&255,255&o])),92,"audio"===e.type?(i=b(e,92),s(T.traf,t,r,i)):(n=g(e),i=b(e,n.length+92),s(T.traf,t,r,i,n))},c=function(e){return e.duration=e.duration||4294967295,s(T.trak,d(e),h(e))},_=function(e){var t=new Uint8Array([0,0,0,0,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return"video"!==e.type&&(t[t.length-1]=0),s(T.trex,t)},B=function(e,t){var r=0,i=0,n=0,a=0;return e.length&&(void 0!==e[0].duration&&(r=1),void 0!==e[0].size&&(i=2),void 0!==e[0].flags&&(n=4),void 0!==e[0].compositionTimeOffset&&(a=8)),[0,0,r|i|n|a,1,(4278190080&e.length)>>>24,(16711680&e.length)>>>16,(65280&e.length)>>>8,255&e.length,(4278190080&t)>>>24,(16711680&t)>>>16,(65280&t)>>>8,255&t]},j=function(e,t){var r,i,n,a;for(r=B(i=e.samples||[],t+=20+16*i.length),a=0;a<i.length;a++)r=r.concat([(4278190080&(n=i[a]).duration)>>>24,(16711680&n.duration)>>>16,(65280&n.duration)>>>8,255&n.duration,(4278190080&n.size)>>>24,(16711680&n.size)>>>16,(65280&n.size)>>>8,255&n.size,n.flags.isLeading<<2|n.flags.dependsOn,n.flags.isDependedOn<<6|n.flags.hasRedundancy<<4|n.flags.paddingValue<<1|n.flags.isNonSyncSample,61440&n.flags.degradationPriority,15&n.flags.degradationPriority,(4278190080&n.compositionTimeOffset)>>>24,(16711680&n.compositionTimeOffset)>>>16,(65280&n.compositionTimeOffset)>>>8,255&n.compositionTimeOffset]);return s(T.trun,new Uint8Array(r))},F=function(e,t){var r,i,n,a;for(r=B(i=e.samples||[],t+=20+8*i.length),a=0;a<i.length;a++)r=r.concat([(4278190080&(n=i[a]).duration)>>>24,(16711680&n.duration)>>>16,(65280&n.duration)>>>8,255&n.duration,(4278190080&n.size)>>>24,(16711680&n.size)>>>16,(65280&n.size)>>>8,255&n.size]);return s(T.trun,new Uint8Array(r))},b=function(e,t){return"audio"===e.type?F(e,t):j(e,t)};var G={ftyp:n=function(){return s(T.ftyp,S,E,S,k)},mdat:function(e){return s(T.mdat,e)},moof:e,moov:o,initSegment:function(e){var t,r=n(),i=o(e);return(t=new Uint8Array(r.byteLength+i.byteLength)).set(r),t.set(i,r.byteLength),t}},q=function(){this.init=function(){var a={};this.on=function(e,t){a[e]||(a[e]=[]),a[e]=a[e].concat(t)},this.off=function(e,t){var r;return!!a[e]&&(r=a[e].indexOf(t),a[e]=a[e].slice(),a[e].splice(r,1),-1<r)},this.trigger=function(e){var t,r,i,n;if(t=a[e])if(2===arguments.length)for(i=t.length,r=0;r<i;++r)t[r].call(this,arguments[1]);else{for(n=[],r=arguments.length,r=1;r<arguments.length;++r)n.push(arguments[r]);for(i=t.length,r=0;r<i;++r)t[r].apply(this,n)}},this.dispose=function(){a={}}}};q.prototype.pipe=function(t){return this.on("data",function(e){t.push(e)}),this.on("done",function(e){t.flush(e)}),t},q.prototype.push=function(e){this.trigger("data",e)},q.prototype.flush=function(e){this.trigger("done",e)};var V=q,W=function e(){e.prototype.init.call(this),this.captionPackets_=[],this.ccStreams_=[new Q(0,0),new Q(0,1),new Q(1,0),new Q(1,1)],this.reset(),this.ccStreams_.forEach(function(e){e.on("data",this.trigger.bind(this,"data")),e.on("done",this.trigger.bind(this,"done"))},this)};(W.prototype=new V).push=function(e){var t,r,i;if("sei_rbsp"===e.nalUnitType&&(4===(t=function(e){for(var t=0,r={payloadType:-1,payloadSize:0},i=0,n=0;t<e.byteLength&&128!==e[t];){for(;255===e[t];)i+=255,t++;for(i+=e[t++];255===e[t];)n+=255,t++;if(n+=e[t++],!r.payload&&4===i){r.payloadType=i,r.payloadSize=n,r.payload=e.subarray(t,t+n);break}t+=n,n=i=0}return r}(e.escapedRBSP)).payloadType&&(r=181!==(i=t).payload[0]?null:49!=(i.payload[1]<<8|i.payload[2])?null:"GA94"!==String.fromCharCode(i.payload[3],i.payload[4],i.payload[5],i.payload[6])?null:3!==i.payload[7]?null:i.payload.subarray(8,i.payload.length-1))))if(e.dts<this.latestDts_)this.ignoreNextEqualDts_=!0;else{if(e.dts===this.latestDts_&&this.ignoreNextEqualDts_)return this.numSameDts_--,void(this.numSameDts_||(this.ignoreNextEqualDts_=!1));this.captionPackets_=this.captionPackets_.concat(function(e,t){var r,i,n,a,o=[];if(!(64&t[0]))return o;for(i=31&t[0],r=0;r<i;r++)a={type:3&t[2+(n=3*r)],pts:e},4&t[n+2]&&(a.ccData=t[n+3]<<8|t[n+4],o.push(a));return o}(e.pts,r)),this.latestDts_!==e.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=e.dts}},W.prototype.flush=function(){this.captionPackets_.length?(this.captionPackets_.forEach(function(e,t){e.presortIndex=t}),this.captionPackets_.sort(function(e,t){return e.pts===t.pts?e.presortIndex-t.presortIndex:e.pts-t.pts}),this.captionPackets_.forEach(function(e){e.type<2&&this.dispatchCea608Packet(e)},this),this.captionPackets_.length=0,this.ccStreams_.forEach(function(e){e.flush()},this)):this.ccStreams_.forEach(function(e){e.flush()},this)},W.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach(function(e){e.reset()})},W.prototype.dispatchCea608Packet=function(e){this.setsChannel1Active(e)?this.activeCea608Channel_[e.type]=0:this.setsChannel2Active(e)&&(this.activeCea608Channel_[e.type]=1),null!==this.activeCea608Channel_[e.type]&&this.ccStreams_[(e.type<<1)+this.activeCea608Channel_[e.type]].push(e)},W.prototype.setsChannel1Active=function(e){return 4096==(30720&e.ccData)},W.prototype.setsChannel2Active=function(e){return 6144==(30720&e.ccData)};var z={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},K=function(e){return null===e?"":String.fromCharCode(e=z[e]||e)},Y=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],X=function(){for(var e=[],t=15;t--;)e.push("");return e},Q=function e(t,r){e.prototype.init.call(this),this.field_=t||0,this.dataChannel_=r||0,this.name_="CC"+(1+(this.field_<<1|this.dataChannel_)),this.setConstants(),this.reset(),this.push=function(e){var t,r,i,n,a;if((t=32639&e.ccData)!==this.lastControlCode_){if(4096==(61440&t)?this.lastControlCode_=t:t!==this.PADDING_&&(this.lastControlCode_=null),i=t>>>8,n=255&t,t!==this.PADDING_)if(t===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(t===this.END_OF_CAPTION_)this.clearFormatting(e.pts),this.flushDisplayed(e.pts),r=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=r,this.startPts_=e.pts;else if(t===this.ROLL_UP_2_ROWS_)this.topRow_=13,this.mode_="rollUp";else if(t===this.ROLL_UP_3_ROWS_)this.topRow_=12,this.mode_="rollUp";else if(t===this.ROLL_UP_4_ROWS_)this.topRow_=11,this.mode_="rollUp";else if(t===this.CARRIAGE_RETURN_)this.clearFormatting(e.pts),this.flushDisplayed(e.pts),this.shiftRowsUp_(),this.startPts_=e.pts;else if(t===this.BACKSPACE_)"popOn"===this.mode_?this.nonDisplayed_[14]=this.nonDisplayed_[14].slice(0,-1):this.displayed_[14]=this.displayed_[14].slice(0,-1);else if(t===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(e.pts),this.displayed_=X();else if(t===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=X();else if(t===this.RESUME_DIRECT_CAPTIONING_)this.mode_="paintOn";else if(this.isSpecialCharacter(i,n))a=K((i=(3&i)<<8)|n),this[this.mode_](e.pts,a),this.column_++;else if(this.isExtCharacter(i,n))"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[14]=this.displayed_[14].slice(0,-1),a=K((i=(3&i)<<8)|n),this[this.mode_](e.pts,a),this.column_++;else if(this.isMidRowCode(i,n))this.clearFormatting(e.pts),this[this.mode_](e.pts," "),this.column_++,14==(14&n)&&this.addFormatting(e.pts,["i"]),1==(1&n)&&this.addFormatting(e.pts,["u"]);else if(this.isOffsetControlCode(i,n))this.column_+=3&n;else if(this.isPAC(i,n)){var o=Y.indexOf(7968&t);o!==this.row_&&(this.clearFormatting(e.pts),this.row_=o),1&n&&-1==this.formatting_.indexOf("u")&&this.addFormatting(e.pts,["u"]),16==(16&t)&&(this.column_=4*((14&t)>>1)),this.isColorPAC(n)&&14==(14&n)&&this.addFormatting(e.pts,["i"])}else this.isNormalChar(i)&&(0===n&&(n=null),a=K(i),a+=K(n),this[this.mode_](e.pts,a),this.column_+=a.length)}else this.lastControlCode_=null}};Q.prototype=new V,Q.prototype.flushDisplayed=function(e){var t=this.displayed_.map(function(e){return e.trim()}).join("\n").replace(/^\n+|\n+$/g,"");t.length&&this.trigger("data",{startPts:this.startPts_,endPts:e,text:t,stream:this.name_})},Q.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=X(),this.nonDisplayed_=X(),this.lastControlCode_=null,this.column_=0,this.row_=14,this.formatting_=[]},Q.prototype.setConstants=function(){0===this.dataChannel_?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):1===this.dataChannel_&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=32|this.CONTROL_,this.END_OF_CAPTION_=47|this.CONTROL_,this.ROLL_UP_2_ROWS_=37|this.CONTROL_,this.ROLL_UP_3_ROWS_=38|this.CONTROL_,this.ROLL_UP_4_ROWS_=39|this.CONTROL_,this.CARRIAGE_RETURN_=45|this.CONTROL_,this.RESUME_DIRECT_CAPTIONING_=41|this.CONTROL_,this.BACKSPACE_=33|this.CONTROL_,this.ERASE_DISPLAYED_MEMORY_=44|this.CONTROL_,this.ERASE_NON_DISPLAYED_MEMORY_=46|this.CONTROL_},Q.prototype.isSpecialCharacter=function(e,t){return e===this.EXT_&&48<=t&&t<=63},Q.prototype.isExtCharacter=function(e,t){return(e===this.EXT_+1||e===this.EXT_+2)&&32<=t&&t<=63},Q.prototype.isMidRowCode=function(e,t){return e===this.EXT_&&32<=t&&t<=47},Q.prototype.isOffsetControlCode=function(e,t){return e===this.OFFSET_&&33<=t&&t<=35},Q.prototype.isPAC=function(e,t){return this.BASE_<=e&&e<this.BASE_+8&&64<=t&&t<=127},Q.prototype.isColorPAC=function(e){return 64<=e&&e<=79||96<=e&&e<=127},Q.prototype.isNormalChar=function(e){return 32<=e&&e<=127},Q.prototype.addFormatting=function(e,t){this.formatting_=this.formatting_.concat(t);var r=t.reduce(function(e,t){return e+"<"+t+">"},"");this[this.mode_](e,r)},Q.prototype.clearFormatting=function(e){if(this.formatting_.length){var t=this.formatting_.reverse().reduce(function(e,t){return e+"</"+t+">"},"");this.formatting_=[],this[this.mode_](e,t)}},Q.prototype.popOn=function(e,t){var r=this.nonDisplayed_[this.row_];this.nonDisplayed_[this.row_]=r+=t},Q.prototype.rollUp=function(e,t){var r=this.displayed_[14];this.displayed_[14]=r+=t},Q.prototype.shiftRowsUp_=function(){var e;for(e=0;e<this.topRow_;e++)this.displayed_[e]="";for(e=this.topRow_;e<14;e++)this.displayed_[e]=this.displayed_[e+1];this.displayed_[14]=""},Q.prototype.paintOn=function(){};var J={CaptionStream:W,Cea608Stream:Q},Z={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},$=function(e,t){var r=1;for(t<e&&(r=-1);4294967296<Math.abs(t-e);)e+=8589934592*r;return e},ee=function e(t){var r,i;e.prototype.init.call(this),this.type_=t,this.push=function(e){e.type===this.type_&&(void 0===i&&(i=e.dts),e.dts=$(e.dts,i),e.pts=$(e.pts,i),r=e.dts,this.trigger("data",e))},this.flush=function(){i=r,this.trigger("done")},this.discontinuity=function(){r=i=void 0}};ee.prototype=new V;var te,re=ee,ie=function(e,t,r){var i,n="";for(i=t;i<r;i++)n+="%"+("00"+e[i].toString(16)).slice(-2);return n},ne=function(e,t,r){return decodeURIComponent(ie(e,t,r))},ae=function(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]},oe={TXXX:function(e){var t;if(3===e.data[0]){for(t=1;t<e.data.length;t++)if(0===e.data[t]){e.description=ne(e.data,1,t),e.value=ne(e.data,t+1,e.data.length).replace(/\0*$/,"");break}e.data=e.value}},WXXX:function(e){var t;if(3===e.data[0])for(t=1;t<e.data.length;t++)if(0===e.data[t]){e.description=ne(e.data,1,t),e.url=ne(e.data,t+1,e.data.length);break}},PRIV:function(e){var t;for(t=0;t<e.data.length;t++)if(0===e.data[t]){e.owner=unescape(ie(e.data,0,t));break}e.privateData=e.data.subarray(t+1),e.data=e.privateData}};(te=function(e){var t,l={debug:!(!e||!e.debug),descriptor:e&&e.descriptor},u=0,c=[],d=0;if(te.prototype.init.call(this),this.dispatchType=Z.METADATA_STREAM_TYPE.toString(16),l.descriptor)for(t=0;t<l.descriptor.length;t++)this.dispatchType+=("00"+l.descriptor[t].toString(16)).slice(-2);this.push=function(e){var t,r,i,n,a;if("timed-metadata"===e.type)if(e.dataAlignmentIndicator&&(c.length=d=0),0===c.length&&(e.data.length<10||73!==e.data[0]||68!==e.data[1]||51!==e.data[2]))l.debug&&console.log("Skipping unrecognized metadata packet");else if(c.push(e),d+=e.data.byteLength,1===c.length&&(u=ae(e.data.subarray(6,10)),u+=10),!(d<u)){for(t={data:new Uint8Array(u),frames:[],pts:c[0].pts,dts:c[0].dts},a=0;a<u;)t.data.set(c[0].data.subarray(0,u-a),a),a+=c[0].data.byteLength,d-=c[0].data.byteLength,c.shift();r=10,64&t.data[5]&&(r+=4,r+=ae(t.data.subarray(10,14)),u-=ae(t.data.subarray(16,20)));do{if((i=ae(t.data.subarray(r+4,r+8)))<1)return console.log("Malformed ID3 frame encountered. Skipping metadata parsing.");if((n={id:String.fromCharCode(t.data[r],t.data[r+1],t.data[r+2],t.data[r+3]),data:t.data.subarray(r+10,r+i+10)}).key=n.id,oe[n.id]&&(oe[n.id](n),"com.apple.streaming.transportStreamTimestamp"===n.owner)){var o=n.data,s=(1&o[3])<<30|o[4]<<22|o[5]<<14|o[6]<<6|o[7]>>>2;s*=4,n.timeStamp=s+=3&o[7],void 0===t.pts&&void 0===t.dts&&(t.pts=n.timeStamp,t.dts=n.timeStamp),this.trigger("timestamp",n)}t.frames.push(n),r+=10,r+=i}while(r<u);this.trigger("data",t)}}}).prototype=new V;var se,le,ue,ce=te,de=re;(se=function(){var n=new Uint8Array(188),a=0;se.prototype.init.call(this),this.push=function(e){var t,r=0,i=188;for(a?((t=new Uint8Array(e.byteLength+a)).set(n.subarray(0,a)),t.set(e,a),a=0):t=e;i<t.byteLength;)71!==t[r]||71!==t[i]?(r++,i++):(this.trigger("data",t.subarray(r,i)),r+=188,i+=188);r<t.byteLength&&(n.set(t.subarray(r),0),a=t.byteLength-r)},this.flush=function(){188===a&&71===n[0]&&(this.trigger("data",n),a=0),this.trigger("done")}}).prototype=new V,(le=function(){var i,n,a,o;le.prototype.init.call(this),(o=this).packetsWaitingForPmt=[],this.programMapTable=void 0,i=function(e,t){var r=0;t.payloadUnitStartIndicator&&(r+=e[r]+1),"pat"===t.type?n(e.subarray(r),t):a(e.subarray(r),t)},n=function(e,t){t.section_number=e[7],t.last_section_number=e[8],o.pmtPid=(31&e[10])<<8|e[11],t.pmtPid=o.pmtPid},a=function(e,t){var r,i;if(1&e[5]){for(o.programMapTable={video:null,audio:null,"timed-metadata":{}},r=3+((15&e[1])<<8|e[2])-4,i=12+((15&e[10])<<8|e[11]);i<r;){var n=e[i],a=(31&e[i+1])<<8|e[i+2];n===Z.H264_STREAM_TYPE&&null===o.programMapTable.video?o.programMapTable.video=a:n===Z.ADTS_STREAM_TYPE&&null===o.programMapTable.audio?o.programMapTable.audio=a:n===Z.METADATA_STREAM_TYPE&&(o.programMapTable["timed-metadata"][a]=n),i+=5+((15&e[i+3])<<8|e[i+4])}t.programMapTable=o.programMapTable}},this.push=function(e){var t={},r=4;if(t.payloadUnitStartIndicator=!!(64&e[1]),t.pid=31&e[1],t.pid<<=8,t.pid|=e[2],1<(48&e[3])>>>4&&(r+=e[r]+1),0===t.pid)t.type="pat",i(e.subarray(r),t),this.trigger("data",t);else if(t.pid===this.pmtPid)for(t.type="pmt",i(e.subarray(r),t),this.trigger("data",t);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else void 0===this.programMapTable?this.packetsWaitingForPmt.push([e,r,t]):this.processPes_(e,r,t)},this.processPes_=function(e,t,r){r.streamType=r.pid===this.programMapTable.video?Z.H264_STREAM_TYPE:r.pid===this.programMapTable.audio?Z.ADTS_STREAM_TYPE:this.programMapTable["timed-metadata"][r.pid],r.type="pes",r.data=e.subarray(t),this.trigger("data",r)}}).prototype=new V,le.STREAM_TYPES={h264:27,adts:15},(ue=function(){var h=this,i={data:[],size:0},n={data:[],size:0},a={data:[],size:0},o=function(e,t,r){var i,n,a=new Uint8Array(e.size),o={type:t},s=0,l=0;if(e.data.length&&!(e.size<9)){for(o.trackId=e.data[0].pid,s=0;s<e.data.length;s++)a.set((n=e.data[s]).data,l),l+=n.data.byteLength;var u,c,d;(c=o).packetLength=6+((u=a)[4]<<8|u[5]),c.dataAlignmentIndicator=0!=(4&u[6]),192&(d=u[7])&&(c.pts=(14&u[9])<<27|(255&u[10])<<20|(254&u[11])<<12|(255&u[12])<<5|(254&u[13])>>>3,c.pts*=4,c.pts+=(6&u[13])>>>1,c.dts=c.pts,64&d&&(c.dts=(14&u[14])<<27|(255&u[15])<<20|(254&u[16])<<12|(255&u[17])<<5|(254&u[18])>>>3,c.dts*=4,c.dts+=(6&u[18])>>>1)),c.data=u.subarray(9+u[8]),i="video"===t||o.packetLength<=e.size,(r||i)&&(e.size=0,e.data.length=0),i&&h.trigger("data",o)}};ue.prototype.init.call(this),this.push=function(r){({pat:function(){},pes:function(){var e,t;switch(r.streamType){case Z.H264_STREAM_TYPE:case Z.H264_STREAM_TYPE:e=i,t="video";break;case Z.ADTS_STREAM_TYPE:e=n,t="audio";break;case Z.METADATA_STREAM_TYPE:e=a,t="timed-metadata";break;default:return}r.payloadUnitStartIndicator&&o(e,t,!0),e.data.push(r),e.size+=r.data.byteLength},pmt:function(){var e={type:"metadata",tracks:[]},t=r.programMapTable;null!==t.video&&e.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+t.video,codec:"avc",type:"video"}),null!==t.audio&&e.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+t.audio,codec:"adts",type:"audio"}),h.trigger("data",e)}})[r.type]()},this.flush=function(){o(i,"video"),o(n,"audio"),o(a,"timed-metadata"),this.trigger("done")}}).prototype=new V;var he={PAT_PID:0,MP2T_PACKET_LENGTH:188,TransportPacketStream:se,TransportParseStream:le,ElementaryStream:ue,TimestampRolloverStream:de,CaptionStream:J.CaptionStream,Cea608Stream:J.Cea608Stream,MetadataStream:ce};for(var fe in Z)Z.hasOwnProperty(fe)&&(he[fe]=Z[fe]);var pe,ge=he,me=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];(pe=function(){var s;pe.prototype.init.call(this),this.push=function(e){var t,r,i,n,a=0,o=0;if("audio"===e.type)for(s?(r=s,(s=new Uint8Array(r.byteLength+e.data.byteLength)).set(r),s.set(e.data,r.byteLength)):s=e.data;a+5<s.length;)if(255===s[a]&&240==(246&s[a+1])){if(s.byteLength<(t=a+((3&s[a+3])<<11|s[a+4]<<3|(224&s[a+5])>>5)))return;if(this.trigger("data",{pts:e.pts+o*(n=9e4*(i=1024*(1+(3&s[a+6])))/me[(60&s[a+2])>>>2]),dts:e.dts+o*n,sampleCount:i,audioobjecttype:1+(s[a+2]>>>6&3),channelcount:(1&s[a+2])<<2|(192&s[a+3])>>>6,samplerate:me[(60&s[a+2])>>>2],samplingfrequencyindex:(60&s[a+2])>>>2,samplesize:16,data:s.subarray(a+7+2*(1&~s[a+1]),t)}),s.byteLength===t)return void(s=void 0);o++,s=s.subarray(t)}else a++},this.flush=function(){this.trigger("done")}}).prototype=new V;var ve,ye,_e,be=pe,Te=function(i){var n=i.byteLength,a=0,o=0;this.length=function(){return 8*n},this.bitsAvailable=function(){return 8*n+o},this.loadWord=function(){var e=i.byteLength-n,t=new Uint8Array(4),r=Math.min(4,n);if(0===r)throw Error("no bytes available");t.set(i.subarray(e,e+r)),a=new DataView(t.buffer).getUint32(0),o=8*r,n-=r},this.skipBits=function(e){var t;e<o||(e-=o,e-=8*(t=Math.floor(e/8)),n-=t,this.loadWord()),a<<=e,o-=e},this.readBits=function(e){var t=Math.min(o,e),r=a>>>32-t;return 0<(o-=t)?a<<=t:0<n&&this.loadWord(),0<(t=e-t)?r<<t|this.readBits(t):r},this.skipLeadingZeros=function(){var e;for(e=0;e<o;++e)if(0!=(a&2147483648>>>e))return a<<=e,o-=e,e;return this.loadWord(),e+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var e=this.skipLeadingZeros();return this.readBits(e+1)-1},this.readExpGolomb=function(){var e=this.readUnsignedExpGolomb();return 1&e?1+e>>>1:-1*(e>>>1)},this.readBoolean=function(){return 1===this.readBits(1)},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()};(ye=function(){var r,i,n=0;ye.prototype.init.call(this),this.push=function(e){var t;for(i=i?((t=new Uint8Array(i.byteLength+e.data.byteLength)).set(i),t.set(e.data,i.byteLength),t):e.data;n<i.byteLength-3;n++)if(1===i[n+2]){r=n+5;break}for(;r<i.byteLength;)switch(i[r]){case 0:if(0!==i[r-1]){r+=2;break}if(0!==i[r-2]){r++;break}for(n+3!==r-2&&this.trigger("data",i.subarray(n+3,r-2));1!==i[++r]&&r<i.length;);n=r-2,r+=3;break;case 1:if(0!==i[r-1]||0!==i[r-2]){r+=3;break}this.trigger("data",i.subarray(n+3,r-2)),n=r-2,r+=3;break;default:r+=3}i=i.subarray(n),r-=n,n=0},this.flush=function(){i&&3<i.byteLength&&this.trigger("data",i.subarray(n+3)),i=null,n=0,this.trigger("done")}}).prototype=new V,_e={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},(ve=function(){var r,i,n,a,o,s,_,t=new ye;ve.prototype.init.call(this),(r=this).push=function(e){"video"===e.type&&(i=e.trackId,n=e.pts,a=e.dts,t.push(e))},t.on("data",function(e){var t={trackId:i,pts:n,dts:a,data:e};switch(31&e[0]){case 5:t.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:t.nalUnitType="sei_rbsp",t.escapedRBSP=o(e.subarray(1));break;case 7:t.nalUnitType="seq_parameter_set_rbsp",t.escapedRBSP=o(e.subarray(1)),t.config=s(t.escapedRBSP);break;case 8:t.nalUnitType="pic_parameter_set_rbsp";break;case 9:t.nalUnitType="access_unit_delimiter_rbsp"}r.trigger("data",t)}),t.on("done",function(){r.trigger("done")}),this.flush=function(){t.flush()},_=function(e,t){var r,i=8,n=8;for(r=0;r<e;r++)0!==n&&(n=(i+t.readExpGolomb()+256)%256),i=0===n?i:n},o=function(e){for(var t,r,i=e.byteLength,n=[],a=1;a<i-2;)0===e[a]&&0===e[a+1]&&3===e[a+2]?(n.push(a+2),a+=2):a++;if(0===n.length)return e;t=i-n.length,r=new Uint8Array(t);var o=0;for(a=0;a<t;o++,a++)o===n[0]&&(o++,n.shift()),r[a]=e[o];return r},s=function(e){var t,r,i,n,a,o,s,l,u,c,d,h,f,p=0,g=0,m=0,v=0,y=1;if(r=(t=new Te(e)).readUnsignedByte(),n=t.readUnsignedByte(),i=t.readUnsignedByte(),t.skipUnsignedExpGolomb(),_e[r]&&(3===(a=t.readUnsignedExpGolomb())&&t.skipBits(1),t.skipUnsignedExpGolomb(),t.skipUnsignedExpGolomb(),t.skipBits(1),t.readBoolean()))for(d=3!==a?8:12,f=0;f<d;f++)t.readBoolean()&&_(f<6?16:64,t);if(t.skipUnsignedExpGolomb(),0===(o=t.readUnsignedExpGolomb()))t.readUnsignedExpGolomb();else if(1===o)for(t.skipBits(1),t.skipExpGolomb(),t.skipExpGolomb(),s=t.readUnsignedExpGolomb(),f=0;f<s;f++)t.skipExpGolomb();if(t.skipUnsignedExpGolomb(),t.skipBits(1),l=t.readUnsignedExpGolomb(),u=t.readUnsignedExpGolomb(),0===(c=t.readBits(1))&&t.skipBits(1),t.skipBits(1),t.readBoolean()&&(p=t.readUnsignedExpGolomb(),g=t.readUnsignedExpGolomb(),m=t.readUnsignedExpGolomb(),v=t.readUnsignedExpGolomb()),t.readBoolean()&&t.readBoolean()){switch(t.readUnsignedByte()){case 1:h=[1,1];break;case 2:h=[12,11];break;case 3:h=[10,11];break;case 4:h=[16,11];break;case 5:h=[40,33];break;case 6:h=[24,11];break;case 7:h=[20,11];break;case 8:h=[32,11];break;case 9:h=[80,33];break;case 10:h=[18,11];break;case 11:h=[15,11];break;case 12:h=[64,33];break;case 13:h=[160,99];break;case 14:h=[4,3];break;case 15:h=[3,2];break;case 16:h=[2,1];break;case 255:h=[t.readUnsignedByte()<<8|t.readUnsignedByte(),t.readUnsignedByte()<<8|t.readUnsignedByte()]}h&&(y=h[0]/h[1])}return{profileIdc:r,levelIdc:i,profileCompatibility:n,width:Math.ceil((16*(l+1)-2*p-2*g)*y),height:(2-c)*(u+1)*16-2*m-2*v}}}).prototype=new V;var Se,Ee={H264Stream:ve,NalByteStream:ye};(Se=function(){var o=new Uint8Array,s=0;Se.prototype.init.call(this),this.setTimestamp=function(e){s=e},this.parseId3TagSize=function(e,t){var r=e[t+6]<<21|e[t+7]<<14|e[t+8]<<7|e[t+9];return(16&e[t+5])>>4?r+20:r+10},this.parseAdtsSize=function(e,t){return 6144&e[t+3]|e[t+4]<<3|(224&e[t+5])>>5},this.push=function(e){var t,r,i,n=0,a=0;for(o.length?(i=o.length,(o=new Uint8Array(e.byteLength+i)).set(o.subarray(0,i)),o.set(e,i)):o=e;3<=o.length-a;)if(73!==o[a]||68!==o[a+1]||51!==o[a+2])if(!0&o[a]&&240==(240&o[a+1])){if(o.length-a<7)break;if(n=this.parseAdtsSize(o,a),o.length<n)break;r={type:"audio",data:o.subarray(a,a+n),pts:s,dts:s},this.trigger("data",r),a+=n}else a++;else{if(o.length-a<10)break;if(n=this.parseId3TagSize(o,a),o.length<n)break;t={type:"timed-metadata",data:o.subarray(a,a+n)},this.trigger("data",t),a+=n}o=0<o.length-a?o.subarray(a):new Uint8Array}}).prototype=new V;var ke,we,Ce,Ae,Le,Ie,Pe,xe=Se,Re=[33,16,5,32,164,27],Oe=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],De=function(e){for(var t=[];e--;)t.push(0);return t},Me={96e3:[Re,[227,64],De(154),[56]],88200:[Re,[231],De(170),[56]],64e3:[Re,[248,192],De(240),[56]],48e3:[Re,[255,192],De(268),[55,148,128],De(54),[112]],44100:[Re,[255,192],De(268),[55,163,128],De(84),[112]],32e3:[Re,[255,192],De(268),[55,234],De(226),[112]],24e3:[Re,[255,192],De(268),[55,255,128],De(268),[111,112],De(126),[224]],16e3:[Re,[255,192],De(268),[55,255,128],De(268),[111,255],De(269),[223,108],De(195),[1,192]],12e3:[Oe,De(268),[3,127,248],De(268),[6,255,240],De(268),[13,255,224],De(268),[27,253,128],De(259),[56]],11025:[Oe,De(268),[3,127,248],De(268),[6,255,240],De(268),[13,255,224],De(268),[27,255,192],De(268),[55,175,128],De(108),[112]],8e3:[Oe,De(268),[3,121,16],De(47),[7]]},Ne=Object.keys(ke=Me).reduce(function(e,t){return e[t]=new Uint8Array(ke[t].reduce(function(e,t){return e.concat(t)},[])),e},{});Ie=function(e,t){return we(Le(e,t))},Pe=function(e,t){return Ce(Ae(e),t)};we=function(e){return 9e4*e},Ce=function(e,t){return e*t},Ae=function(e){return e/9e4},Le=function(e,t){return e/t};var Fe,je,Be,Ue,He,Ge,qe,Ve,We,ze,Ke=Ie,Ye=Pe,Xe=Ee.H264Stream,Qe=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],Je=["width","height","profileIdc","levelIdc","profileCompatibility"];He=function(e){return 73===e[0]&&68===e[1]&&51===e[2]},We=function(e,t){var r;if(e.length!==t.length)return!1;for(r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0},ze=function(e){var t,r=0;for(t=0;t<e.length;t++)r+=e[t].data.byteLength;return r},(je=function(n,a){var o=[],s=0,t=0,l=0,u=1/0;a=a||{},je.prototype.init.call(this),this.push=function(t){Ge(n,t),n&&Qe.forEach(function(e){n[e]=t[e]}),o.push(t)},this.setEarliestDts=function(e){t=e-n.timelineStartInfo.baseMediaDecodeTime},this.setVideoBaseMediaDecodeTime=function(e){u=e},this.setAudioAppendStart=function(e){l=e},this.flush=function(){var e,t,r,i;0!==o.length&&(e=this.trimAdtsFramesByEarliestDts_(o),n.baseMediaDecodeTime=Ve(n,a.keepOriginalTimestamps),this.prefixWithSilence_(n,e),n.samples=this.generateSampleTable_(e),r=G.mdat(this.concatenateFrameData_(e)),o=[],t=G.moof(s,[n]),i=new Uint8Array(t.byteLength+r.byteLength),s++,i.set(t),i.set(r,t.byteLength),qe(n),this.trigger("data",{track:n,boxes:i})),this.trigger("done","AudioSegmentStream")},this.prefixWithSilence_=function(e,t){var r,i,n,a,o=0,s=0;if(t.length&&(r=Ke(e.baseMediaDecodeTime,e.samplerate),i=Math.ceil(9e4/(e.samplerate/1024)),l&&u&&(s=(o=Math.floor((r-Math.max(l,u))/i))*i),!(o<1||45e3<s))){for((n=Ne[e.samplerate])||(n=t[0].data),a=0;a<o;a++)t.splice(a,0,{data:n});e.baseMediaDecodeTime-=Math.floor(Ye(s,e.samplerate))}},this.trimAdtsFramesByEarliestDts_=function(e){return t<=n.minSegmentDts?e:(n.minSegmentDts=1/0,e.filter(function(e){return t<=e.dts&&(n.minSegmentDts=Math.min(n.minSegmentDts,e.dts),n.minSegmentPts=n.minSegmentDts,!0)}))},this.generateSampleTable_=function(e){var t,r=[];for(t=0;t<e.length;t++)r.push({size:e[t].data.byteLength,duration:1024});return r},this.concatenateFrameData_=function(e){var t,r,i=0,n=new Uint8Array(ze(e));for(t=0;t<e.length;t++)n.set((r=e[t]).data,i),i+=r.data.byteLength;return n}}).prototype=new V,(Fe=function(s,l){var t,r,u=0,c=[],d=[];l=l||{},Fe.prototype.init.call(this),delete s.minPTS,this.gopCache_=[],this.push=function(e){Ge(s,e),"seq_parameter_set_rbsp"!==e.nalUnitType||t||(t=e.config,s.sps=[e.data],Je.forEach(function(e){s[e]=t[e]},this)),"pic_parameter_set_rbsp"!==e.nalUnitType||r||(s.pps=[r=e.data]),c.push(e)},this.flush=function(){for(var e,t,r,i,n,a;c.length&&"access_unit_delimiter_rbsp"!==c[0].nalUnitType;)c.shift();if(0===c.length)return this.resetStream_(),void this.trigger("done","VideoSegmentStream");if(e=this.groupNalsIntoFrames_(c),(r=this.groupFramesIntoGops_(e))[0][0].keyFrame||((t=this.getGopForFusion_(c[0],s))?(r.unshift(t),r.byteLength+=t.byteLength,r.nalCount+=t.nalCount,r.pts=t.pts,r.dts=t.dts,r.duration+=t.duration):r=this.extendFirstKeyFrame_(r)),d.length){var o;if(!(o=l.alignGopsAtEnd?this.alignGopsAtEnd_(r):this.alignGopsAtStart_(r)))return this.gopCache_.unshift({gop:r.pop(),pps:s.pps,sps:s.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),c=[],this.resetStream_(),void this.trigger("done","VideoSegmentStream");qe(s),r=o}Ge(s,r),s.samples=this.generateSampleTable_(r),n=G.mdat(this.concatenateNalData_(r)),s.baseMediaDecodeTime=Ve(s,l.keepOriginalTimestamps),this.trigger("processedGopsInfo",r.map(function(e){return{pts:e.pts,dts:e.dts,byteLength:e.byteLength}})),this.gopCache_.unshift({gop:r.pop(),pps:s.pps,sps:s.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),c=[],this.trigger("baseMediaDecodeTime",s.baseMediaDecodeTime),this.trigger("timelineStartInfo",s.timelineStartInfo),i=G.moof(u,[s]),a=new Uint8Array(i.byteLength+n.byteLength),u++,a.set(i),a.set(n,i.byteLength),this.trigger("data",{track:s,boxes:a}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.resetStream_=function(){qe(s),r=t=void 0},this.getGopForFusion_=function(e){var t,r,i,n,a,o=1/0;for(a=0;a<this.gopCache_.length;a++)i=(n=this.gopCache_[a]).gop,s.pps&&We(s.pps[0],n.pps[0])&&s.sps&&We(s.sps[0],n.sps[0])&&(i.dts<s.timelineStartInfo.dts||-1e4<=(t=e.dts-i.dts-i.duration)&&t<=45e3&&(!r||t<o)&&(r=n,o=t));return r?r.gop:null},this.extendFirstKeyFrame_=function(e){var t;return!e[0][0].keyFrame&&1<e.length&&(t=e.shift(),e.byteLength-=t.byteLength,e.nalCount-=t.nalCount,e[0][0].dts=t.dts,e[0][0].pts=t.pts,e[0][0].duration+=t.duration),e},this.groupNalsIntoFrames_=function(e){var t,r,i=[],n=[];for(t=i.byteLength=0;t<e.length;t++)"access_unit_delimiter_rbsp"===(r=e[t]).nalUnitType?(i.length&&(i.duration=r.dts-i.dts,n.push(i)),(i=[r]).byteLength=r.data.byteLength,i.pts=r.pts,i.dts=r.dts):("slice_layer_without_partitioning_rbsp_idr"===r.nalUnitType&&(i.keyFrame=!0),i.duration=r.dts-i.dts,i.byteLength+=r.data.byteLength,i.push(r));return n.length&&(!i.duration||i.duration<=0)&&(i.duration=n[n.length-1].duration),n.push(i),n},this.groupFramesIntoGops_=function(e){var t,r,i=[],n=[];for(i.byteLength=0,i.nalCount=0,i.duration=0,i.pts=e[0].pts,i.dts=e[0].dts,n.byteLength=0,n.nalCount=0,n.duration=0,n.pts=e[0].pts,n.dts=e[0].dts,t=0;t<e.length;t++)(r=e[t]).keyFrame?(i.length&&(n.push(i),n.byteLength+=i.byteLength,n.nalCount+=i.nalCount,n.duration+=i.duration),(i=[r]).nalCount=r.length,i.byteLength=r.byteLength,i.pts=r.pts,i.dts=r.dts,i.duration=r.duration):(i.duration+=r.duration,i.nalCount+=r.length,i.byteLength+=r.byteLength,i.push(r));return n.length&&i.duration<=0&&(i.duration=n[n.length-1].duration),n.byteLength+=i.byteLength,n.nalCount+=i.nalCount,n.duration+=i.duration,n.push(i),n},this.generateSampleTable_=function(e,t){var r,i,n,a,o,s=t||0,l=[];for(r=0;r<e.length;r++)for(a=e[r],i=0;i<a.length;i++)o=a[i],(n={size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0}}).dataOffset=s,n.compositionTimeOffset=o.pts-o.dts,n.duration=o.duration,n.size=4*o.length,n.size+=o.byteLength,o.keyFrame&&(n.flags.dependsOn=2),s+=n.size,l.push(n);return l},this.concatenateNalData_=function(e){var t,r,i,n,a,o,s=0,l=new Uint8Array(e.byteLength+4*e.nalCount),u=new DataView(l.buffer);for(t=0;t<e.length;t++)for(n=e[t],r=0;r<n.length;r++)for(a=n[r],i=0;i<a.length;i++)u.setUint32(s,(o=a[i]).data.byteLength),l.set(o.data,s+=4),s+=o.data.byteLength;return l},this.alignGopsAtStart_=function(e){var t,r,i,n,a,o,s,l;for(a=e.byteLength,o=e.nalCount,s=e.duration,t=r=0;t<d.length&&r<e.length&&(i=d[t]).pts!==(n=e[r]).pts;)i.pts<n.pts?t++:(r++,a-=n.byteLength,o-=n.nalCount,s-=n.duration);return 0===r?e:r===e.length?null:((l=e.slice(r)).byteLength=a,l.duration=s,l.nalCount=o,l.pts=l[0].pts,l.dts=l[0].dts,l)},this.alignGopsAtEnd_=function(e){var t,r,i,n,a,o,s;for(t=d.length-1,r=e.length-1,a=null,o=!1;0<=t&&0<=r;){if((i=d[t]).pts===(n=e[r]).pts){o=!0;break}n.pts<i.pts?t--:(t===d.length-1&&(a=r),r--)}if(!o&&null===a)return null;if(0===(s=o?r:a))return e;var l=e.slice(s),u=l.reduce(function(e,t){return e.byteLength+=t.byteLength,e.duration+=t.duration,e.nalCount+=t.nalCount,e},{byteLength:0,duration:0,nalCount:0});return l.byteLength=u.byteLength,l.duration=u.duration,l.nalCount=u.nalCount,l.pts=l[0].pts,l.dts=l[0].dts,l},this.alignGopsWith=function(e){d=e}}).prototype=new V,Ge=function(e,t){"number"==typeof t.pts&&(void 0===e.timelineStartInfo.pts&&(e.timelineStartInfo.pts=t.pts),e.minSegmentPts=void 0===e.minSegmentPts?t.pts:Math.min(e.minSegmentPts,t.pts),e.maxSegmentPts=void 0===e.maxSegmentPts?t.pts:Math.max(e.maxSegmentPts,t.pts)),"number"==typeof t.dts&&(void 0===e.timelineStartInfo.dts&&(e.timelineStartInfo.dts=t.dts),e.minSegmentDts=void 0===e.minSegmentDts?t.dts:Math.min(e.minSegmentDts,t.dts),e.maxSegmentDts=void 0===e.maxSegmentDts?t.dts:Math.max(e.maxSegmentDts,t.dts))},qe=function(e){delete e.minSegmentDts,delete e.maxSegmentDts,delete e.minSegmentPts,delete e.maxSegmentPts},Ve=function(e,t){var r,i=e.minSegmentDts;return t||(i-=e.timelineStartInfo.dts),r=e.timelineStartInfo.baseMediaDecodeTime,r=Math.max(0,r+=i),"audio"===e.type&&(r=Math.floor(r*=e.samplerate/9e4)),r},(Ue=function(e,t){this.numberOfTracks=0,this.metadataStream=t,this.remuxTracks=void 0===e.remux||!!e.remux,this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,Ue.prototype.init.call(this),this.push=function(e){return e.text?this.pendingCaptions.push(e):e.frames?this.pendingMetadata.push(e):(this.pendingTracks.push(e.track),this.pendingBoxes.push(e.boxes),this.pendingBytes+=e.boxes.byteLength,"video"===e.track.type&&(this.videoTrack=e.track),void("audio"===e.track.type&&(this.audioTrack=e.track)))}}).prototype=new V,Ue.prototype.flush=function(e){var t,r,i,n,a=0,o={captions:[],captionStreams:{},metadata:[],info:{}},s=0;if(this.pendingTracks.length<this.numberOfTracks){if("VideoSegmentStream"!==e&&"AudioSegmentStream"!==e)return;if(this.remuxTracks)return;if(0===this.pendingTracks.length)return this.emittedTracks++,void(this.numberOfTracks<=this.emittedTracks&&(this.trigger("done"),this.emittedTracks=0))}for(this.videoTrack?(s=this.videoTrack.timelineStartInfo.pts,Je.forEach(function(e){o.info[e]=this.videoTrack[e]},this)):this.audioTrack&&(s=this.audioTrack.timelineStartInfo.pts,Qe.forEach(function(e){o.info[e]=this.audioTrack[e]},this)),o.type=1===this.pendingTracks.length?this.pendingTracks[0].type:"combined",this.emittedTracks+=this.pendingTracks.length,i=G.initSegment(this.pendingTracks),o.initSegment=new Uint8Array(i.byteLength),o.initSegment.set(i),o.data=new Uint8Array(this.pendingBytes),n=0;n<this.pendingBoxes.length;n++)o.data.set(this.pendingBoxes[n],a),a+=this.pendingBoxes[n].byteLength;for(n=0;n<this.pendingCaptions.length;n++)(t=this.pendingCaptions[n]).startTime=t.startPts-s,t.startTime/=9e4,t.endTime=t.endPts-s,t.endTime/=9e4,o.captionStreams[t.stream]=!0,o.captions.push(t);for(n=0;n<this.pendingMetadata.length;n++)(r=this.pendingMetadata[n]).cueTime=r.pts-s,r.cueTime/=9e4,o.metadata.push(r);o.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",o),this.numberOfTracks<=this.emittedTracks&&(this.trigger("done"),this.emittedTracks=0)},(Be=function(i){var n,a,o=this,r=!0;Be.prototype.init.call(this),this.baseMediaDecodeTime=(i=i||{}).baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var t={};(this.transmuxPipeline_=t).type="aac",t.metadataStream=new ge.MetadataStream,t.aacStream=new xe,t.audioTimestampRolloverStream=new ge.TimestampRolloverStream("audio"),t.timedMetadataTimestampRolloverStream=new ge.TimestampRolloverStream("timed-metadata"),t.adtsStream=new be,t.coalesceStream=new Ue(i,t.metadataStream),t.headOfPipeline=t.aacStream,t.aacStream.pipe(t.audioTimestampRolloverStream).pipe(t.adtsStream),t.aacStream.pipe(t.timedMetadataTimestampRolloverStream).pipe(t.metadataStream).pipe(t.coalesceStream),t.metadataStream.on("timestamp",function(e){t.aacStream.setTimestamp(e.timeStamp)}),t.aacStream.on("data",function(e){"timed-metadata"!==e.type||t.audioSegmentStream||(a=a||{timelineStartInfo:{baseMediaDecodeTime:o.baseMediaDecodeTime},codec:"adts",type:"audio"},t.coalesceStream.numberOfTracks++,t.audioSegmentStream=new je(a,i),t.adtsStream.pipe(t.audioSegmentStream).pipe(t.coalesceStream))}),t.coalesceStream.on("data",this.trigger.bind(this,"data")),t.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setupTsPipeline=function(){var r={};(this.transmuxPipeline_=r).type="ts",r.metadataStream=new ge.MetadataStream,r.packetStream=new ge.TransportPacketStream,r.parseStream=new ge.TransportParseStream,r.elementaryStream=new ge.ElementaryStream,r.videoTimestampRolloverStream=new ge.TimestampRolloverStream("video"),r.audioTimestampRolloverStream=new ge.TimestampRolloverStream("audio"),r.timedMetadataTimestampRolloverStream=new ge.TimestampRolloverStream("timed-metadata"),r.adtsStream=new be,r.h264Stream=new Xe,r.captionStream=new ge.CaptionStream,r.coalesceStream=new Ue(i,r.metadataStream),r.headOfPipeline=r.packetStream,r.packetStream.pipe(r.parseStream).pipe(r.elementaryStream),r.elementaryStream.pipe(r.videoTimestampRolloverStream).pipe(r.h264Stream),r.elementaryStream.pipe(r.audioTimestampRolloverStream).pipe(r.adtsStream),r.elementaryStream.pipe(r.timedMetadataTimestampRolloverStream).pipe(r.metadataStream).pipe(r.coalesceStream),r.h264Stream.pipe(r.captionStream).pipe(r.coalesceStream),r.elementaryStream.on("data",function(e){var t;if("metadata"===e.type){for(t=e.tracks.length;t--;)n||"video"!==e.tracks[t].type?a||"audio"!==e.tracks[t].type||((a=e.tracks[t]).timelineStartInfo.baseMediaDecodeTime=o.baseMediaDecodeTime):(n=e.tracks[t]).timelineStartInfo.baseMediaDecodeTime=o.baseMediaDecodeTime;n&&!r.videoSegmentStream&&(r.coalesceStream.numberOfTracks++,r.videoSegmentStream=new Fe(n,i),r.videoSegmentStream.on("timelineStartInfo",function(e){a&&r.audioSegmentStream.setEarliestDts((a.timelineStartInfo=e).dts)}),r.videoSegmentStream.on("processedGopsInfo",o.trigger.bind(o,"gopInfo")),r.videoSegmentStream.on("baseMediaDecodeTime",function(e){a&&r.audioSegmentStream.setVideoBaseMediaDecodeTime(e)}),r.h264Stream.pipe(r.videoSegmentStream).pipe(r.coalesceStream)),a&&!r.audioSegmentStream&&(r.coalesceStream.numberOfTracks++,r.audioSegmentStream=new je(a,i),r.adtsStream.pipe(r.audioSegmentStream).pipe(r.coalesceStream))}}),r.coalesceStream.on("data",this.trigger.bind(this,"data")),r.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setBaseMediaDecodeTime=function(e){var t=this.transmuxPipeline_;this.baseMediaDecodeTime=e,a&&(a.timelineStartInfo.dts=void 0,a.timelineStartInfo.pts=void 0,qe(a),a.timelineStartInfo.baseMediaDecodeTime=e,t.audioTimestampRolloverStream&&t.audioTimestampRolloverStream.discontinuity()),n&&(t.videoSegmentStream&&(t.videoSegmentStream.gopCache_=[],t.videoTimestampRolloverStream.discontinuity()),n.timelineStartInfo.dts=void 0,n.timelineStartInfo.pts=void 0,qe(n),t.captionStream.reset(),n.timelineStartInfo.baseMediaDecodeTime=e),t.timedMetadataTimestampRolloverStream&&t.timedMetadataTimestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(e){a&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(e)},this.alignGopsWith=function(e){n&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(e)},this.push=function(e){if(r){var t=He(e);t&&"aac"!==this.transmuxPipeline_.type?this.setupAacPipeline():t||"ts"===this.transmuxPipeline_.type||this.setupTsPipeline(),r=!1}this.transmuxPipeline_.headOfPipeline.push(e)},this.flush=function(){r=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}}).prototype=new V;var Ze={Transmuxer:Be,VideoSegmentStream:Fe,AudioSegmentStream:je,AUDIO_PROPERTIES:Qe,VIDEO_PROPERTIES:Je},$e={generator:G,Transmuxer:Ze.Transmuxer,AudioSegmentStream:Ze.AudioSegmentStream,VideoSegmentStream:Ze.VideoSegmentStream},et=function(){function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}}(),tt=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.options=e||{},this.init()}return et(t,[{key:"init",value:function(){var e;this.transmuxer&&this.transmuxer.dispose(),this.transmuxer=new $e.Transmuxer(this.options),(e=this.transmuxer).on("data",function(e){var t=e.initSegment;e.initSegment={data:t.buffer,byteOffset:t.byteOffset,byteLength:t.byteLength};var r=e.data;e.data=r.buffer,H.postMessage({action:"data",segment:e,byteOffset:r.byteOffset,byteLength:r.byteLength},[e.data])}),e.captionStream&&e.captionStream.on("data",function(e){H.postMessage({action:"caption",data:e})}),e.on("done",function(e){H.postMessage({action:"done"})}),e.on("gopInfo",function(e){H.postMessage({action:"gopInfo",gopInfo:e})})}},{key:"push",value:function(e){var t=new Uint8Array(e.data,e.byteOffset,e.byteLength);this.transmuxer.push(t)}},{key:"reset",value:function(){this.init()}},{key:"setTimestampOffset",value:function(e){this.transmuxer.setBaseMediaDecodeTime(Math.round(9e4*(e.timestampOffset||0)))}},{key:"setAudioAppendStart",value:function(e){this.transmuxer.setAudioAppendStart(Math.ceil(9e4*e.appendStart))}},{key:"flush",value:function(e){this.transmuxer.flush()}},{key:"resetCaptions",value:function(){this.transmuxer.resetCaptions()}},{key:"alignGopsWith",value:function(e){this.transmuxer.alignGopsWith(e.gopsToAlignWith.slice())}}]),t}();new function(e){e.onmessage=function(e){"init"===e.data.action&&e.data.options?this.messageHandlers=new tt(e.data.options):(this.messageHandlers||(this.messageHandlers=new tt),e.data&&e.data.action&&"init"!==e.data.action&&this.messageHandlers[e.data.action]&&this.messageHandlers[e.data.action](e.data))}}(it)}()}),Up=function(e){return/mp4a\.\d+.\d+/i.test(e)},Hp=function(e){return/avc1\.[\da-f]+/i.test(e)},Gp=function(e){return e.map(function(e){return e.replace(/avc1\.(\d+)\.(\d+)/i,function(e,t,r){return"avc1."+("00"+(+t).toString(16)).slice(-2)+"00"+("00"+(+r).toString(16)).slice(-2)})})},qp=function(e){function n(e,t){Df(this,n);var r=Ff(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,Pf.EventTarget));r.timestampOffset_=0,r.pendingBuffers_=[],r.bufferUpdating_=!1,r.mediaSource_=e,r.codecs_=t,r.audioCodec_=null,r.videoCodec_=null,r.audioDisabled_=!1,r.appendAudioInitSegment_=!0,r.gopBuffer_=[],r.timeMapping_=0,r.safeAppend_=11<=Pf.browser.IE_VERSION;var i={remux:!1,alignGopsAtEnd:r.safeAppend_};return r.codecs_.forEach(function(e){Up(e)?r.audioCodec_=e:Hp(e)&&(r.videoCodec_=e)}),r.transmuxer_=new Bp,r.transmuxer_.postMessage({action:"init",options:i}),r.transmuxer_.onmessage=function(e){return"data"===e.data.action?r.data_(e):"done"===e.data.action?r.done_(e):"gopInfo"===e.data.action?r.appendGopInfo_(e):void 0},Object.defineProperty(r,"timestampOffset",{get:function(){return this.timestampOffset_},set:function(e){"number"==typeof e&&0<=e&&(this.timestampOffset_=e,this.appendAudioInitSegment_=!0,this.gopBuffer_.length=0,this.timeMapping_=0,this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:e}))}}),Object.defineProperty(r,"appendWindowStart",{get:function(){return(this.videoBuffer_||this.audioBuffer_).appendWindowStart},set:function(e){this.videoBuffer_&&(this.videoBuffer_.appendWindowStart=e),this.audioBuffer_&&(this.audioBuffer_.appendWindowStart=e)}}),Object.defineProperty(r,"updating",{get:function(){return!!(this.bufferUpdating_||!this.audioDisabled_&&this.audioBuffer_&&this.audioBuffer_.updating||this.videoBuffer_&&this.videoBuffer_.updating)}}),Object.defineProperty(r,"buffered",{get:function(){var e=null,t=null,r=0,i=[],n=[];if(!this.videoBuffer_&&!this.audioBuffer_)return Pf.createTimeRange();if(!this.videoBuffer_)return this.audioBuffer_.buffered;if(!this.audioBuffer_)return this.videoBuffer_.buffered;if(this.audioDisabled_)return this.videoBuffer_.buffered;if(0===this.videoBuffer_.buffered.length&&0===this.audioBuffer_.buffered.length)return Pf.createTimeRange();for(var a=this.videoBuffer_.buffered,o=this.audioBuffer_.buffered,s=a.length;s--;)i.push({time:a.start(s),type:"start"}),i.push({time:a.end(s),type:"end"});for(s=o.length;s--;)i.push({time:o.start(s),type:"start"}),i.push({time:o.end(s),type:"end"});for(i.sort(function(e,t){return e.time-t.time}),s=0;s<i.length;s++)"start"===i[s].type?2===++r&&(e=i[s].time):"end"===i[s].type&&1===--r&&(t=i[s].time),null!==e&&null!==t&&(n.push([e,t]),t=e=null);return Pf.createTimeRanges(n)}}),r}return Nf(n,Pf.EventTarget),Mf(n,[{key:"data_",value:function(e){var t=e.data.segment;t.data=new Uint8Array(t.data,e.data.byteOffset,e.data.byteLength),t.initSegment=new Uint8Array(t.initSegment.data,t.initSegment.byteOffset,t.initSegment.byteLength),function(e,t,r){var i=t.player_;if(r.captions&&r.captions.length)for(var n in e.inbandTextTracks_||(e.inbandTextTracks_={}),r.captionStreams)if(!e.inbandTextTracks_[n]){i.tech_.trigger({type:"usage",name:"hls-608"});var a=i.textTracks().getTrackById(n);e.inbandTextTracks_[n]=a||i.addRemoteTextTrack({kind:"captions",id:n,label:n},!1).track}r.metadata&&r.metadata.length&&!e.metadataTrack_&&(e.metadataTrack_=i.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},!1).track,e.metadataTrack_.inBandMetadataTrackDispatchType=r.metadata.dispatchType)}(this,this.mediaSource_,t),this.pendingBuffers_.push(t)}},{key:"done_",value:function(e){"closed"!==this.mediaSource_.readyState?this.processPendingSegments_():this.pendingBuffers_.length=0}},{key:"createRealSourceBuffers_",value:function(){var i=this,n=["audio","video"];n.forEach(function(t){if(i[t+"Codec_"]&&!i[t+"Buffer_"]){var r=null;if(i.mediaSource_[t+"Buffer_"])(r=i.mediaSource_[t+"Buffer_"]).updating=!1;else r=function(e,t){var r=e.addSourceBuffer(t),i=Object.create(null);i.updating=!1,i.realBuffer_=r;var n=function(t){"function"==typeof r[t]?i[t]=function(){return r[t].apply(r,arguments)}:void 0===i[t]&&Object.defineProperty(i,t,{get:function(){return r[t]},set:function(e){return r[t]=e}})};for(var a in r)n(a);return i}(i.mediaSource_.nativeMediaSource_,t+'/mp4;codecs="'+i[t+"Codec_"]+'"'),i.mediaSource_[t+"Buffer_"]=r;i[t+"Buffer_"]=r,["update","updatestart","updateend"].forEach(function(e){r.addEventListener(e,function(){if("audio"!==t||!i.audioDisabled_)return"updateend"===e&&(i[t+"Buffer_"].updating=!1),n.every(function(e){return!("audio"!==e||!i.audioDisabled_)||(t===e||!i[e+"Buffer_"]||!i[e+"Buffer_"].updating)})?i.trigger(e):void 0})})}})}},{key:"appendBuffer",value:function(e){if(this.bufferUpdating_=!0,this.audioBuffer_&&this.audioBuffer_.buffered.length){var t=this.audioBuffer_.buffered;this.transmuxer_.postMessage({action:"setAudioAppendStart",appendStart:t.end(t.length-1)})}this.videoBuffer_&&this.transmuxer_.postMessage({action:"alignGopsWith",gopsToAlignWith:function(e,t,r){if(!t||!e.length)return[];var i=Math.ceil(9e4*(t.currentTime()-r+3)),n=void 0;for(n=0;n<e.length&&!(i<e[n].pts);n++);return e.slice(n)}(this.gopBuffer_,this.mediaSource_.player_,this.timeMapping_)}),this.transmuxer_.postMessage({action:"push",data:e.buffer,byteOffset:e.byteOffset,byteLength:e.byteLength},[e.buffer]),this.transmuxer_.postMessage({action:"flush"})}},{key:"appendGopInfo_",value:function(e){this.gopBuffer_=function(e,t,r){if(!t.length)return e;if(r)return t.slice();for(var i=t[0].pts,n=0;n<e.length&&!(i<=e[n].pts);n++);return e.slice(0,n).concat(t)}(this.gopBuffer_,e.data.gopInfo,this.safeAppend_)}},{key:"remove",value:function(e,t){if(this.videoBuffer_&&(this.videoBuffer_.updating=!0,this.videoBuffer_.remove(e,t),this.gopBuffer_=function(e,t,r,i){for(var n=Math.ceil(9e4*(t-i)),a=Math.ceil(9e4*(r-i)),o=e.slice(),s=e.length;s--&&!(e[s].pts<=a););if(-1===s)return o;for(var l=s+1;l--&&!(e[l].pts<=n););return o.splice(l=Math.max(l,0),s-l+1),o}(this.gopBuffer_,e,t,this.timeMapping_)),!this.audioDisabled_&&this.audioBuffer_&&(this.audioBuffer_.updating=!0,this.audioBuffer_.remove(e,t)),wp(e,t,this.metadataTrack_),this.inbandTextTracks_)for(var r in this.inbandTextTracks_)wp(e,t,this.inbandTextTracks_[r])}},{key:"processPendingSegments_",value:function(){var e={video:{segments:[],bytes:0},audio:{segments:[],bytes:0},captions:[],metadata:[]};e=this.pendingBuffers_.reduce(function(e,t){var r=t.type,i=t.data,n=t.initSegment;return e[r].segments.push(i),e[r].bytes+=i.byteLength,e[r].initSegment=n,t.captions&&(e.captions=e.captions.concat(t.captions)),t.info&&(e[r].info=t.info),t.metadata&&(e.metadata=e.metadata.concat(t.metadata)),e},e),this.videoBuffer_||this.audioBuffer_||(0===e.video.bytes&&(this.videoCodec_=null),0===e.audio.bytes&&(this.audioCodec_=null),this.createRealSourceBuffers_()),e.audio.info&&this.mediaSource_.trigger({type:"audioinfo",info:e.audio.info}),e.video.info&&this.mediaSource_.trigger({type:"videoinfo",info:e.video.info}),this.appendAudioInitSegment_&&(!this.audioDisabled_&&this.audioBuffer_&&(e.audio.segments.unshift(e.audio.initSegment),e.audio.bytes+=e.audio.initSegment.byteLength),this.appendAudioInitSegment_=!1);var t=!1;this.videoBuffer_&&e.video.bytes?(e.video.segments.unshift(e.video.initSegment),e.video.bytes+=e.video.initSegment.byteLength,this.concatAndAppendSegments_(e.video,this.videoBuffer_),Ap(this,e.captions,e.metadata)):!this.videoBuffer_||!this.audioDisabled_&&this.audioBuffer_||(t=!0),!this.audioDisabled_&&this.audioBuffer_&&this.concatAndAppendSegments_(e.audio,this.audioBuffer_),this.pendingBuffers_.length=0,t&&this.trigger("updateend"),this.bufferUpdating_=!1}},{key:"concatAndAppendSegments_",value:function(e,t){var r=0,i=void 0;if(e.bytes){i=new Uint8Array(e.bytes),e.segments.forEach(function(e){i.set(e,r),r+=e.byteLength});try{t.updating=!0,t.appendBuffer(i)}catch(e){this.mediaSource_.player_&&this.mediaSource_.player_.error({code:-3,type:"APPEND_BUFFER_ERR",message:e.message,originalError:e})}}}},{key:"abort",value:function(){this.videoBuffer_&&this.videoBuffer_.abort(),!this.audioDisabled_&&this.audioBuffer_&&this.audioBuffer_.abort(),this.transmuxer_&&this.transmuxer_.postMessage({action:"reset"}),this.pendingBuffers_.length=0,this.bufferUpdating_=!1}}]),n}(),Vp=function(e){function t(){Df(this,t);var a=Ff(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),e=void 0;for(e in a.nativeMediaSource_=new Ja.MediaSource,a.nativeMediaSource_)e in t.prototype||"function"!=typeof a.nativeMediaSource_[e]||(a[e]=a.nativeMediaSource_[e].bind(a.nativeMediaSource_));return a.duration_=NaN,Object.defineProperty(a,"duration",{get:function(){return this.duration_===1/0?this.duration_:this.nativeMediaSource_.duration},set:function(e){(this.duration_=e)===1/0||(this.nativeMediaSource_.duration=e)}}),Object.defineProperty(a,"seekable",{get:function(){return this.duration_===1/0?Pf.createTimeRanges([[0,this.nativeMediaSource_.duration]]):this.nativeMediaSource_.seekable}}),Object.defineProperty(a,"readyState",{get:function(){return this.nativeMediaSource_.readyState}}),Object.defineProperty(a,"activeSourceBuffers",{get:function(){return this.activeSourceBuffers_}}),a.sourceBuffers=[],a.activeSourceBuffers_=[],a.updateActiveSourceBuffers_=function(){if(a.activeSourceBuffers_.length=0,1===a.sourceBuffers.length){var e=a.sourceBuffers[0];return e.appendAudioInitSegment_=!0,e.audioDisabled_=!e.audioCodec_,void a.activeSourceBuffers_.push(e)}for(var r=!1,i=!0,t=0;t<a.player_.audioTracks().length;t++){var n=a.player_.audioTracks()[t];if(n.enabled&&"main"!==n.kind){i=!(r=!0);break}}a.sourceBuffers.forEach(function(e,t){if(e.appendAudioInitSegment_=!0,e.videoCodec_&&e.audioCodec_)e.audioDisabled_=r;else if(e.videoCodec_&&!e.audioCodec_)i=!(e.audioDisabled_=!0);else if(!e.videoCodec_&&e.audioCodec_&&(e.audioDisabled_=t?i:!i,e.audioDisabled_))return;a.activeSourceBuffers_.push(e)})},a.onPlayerMediachange_=function(){a.sourceBuffers.forEach(function(e){e.appendAudioInitSegment_=!0})},a.onHlsReset_=function(){a.sourceBuffers.forEach(function(e){e.transmuxer_&&e.transmuxer_.postMessage({action:"resetCaptions"})})},a.onHlsSegmentTimeMapping_=function(t){a.sourceBuffers.forEach(function(e){return e.timeMapping_=t.mapping})},["sourceopen","sourceclose","sourceended"].forEach(function(e){this.nativeMediaSource_.addEventListener(e,this.trigger.bind(this))},a),a.on("sourceopen",function(e){var t=to.querySelector('[src="'+a.url_+'"]');t&&(a.player_=Pf(t.parentNode),a.player_.tech_.on("hls-reset",a.onHlsReset_),a.player_.tech_.on("hls-segment-time-mapping",a.onHlsSegmentTimeMapping_),a.player_.audioTracks&&a.player_.audioTracks()&&(a.player_.audioTracks().on("change",a.updateActiveSourceBuffers_),a.player_.audioTracks().on("addtrack",a.updateActiveSourceBuffers_),a.player_.audioTracks().on("removetrack",a.updateActiveSourceBuffers_)),a.player_.on("mediachange",a.onPlayerMediachange_))}),a.on("sourceended",function(e){for(var t=Cp(a.duration),r=0;r<a.sourceBuffers.length;r++){var i=a.sourceBuffers[r],n=i.metadataTrack_&&i.metadataTrack_.cues;n&&n.length&&(n[n.length-1].endTime=t)}}),a.on("sourceclose",function(e){this.sourceBuffers.forEach(function(e){e.transmuxer_&&e.transmuxer_.terminate()}),this.sourceBuffers.length=0,this.player_&&(this.player_.audioTracks&&this.player_.audioTracks()&&(this.player_.audioTracks().off("change",this.updateActiveSourceBuffers_),this.player_.audioTracks().off("addtrack",this.updateActiveSourceBuffers_),this.player_.audioTracks().off("removetrack",this.updateActiveSourceBuffers_)),this.player_.el_&&(this.player_.off("mediachange",this.onPlayerMediachange_),this.player_.tech_.off("hls-reset",this.onHlsReset_),this.player_.tech_.off("hls-segment-time-mapping",this.onHlsSegmentTimeMapping_)))}),a}return Nf(t,Pf.EventTarget),Mf(t,[{key:"addSeekableRange_",value:function(e,t){var r=void 0;if(this.duration!==1/0)throw(r=Error("MediaSource.addSeekableRange() can only be invoked when the duration is Infinity")).name="InvalidStateError",r.code=11,r;(this.nativeMediaSource_.duration<t||isNaN(this.nativeMediaSource_.duration))&&(this.nativeMediaSource_.duration=t)}},{key:"addSourceBuffer",value:function(e){var n,t,r=void 0,i=(n={type:"",parameters:{}},t=e.trim().split(";"),n.type=t.shift().trim(),t.forEach(function(e){var t=e.trim().split("=");if(1<t.length){var r=t[0].replace(/"/g,"").trim(),i=t[1].replace(/"/g,"").trim();n.parameters[r]=i}}),n);if(/^(video|audio)\/mp2t$/i.test(i.type)){var a=[];i.parameters&&i.parameters.codecs&&(a=i.parameters.codecs.split(","),a=(a=Gp(a)).filter(function(e){return Up(e)||Hp(e)})),0===a.length&&(a=["avc1.4d400d","mp4a.40.2"]),r=new qp(this,a),0!==this.sourceBuffers.length&&(this.sourceBuffers[0].createRealSourceBuffers_(),r.createRealSourceBuffers_(),this.sourceBuffers[0].audioDisabled_=!0)}else r=this.nativeMediaSource_.addSourceBuffer(e);return this.sourceBuffers.push(r),r}}]),t}(),Wp=0;Pf.mediaSources={};var zp=function(e,t){var r=Pf.mediaSources[e];if(!r)throw Error("Media Source not found (Video.js)");r.trigger({type:"sourceopen",swfId:t})},Kp=function(){return!!Ja.MediaSource&&!!Ja.MediaSource.isTypeSupported&&Ja.MediaSource.isTypeSupported('video/mp4;codecs="avc1.4d400d,mp4a.40.2"')},Yp=function(){if(this.MediaSource={open:zp,supportsNativeMediaSources:Kp},Kp())return new Vp;throw Error("Cannot use create a virtual MediaSource for this video")};Yp.open=zp,Yp.supportsNativeMediaSources=Kp;var Xp={createObjectURL:function(e){var t=void 0;return e instanceof Vp?(t=Ja.URL.createObjectURL(e.nativeMediaSource_),e.url_=t):e instanceof Vp?(t="blob:vjs-media-source/"+Wp,Wp++,Pf.mediaSources[t]=e,t):(t=Ja.URL.createObjectURL(e),e.url_=t)}};Pf.MediaSource=Yp,Pf.URL=Xp;var Qp=Pf.EventTarget,Jp=Pf.mergeOptions,Zp=function(e,t){for(var o=Jp(e,{duration:t.duration,minimumUpdatePeriod:t.minimumUpdatePeriod}),r=0;r<t.playlists.length;r++){var i=qf(o,t.playlists[r]);i&&(o=i)}return Gf(t,function(e,t,r,i){if(e.playlists&&e.playlists.length){var n=e.playlists[0].uri,a=qf(o,e.playlists[0]);a&&((o=a).mediaGroups[t][r][i].playlists[0]=o.playlists[n])}}),o},$p=function(e){function a(e,t,r,i){Df(this,a);var n=Ff(this,(a.__proto__||Object.getPrototypeOf(a)).call(this));if(n.hls_=t,n.withCredentials=r,!e)throw Error("A non-empty playlist URL or playlist is required");return n.on("minimumUpdatePeriod",function(){n.refreshXml_()}),n.on("mediaupdatetimeout",function(){n.refreshMedia_()}),"string"==typeof e?(n.srcUrl=e,n.state="HAVE_NOTHING",Ff(n)):(n.masterPlaylistLoader_=i,n.state="HAVE_METADATA",n.started=!0,n.media(e),Ja.setTimeout(function(){n.trigger("loadedmetadata")},0),n)}return Nf(a,Qp),Mf(a,[{key:"dispose",value:function(){this.stopRequest(),Ja.clearTimeout(this.mediaUpdateTimeout)}},{key:"stopRequest",value:function(){if(this.request){var e=this.request;e.onreadystatechange=this.request=null,e.abort()}}},{key:"media",value:function(e){if(!e)return this.media_;if("HAVE_NOTHING"===this.state)throw Error("Cannot switch media playlist from "+this.state);var t=this.state;if("string"==typeof e){if(!this.master.playlists[e])throw Error("Unknown playlist URI: "+e);e=this.master.playlists[e]}var r=!this.media_||e.uri!==this.media_.uri;this.state="HAVE_METADATA",r&&(this.media_&&this.trigger("mediachanging"),this.media_=e,this.refreshMedia_(),"HAVE_MASTER"!==t&&this.trigger("mediachange"))}},{key:"pause",value:function(){this.stopRequest(),"HAVE_NOTHING"===this.state&&(this.started=!1)}},{key:"load",value:function(){this.started?this.trigger("loadedplaylist"):this.start()}},{key:"parseMasterXml",value:function(){var a=Ws(this.masterXml_,{manifestUri:this.srcUrl,clientOffset:this.clientOffset_});a.uri=this.srcUrl;for(var e=0;e<a.playlists.length;e++){var t="placeholder-uri-"+e;a.playlists[e].uri=t,a.playlists[t]=a.playlists[e]}return Gf(a,function(e,t,r,i){if(e.playlists&&e.playlists.length){var n="placeholder-uri-"+t+"-"+r+"-"+i;a.playlists[e.playlists[0].uri=n]=e.playlists[0]}}),Vf(a),Wf(a),a}},{key:"start",value:function(){var r=this;this.started=!0,this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},function(e,t){if(r.request){if(r.request=null,e)return r.error={status:t.status,message:"DASH playlist request error at URL: "+r.srcUrl,responseText:t.responseText,code:2},"HAVE_NOTHING"===r.state&&(r.started=!1),r.trigger("error");r.masterXml_=t.responseText,r.masterLoaded_=t.responseHeaders&&t.responseHeaders.date?Date.parse(t.responseHeaders.date):Date.now(),r.syncClientServerClock_(r.onClientServerClockSync_.bind(r))}})}},{key:"syncClientServerClock_",value:function(i){var n=this,a=zs(this.masterXml_);return null===a?(this.clientOffset_=this.masterLoaded_-Date.now(),i()):"DIRECT"===a.method?(this.clientOffset_=a.value-Date.now(),i()):void(this.request=this.hls_.xhr({uri:Of(this.srcUrl,a.value),method:a.method,withCredentials:this.withCredentials},function(e,t){if(n.request){if(e)return n.clientOffset_=n.masterLoaded_-Date.now(),i();var r=void 0;r="HEAD"===a.method?t.responseHeaders&&t.responseHeaders.date?Date.parse(t.responseHeaders.date):n.masterLoaded_:Date.parse(t.responseText),n.clientOffset_=r-Date.now(),i()}}))}},{key:"onClientServerClockSync_",value:function(){var e=this;this.master=this.parseMasterXml(),this.state="HAVE_MASTER",this.trigger("loadedplaylist"),this.media_||this.media(this.master.playlists[0]),Ja.setTimeout(function(){e.trigger("loadedmetadata")},0),this.master.minimumUpdatePeriod&&Ja.setTimeout(function(){e.trigger("minimumUpdatePeriod")},this.master.minimumUpdatePeriod)}},{key:"refreshXml_",value:function(){var i=this;this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},function(e,t){if(i.request){if(i.request=null,e)return i.error={status:t.status,message:"DASH playlist request error at URL: "+i.srcUrl,responseText:t.responseText,code:2},"HAVE_NOTHING"===i.state&&(i.started=!1),i.trigger("error");i.masterXml_=t.responseText;var r=i.parseMasterXml();i.master=Zp(i.master,r),Ja.setTimeout(function(){i.trigger("minimumUpdatePeriod")},i.master.minimumUpdatePeriod)}})}},{key:"refreshMedia_",value:function(){var e=this,t=void 0,r=void 0;r=this.masterPlaylistLoader_?(t=this.masterPlaylistLoader_.master,this.masterPlaylistLoader_.parseMasterXml()):(t=this.master,this.parseMasterXml());var i=Zp(t,r);i?(this.masterPlaylistLoader_?this.masterPlaylistLoader_.master=i:this.master=i,this.media_=i.playlists[this.media_.uri]):this.trigger("playlistunchanged"),this.media().endList||(this.mediaUpdateTimeout=Ja.setTimeout(function(){e.trigger("mediaupdatetimeout")},zf(this.media(),!!i))),this.trigger("loadedplaylist")}}]),a}(),eg=function(e){return Pf.log.debug?Pf.log.debug.bind(Pf,"VHS:",e+" >"):function(){}};function tg(){}var rg=function(){function n(e,t,r,i){Df(this,n),this.callbacks_=[],this.pendingCallback_=null,this.timestampOffset_=0,this.mediaSource=e,this.processedAppend_=!1,this.type_=r,this.mimeType_=t,this.logger_=eg("SourceUpdater["+r+"]["+t+"]"),"closed"===e.readyState?e.addEventListener("sourceopen",this.createSourceBuffer_.bind(this,t,i)):this.createSourceBuffer_(t,i)}return Mf(n,[{key:"createSourceBuffer_",value:function(e,t){var r=this;this.sourceBuffer_=this.mediaSource.addSourceBuffer(e),this.logger_("created SourceBuffer"),t&&(t.trigger("sourcebufferadded"),this.mediaSource.sourceBuffers.length<2)?t.on("sourcebufferadded",function(){r.start_()}):this.start_()}},{key:"start_",value:function(){var t=this;this.started_=!0,this.onUpdateendCallback_=function(){var e=t.pendingCallback_;t.pendingCallback_=null,t.logger_("buffered ["+Ep(t.buffered())+"]"),e&&e(),t.runCallback_()},this.sourceBuffer_.addEventListener("updateend",this.onUpdateendCallback_),this.runCallback_()}},{key:"abort",value:function(e){var t=this;this.processedAppend_&&this.queueCallback_(function(){t.sourceBuffer_.abort()},e)}},{key:"appendBuffer",value:function(e,t){var r=this;this.processedAppend_=!0,this.queueCallback_(function(){r.sourceBuffer_.appendBuffer(e)},t)}},{key:"buffered",value:function(){return this.sourceBuffer_?this.sourceBuffer_.buffered:Pf.createTimeRanges()}},{key:"remove",value:function(e,t){var r=this;this.processedAppend_&&this.queueCallback_(function(){r.logger_("remove ["+e+" => "+t+"]"),r.sourceBuffer_.remove(e,t)},tg)}},{key:"updating",value:function(){return!this.sourceBuffer_||this.sourceBuffer_.updating||this.pendingCallback_}},{key:"timestampOffset",value:function(e){var t=this;return void 0!==e&&(this.queueCallback_(function(){t.sourceBuffer_.timestampOffset=e}),this.timestampOffset_=e),this.timestampOffset_}},{key:"queueCallback_",value:function(e,t){this.callbacks_.push([e.bind(this),t]),this.runCallback_()}},{key:"runCallback_",value:function(){var e=void 0;!this.updating()&&this.callbacks_.length&&this.started_&&(e=this.callbacks_.shift(),this.pendingCallback_=e[1],e[0]())}},{key:"dispose",value:function(){this.sourceBuffer_.removeEventListener("updateend",this.onUpdateendCallback_),this.sourceBuffer_&&"open"===this.mediaSource.readyState&&this.sourceBuffer_.abort()}}]),n}(),ig={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,GOAL_BUFFER_LENGTH_RATE:1,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,BUFFER_LOW_WATER_LINE_RATE:1},ng=2,ag=-101,og=-102,sg=function(e){var t,r={};return e.byterange&&(r.Range="bytes="+(t=e.byterange).offset+"-"+(t.offset+t.length-1)),r},lg=function(e){e.forEach(function(e){e.abort()})},ug=function(e,t){return t.timedout?{status:t.status,message:"HLS request timed-out at URL: "+t.uri,code:ag,xhr:t}:t.aborted?{status:t.status,message:"HLS request aborted at URL: "+t.uri,code:og,xhr:t}:e?{status:t.status,message:"HLS request errored at URL: "+t.uri,code:ng,xhr:t}:null},cg=function(o,s,l){var u=[],c=0;return function(e,t){if(e&&(lg(o),u.push(e)),(c+=1)===o.length){if(t.endOfAllRequests=Date.now(),0<u.length){var r=u.reduce(function(e,t){return e.code<t.code?t:e});return l(r,t)}return t.encryptedBytes?(n=t,a=l,(i=s).addEventListener("message",function e(t){if(t.data.source===n.requestId){i.removeEventListener("message",e);var r=t.data.decrypted;return n.bytes=new Uint8Array(r.bytes,r.byteOffset,r.byteLength),a(null,n)}}),void i.postMessage(gp({source:n.requestId,encrypted:n.encryptedBytes,key:n.key.bytes,iv:n.key.iv}),[n.encryptedBytes.buffer,n.key.bytes.buffer])):l(null,t)}var i,n,a}},dg=function(n,a){return function(e){var t,r,i;return n.stats=Pf.mergeOptions(n.stats,(r=(t=e).target,(i={bandwidth:1/0,bytesReceived:0,roundTripTime:Date.now()-r.requestTime||0}).bytesReceived=t.loaded,i.bandwidth=Math.floor(i.bytesReceived/i.roundTripTime*8*1e3),i)),!n.stats.firstBytesReceivedAt&&n.stats.bytesReceived&&(n.stats.firstBytesReceivedAt=Date.now()),a(e,n)}},hg=function(e,t,r,i,n,a){var o,s,l,u,c=[],d=cg(c,r,a);if(i.key){var h=e(Pf.mergeOptions(t,{uri:i.key.resolvedUri,responseType:"arraybuffer"}),(o=i,s=d,function(e,t){var r=t.response,i=ug(e,t);if(i)return s(i,o);if(16!==r.byteLength)return s({status:t.status,message:"Invalid HLS key at URL: "+t.uri,code:ng,xhr:t},o);var n=new DataView(r);return o.key.bytes=new Uint32Array([n.getUint32(0),n.getUint32(4),n.getUint32(8),n.getUint32(12)]),s(null,o)}));c.push(h)}if(i.map&&!i.map.bytes){var f=e(Pf.mergeOptions(t,{uri:i.map.resolvedUri,responseType:"arraybuffer",headers:sg(i.map)}),(l=i,u=d,function(e,t){var r=t.response,i=ug(e,t);return i?u(i,l):0===r.byteLength?u({status:t.status,message:"Empty HLS segment content at URL: "+t.uri,code:ng,xhr:t},l):(l.map.bytes=new Uint8Array(t.response),u(null,l))}));c.push(f)}var p,g,m=e(Pf.mergeOptions(t,{uri:i.resolvedUri,responseType:"arraybuffer",headers:sg(i)}),(p=i,g=d,function(e,t){var r,i=t.response,n=ug(e,t);return n?g(n,p):0===i.byteLength?g({status:t.status,message:"Empty HLS segment content at URL: "+t.uri,code:ng,xhr:t},p):(p.stats={bandwidth:(r=t).bandwidth,bytesReceived:r.bytesReceived||0,roundTripTime:r.roundTripTime||0},p.key?p.encryptedBytes=new Uint8Array(t.response):p.bytes=new Uint8Array(t.response),g(null,p))}));return m.addEventListener("progress",dg(i,n)),c.push(m),function(){return lg(c)}},fg={videoCodec:"avc1",videoObjectTypeIndicator:".4d400d",audioProfile:"2"},pg=function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",r={codecCount:0};return r.codecCount=t.split(",").length,r.codecCount=r.codecCount||2,(e=/(^|\s|,)+(avc[13])([^ ,]*)/i.exec(t))&&(r.videoCodec=e[2],r.videoObjectTypeIndicator=e[3]),r.audioProfile=/(^|\s|,)+mp4a.[0-9A-Fa-f]+\.([0-9A-Fa-f]+)/i.exec(t),r.audioProfile=r.audioProfile&&r.audioProfile[2],r},gg=function(e,t,r){return e+"/"+t+'; codecs="'+r.filter(function(e){return!!e}).join(", ")+'"'},mg=function(e,t){var r,i,n=(r=t).segments&&r.segments.length&&r.segments[0].map?"mp4":"mp2t",a=(i=t.attributes||{}).CODECS?pg(i.CODECS):fg,o=t.attributes||{},s=!0,l=!1;if(!t)return[];if(e.mediaGroups.AUDIO&&o.AUDIO){var u=e.mediaGroups.AUDIO[o.AUDIO];if(u)for(var c in s=!(l=!0),u)if(!u[c].uri&&!u[c].playlists){s=!0;break}}l&&!a.audioProfile&&(s||(a.audioProfile=function(e,t){if(!e.mediaGroups.AUDIO||!t)return null;var r=e.mediaGroups.AUDIO[t];if(!r)return null;for(var i in r){var n=r[i];if(n.default&&n.playlists)return pg(n.playlists[0].attributes.CODECS).audioProfile}return null}(e,o.AUDIO)),a.audioProfile||(Pf.log.warn("Multiple audio tracks present but no audio codec string is specified. Attempting to use the default audio codec (mp4a.40.2)"),a.audioProfile=fg.audioProfile));var d={};a.videoCodec&&(d.video=""+a.videoCodec+a.videoObjectTypeIndicator),a.audioProfile&&(d.audio="mp4a.40."+a.audioProfile);var h=gg("audio",n,[d.audio]),f=gg("video",n,[d.video]),p=gg("video",n,[d.video,d.audio]);return l?!s&&d.video?[f,h]:s||d.video?[p,h]:[h,h]:d.video?[p]:[h]},vg=function(e,t){var r;return e&&(r=Ja.getComputedStyle(e))?r[t]:""},yg=function(e,i){var n=e.slice();e.sort(function(e,t){var r=i(e,t);return 0===r?n.indexOf(e)-n.indexOf(t):r})},_g=function(e,t){var r=void 0,i=void 0;return e.attributes.BANDWIDTH&&(r=e.attributes.BANDWIDTH),t.attributes.BANDWIDTH&&(i=t.attributes.BANDWIDTH),(r=r||Ja.Number.MAX_VALUE)-(i=i||Ja.Number.MAX_VALUE)},bg=function(e,t,r){return!(!e||!t)&&(e.endList&&"open"===t.readyState&&r===e.segments.length)},Tg=function(e){return"number"==typeof e&&isFinite(e)},Sg=function(e){function r(e){Df(this,r);var t=Ff(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));if(!e)throw new TypeError("Initialization settings are required");if("function"!=typeof e.currentTime)throw new TypeError("No currentTime getter specified");if(!e.mediaSource)throw new TypeError("No MediaSource specified");return t.bandwidth=e.bandwidth,t.throughput={rate:0,count:0},t.roundTrip=NaN,t.resetStats_(),t.mediaIndex=null,t.hasPlayed_=e.hasPlayed,t.currentTime_=e.currentTime,t.seekable_=e.seekable,t.seeking_=e.seeking,t.duration_=e.duration,t.mediaSource_=e.mediaSource,t.hls_=e.hls,t.loaderType_=e.loaderType,t.startingMedia_=void 0,t.segmentMetadataTrack_=e.segmentMetadataTrack,t.goalBufferLength_=e.goalBufferLength,t.sourceType_=e.sourceType,t.state_="INIT",t.checkBufferTimeout_=null,t.error_=void 0,t.currentTimeline_=-1,t.pendingSegment_=null,t.mimeType_=null,t.sourceUpdater_=null,t.xhrOptions_=null,t.activeInitSegmentId_=null,t.initSegments_={},t.decrypter_=e.decrypter,t.syncController_=e.syncController,t.syncPoint_={segmentIndex:0,time:0},t.syncController_.on("syncinfoupdate",function(){return t.trigger("syncinfoupdate")}),t.mediaSource_.addEventListener("sourceopen",function(){return t.ended_=!1}),t.fetchAtBuffer_=!1,t.logger_=eg("SegmentLoader["+t.loaderType_+"]"),Object.defineProperty(t,"state",{get:function(){return this.state_},set:function(e){e!==this.state_&&(this.logger_(this.state_+" -> "+e),this.state_=e)}}),t}return Nf(r,Pf.EventTarget),Mf(r,[{key:"resetStats_",value:function(){this.mediaBytesTransferred=0,this.mediaRequests=0,this.mediaRequestsAborted=0,this.mediaRequestsTimedout=0,this.mediaRequestsErrored=0,this.mediaTransferDuration=0,this.mediaSecondsLoaded=0}},{key:"dispose",value:function(){this.state="DISPOSED",this.pause(),this.abort_(),this.sourceUpdater_&&this.sourceUpdater_.dispose(),this.resetStats_()}},{key:"abort",value:function(){"WAITING"===this.state?(this.abort_(),this.state="READY",this.paused()||this.monitorBuffer_()):this.pendingSegment_&&(this.pendingSegment_=null)}},{key:"abort_",value:function(){this.pendingSegment_&&this.pendingSegment_.abortRequests(),this.pendingSegment_=null}},{key:"error",value:function(e){return void 0!==e&&(this.error_=e),this.pendingSegment_=null,this.error_}},{key:"endOfStream",value:function(){this.ended_=!0,this.pause(),this.trigger("ended")}},{key:"buffered_",value:function(){return this.sourceUpdater_?this.sourceUpdater_.buffered():Pf.createTimeRanges()}},{key:"initSegment",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(!e)return null;var r=mp(e),i=this.initSegments_[r];return t&&!i&&e.bytes&&(this.initSegments_[r]=i={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:e.bytes}),i||e}},{key:"couldBeginLoading_",value:function(){return this.playlist_&&(this.sourceUpdater_||this.mimeType_&&"INIT"===this.state)&&!this.paused()}},{key:"load",value:function(){if(this.monitorBuffer_(),this.playlist_){if(this.syncController_.setDateTimeMapping(this.playlist_),"INIT"===this.state&&this.couldBeginLoading_())return this.init_();!this.couldBeginLoading_()||"READY"!==this.state&&"INIT"!==this.state||(this.state="READY")}}},{key:"init_",value:function(){return this.state="READY",this.sourceUpdater_=new rg(this.mediaSource_,this.mimeType_,this.loaderType_,this.sourceBufferEmitter_),this.resetEverything(),this.monitorBuffer_()}},{key:"playlist",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(e){var r=this.playlist_,i=this.pendingSegment_;if(this.playlist_=e,this.xhrOptions_=t,this.hasPlayed_()||(e.syncInfo={mediaSequence:e.mediaSequence,time:0}),this.logger_("playlist update ["+(r?r.id:null)+" => "+e.id+"]"),this.trigger("syncinfoupdate"),"INIT"===this.state&&this.couldBeginLoading_())return this.init_();if(r&&r.uri===e.uri){var n=e.mediaSequence-r.mediaSequence;this.logger_("live window shift ["+n+"]"),null!==this.mediaIndex&&(this.mediaIndex-=n),i&&(i.mediaIndex-=n,0<=i.mediaIndex&&(i.segment=e.segments[i.mediaIndex])),this.syncController_.saveExpiredSegmentInfo(r,e)}else null!==this.mediaIndex&&this.resyncLoader()}}},{key:"pause",value:function(){this.checkBufferTimeout_&&(Ja.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null)}},{key:"paused",value:function(){return null===this.checkBufferTimeout_}},{key:"mimeType",value:function(e,t){this.mimeType_||(this.mimeType_=e,this.sourceBufferEmitter_=t,"INIT"===this.state&&this.couldBeginLoading_()&&this.init_())}},{key:"resetEverything",value:function(){this.ended_=!1,this.resetLoader(),this.remove(0,this.duration_()),this.trigger("reseteverything")}},{key:"resetLoader",value:function(){this.fetchAtBuffer_=!1,this.resyncLoader()}},{key:"resyncLoader",value:function(){this.mediaIndex=null,this.syncPoint_=null,this.abort()}},{key:"remove",value:function(e,t){this.sourceUpdater_&&this.sourceUpdater_.remove(e,t),wp(e,t,this.segmentMetadataTrack_)}},{key:"monitorBuffer_",value:function(){this.checkBufferTimeout_&&Ja.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=Ja.setTimeout(this.monitorBufferTick_.bind(this),1)}},{key:"monitorBufferTick_",value:function(){"READY"===this.state&&this.fillBuffer_(),this.checkBufferTimeout_&&Ja.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=Ja.setTimeout(this.monitorBufferTick_.bind(this),500)}},{key:"fillBuffer_",value:function(){if(!this.sourceUpdater_.updating()){this.syncPoint_||(this.syncPoint_=this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_()));var e=this.checkBuffer_(this.buffered_(),this.playlist_,this.mediaIndex,this.hasPlayed_(),this.currentTime_(),this.syncPoint_);if(e)bg(this.playlist_,this.mediaSource_,e.mediaIndex)?this.endOfStream():(e.mediaIndex!==this.playlist_.segments.length-1||"ended"!==this.mediaSource_.readyState||this.seeking_())&&((e.timeline!==this.currentTimeline_||null!==e.startOfSegment&&e.startOfSegment<this.sourceUpdater_.timestampOffset())&&(this.syncController_.reset(),e.timestampOffset=e.startOfSegment),this.loadSegment_(e))}}},{key:"checkBuffer_",value:function(e,t,r,i,n,a){var o=0,s=void 0;e.length&&(o=e.end(e.length-1));var l=Math.max(0,o-n);if(!t.segments.length)return null;if(l>=this.goalBufferLength_())return null;if(!i&&1<=l)return null;if(null===a)return r=this.getSyncSegmentCandidate_(t),this.generateSegmentInfo_(t,r,null,!0);if(null!==r){var u=t.segments[r];return this.generateSegmentInfo_(t,r+1,s=u&&u.end?u.end:o,!1)}if(this.fetchAtBuffer_){var c=up.getMediaInfoForTime(t,o,a.segmentIndex,a.time);r=c.mediaIndex,s=c.startTime}else{var d=up.getMediaInfoForTime(t,n,a.segmentIndex,a.time);r=d.mediaIndex,s=d.startTime}return this.generateSegmentInfo_(t,r,s,!1)}},{key:"getSyncSegmentCandidate_",value:function(e){var t=this;if(-1===this.currentTimeline_)return 0;var r=e.segments.map(function(e,t){return{timeline:e.timeline,segmentIndex:t}}).filter(function(e){return e.timeline===t.currentTimeline_});return r.length?r[Math.min(r.length-1,1)].segmentIndex:Math.max(e.segments.length-1,0)}},{key:"generateSegmentInfo_",value:function(e,t,r,i){if(t<0||e.segments.length<=t)return null;var n=e.segments[t];return{requestId:"segment-loader-"+Math.random(),uri:n.resolvedUri,mediaIndex:t,isSyncRequest:i,startOfSegment:r,playlist:e,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:n.timeline,duration:n.duration,segment:n}}},{key:"abortRequestEarly_",value:function(e){if(this.hls_.tech_.paused()||!this.xhrOptions_.timeout||!this.playlist_.attributes.BANDWIDTH)return!1;if(Date.now()-(e.firstBytesReceivedAt||Date.now())<1e3)return!1;var t=this.currentTime_(),r=e.bandwidth,i=this.pendingSegment_.duration,n=up.estimateSegmentRequestTime(i,r,this.playlist_,e.bytesReceived),a=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;return((e.length?e.end(e.length-1):0)-t)/r}(this.buffered_(),t,this.hls_.tech_.playbackRate())-1;if(n<=a)return!1;var o=function(e){var r=e.currentTime,i=e.bandwidth,n=e.duration,a=e.segmentDuration,o=e.timeUntilRebuffer,s=e.currentTimeline,l=e.syncController,t=e.master.playlists.filter(function(e){return!up.isIncompatible(e)}),u=t.filter(up.isEnabled);u.length||(u=t.filter(function(e){return!up.isDisabled(e)}));var c=u.filter(up.hasAttribute.bind(null,"BANDWIDTH")).map(function(e){var t=l.getSyncPoint(e,n,s,r)?1:2;return{playlist:e,rebufferingImpact:up.estimateSegmentRequestTime(a,i,e)*t-o}}),d=c.filter(function(e){return e.rebufferingImpact<=0});return yg(d,function(e,t){return _g(t.playlist,e.playlist)}),d.length?d[0]:(yg(c,function(e,t){return e.rebufferingImpact-t.rebufferingImpact}),c[0]||null)}({master:this.hls_.playlists.master,currentTime:t,bandwidth:r,duration:this.duration_(),segmentDuration:i,timeUntilRebuffer:a,currentTimeline:this.currentTimeline_,syncController:this.syncController_});if(o){var s=.5;return a<=_p&&(s=1),!o.playlist||o.playlist.uri===this.playlist_.uri||n-a-o.rebufferingImpact<s?!1:(this.bandwidth=o.playlist.attributes.BANDWIDTH*ig.BANDWIDTH_VARIANCE+1,this.abort(),this.trigger("earlyabort"),!0)}}},{key:"handleProgress_",value:function(e,t){this.pendingSegment_&&t.requestId===this.pendingSegment_.requestId&&!this.abortRequestEarly_(t.stats)&&this.trigger("progress")}},{key:"loadSegment_",value:function(e){this.state="WAITING",this.pendingSegment_=e,this.trimBackBuffer_(e),e.abortRequests=hg(this.hls_.xhr,this.xhrOptions_,this.decrypter_,this.createSimplifiedSegmentObj_(e),this.handleProgress_.bind(this),this.segmentRequestFinished_.bind(this))}},{key:"trimBackBuffer_",value:function(e){var t,r,i,n,a=(t=this.seekable_(),r=this.currentTime_(),i=this.playlist_.targetDuration||10,n=void 0,n=t.length&&0<t.start(0)&&t.start(0)<r?t.start(0):r-30,Math.min(n,r-i));0<a&&this.remove(0,a)}},{key:"createSimplifiedSegmentObj_",value:function(e){var t=e.segment,r={resolvedUri:t.resolvedUri,byterange:t.byterange,requestId:e.requestId};if(t.key){var i=t.key.iv||new Uint32Array([0,0,0,e.mediaIndex+e.playlist.mediaSequence]);r.key={resolvedUri:t.key.resolvedUri,iv:i}}return t.map&&(r.map=this.initSegment(t.map)),r}},{key:"segmentRequestFinished_",value:function(e,t){if(this.mediaRequests+=1,t.stats&&(this.mediaBytesTransferred+=t.stats.bytesReceived,this.mediaTransferDuration+=t.stats.roundTripTime),this.pendingSegment_){if(t.requestId===this.pendingSegment_.requestId){if(e)return this.pendingSegment_=null,this.state="READY",e.code===og?void(this.mediaRequestsAborted+=1):(this.pause(),e.code===ag?(this.mediaRequestsTimedout+=1,this.bandwidth=1,this.roundTrip=NaN,void this.trigger("bandwidthupdate")):(this.mediaRequestsErrored+=1,this.error(e),void this.trigger("error")));this.bandwidth=t.stats.bandwidth,this.roundTrip=t.stats.roundTripTime,t.map&&(t.map=this.initSegment(t.map,!0)),this.processSegmentResponse_(t)}}else this.mediaRequestsAborted+=1}},{key:"processSegmentResponse_",value:function(e){var t=this.pendingSegment_;t.bytes=e.bytes,e.map&&(t.segment.map.bytes=e.map.bytes),t.endOfAllRequests=e.endOfAllRequests,this.handleSegment_()}},{key:"handleSegment_",value:function(){var e=this;if(this.pendingSegment_){var t=this.pendingSegment_,r=t.segment,i=this.syncController_.probeSegmentInfo(t);void 0===this.startingMedia_&&i&&(i.containsAudio||i.containsVideo)&&(this.startingMedia_={containsAudio:i.containsAudio,containsVideo:i.containsVideo});var n,a,o=(n=this.startingMedia_,a=i,"main"===this.loaderType_&&n&&a?a.containsAudio||a.containsVideo?n.containsVideo&&!a.containsVideo?"Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest.":!n.containsVideo&&a.containsVideo?"Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest.":null:"Neither audio nor video found in segment.":null);if(o)return this.error({message:o,blacklistDuration:1/0}),void this.trigger("error");if(t.isSyncRequest)return this.trigger("syncinfoupdate"),this.pendingSegment_=null,void(this.state="READY");null!==t.timestampOffset&&t.timestampOffset!==this.sourceUpdater_.timestampOffset()&&(this.sourceUpdater_.timestampOffset(t.timestampOffset),this.trigger("timestampoffset"));var s,l,u,c,d,h=this.syncController_.mappingForTimeline(t.timeline);if(null!==h&&this.trigger({type:"segmenttimemapping",mapping:h}),this.state="APPENDING",r.map){var f=mp(r.map);if(!this.activeInitSegmentId_||this.activeInitSegmentId_!==f){var p=this.initSegment(r.map);this.sourceUpdater_.appendBuffer(p.bytes,function(){e.activeInitSegmentId_=f})}}t.byteLength=t.bytes.byteLength,this.mediaSecondsLoaded+="number"==typeof r.start&&"number"==typeof r.end?r.end-r.start:r.duration,this.logger_(["appending ["+(s=t).mediaIndex+"] of ["+(c=(u=s.playlist).mediaSequence)+", "+(c+(void 0===(d=u.segments)?[]:d).length)+"] from playlist ["+u.id+"]","["+(l=s.segment).start+" => "+l.end+"] in timeline ["+s.timeline+"]"].join(" ")),this.sourceUpdater_.appendBuffer(t.bytes,this.handleUpdateEnd_.bind(this))}else this.state="READY"}},{key:"handleUpdateEnd_",value:function(){if(!this.pendingSegment_)return this.state="READY",void(this.paused()||this.monitorBuffer_());var e=this.pendingSegment_,t=e.segment,r=null!==this.mediaIndex;(this.pendingSegment_=null,this.recordThroughput_(e),this.addSegmentMetadataCue_(e),this.state="READY",this.mediaIndex=e.mediaIndex,this.fetchAtBuffer_=!0,this.currentTimeline_=e.timeline,this.trigger("syncinfoupdate"),t.end&&this.currentTime_()-t.end>3*e.playlist.targetDuration)?this.resetEverything():(r&&this.trigger("bandwidthupdate"),this.trigger("progress"),bg(e.playlist,this.mediaSource_,e.mediaIndex+1)&&this.endOfStream(),this.paused()||this.monitorBuffer_())}},{key:"recordThroughput_",value:function(e){var t=this.throughput.rate,r=Date.now()-e.endOfAllRequests+1;this.throughput.rate+=(Math.floor(e.byteLength/r*8*1e3)-t)/++this.throughput.count}},{key:"addSegmentMetadataCue_",value:function(e){if(this.segmentMetadataTrack_){var t=e.segment,r=t.start,i=t.end;if(Tg(r)&&Tg(i)){wp(r,i,this.segmentMetadataTrack_);var n={bandwidth:e.playlist.attributes.BANDWIDTH,resolution:e.playlist.attributes.RESOLUTION,codecs:e.playlist.attributes.CODECS,byteLength:e.byteLength,uri:e.uri,timeline:e.timeline,playlist:e.playlist.uri,start:r,end:i},a=new(Ja.WebKitDataCue||Ja.VTTCue)(r,i,JSON.stringify(n));a.value=n,this.segmentMetadataTrack_.addCue(a)}}}}]),r}(),Eg=new Uint8Array("\n\n".split("").map(function(e){return e.charCodeAt(0)})),kg=function(e){return String.fromCharCode.apply(null,e)},wg=function(e){function i(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};Df(this,i);var r=Ff(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,e,t));return r.mediaSource_=null,r.subtitlesTrack_=null,r}return Nf(i,Sg),Mf(i,[{key:"buffered_",value:function(){if(!this.subtitlesTrack_||!this.subtitlesTrack_.cues.length)return Pf.createTimeRanges();var e=this.subtitlesTrack_.cues;return Pf.createTimeRanges([[e[0].startTime,e[e.length-1].startTime]])}},{key:"initSegment",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(!e)return null;var r=mp(e),i=this.initSegments_[r];if(t&&!i&&e.bytes){var n=new Uint8Array(Eg.byteLength+e.bytes.byteLength);n.set(e.bytes),n.set(Eg,e.bytes.byteLength),this.initSegments_[r]=i={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:n}}return i||e}},{key:"couldBeginLoading_",value:function(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()}},{key:"init_",value:function(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}},{key:"track",value:function(e){return void 0===e||(this.subtitlesTrack_=e,"INIT"===this.state&&this.couldBeginLoading_()&&this.init_()),this.subtitlesTrack_}},{key:"remove",value:function(e,t){wp(e,t,this.subtitlesTrack_)}},{key:"fillBuffer_",value:function(){var e=this;this.syncPoint_||(this.syncPoint_=this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_()));var t=this.checkBuffer_(this.buffered_(),this.playlist_,this.mediaIndex,this.hasPlayed_(),this.currentTime_(),this.syncPoint_);if(t=this.skipEmptySegments_(t)){if(null===this.syncController_.timestampOffsetForTimeline(t.timeline)){return this.syncController_.one("timestampoffset",function(){e.state="READY",e.paused()||e.monitorBuffer_()}),void(this.state="WAITING_ON_TIMELINE")}this.loadSegment_(t)}}},{key:"skipEmptySegments_",value:function(e){for(;e&&e.segment.empty;)e=this.generateSegmentInfo_(e.playlist,e.mediaIndex+1,e.startOfSegment+e.duration,e.isSyncRequest);return e}},{key:"handleSegment_",value:function(){var t=this;if(this.pendingSegment_&&this.subtitlesTrack_){this.state="APPENDING";var e=this.pendingSegment_,r=e.segment;if("function"!=typeof Ja.WebVTT&&this.subtitlesTrack_&&this.subtitlesTrack_.tech_){var i=function(){t.handleSegment_()};return this.state="WAITING_ON_VTTJS",this.subtitlesTrack_.tech_.one("vttjsloaded",i),void this.subtitlesTrack_.tech_.one("vttjserror",function(){t.subtitlesTrack_.tech_.off("vttjsloaded",i),t.error({message:"Error loading vtt.js"}),t.state="READY",t.pause(),t.trigger("error")})}r.requested=!0;try{this.parseVTTCues_(e)}catch(e){return this.error({message:e.message}),this.state="READY",this.pause(),this.trigger("error")}if(this.updateTimeMapping_(e,this.syncController_.timelines[e.timeline],this.playlist_),e.isSyncRequest)return this.trigger("syncinfoupdate"),this.pendingSegment_=null,void(this.state="READY");e.byteLength=e.bytes.byteLength,this.mediaSecondsLoaded+=r.duration,e.cues.length&&this.remove(e.cues[0].endTime,e.cues[e.cues.length-1].endTime),e.cues.forEach(function(e){t.subtitlesTrack_.addCue(e)}),this.handleUpdateEnd_()}else this.state="READY"}},{key:"parseVTTCues_",value:function(t){var e=void 0,r=!1;"function"==typeof Ja.TextDecoder?e=new Ja.TextDecoder("utf8"):(e=Ja.WebVTT.StringDecoder(),r=!0);var i=new Ja.WebVTT.Parser(Ja,Ja.vttjs,e);if(t.cues=[],t.timestampmap={MPEGTS:0,LOCAL:0},i.oncue=t.cues.push.bind(t.cues),i.ontimestampmap=function(e){return t.timestampmap=e},i.onparsingerror=function(e){Pf.log.warn("Error encountered when parsing cues: "+e.message)},t.segment.map){var n=t.segment.map.bytes;r&&(n=kg(n)),i.parse(n)}var a=t.bytes;r&&(a=kg(a)),i.parse(a),i.flush()}},{key:"updateTimeMapping_",value:function(e,t,r){var i=e.segment;if(t)if(e.cues.length){var n=e.timestampmap,a=n.MPEGTS/9e4-n.LOCAL+t.mapping;if(e.cues.forEach(function(e){e.startTime+=a,e.endTime+=a}),!r.syncInfo)r.syncInfo={mediaSequence:r.mediaSequence+e.mediaIndex,time:Math.min(e.cues[0].startTime,e.cues[e.cues.length-1].startTime-i.duration)}}else i.empty=!0}}]),i}(),Cg=function(e,t){for(var r=e.cues,i=0;i<r.length;i++){var n=r[i];if(n.adStartTime<=t&&t<=n.adEndTime)return n}return null},Ag=gl,Lg=[{name:"VOD",run:function(e,t,r,i,n){if(r===1/0)return null;return{time:0,segmentIndex:0}}},{name:"ProgramDateTime",run:function(e,t,r,i,n){if(!e.datetimeToDisplayTime)return null;var a=t.segments||[],o=null,s=null;n=n||0;for(var l=0;l<a.length;l++){var u=a[l];if(u.dateTimeObject){var c=u.dateTimeObject.getTime()/1e3+e.datetimeToDisplayTime,d=Math.abs(n-c);if(null!==s&&s<d)break;s=d,o={time:c,segmentIndex:l}}}return o}},{name:"Segment",run:function(e,t,r,i,n){var a=t.segments||[],o=null,s=null;n=n||0;for(var l=0;l<a.length;l++){var u=a[l];if(u.timeline===i&&void 0!==u.start){var c=Math.abs(n-u.start);if(null!==s&&s<c)break;(!o||null===s||c<=s)&&(s=c,o={time:u.start,segmentIndex:l})}}return o}},{name:"Discontinuity",run:function(e,t,r,i,n){var a=null;if(n=n||0,t.discontinuityStarts&&t.discontinuityStarts.length)for(var o=null,s=0;s<t.discontinuityStarts.length;s++){var l=t.discontinuityStarts[s],u=e.discontinuities[t.discontinuitySequence+s+1];if(u){var c=Math.abs(n-u.time);if(null!==o&&o<c)break;(!a||null===o||c<=o)&&(o=c,a={time:u.time,segmentIndex:l})}}return a}},{name:"Playlist",run:function(e,t,r,i,n){return t.syncInfo?{time:t.syncInfo.time,segmentIndex:t.syncInfo.mediaSequence-t.mediaSequence}:null}}],Ig=function(e){function t(){Df(this,t);var e=Ff(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.inspectCache_=void 0,e.timelines=[],e.discontinuities=[],e.datetimeToDisplayTime=null,e.logger_=eg("SyncController"),e}return Nf(t,Pf.EventTarget),Mf(t,[{key:"getSyncPoint",value:function(e,t,r,i){var n=this.runStrategies_(e,t,r,i);return n.length?this.selectSyncPoint_(n,{key:"time",value:i}):null}},{key:"getExpiredTime",value:function(e,t){if(!e||!e.segments)return null;var r=this.runStrategies_(e,t,e.discontinuitySequence,0);if(!r.length)return null;var i=this.selectSyncPoint_(r,{key:"segmentIndex",value:0});return 0<i.segmentIndex&&(i.time*=-1),Math.abs(i.time+Jf(e,i.segmentIndex,0))}},{key:"runStrategies_",value:function(e,t,r,i){for(var n=[],a=0;a<Lg.length;a++){var o=Lg[a],s=o.run(this,e,t,r,i);s&&(s.strategy=o.name,n.push({strategy:o.name,syncPoint:s}))}return n}},{key:"selectSyncPoint_",value:function(e,t){for(var r=e[0].syncPoint,i=Math.abs(e[0].syncPoint[t.key]-t.value),n=e[0].strategy,a=1;a<e.length;a++){var o=Math.abs(e[a].syncPoint[t.key]-t.value);o<i&&(i=o,r=e[a].syncPoint,n=e[a].strategy)}return this.logger_("syncPoint for ["+t.key+": "+t.value+"] chosen with strategy ["+n+"]: [time:"+r.time+", segmentIndex:"+r.segmentIndex+"]"),r}},{key:"saveExpiredSegmentInfo",value:function(e,t){for(var r=t.mediaSequence-e.mediaSequence-1;0<=r;r--){var i=e.segments[r];if(i&&void 0!==i.start){t.syncInfo={mediaSequence:e.mediaSequence+r,time:i.start},this.logger_("playlist refresh sync: [time:"+t.syncInfo.time+", mediaSequence: "+t.syncInfo.mediaSequence+"]"),this.trigger("syncinfoupdate");break}}}},{key:"setDateTimeMapping",value:function(e){if(!this.datetimeToDisplayTime&&e.segments&&e.segments.length&&e.segments[0].dateTimeObject){var t=e.segments[0].dateTimeObject.getTime()/1e3;this.datetimeToDisplayTime=-t}}},{key:"reset",value:function(){this.inspectCache_=void 0}},{key:"probeSegmentInfo",value:function(e){var t=e.segment,r=e.playlist,i=void 0;return(i=t.map?this.probeMp4Segment_(e):this.probeTsSegment_(e))&&this.calculateSegmentTimeMapping_(e,i)&&(this.saveDiscontinuitySyncInfo_(e),r.syncInfo||(r.syncInfo={mediaSequence:r.mediaSequence+e.mediaIndex,time:t.start})),i}},{key:"probeMp4Segment_",value:function(e){var t=e.segment,r=Ys(t.map.bytes),i=Xs(r,e.bytes);return null!==e.timestampOffset&&(e.timestampOffset-=i),{start:i,end:i+t.duration}}},{key:"probeTsSegment_",value:function(e){var t=Ag(e.bytes,this.inspectCache_),r=void 0,i=void 0;return t?(t.video&&2===t.video.length?(this.inspectCache_=t.video[1].dts,r=t.video[0].dtsTime,i=t.video[1].dtsTime):t.audio&&2===t.audio.length&&(this.inspectCache_=t.audio[1].dts,r=t.audio[0].dtsTime,i=t.audio[1].dtsTime),{start:r,end:i,containsVideo:t.video&&2===t.video.length,containsAudio:t.audio&&2===t.audio.length}):null}},{key:"timestampOffsetForTimeline",value:function(e){return void 0===this.timelines[e]?null:this.timelines[e].time}},{key:"mappingForTimeline",value:function(e){return void 0===this.timelines[e]?null:this.timelines[e].mapping}},{key:"calculateSegmentTimeMapping_",value:function(e,t){var r=e.segment,i=this.timelines[e.timeline];if(null!==e.timestampOffset)this.timelines[e.timeline]=i={time:e.startOfSegment,mapping:e.startOfSegment-t.start},this.trigger("timestampoffset"),this.logger_("time mapping for timeline "+e.timeline+": [time: "+i.time+"] [mapping: "+i.mapping+"]"),r.start=e.startOfSegment,r.end=t.end+i.mapping;else{if(!i)return!1;r.start=t.start+i.mapping,r.end=t.end+i.mapping}return!0}},{key:"saveDiscontinuitySyncInfo_",value:function(e){var t=e.playlist,r=e.segment;if(r.discontinuity)this.discontinuities[r.timeline]={time:r.start,accuracy:0};else if(t.discontinuityStarts&&t.discontinuityStarts.length)for(var i=0;i<t.discontinuityStarts.length;i++){var n=t.discontinuityStarts[i],a=t.discontinuitySequence+i+1,o=n-e.mediaIndex,s=Math.abs(o);if(!this.discontinuities[a]||s<this.discontinuities[a].accuracy){var l=void 0;l=o<0?r.start-Jf(t,e.mediaIndex,n):r.end+Jf(t,e.mediaIndex+1,n),this.discontinuities[a]={time:l,accuracy:s}}}}}]),t}(),Pg=new Dp("./decrypter-worker.worker.js",function(e,t){var r,a,d,i,h,m,n,u,v,o,s=this;r=void 0!==e?e:"undefined"!=typeof global?global:void 0!==s?s:{},a=void 0!==e?e:void 0!==r?r:void 0!==s?s:{},d=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},i=function(){function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}}(),h=null,m=function(){function c(e){d(this,c),h||(h=function(){var e=[[[],[],[],[],[]],[[],[],[],[],[]]],t=e[0],r=e[1],i=t[4],n=r[4],a=void 0,o=void 0,s=void 0,l=[],u=[],c=void 0,d=void 0,h=void 0,f=void 0,p=void 0;for(a=0;a<256;a++)u[(l[a]=a<<1^283*(a>>7))^a]=a;for(o=s=0;!i[o];o^=c||1,s=u[s]||1)for(p=16843009*l[d=l[c=l[n[i[o]=h=(h=s^s<<1^s<<2^s<<3^s<<4)>>8^255&h^99]=o]]]^65537*d^257*c^16843008*o,f=257*l[h]^16843008*h,a=0;a<4;a++)t[a][o]=f=f<<24^f>>>8,r[a][h]=p=p<<24^p>>>8;for(a=0;a<5;a++)t[a]=t[a].slice(0),r[a]=r[a].slice(0);return e}()),this._tables=[[h[0][0].slice(),h[0][1].slice(),h[0][2].slice(),h[0][3].slice(),h[0][4].slice()],[h[1][0].slice(),h[1][1].slice(),h[1][2].slice(),h[1][3].slice(),h[1][4].slice()]];var t=void 0,r=void 0,i=void 0,n=void 0,a=void 0,o=this._tables[0][4],s=this._tables[1],l=e.length,u=1;if(4!==l&&6!==l&&8!==l)throw Error("Invalid aes key size");for(n=e.slice(0),this._key=[n,a=[]],t=l;t<4*l+28;t++)i=n[t-1],(t%l==0||8===l&&t%l==4)&&(i=o[i>>>24]<<24^o[i>>16&255]<<16^o[i>>8&255]<<8^o[255&i],t%l==0&&(i=i<<8^i>>>24^u<<24,u=u<<1^283*(u>>7))),n[t]=n[t-l]^i;for(r=0;t;r++,t--)i=n[3&r?t:t-4],a[r]=t<=4||r<4?i:s[0][o[i>>>24]]^s[1][o[i>>16&255]]^s[2][o[i>>8&255]]^s[3][o[255&i]]}return c.prototype.decrypt=function(e,t,r,i,n,a){var o=this._key[1],s=e^o[0],l=i^o[1],u=r^o[2],c=t^o[3],d=void 0,h=void 0,f=void 0,p=o.length/4-2,g=void 0,m=4,v=this._tables[1],y=v[0],_=v[1],b=v[2],T=v[3],S=v[4];for(g=0;g<p;g++)d=y[s>>>24]^_[l>>16&255]^b[u>>8&255]^T[255&c]^o[m],h=y[l>>>24]^_[u>>16&255]^b[c>>8&255]^T[255&s]^o[m+1],f=y[u>>>24]^_[c>>16&255]^b[s>>8&255]^T[255&l]^o[m+2],c=y[c>>>24]^_[s>>16&255]^b[l>>8&255]^T[255&u]^o[m+3],m+=4,s=d,l=h,u=f;for(g=0;g<4;g++)n[(3&-g)+a]=S[s>>>24]<<24^S[l>>16&255]<<16^S[u>>8&255]<<8^S[255&c]^o[m++],d=s,s=l,l=u,u=c,c=d},c}(),n=function(){function e(){d(this,e),this.listeners={}}return e.prototype.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},e.prototype.off=function(e,t){if(!this.listeners[e])return!1;var r=this.listeners[e].indexOf(t);return this.listeners[e].splice(r,1),-1<r},e.prototype.trigger=function(e){var t=this.listeners[e];if(t)if(2===arguments.length)for(var r=t.length,i=0;i<r;++i)t[i].call(this,arguments[1]);else for(var n=Array.prototype.slice.call(arguments,1),a=t.length,o=0;o<a;++o)t[o].apply(this,n)},e.prototype.dispose=function(){this.listeners={}},e.prototype.pipe=function(t){this.on("data",function(e){t.push(e)})},e}(),u=function(t){function r(){d(this,r);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":Pl(t))&&"function"!=typeof t?e:t}(this,t.call(this,n));return e.jobs=[],e.delay=1,e.timeout_=null,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":Pl(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(r,t),r.prototype.processJob_=function(){this.jobs.shift()(),this.timeout_=this.jobs.length?setTimeout(this.processJob_.bind(this),this.delay):null},r.prototype.push=function(e){this.jobs.push(e),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))},r}(n),v=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},o=function(){function l(e,t,r,i){d(this,l);var n=l.STEP,a=new Int32Array(e.buffer),o=new Uint8Array(e.byteLength),s=0;for(this.asyncStream_=new u,this.asyncStream_.push(this.decryptChunk_(a.subarray(s,s+n),t,r,o)),s=n;s<a.length;s+=n)r=new Uint32Array([v(a[s-4]),v(a[s-3]),v(a[s-2]),v(a[s-1])]),this.asyncStream_.push(this.decryptChunk_(a.subarray(s,s+n),t,r,o));this.asyncStream_.push(function(){var e;i(null,(e=o).subarray(0,e.byteLength-e[e.byteLength-1]))})}return l.prototype.decryptChunk_=function(t,r,i,n){return function(){var e=function(e,t,r){var i=new Int32Array(e.buffer,e.byteOffset,e.byteLength>>2),n=new m(Array.prototype.slice.call(t)),a=new Uint8Array(e.byteLength),o=new Int32Array(a.buffer),s=void 0,l=void 0,u=void 0,c=void 0,d=void 0,h=void 0,f=void 0,p=void 0,g=void 0;for(s=r[0],l=r[1],u=r[2],c=r[3],g=0;g<i.length;g+=4)d=v(i[g]),h=v(i[g+1]),f=v(i[g+2]),p=v(i[g+3]),n.decrypt(d,h,f,p,o,g),o[g]=v(o[g]^s),o[g+1]=v(o[g+1]^l),o[g+2]=v(o[g+2]^u),o[g+3]=v(o[g+3]^c),s=d,l=h,u=f,c=p;return a}(t,r,i);n.set(e,t.byteOffset)}},i(l,null,[{key:"STEP",get:function(){return 32e3}}]),l}(),new function(e){e.onmessage=function(e){var n=e.data,t=new Uint8Array(n.encrypted.bytes,n.encrypted.byteOffset,n.encrypted.byteLength),r=new Uint32Array(n.key.bytes,n.key.byteOffset,n.key.byteLength/4),i=new Uint32Array(n.iv.bytes,n.iv.byteOffset,n.iv.byteLength/4);new o(t,r,i,function(e,t){var r,i;a.postMessage((i={},Object.keys(r={source:n.source,decrypted:t}).forEach(function(e){var t=r[e];i[e]=ArrayBuffer.isView(t)?{bytes:t.buffer,byteOffset:t.byteOffset,byteLength:t.byteLength}:t}),i),[t.buffer])})}}(s)}),xg=function(e,t){e.abort(),e.pause(),t&&t.activePlaylistLoader&&(t.activePlaylistLoader.pause(),t.activePlaylistLoader=null)},Rg=function(e,t){(t.activePlaylistLoader=e).load()},Og={AUDIO:function(s,l){return function(){var e=l.mediaTypes[s],t=l.blacklistCurrentPlaylist;xg(l.segmentLoaders[s],e);var r=e.activeTrack(),i=e.activeGroup(),n=(i.filter(function(e){return e.default})[0]||i[0]).id,a=e.tracks[n];if(r!==a){for(var o in Pf.log.warn("Problem encountered loading the alternate audio track.Switching back to default."),e.tracks)e.tracks[o].enabled=e.tracks[o]===a;e.onTrackChanged()}else t({message:"Problem encountered loading the default audio track."})}},SUBTITLES:function(i,n){return function(){var e=n.segmentLoaders[i],t=n.mediaTypes[i];Pf.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track."),xg(e,t);var r=t.activeTrack();r&&(r.mode="disabled"),t.onTrackChanged()}}},Dg={AUDIO:function(e,t,r){if(t){var i=r.tech,n=r.requestOptions,a=r.segmentLoaders[e];t.on("loadedmetadata",function(){var e=t.media();a.playlist(e,n),(!i.paused()||e.endList&&"none"!==i.preload())&&a.load()}),t.on("loadedplaylist",function(){a.playlist(t.media(),n),i.paused()||a.load()}),t.on("error",Og[e](e,r))}},SUBTITLES:function(e,t,r){var i=r.tech,n=r.requestOptions,a=r.segmentLoaders[e],o=r.mediaTypes[e];t.on("loadedmetadata",function(){var e=t.media();a.playlist(e,n),a.track(o.activeTrack()),(!i.paused()||e.endList&&"none"!==i.preload())&&a.load()}),t.on("loadedplaylist",function(){a.playlist(t.media(),n),i.paused()||a.load()}),t.on("error",Og[e](e,r))}},Mg=function(t,r){return function(e){return e.attributes[t]===r}},Ng=function(t){return function(e){return e.resolvedUri===t}},Fg={AUDIO:function(e,t){var r,i,n=t.hls,a=t.sourceType,o=t.segmentLoaders[e],s=t.requestOptions.withCredentials,l=t.master,u=l.mediaGroups,c=l.playlists,d=t.mediaTypes[e],h=d.groups,f=d.tracks,p=t.masterPlaylistLoader;for(var g in u[e]&&0!==Object.keys(u[e]).length||(u[e]={main:{default:{default:!0}}}),u[e]){h[g]||(h[g]=[]);var m=c.filter(Mg(e,g));for(var v in u[e][g]){var y=u[e][g][v];m.filter(Ng(y.resolvedUri)).length&&delete y.resolvedUri;var _=void 0;if(_=y.resolvedUri?new Kf(y.resolvedUri,n,s):y.playlists&&"dash"===a?new $p(y.playlists[0],n,s,p):null,y=Pf.mergeOptions({id:v,playlistLoader:_},y),Dg[e](e,y.playlistLoader,t),h[g].push(y),void 0===f[v]){var b=new Pf.AudioTrack({id:v,kind:(r=y,i=void 0,i=r.default?"main":"alternative",r.characteristics&&0<=r.characteristics.indexOf("public.accessibility.describes-video")&&(i="main-desc"),i),enabled:!1,language:y.language,default:y.default,label:v});f[v]=b}}}o.on("error",Og[e](e,t))},SUBTITLES:function(e,t){var r=t.tech,i=t.hls,n=t.sourceType,a=t.segmentLoaders[e],o=t.requestOptions.withCredentials,s=t.master.mediaGroups,l=t.mediaTypes[e],u=l.groups,c=l.tracks,d=t.masterPlaylistLoader;for(var h in s[e])for(var f in u[h]||(u[h]=[]),s[e][h])if(!s[e][h][f].forced){var p=s[e][h][f],g=void 0;if("hls"===n?g=new Kf(p.resolvedUri,i,o):"dash"===n&&(g=new $p(p.playlists[0],i,o,d)),p=Pf.mergeOptions({id:f,playlistLoader:g},p),Dg[e](e,p.playlistLoader,t),u[h].push(p),void 0===c[f]){var m=r.addRemoteTextTrack({id:f,kind:"subtitles",enabled:!1,language:p.language,label:f},!1).track;c[f]=m}}a.on("error",Og[e](e,t))},"CLOSED-CAPTIONS":function(e,t){var r=t.tech,i=t.master.mediaGroups,n=t.mediaTypes[e],a=n.groups,o=n.tracks;for(var s in i[e])for(var l in a[s]||(a[s]=[]),i[e][s]){var u=i[e][s][l];if(u.instreamId.match(/CC\d/)&&(a[s].push(Pf.mergeOptions({id:l},u)),void 0===o[l])){var c=r.addRemoteTextTrack({id:u.instreamId,kind:"captions",enabled:!1,language:u.language,label:l},!1).track;o[l]=c}}}},jg={AUDIO:function(r,i){return function(){var e=i.mediaTypes[r].tracks;for(var t in e)if(e[t].enabled)return e[t];return null}},SUBTITLES:function(r,i){return function(){var e=i.mediaTypes[r].tracks;for(var t in e)if("showing"===e[t].mode)return e[t];return null}}},Bg=function(t){["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(function(e){Fg[e](e,t)});var r=t.mediaTypes,e=t.masterPlaylistLoader,i=t.tech,n=t.hls;["AUDIO","SUBTITLES"].forEach(function(e){var n,a,s,l,u,c;r[e].activeGroup=(n=e,a=t,function(t){var e=a.mediaTypes[n].groups,r=a.masterPlaylistLoader.media();if(!r)return null;var i=null;return r.attributes[n]&&(i=e[r.attributes[n]]),i=i||e.main,void 0===t?i:null===t?null:i.filter(function(e){return e.id===t.id})[0]||null}),r[e].activeTrack=jg[e](e,t),r[e].onGroupChanged=(s=e,l=t,function(){var e=l.segmentLoaders,t=e[s],r=e.main,i=l.mediaTypes[s],n=i.activeTrack(),a=i.activeGroup(n),o=i.activePlaylistLoader;xg(t,i),a&&(a.playlistLoader?(t.resyncLoader(),Rg(a.playlistLoader,i)):o&&r.resetEverything())}),r[e].onTrackChanged=(u=e,c=t,function(){var e=c.segmentLoaders,t=e[u],r=e.main,i=c.mediaTypes[u],n=i.activeTrack(),a=i.activeGroup(n),o=i.activePlaylistLoader;xg(t,i),a&&(a.playlistLoader?(o!==a.playlistLoader&&(t.track&&t.track(n),t.resetEverything()),Rg(a.playlistLoader,i)):r.resetEverything())})});var a=r.AUDIO.activeGroup(),o=(a.filter(function(e){return e.default})[0]||a[0]).id;r.AUDIO.tracks[o].enabled=!0,r.AUDIO.onTrackChanged(),e.on("mediachange",function(){["AUDIO","SUBTITLES"].forEach(function(e){return r[e].onGroupChanged()})});var s=function(){r.AUDIO.onTrackChanged(),i.trigger({type:"usage",name:"hls-audio-change"})};for(var l in i.audioTracks().addEventListener("change",s),i.remoteTextTracks().addEventListener("change",r.SUBTITLES.onTrackChanged),n.on("dispose",function(){i.audioTracks().removeEventListener("change",s),i.remoteTextTracks().removeEventListener("change",r.SUBTITLES.onTrackChanged)}),i.clearTracks("audio"),r.AUDIO.tracks)i.audioTracks().addTrack(r.AUDIO.tracks[l])},Ug=void 0,Hg=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred"],Gg=function(e){function f(e){Df(this,f);var t,r=Ff(this,(f.__proto__||Object.getPrototypeOf(f)).call(this)),i=e.url,n=e.withCredentials,a=e.tech,o=e.bandwidth,s=e.externHls,l=e.useCueTags,u=e.blacklistDuration,c=e.enableLowInitialPlaylist,d=e.sourceType;if(!i)throw Error("A non-empty playlist URL is required");Ug=s,r.withCredentials=n,r.tech_=a,r.hls_=a.hls,r.sourceType_=d,r.useCueTags_=l,r.blacklistDuration=u,r.enableLowInitialPlaylist=c,r.useCueTags_&&(r.cueTagsTrack_=r.tech_.addTextTrack("metadata","ad-cues"),r.cueTagsTrack_.inBandMetadataTrackDispatchType=""),r.requestOptions_={withCredentials:r.withCredentials,timeout:null},r.mediaTypes_=(t={},["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(function(e){t[e]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:tg,activeTrack:tg,onGroupChanged:tg,onTrackChanged:tg}}),t),r.mediaSource=new Pf.MediaSource,r.mediaSource.addEventListener("sourceopen",r.handleSourceOpen_.bind(r)),r.seekable_=Pf.createTimeRanges(),r.hasPlayed_=function(){return!1},r.syncController_=new Ig(e),r.segmentMetadataTrack_=a.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},!1).track,r.decrypter_=new Pg;var h={hls:r.hls_,mediaSource:r.mediaSource,currentTime:r.tech_.currentTime.bind(r.tech_),seekable:function(){return r.seekable()},seeking:function(){return r.tech_.seeking()},duration:function(){return r.mediaSource.duration},hasPlayed:function(){return r.hasPlayed_()},goalBufferLength:function(){return r.goalBufferLength()},bandwidth:o,syncController:r.syncController_,decrypter:r.decrypter_,sourceType:r.sourceType_};return r.masterPlaylistLoader_="dash"===r.sourceType_?new $p(i,r.hls_,r.withCredentials):new Kf(i,r.hls_,r.withCredentials),r.setupMasterPlaylistLoaderListeners_(),r.mainSegmentLoader_=new Sg(Pf.mergeOptions(h,{segmentMetadataTrack:r.segmentMetadataTrack_,loaderType:"main"}),e),r.audioSegmentLoader_=new Sg(Pf.mergeOptions(h,{loaderType:"audio"}),e),r.subtitleSegmentLoader_=new wg(Pf.mergeOptions(h,{loaderType:"vtt"}),e),r.setupSegmentLoaderListeners_(),Hg.forEach(function(e){r[e+"_"]=function(e){return this.audioSegmentLoader_[e]+this.mainSegmentLoader_[e]}.bind(r,e)}),r.logger_=eg("MPC"),r.masterPlaylistLoader_.load(),r}return Nf(f,Pf.EventTarget),Mf(f,[{key:"setupMasterPlaylistLoaderListeners_",value:function(){var i=this;this.masterPlaylistLoader_.on("loadedmetadata",function(){var e=i.masterPlaylistLoader_.media(),t=1.5*i.masterPlaylistLoader_.targetDuration*1e3;i.requestOptions_.timeout=lp(i.masterPlaylistLoader_.master,i.masterPlaylistLoader_.media())?0:t,e.endList&&"none"!==i.tech_.preload()&&(i.mainSegmentLoader_.playlist(e,i.requestOptions_),i.mainSegmentLoader_.load()),Bg({sourceType:i.sourceType_,segmentLoaders:{AUDIO:i.audioSegmentLoader_,SUBTITLES:i.subtitleSegmentLoader_,main:i.mainSegmentLoader_},tech:i.tech_,requestOptions:i.requestOptions_,masterPlaylistLoader:i.masterPlaylistLoader_,hls:i.hls_,master:i.master(),mediaTypes:i.mediaTypes_,blacklistCurrentPlaylist:i.blacklistCurrentPlaylist.bind(i)}),i.triggerPresenceUsage_(i.master(),e);try{i.setupSourceBuffers_()}catch(e){return Pf.log.warn("Failed to create SourceBuffers",e),i.mediaSource.endOfStream("decode")}i.setupFirstPlay(),i.trigger("selectedinitialmedia")}),this.masterPlaylistLoader_.on("loadedplaylist",function(){var e=i.masterPlaylistLoader_.media();if(!e){i.excludeUnsupportedVariants_();var t=void 0;return i.enableLowInitialPlaylist&&(t=i.selectInitialPlaylist()),t||(t=i.selectPlaylist()),i.initialMedia_=t,void i.masterPlaylistLoader_.media(i.initialMedia_)}if(i.useCueTags_&&i.updateAdCues_(e),i.mainSegmentLoader_.playlist(e,i.requestOptions_),i.updateDuration(),i.tech_.paused()||i.mainSegmentLoader_.load(),!e.endList){var r=function(){var e=i.seekable();0!==e.length&&i.mediaSource.addSeekableRange_(e.start(0),e.end(0))};if(i.duration()!==1/0){i.tech_.one("durationchange",function e(){i.duration()===1/0?r():i.tech_.one("durationchange",e)})}else r()}}),this.masterPlaylistLoader_.on("error",function(){i.blacklistCurrentPlaylist(i.masterPlaylistLoader_.error)}),this.masterPlaylistLoader_.on("mediachanging",function(){i.mainSegmentLoader_.abort(),i.mainSegmentLoader_.pause()}),this.masterPlaylistLoader_.on("mediachange",function(){var e=i.masterPlaylistLoader_.media(),t=1.5*i.masterPlaylistLoader_.targetDuration*1e3;i.requestOptions_.timeout=lp(i.masterPlaylistLoader_.master,i.masterPlaylistLoader_.media())?0:t,i.mainSegmentLoader_.playlist(e,i.requestOptions_),i.mainSegmentLoader_.load(),i.tech_.trigger({type:"mediachange",bubbles:!0})}),this.masterPlaylistLoader_.on("playlistunchanged",function(){var e=i.masterPlaylistLoader_.media();i.stuckAtPlaylistEnd_(e)&&(i.blacklistCurrentPlaylist({message:"Playlist no longer updating."}),i.tech_.trigger("playliststuck"))}),this.masterPlaylistLoader_.on("renditiondisabled",function(){i.tech_.trigger({type:"usage",name:"hls-rendition-disabled"})}),this.masterPlaylistLoader_.on("renditionenabled",function(){i.tech_.trigger({type:"usage",name:"hls-rendition-enabled"})})}},{key:"triggerPresenceUsage_",value:function(e,t){var r=e.mediaGroups||{},i=!0,n=Object.keys(r.AUDIO);for(var a in r.AUDIO)for(var o in r.AUDIO[a]){r.AUDIO[a][o].uri||(i=!1)}i&&this.tech_.trigger({type:"usage",name:"hls-demuxed"}),Object.keys(r.SUBTITLES).length&&this.tech_.trigger({type:"usage",name:"hls-webvtt"}),Ug.Playlist.isAes(t)&&this.tech_.trigger({type:"usage",name:"hls-aes"}),Ug.Playlist.isFmp4(t)&&this.tech_.trigger({type:"usage",name:"hls-fmp4"}),n.length&&1<Object.keys(r.AUDIO[n[0]]).length&&this.tech_.trigger({type:"usage",name:"hls-alternate-audio"}),this.useCueTags_&&this.tech_.trigger({type:"usage",name:"hls-playlist-cue-tags"})}},{key:"setupSegmentLoaderListeners_",value:function(){var a=this;this.mainSegmentLoader_.on("bandwidthupdate",function(){var e=a.selectPlaylist(),t=a.masterPlaylistLoader_.media(),r=a.tech_.buffered(),i=r.length?r.end(r.length-1)-a.tech_.currentTime():0,n=a.bufferLowWaterLine();(!t.endList||a.duration()<ig.MAX_BUFFER_LOW_WATER_LINE||e.attributes.BANDWIDTH<t.attributes.BANDWIDTH||n<=i)&&a.masterPlaylistLoader_.media(e),a.tech_.trigger("bandwidthupdate")}),this.mainSegmentLoader_.on("progress",function(){a.trigger("progress")}),this.mainSegmentLoader_.on("error",function(){a.blacklistCurrentPlaylist(a.mainSegmentLoader_.error())}),this.mainSegmentLoader_.on("syncinfoupdate",function(){a.onSyncInfoUpdate_()}),this.mainSegmentLoader_.on("timestampoffset",function(){a.tech_.trigger({type:"usage",name:"hls-timestamp-offset"})}),this.audioSegmentLoader_.on("syncinfoupdate",function(){a.onSyncInfoUpdate_()}),this.mainSegmentLoader_.on("ended",function(){a.onEndOfStream()}),this.mainSegmentLoader_.on("earlyabort",function(){a.blacklistCurrentPlaylist({message:"Aborted early because there isn't enough bandwidth to complete the request without rebuffering."},120)}),this.mainSegmentLoader_.on("reseteverything",function(){a.tech_.trigger("hls-reset")}),this.mainSegmentLoader_.on("segmenttimemapping",function(e){a.tech_.trigger({type:"hls-segment-time-mapping",mapping:e.mapping})}),this.audioSegmentLoader_.on("ended",function(){a.onEndOfStream()})}},{key:"mediaSecondsLoaded_",value:function(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)}},{key:"load",value:function(){this.mainSegmentLoader_.load(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.load(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.load()}},{key:"fastQualityChange_",value:function(){var e=this.selectPlaylist();e!==this.masterPlaylistLoader_.media()&&(this.masterPlaylistLoader_.media(e),this.mainSegmentLoader_.resetLoader())}},{key:"play",value:function(){if(!this.setupFirstPlay()){this.tech_.ended()&&this.tech_.setCurrentTime(0),this.hasPlayed_()&&this.load();var e=this.tech_.seekable();return this.tech_.duration()===1/0&&this.tech_.currentTime()<e.start(0)?this.tech_.setCurrentTime(e.end(e.length-1)):void 0}}},{key:"setupFirstPlay",value:function(){var e=this,t=this.masterPlaylistLoader_.media();if(!t||this.tech_.paused()||this.hasPlayed_())return!1;if(!t.endList){var r=this.seekable();if(!r.length)return!1;if(Pf.browser.IE_VERSION&&0===this.tech_.readyState())return this.tech_.one("loadedmetadata",function(){e.trigger("firstplay"),e.tech_.setCurrentTime(r.end(0)),e.hasPlayed_=function(){return!0}}),!1;this.trigger("firstplay"),this.tech_.setCurrentTime(r.end(0))}return this.hasPlayed_=function(){return!0},this.load(),!0}},{key:"handleSourceOpen_",value:function(){try{this.setupSourceBuffers_()}catch(e){return Pf.log.warn("Failed to create Source Buffers",e),this.mediaSource.endOfStream("decode")}if(this.tech_.autoplay()){var e=this.tech_.play();void 0!==e&&"function"==typeof e.then&&e.then(null,function(e){})}this.trigger("sourceopen")}},{key:"onEndOfStream",value:function(){var e=this.mainSegmentLoader_.ended_;this.mediaTypes_.AUDIO.activePlaylistLoader&&(e=!this.mainSegmentLoader_.startingMedia_||this.mainSegmentLoader_.startingMedia_.containsVideo?e&&this.audioSegmentLoader_.ended_:this.audioSegmentLoader_.ended_),e&&this.mediaSource.endOfStream()}},{key:"stuckAtPlaylistEnd_",value:function(e){if(!this.seekable().length)return!1;var t=this.syncController_.getExpiredTime(e,this.mediaSource.duration);if(null===t)return!1;var r=Ug.Playlist.playlistEnd(e,t),i=this.tech_.currentTime(),n=this.tech_.buffered();if(!n.length)return r-i<=.1;var a=n.end(n.length-1);return a-i<=.1&&r-a<=.1}},{key:"blacklistCurrentPlaylist",value:function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=arguments[1],i=void 0;if(i=t.playlist||this.masterPlaylistLoader_.media(),r=r||t.blacklistDuration||this.blacklistDuration,!i){this.error=t;try{return this.mediaSource.endOfStream("network")}catch(e){return this.trigger("error")}}var n=1===this.masterPlaylistLoader_.master.playlists.filter(op).length;return n?(Pf.log.warn("Problem encountered with the current HLS playlist. Trying again since it is the final playlist."),this.tech_.trigger("retryplaylist"),this.masterPlaylistLoader_.load(n)):(i.excludeUntil=Date.now()+1e3*r,this.tech_.trigger("blacklistplaylist"),this.tech_.trigger({type:"usage",name:"hls-rendition-blacklisted"}),e=this.selectPlaylist(),Pf.log.warn("Problem encountered with the current HLS playlist."+(t.message?" "+t.message:"")+" Switching to another playlist."),this.masterPlaylistLoader_.media(e))}},{key:"pauseLoading",value:function(){this.mainSegmentLoader_.pause(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.pause(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.pause()}},{key:"setCurrentTime",value:function(e){var t=Tp(this.tech_.buffered(),e);return this.masterPlaylistLoader_&&this.masterPlaylistLoader_.media()&&this.masterPlaylistLoader_.media().segments?t&&t.length?e:(this.mainSegmentLoader_.resetEverything(),this.mainSegmentLoader_.abort(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.resetEverything(),this.audioSegmentLoader_.abort()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.resetEverything(),this.subtitleSegmentLoader_.abort()),void this.load()):0}},{key:"duration",value:function(){return this.masterPlaylistLoader_?this.mediaSource?this.mediaSource.duration:Ug.Playlist.duration(this.masterPlaylistLoader_.media()):0}},{key:"seekable",value:function(){return this.seekable_}},{key:"onSyncInfoUpdate_",value:function(){var e=void 0,t=void 0;if(this.masterPlaylistLoader_){var r=this.masterPlaylistLoader_.media();if(r){var i=this.syncController_.getExpiredTime(r,this.mediaSource.duration);if(null!==i&&0!==(e=Ug.Playlist.seekable(r,i)).length){if(this.mediaTypes_.AUDIO.activePlaylistLoader){if(r=this.mediaTypes_.AUDIO.activePlaylistLoader.media(),null===(i=this.syncController_.getExpiredTime(r,this.mediaSource.duration)))return;if(0===(t=Ug.Playlist.seekable(r,i)).length)return}this.seekable_=t?t.start(0)>e.end(0)||e.start(0)>t.end(0)?e:Pf.createTimeRanges([[t.start(0)>e.start(0)?t.start(0):e.start(0),t.end(0)<e.end(0)?t.end(0):e.end(0)]]):e,this.logger_("seekable updated ["+Ep(this.seekable_)+"]"),this.tech_.trigger("seekablechanged")}}}}},{key:"updateDuration",value:function(){var t=this,e=this.mediaSource.duration,r=Ug.Playlist.duration(this.masterPlaylistLoader_.media()),i=this.tech_.buffered(),n=function e(){t.mediaSource.duration=r,t.tech_.trigger("durationchange"),t.mediaSource.removeEventListener("sourceopen",e)};0<i.length&&(r=Math.max(r,i.end(i.length-1))),e!==r&&("open"!==this.mediaSource.readyState?this.mediaSource.addEventListener("sourceopen",n):n())}},{key:"dispose",value:function(){var i=this;this.decrypter_.terminate(),this.masterPlaylistLoader_.dispose(),this.mainSegmentLoader_.dispose(),["AUDIO","SUBTITLES"].forEach(function(e){var t=i.mediaTypes_[e].groups;for(var r in t)t[r].forEach(function(e){e.playlistLoader&&e.playlistLoader.dispose()})}),this.audioSegmentLoader_.dispose(),this.subtitleSegmentLoader_.dispose()}},{key:"master",value:function(){return this.masterPlaylistLoader_.master}},{key:"media",value:function(){return this.masterPlaylistLoader_.media()||this.initialMedia_}},{key:"setupSourceBuffers_",value:function(){var e,t=this.masterPlaylistLoader_.media();if(t&&"open"===this.mediaSource.readyState){if((e=mg(this.masterPlaylistLoader_.master,t)).length<1)return this.error="No compatible SourceBuffer configuration for the variant stream:"+t.resolvedUri,this.mediaSource.endOfStream("decode");this.configureLoaderMimeTypes_(e),this.excludeIncompatibleVariants_(t)}}},{key:"configureLoaderMimeTypes_",value:function(e){var t=1<e.length&&-1==e[0].indexOf(",")&&e[0]!==e[1]?new Pf.EventTarget:null;this.mainSegmentLoader_.mimeType(e[0],t),e[1]&&this.audioSegmentLoader_.mimeType(e[1],t)}},{key:"excludeUnsupportedVariants_",value:function(){this.master().playlists.forEach(function(e){e.attributes.CODECS&&Ja.MediaSource&&Ja.MediaSource.isTypeSupported&&!Ja.MediaSource.isTypeSupported('video/mp4; codecs="'+e.attributes.CODECS.replace(/avc1\.(\d+)\.(\d+)/i,function(e){return Gp([e])[0]})+'"')&&(e.excludeUntil=1/0)})}},{key:"excludeIncompatibleVariants_",value:function(e){var r=2,i=null,t=void 0;e.attributes.CODECS&&(t=pg(e.attributes.CODECS),i=t.videoCodec,r=t.codecCount),this.master().playlists.forEach(function(e){var t={codecCount:2,videoCodec:null};e.attributes.CODECS&&(t=pg(e.attributes.CODECS)),t.codecCount!==r&&(e.excludeUntil=1/0),t.videoCodec!==i&&(e.excludeUntil=1/0)})}},{key:"updateAdCues_",value:function(e){var t=0,r=this.seekable();r.length&&(t=r.start(0)),function(e,t){if(e.segments)for(var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,i=void 0,n=0;n<e.segments.length;n++){var a=e.segments[n];if(i||(i=Cg(t,r+a.duration/2)),i){if("cueIn"in a){i.endTime=r,i.adEndTime=r,r+=a.duration,i=null;continue}if(r<i.endTime){r+=a.duration;continue}i.endTime+=a.duration}else if("cueOut"in a&&((i=new Ja.VTTCue(r,r+a.duration,a.cueOut)).adStartTime=r,i.adEndTime=r+parseFloat(a.cueOut),t.addCue(i)),"cueOutCont"in a){var o,s,l=a.cueOutCont.split("/").map(parseFloat),u=jf(l,2);o=u[0],s=u[1],(i=new Ja.VTTCue(r,r+a.duration,"")).adStartTime=r-o,i.adEndTime=i.adStartTime+s,t.addCue(i)}r+=a.duration}}(e,this.cueTagsTrack_,t)}},{key:"goalBufferLength",value:function(){var e=this.tech_.currentTime(),t=ig.GOAL_BUFFER_LENGTH;return Math.min(t+e*ig.GOAL_BUFFER_LENGTH_RATE,Math.max(t,ig.MAX_GOAL_BUFFER_LENGTH))}},{key:"bufferLowWaterLine",value:function(){var e=this.tech_.currentTime(),t=ig.BUFFER_LOW_WATER_LINE;return Math.min(t+e*ig.BUFFER_LOW_WATER_LINE_RATE,Math.max(t,ig.MAX_BUFFER_LOW_WATER_LINE))}}]),f}(),qg=function e(t,r,i){Df(this,e);var n,a,o,s=t.masterPlaylistController_.fastQualityChange_.bind(t.masterPlaylistController_);if(r.attributes.RESOLUTION){var l=r.attributes.RESOLUTION;this.width=l.width,this.height=l.height}this.bandwidth=r.attributes.BANDWIDTH,this.id=i,this.enabled=(n=t.playlists,a=r.uri,o=s,function(e){var t=n.master.playlists[a],r=ap(t),i=op(t);return void 0===e?i:(e?delete t.disabled:t.disabled=!0,e===i||r||(o(),n.trigger(e?"renditionenabled":"renditiondisabled")),e)})},Vg=["seeking","seeked","pause","playing","error"],Wg=function(){function o(e){var t=this;Df(this,o),this.tech_=e.tech,this.seekable=e.seekable,this.consecutiveUpdates=0,this.lastRecordedTime=null,this.timer_=null,this.checkCurrentTimeTimeout_=null,this.logger_=eg("PlaybackWatcher"),this.logger_("initialize");var r=function(){return t.monitorCurrentTime_()},i=function(){return t.techWaiting_()},n=function(){return t.cancelTimer_()},a=function(){return t.fixesBadSeeks_()};this.tech_.on("seekablechanged",a),this.tech_.on("waiting",i),this.tech_.on(Vg,n),this.tech_.on("canplay",r),this.dispose=function(){t.logger_("dispose"),t.tech_.off("seekablechanged",a),t.tech_.off("waiting",i),t.tech_.off(Vg,n),t.tech_.off("canplay",r),t.checkCurrentTimeTimeout_&&Ja.clearTimeout(t.checkCurrentTimeTimeout_),t.cancelTimer_()}}return Mf(o,[{key:"monitorCurrentTime_",value:function(){this.checkCurrentTime_(),this.checkCurrentTimeTimeout_&&Ja.clearTimeout(this.checkCurrentTimeTimeout_),this.checkCurrentTimeTimeout_=Ja.setTimeout(this.monitorCurrentTime_.bind(this),250)}},{key:"checkCurrentTime_",value:function(){if(this.tech_.seeking()&&this.fixesBadSeeks_())return this.consecutiveUpdates=0,void(this.lastRecordedTime=this.tech_.currentTime());if(!this.tech_.paused()&&!this.tech_.seeking()){var e=this.tech_.currentTime(),t=this.tech_.buffered();if(this.lastRecordedTime===e&&(!t.length||e+.1>=t.end(t.length-1)))return this.techWaiting_();5<=this.consecutiveUpdates&&e===this.lastRecordedTime?(this.consecutiveUpdates++,this.waiting_()):e===this.lastRecordedTime?this.consecutiveUpdates++:(this.consecutiveUpdates=0,this.lastRecordedTime=e)}}},{key:"cancelTimer_",value:function(){this.consecutiveUpdates=0,this.timer_&&(this.logger_("cancelTimer_"),clearTimeout(this.timer_)),this.timer_=null}},{key:"fixesBadSeeks_",value:function(){var e=this.tech_.seeking(),t=this.seekable(),r=this.tech_.currentTime(),i=void 0;e&&this.afterSeekableWindow_(t,r)&&(i=t.end(t.length-1));e&&this.beforeSeekableWindow_(t,r)&&(i=t.start(0)+.1);return void 0!==i&&(this.logger_("Trying to seek outside of seekable at time "+r+" with seekable range "+Ep(t)+". Seeking to "+i+"."),this.tech_.setCurrentTime(i),!0)}},{key:"waiting_",value:function(){if(!this.techWaiting_()){var e=this.tech_.currentTime(),t=this.tech_.buffered(),r=Tp(t,e);return r.length&&e+3<=r.end(0)?(this.cancelTimer_(),this.tech_.setCurrentTime(e),this.logger_("Stopped at "+e+" while inside a buffered region ["+r.start(0)+" -> "+r.end(0)+"]. Attempting to resume playback by seeking to the current time."),void this.tech_.trigger({type:"usage",name:"hls-unknown-waiting"})):void 0}}},{key:"techWaiting_",value:function(){var e=this.seekable(),t=this.tech_.currentTime();if(this.tech_.seeking()&&this.fixesBadSeeks_())return!0;if(this.tech_.seeking()||null!==this.timer_)return!0;if(this.beforeSeekableWindow_(e,t)){var r=e.end(e.length-1);return this.logger_("Fell out of live window at time "+t+". Seeking to live point (seekable end) "+r),this.cancelTimer_(),this.tech_.setCurrentTime(r),this.tech_.trigger({type:"usage",name:"hls-live-resync"}),!0}var i=this.tech_.buffered(),n=Sp(i,t);if(this.videoUnderflow_(n,i,t))return this.cancelTimer_(),this.tech_.setCurrentTime(t),this.tech_.trigger({type:"usage",name:"hls-video-underflow"}),!0;if(0<n.length){var a=n.start(0)-t;return this.logger_("Stopped at "+t+", setting timer for "+a+", seeking to "+n.start(0)),this.timer_=setTimeout(this.skipTheGap_.bind(this),1e3*a,t),!0}return!1}},{key:"afterSeekableWindow_",value:function(e,t){return!!e.length&&t>e.end(e.length-1)+.1}},{key:"beforeSeekableWindow_",value:function(e,t){return!!(e.length&&0<e.start(0)&&t<e.start(0)-.1)}},{key:"videoUnderflow_",value:function(e,t,r){if(0===e.length){var i=this.gapFromVideoUnderflow_(t,r);if(i)return this.logger_("Encountered a gap in video from "+i.start+" to "+i.end+". Seeking to current time "+r),!0}return!1}},{key:"skipTheGap_",value:function(e){var t=this.tech_.buffered(),r=this.tech_.currentTime(),i=Sp(t,r);this.cancelTimer_(),0!==i.length&&r===e&&(this.logger_("skipTheGap_:","currentTime:",r,"scheduled currentTime:",e,"nextRange start:",i.start(0)),this.tech_.setCurrentTime(i.start(0)+_p),this.tech_.trigger({type:"usage",name:"hls-gap-skip"}))}},{key:"gapFromVideoUnderflow_",value:function(e,t){for(var r=function(e){if(e.length<2)return Pf.createTimeRanges();for(var t=[],r=1;r<e.length;r++){var i=e.end(r-1),n=e.start(r);t.push([i,n])}return Pf.createTimeRanges(t)}(e),i=0;i<r.length;i++){var n=r.start(i),a=r.end(i);if(t-n<4&&2<t-n)return{start:n,end:a}}return null}}]),o}(),zg={errorInterval:30,getSource:function(e){return e(this.tech({IWillNotUseThisInPlugins:!0}).currentSource_)}},Kg=function(e){!function t(r,e){var i=0,n=0,a=Pf.mergeOptions(zg,e);r.ready(function(){r.trigger({type:"usage",name:"hls-error-reload-initialized"})});var o=function(){n&&r.currentTime(n)},s=function(e){null!=e&&(n=r.duration()!==1/0&&r.currentTime()||0,r.one("loadedmetadata",o),r.src(e),r.trigger({type:"usage",name:"hls-error-reload"}),r.play())},l=function(){if(Date.now()-i<1e3*a.errorInterval)r.trigger({type:"usage",name:"hls-error-reload-canceled"});else{if(a.getSource&&"function"==typeof a.getSource)return i=Date.now(),a.getSource.call(r,s);Pf.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!")}},u=function e(){r.off("loadedmetadata",o),r.off("error",l),r.off("dispose",e)};r.on("error",l),r.on("dispose",u),r.reloadSourceOnError=function(e){u(),t(r,e)}}(this,e)},Yg={PlaylistLoader:Kf,Playlist:up,Decrypter:kl,AsyncStream:Tl,decrypt:El,utils:yp,STANDARD_PLAYLIST_SELECTOR:function(){return function(e,t,r,i){var n=e.playlists.map(function(e){return{bandwidth:e.attributes.BANDWIDTH||Ja.Number.MAX_VALUE,width:e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width,height:e.attributes.RESOLUTION&&e.attributes.RESOLUTION.height,playlist:e}});yg(n,function(e,t){return e.bandwidth-t.bandwidth});var a=(n=n.filter(function(e){return!up.isIncompatible(e.playlist)})).filter(function(e){return up.isEnabled(e.playlist)});a.length||(a=n.filter(function(e){return!up.isDisabled(e.playlist)}));var o=a.filter(function(e){return e.bandwidth*ig.BANDWIDTH_VARIANCE<t}),s=o[o.length-1],l=o.filter(function(e){return e.bandwidth===s.bandwidth})[0],u=o.filter(function(e){return e.width&&e.height});yg(u,function(e,t){return e.width-t.width});var c=u.filter(function(e){return e.width===r&&e.height===i});s=c[c.length-1];var d=c.filter(function(e){return e.bandwidth===s.bandwidth})[0],h=void 0,f=void 0,p=void 0;d||(f=(h=u.filter(function(e){return r<e.width||i<e.height})).filter(function(e){return e.width===h[0].width&&e.height===h[0].height}),s=f[f.length-1],p=f.filter(function(e){return e.bandwidth===s.bandwidth})[0]);var g=p||d||l||a[0]||n[0];return g?g.playlist:null}(this.playlists.master,this.systemBandwidth,parseInt(vg(this.tech_.el(),"width"),10),parseInt(vg(this.tech_.el(),"height"),10))},INITIAL_PLAYLIST_SELECTOR:function(){var e=this.playlists.master.playlists.filter(up.isEnabled);return yg(e,function(e,t){return _g(e,t)}),e.filter(function(e){return pg(e.attributes.CODECS).videoCodec})[0]||null},comparePlaylistBandwidth:_g,comparePlaylistResolution:function(e,t){var r=void 0,i=void 0;return e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width&&(r=e.attributes.RESOLUTION.width),t.attributes.RESOLUTION&&t.attributes.RESOLUTION.width&&(i=t.attributes.RESOLUTION.width),(r=r||Ja.Number.MAX_VALUE)===(i=i||Ja.Number.MAX_VALUE)&&e.attributes.BANDWIDTH&&t.attributes.BANDWIDTH?e.attributes.BANDWIDTH-t.attributes.BANDWIDTH:r-i},xhr:hp()};["GOAL_BUFFER_LENGTH","MAX_GOAL_BUFFER_LENGTH","GOAL_BUFFER_LENGTH_RATE","BUFFER_LOW_WATER_LINE","MAX_BUFFER_LOW_WATER_LINE","BUFFER_LOW_WATER_LINE_RATE","BANDWIDTH_VARIANCE"].forEach(function(t){Object.defineProperty(Yg,t,{get:function(){return Pf.log.warn("using Hls."+t+" is UNSAFE be sure you know what you are doing"),ig[t]},set:function(e){Pf.log.warn("using Hls."+t+" is UNSAFE be sure you know what you are doing"),"number"!=typeof e||e<0?Pf.log.warn("value of Hls."+t+" must be greater than or equal to 0"):ig[t]=e}})});var Xg=function(e){if(/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i.test(e))return"hls";return/^application\/dash\+xml/i.test(e)?"dash":null},Qg=function(e,t){for(var r=t.media(),i=-1,n=0;n<e.length;n++)if(e[n].id===r.uri){i=n;break}e.selectedIndex_=i,e.trigger({selectedIndex:i,type:"change"})};Yg.canPlaySource=function(){return Pf.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var Jg=function(e){if("dash"===e.options_.sourceType){var t=Pf.players[e.tech_.options_.playerId];if(t.eme){var r=function(e,t,r){if(!e)return e;var i={};for(var n in e)i[n]={audioContentType:'audio/mp4; codecs="'+r.attributes.CODECS+'"',videoContentType:'video/mp4; codecs="'+t.attributes.CODECS+'"'},t.contentProtection&&t.contentProtection[n]&&t.contentProtection[n].pssh&&(i[n].pssh=t.contentProtection[n].pssh),"string"==typeof e[n]&&(i[n].url=e[n]);return Pf.mergeOptions(e,i)}(e.source_.keySystems,e.playlists.media(),e.masterPlaylistController_.mediaTypes_.AUDIO.activePlaylistLoader.media());r&&(t.currentSource().keySystems=r)}}};Yg.supportsNativeHls=function(){var t=to.createElement("video");if(!Pf.getTech("Html5").isSupported())return!1;return["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"].some(function(e){return/maybe|probably/i.test(t.canPlayType(e))})}(),Yg.supportsNativeDash=!!Pf.getTech("Html5").isSupported()&&/maybe|probably/i.test(to.createElement("video").canPlayType("application/dash+xml")),Yg.supportsTypeNatively=function(e){return"hls"===e?Yg.supportsNativeHls:"dash"===e&&Yg.supportsNativeDash},Yg.isSupported=function(){return Pf.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var Zg=Pf.getComponent("Component"),$g=function(e){function a(e,t,r){Df(this,a);var i=Ff(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,t,r.hls));if(t.options_&&t.options_.playerId){var n=Pf(t.options_.playerId);n.hasOwnProperty("hls")||Object.defineProperty(n,"hls",{get:function(){return Pf.log.warn("player.hls is deprecated. Use player.tech_.hls instead."),t.trigger({type:"usage",name:"hls-player-access"}),i}}),n.vhs=i,n.dash=i}if(i.tech_=t,i.source_=e,i.stats={},i.ignoreNextSeekingEvent_=!1,i.setOptions_(),i.options_.overrideNative&&t.overrideNativeAudioTracks&&t.overrideNativeVideoTracks)t.overrideNativeAudioTracks(!0),t.overrideNativeVideoTracks(!0);else if(i.options_.overrideNative&&(t.featuresNativeVideoTracks||t.featuresNativeAudioTracks))throw Error("Overriding native HLS requires emulated tracks. See https://git.io/vMpjB");return i.on(to,["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],function(e){var t=to.fullscreenElement||to.webkitFullscreenElement||to.mozFullScreenElement||to.msFullscreenElement;t&&t.contains(i.tech_.el())&&i.masterPlaylistController_.fastQualityChange_()}),i.on(i.tech_,"seeking",function(){this.ignoreNextSeekingEvent_?this.ignoreNextSeekingEvent_=!1:this.setCurrentTime(this.tech_.currentTime())}),i.on(i.tech_,"error",function(){this.masterPlaylistController_&&this.masterPlaylistController_.pauseLoading()}),i.on(i.tech_,"play",i.play),i}return Nf(a,Zg),Mf(a,[{key:"setOptions_",value:function(){var t=this;this.options_.withCredentials=this.options_.withCredentials||!1,"number"!=typeof this.options_.blacklistDuration&&(this.options_.blacklistDuration=300),"number"!=typeof this.options_.bandwidth&&(this.options_.bandwidth=4194304),this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&4194304===this.options_.bandwidth,["withCredentials","bandwidth"].forEach(function(e){void 0!==t.source_[e]&&(t.options_[e]=t.source_[e])}),this.bandwidth=this.options_.bandwidth}},{key:"src",value:function(e,t){var i=this;e&&(this.setOptions_(),this.options_.url=this.source_.src,this.options_.tech=this.tech_,this.options_.externHls=Yg,this.options_.sourceType=Xg(t),this.masterPlaylistController_=new Gg(this.options_),this.playbackWatcher_=new Wg(Pf.mergeOptions(this.options_,{seekable:function(){return i.seekable()}})),this.masterPlaylistController_.on("error",function(){Pf.players[i.tech_.options_.playerId].error(i.masterPlaylistController_.error)}),this.masterPlaylistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):Yg.STANDARD_PLAYLIST_SELECTOR.bind(this),this.masterPlaylistController_.selectInitialPlaylist=Yg.INITIAL_PLAYLIST_SELECTOR.bind(this),this.playlists=this.masterPlaylistController_.masterPlaylistLoader_,this.mediaSource=this.masterPlaylistController_.mediaSource,Object.defineProperties(this,{selectPlaylist:{get:function(){return this.masterPlaylistController_.selectPlaylist},set:function(e){this.masterPlaylistController_.selectPlaylist=e.bind(this)}},throughput:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.throughput.rate},set:function(e){this.masterPlaylistController_.mainSegmentLoader_.throughput.rate=e,this.masterPlaylistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.bandwidth},set:function(e){this.masterPlaylistController_.mainSegmentLoader_.bandwidth=e,this.masterPlaylistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get:function(){return Math.floor(1/(1/(this.bandwidth||1)+(0<this.throughput?1/this.throughput:0)))},set:function(){Pf.log.error('The "systemBandwidth" property is read-only')}}}),Object.defineProperties(this.stats,{bandwidth:{get:function(){return i.bandwidth||0},enumerable:!0},mediaRequests:{get:function(){return i.masterPlaylistController_.mediaRequests_()||0},enumerable:!0},mediaRequestsAborted:{get:function(){return i.masterPlaylistController_.mediaRequestsAborted_()||0},enumerable:!0},mediaRequestsTimedout:{get:function(){return i.masterPlaylistController_.mediaRequestsTimedout_()||0},enumerable:!0},mediaRequestsErrored:{get:function(){return i.masterPlaylistController_.mediaRequestsErrored_()||0},enumerable:!0},mediaTransferDuration:{get:function(){return i.masterPlaylistController_.mediaTransferDuration_()||0},enumerable:!0},mediaBytesTransferred:{get:function(){return i.masterPlaylistController_.mediaBytesTransferred_()||0},enumerable:!0},mediaSecondsLoaded:{get:function(){return i.masterPlaylistController_.mediaSecondsLoaded_()||0},enumerable:!0},buffered:{get:function(){return kp(i.tech_.buffered())},enumerable:!0},currentTime:{get:function(){return i.tech_.currentTime()},enumerable:!0},currentSource:{get:function(){return i.tech_.currentSource_},enumerable:!0},currentTech:{get:function(){return i.tech_.name_},enumerable:!0},duration:{get:function(){return i.tech_.duration()},enumerable:!0},master:{get:function(){return i.playlists.master},enumerable:!0},playerDimensions:{get:function(){return i.tech_.currentDimensions()},enumerable:!0},seekable:{get:function(){return kp(i.tech_.seekable())},enumerable:!0},timestamp:{get:function(){return Date.now()},enumerable:!0},videoPlaybackQuality:{get:function(){return i.tech_.getVideoPlaybackQuality()},enumerable:!0}}),this.tech_.one("canplay",this.masterPlaylistController_.setupFirstPlay.bind(this.masterPlaylistController_)),this.masterPlaylistController_.on("selectedinitialmedia",function(){var r,e;e=(r=i).playlists,r.representations=function(){return e.master.playlists.filter(function(e){return!ap(e)}).map(function(e,t){return new qg(r,e,e.uri)})},Jg(i)}),this.on(this.masterPlaylistController_,"progress",function(){this.tech_.trigger("progress")}),this.on(this.masterPlaylistController_,"firstplay",function(){this.ignoreNextSeekingEvent_=!0}),this.tech_.ready(function(){return i.setupQualityLevels_()}),this.tech_.el()&&this.tech_.src(Pf.URL.createObjectURL(this.masterPlaylistController_.mediaSource)))}},{key:"setupQualityLevels_",value:function(){var r=this,e=Pf.players[this.tech_.options_.playerId];e&&e.qualityLevels&&(this.qualityLevels_=e.qualityLevels(),this.masterPlaylistController_.on("selectedinitialmedia",function(){var t,e;t=r.qualityLevels_,(e=r).representations().forEach(function(e){t.addQualityLevel(e)}),Qg(t,e.playlists)}),this.playlists.on("mediachange",function(){Qg(r.qualityLevels_,r.playlists)}))}},{key:"play",value:function(){this.masterPlaylistController_.play()}},{key:"setCurrentTime",value:function(e){this.masterPlaylistController_.setCurrentTime(e)}},{key:"duration",value:function(){return this.masterPlaylistController_.duration()}},{key:"seekable",value:function(){return this.masterPlaylistController_.seekable()}},{key:"dispose",value:function(){this.playbackWatcher_&&this.playbackWatcher_.dispose(),this.masterPlaylistController_&&this.masterPlaylistController_.dispose(),this.qualityLevels_&&this.qualityLevels_.dispose(),function e(t,r,i){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,r);if(void 0===n){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,r,i)}if("value"in n)return n.value;var o=n.get;return void 0!==o?o.call(i):void 0}(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"dispose",this).call(this)}}]),a}(),em={name:"videojs-http-streaming",VERSION:"1.1.0",canHandleSource:function(e){var t=Pf.mergeOptions(Pf.options,1<arguments.length&&void 0!==arguments[1]?arguments[1]:{});return em.canPlayType(e.type,t)},handleSource:function(e,t){var r=Pf.mergeOptions(Pf.options,2<arguments.length&&void 0!==arguments[2]?arguments[2]:{});return t.hls=new $g(e,t,r),t.hls.xhr=hp(),t.hls.src(e.src,e.type),t.hls},canPlayType:function(e){var t=Pf.mergeOptions(Pf.options,1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).hls.overrideNative,r=Xg(e);return r&&(!Yg.supportsTypeNatively(r)||t)?"maybe":""}};void 0!==Pf.MediaSource&&void 0!==Pf.URL||(Pf.MediaSource=Yp,Pf.URL=Xp),Yp.supportsNativeMediaSources()&&Pf.getTech("Html5").registerSourceHandler(em,0),Pf.HlsHandler=$g,Pf.HlsSourceHandler=em,Pf.Hls=Yg,Pf.use||Pf.registerComponent("Hls",Yg),Pf.options.hls=Pf.options.hls||{},Pf.registerPlugin?Pf.registerPlugin("reloadSourceOnError",Kg):Pf.plugin("reloadSourceOnError",Kg),window.Promise=Ri;var tm=["pause","duration","currentTime","bufferedEnd","remainingTimeDisplay","paused","playbackRate","muted","scrubbing","play","volume","dispose"],rm=function(){function t(e){_r(this,t),this.sequence=0,this.isFullScreen=!1,this.hasPlaying=!1,this.dbClickTimer=null,this.options={preload:"metadata",controls:!1,autoplay:!0,bigPlayButton:!1,autoHeight:!0,techOrder:["html5"],aspectRatio:"4:3",textTrackDisplay:!1},Rr(!0,this,e),this.events=new rn,this.playerId="_sunlplayer"+t.id,t.id+=1,this._init()}return Cr(t,[{key:"start",value:function(){if(!this._player){Rr(!0,this.options,{sources:[],flash:{},Promise:window.Promise,html5:{nativeAudioTracks:!1}}),this._player=Pf(this.playerId,this.options);var e=this.options.Promise;if(e){var t=this._player;t.play=function(){return new e(function(e){if(t.playOnLoadstart_&&t.on("loadstart",t.playOnLoadstart_),t.isReady_)t.changingSrc_||!t.src()&&!t.currentSrc()?(t.playOnLoadstart_=function(){t.playOnLoadstart_=null,e(t.play())},t.one("loadstart",t.playOnLoadstart_)):e(t.techGet_("play"));else{if(t.playWaitingForReady_)return;t.playWaitingForReady_=!0,t.ready(function(){t.playWaitingForReady_=!1,e(t.play())})}})}}}}},{key:"setSrc",value:function(e){var t=this,r=this._player,i=this.options.Promise;r.src({src:e});var n=r.play();i&&n.then(function(){t.trigger("autoplay_success,status_change","playing")}).catch(function(e){t.trigger("autoplay_fail",e)})}},{key:"_init",value:function(){this._initDom(),this.start(),this._initEvents()}},{key:"_initDom",value:function(){var e="height:100%;width:100%;object-fit:fill;background:#000;";this.options.controls||(e+="padding-top:0;");var t=document.createElement("video");t.id=this.playerId,t.style.cssText=e,t.className="video-js vjs-default-skin";var r=document.createElement("p");r.textContent="您的播放器暂不支持播放此视频",t.appendChild(r);var i=Bi(this.el)?this.el:document.querySelector("#"+this.el);this.video=i.appendChild(t)}},{key:"on",value:function(e,t){this.events.on(e,t)}},{key:"trigger",value:function(e){for(var t,r=arguments.length,i=Array(1<r?r-1:0),n=1;n<r;n++)i[n-1]=arguments[n];(t=this.events).trigger.apply(t,[e].concat(i))}},{key:"_initEvents",value:function(){var a=this;tm.forEach(function(t){a[t]=function(){var e;return(e=a._player)[t].apply(e,arguments)}});var o=["time_update","seeked","volume_change","rate_change"];this.on("_time_update",function(){var e=a.currentTime();a.trigger("metadata_update",{currentTime:e})}),this.on("_rate_change",function(){a.trigger("rate_change",a.playbackRate())}),this.on("_volume_change",function(){a.trigger("volume_change",a.volume())}),this.events.videoEvents.forEach(function(n){var e=n.replace(/_/g,"");a._player.on(e,function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=-1<o.indexOf(n)?"_"+n:n;a.trigger.apply(a,[i].concat(t))})}),this.options.controls||Vi(this.video,{click:function(){a._player.paused()?a._player.play():a._player.pause()},dblclick:function(){a.isFullScreen?a._player.exitFullscreen():a._player.requestFullscreen(),a.isFullScreen=!a.isFullScreen}})}},{key:"getPlayer",value:function(){return this._player}},{key:"getPlayerId",value:function(){return this.playerId}},{key:"dispose",value:function(){this._player.dispose(),this.events.removeAllListeners()}}],[{key:"supportHls",value:function(){return Pf.getTech("Html5").isSupported()}}]),t}();rm.id=100;var im=e(t(function(e,t){"undefined"!=typeof window&&(e.exports=function(){return function(r){var i={};function n(e){if(i[e])return i[e].exports;var t=i[e]={i:e,l:!1,exports:{}};return r[e].call(t.exports,t,t.exports,n),t.l=!0,t.exports}return n.m=r,n.c=i,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/dist/",n(n.s="./src/hls.js")}({"./node_modules/eventemitter3/index.js":function(e,t,r){var i=Object.prototype.hasOwnProperty,f="~";function n(){}function s(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function a(e,t,r,i,n){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new s(r,i||e,n),o=f?f+t:t;return e._events[o]?e._events[o].fn?e._events[o]=[e._events[o],a]:e._events[o].push(a):(e._events[o]=a,e._eventsCount++),e}function u(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function o(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(f=!1)),o.prototype.eventNames=function(){var e,t,r=[];if(0===this._eventsCount)return r;for(t in e=this._events)i.call(e,t)&&r.push(f?t.slice(1):t);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},o.prototype.listeners=function(e){var t=this._events[f?f+e:e];if(!t)return[];if(t.fn)return[t.fn];for(var r=0,i=t.length,n=Array(i);r<i;r++)n[r]=t[r].fn;return n},o.prototype.listenerCount=function(e){var t=this._events[f?f+e:e];return t?t.fn?1:t.length:0},o.prototype.emit=function(e,t,r,i,n,a){var o=f?f+e:e;if(!this._events[o])return!1;var s,l,u=this._events[o],c=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),c){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,r),!0;case 4:return u.fn.call(u.context,t,r,i),!0;case 5:return u.fn.call(u.context,t,r,i,n),!0;case 6:return u.fn.call(u.context,t,r,i,n,a),!0}for(s=Array(c-(l=1));l<c;l++)s[l-1]=arguments[l];u.fn.apply(u.context,s)}else{var d,h=u.length;for(l=0;l<h;l++)switch(u[l].once&&this.removeListener(e,u[l].fn,void 0,!0),c){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,t);break;case 3:u[l].fn.call(u[l].context,t,r);break;case 4:u[l].fn.call(u[l].context,t,r,i);break;default:if(!s)for(s=Array(c-(d=1));d<c;d++)s[d-1]=arguments[d];u[l].fn.apply(u[l].context,s)}}return!0},o.prototype.on=function(e,t,r){return a(this,e,t,r,!1)},o.prototype.once=function(e,t,r){return a(this,e,t,r,!0)},o.prototype.removeListener=function(e,t,r,i){var n=f?f+e:e;if(!this._events[n])return this;if(!t)return u(this,n),this;var a=this._events[n];if(a.fn)a.fn!==t||i&&!a.once||r&&a.context!==r||u(this,n);else{for(var o=0,s=[],l=a.length;o<l;o++)(a[o].fn!==t||i&&!a[o].once||r&&a[o].context!==r)&&s.push(a[o]);s.length?this._events[n]=1===s.length?s[0]:s:u(this,n)}return this},o.prototype.removeAllListeners=function(e){var t;return e?this._events[t=f?f+e:e]&&u(this,t):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=f,e.exports=o.EventEmitter=o},"./node_modules/node-libs-browser/node_modules/events/events.js":function(e,t){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function l(e){return"function"==typeof e}function u(e){return"object"==typeof e&&null!==e}function c(e){return void 0===e}((e.exports=i).EventEmitter=i).prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},i.prototype.emit=function(e){var t,r,i,n,a,o;if(this._events||(this._events={}),"error"===e&&(!this._events.error||u(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var s=Error('Uncaught, unspecified "error" event. ('+t+")");throw s.context=t,s}if(c(r=this._events[e]))return!1;if(l(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:n=Array.prototype.slice.call(arguments,1),r.apply(this,n)}else if(u(r))for(n=Array.prototype.slice.call(arguments,1),i=(o=r.slice()).length,a=0;a<i;a++)o[a].apply(this,n);return!0},i.prototype.on=i.prototype.addListener=function(e,t){var r;if(!l(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,l(t.listener)?t.listener:t),this._events[e]?u(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,u(this._events[e])&&!this._events[e].warned&&(r=c(this._maxListeners)?i.defaultMaxListeners:this._maxListeners)&&0<r&&r<this._events[e].length&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},i.prototype.once=function(e,t){if(!l(t))throw TypeError("listener must be a function");var r=!1;function i(){this.removeListener(e,i),r||(r=!0,t.apply(this,arguments))}return i.listener=t,this.on(e,i),this},i.prototype.removeListener=function(e,t){var r,i,n,a;if(!l(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=(r=this._events[e]).length,i=-1,r===t||l(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(u(r)){for(a=n;0<a--;)if(r[a]===t||r[a].listener&&r[a].listener===t){i=a;break}if(i<0)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},i.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(l(r=this._events[e]))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},i.prototype.listeners=function(e){return this._events&&this._events[e]?l(this._events[e])?[this._events[e]]:this._events[e].slice():[]},i.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(l(t))return 1;if(t)return t.length}return 0},i.listenerCount=function(e,t){return e.listenerCount(t)}},"./node_modules/url-toolkit/src/url-toolkit.js":function(e,t,r){var i,c,n,a,d;i=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,c=/^([^\/?#]*)(.*)$/,n=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,e.exports=d={buildAbsoluteURL:function(e,t,r){if(r=r||{},e=e.trim(),!(t=t.trim())){if(!r.alwaysNormalize)return e;var i=d.parseURL(e);if(!i)throw Error("Error trying to parse base URL.");return i.path=d.normalizePath(i.path),d.buildURLFromParts(i)}var n=d.parseURL(t);if(!n)throw Error("Error trying to parse relative URL.");if(n.scheme)return r.alwaysNormalize?(n.path=d.normalizePath(n.path),d.buildURLFromParts(n)):t;var a=d.parseURL(e);if(!a)throw Error("Error trying to parse base URL.");if(!a.netLoc&&a.path&&"/"!==a.path[0]){var o=c.exec(a.path);a.netLoc=o[1],a.path=o[2]}a.netLoc&&!a.path&&(a.path="/");var s={scheme:a.scheme,netLoc:n.netLoc,path:null,params:n.params,query:n.query,fragment:n.fragment};if(!n.netLoc&&(s.netLoc=a.netLoc,"/"!==n.path[0]))if(n.path){var l=a.path,u=l.substring(0,1+l.lastIndexOf("/"))+n.path;s.path=d.normalizePath(u)}else s.path=a.path,n.params||(s.params=a.params,n.query||(s.query=a.query));return null===s.path&&(s.path=r.alwaysNormalize?d.normalizePath(n.path):n.path),d.buildURLFromParts(s)},parseURL:function(e){var t=i.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(n,"");e.length!==(e=e.replace(a,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}}},"./node_modules/webworkify-webpack/index.js":function(e,t,h){function l(r){var i={};function n(e){if(i[e])return i[e].exports;var t=i[e]={i:e,l:!1,exports:{}};return r[e].call(t.exports,t,t.exports,n),t.l=!0,t.exports}n.m=r,n.c=i,n.i=function(e){return e},n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n.oe=function(e){throw console.error(e),e};var e=n(n.s=ENTRY_MODULE);return e.default||e}var f="[\\.|\\-|\\+|\\w|/|@]+",p="\\((/\\*.*?\\*/)?s?.*?("+f+").*?\\)";function g(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function m(e,t,r){var i={};i[r]=[];var n=""+t,a=n.match(/^function\s?\(\w+,\s*\w+,\s*(\w+)\)/);if(!a)return i;for(var o,s=a[1],l=RegExp("(\\\\n|\\W)"+g(s)+p,"g");o=l.exec(n);)"dll-reference"!==o[3]&&i[r].push(o[3]);for(l=RegExp("\\("+g(s)+'\\("(dll-reference\\s('+f+'))"\\)\\)'+p,"g");o=l.exec(n);)e[o[2]]||(i[r].push(o[1]),e[o[2]]=h(o[1]).m),i[o[2]]=i[o[2]]||[],i[o[2]].push(o[4]);for(var u=Object.keys(i),c=0;c<u.length;c++)for(var d=0;d<i[u[c]].length;d++)isNaN(1*i[u[c]][d])||(i[u[c]][d]=1*i[u[c]][d]);return i}function v(r){return Object.keys(r).reduce(function(e,t){return e||0<r[t].length},!1)}e.exports=function(e,t){var r={main:h.m},i=(t=t||{}).all?{main:Object.keys(r.main)}:function(e,t){for(var r={main:[t]},i={main:[]},n={main:{}};v(r);)for(var a=Object.keys(r),o=0;o<a.length;o++){var s=a[o],l=r[s].pop();if(n[s]=n[s]||{},!n[s][l]&&e[s][l]){n[s][l]=!0,i[s]=i[s]||[],i[s].push(l);for(var u=m(e,e[s][l],s),c=Object.keys(u),d=0;d<c.length;d++)r[c[d]]=r[c[d]]||[],r[c[d]]=r[c[d]].concat(u[c[d]])}}return i}(r,e),n="";Object.keys(i).filter(function(e){return"main"!==e}).forEach(function(t){for(var e=0;i[t][e];)e++;i[t].push(e),r[t][e]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",n=n+"var "+t+" = ("+(""+l).replace("ENTRY_MODULE",JSON.stringify(e))+")({"+i[t].map(function(e){return JSON.stringify(e)+": "+r[t][e]}).join(",")+"});\n"}),n=n+"new (("+(""+l).replace("ENTRY_MODULE",JSON.stringify(e))+")({"+i.main.map(function(e){return JSON.stringify(e)+": "+r.main[e]}).join(",")+"}))(self);";var a=new window.Blob([n],{type:"text/javascript"});if(t.bare)return a;var o=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(a),s=new window.Worker(o);return s.objectURL=o,s}},"./src/config.js":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var i=r("./src/controller/abr-controller.js"),n=r("./src/controller/buffer-controller.js"),a=r("./src/controller/cap-level-controller.js"),o=r("./src/controller/fps-controller.js"),s=r("./src/utils/xhr-loader.js"),l=r("./src/controller/audio-track-controller.js"),u=r("./src/controller/audio-stream-controller.js"),c=r("./src/utils/cues.js"),d=r("./src/controller/timeline-controller.js"),h=r("./src/controller/subtitle-track-controller.js"),f=r("./src/controller/subtitle-stream-controller.js"),p=r("./src/controller/eme-controller.js"),g=r("./src/utils/mediakeys-helper.js");t.hlsDefaultConfig={autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,liveDurationInfinity:!1,liveBackBufferLength:1/0,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:s.default,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,abrController:i.default,bufferController:n.default,capLevelController:a.default,fpsController:o.default,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,requestMediaKeySystemAccessFunc:g.requestMediaKeySystemAccess},t.hlsDefaultConfig.subtitleStreamController=f.SubtitleStreamController,t.hlsDefaultConfig.subtitleTrackController=h.default,t.hlsDefaultConfig.timelineController=d.default,t.hlsDefaultConfig.cueHandler=c,t.hlsDefaultConfig.enableCEA708Captions=!0,t.hlsDefaultConfig.enableWebVTT=!0,t.hlsDefaultConfig.captionsTextTrack1Label="English",t.hlsDefaultConfig.captionsTextTrack1LanguageCode="en",t.hlsDefaultConfig.captionsTextTrack2Label="Spanish",t.hlsDefaultConfig.captionsTextTrack2LanguageCode="es",t.hlsDefaultConfig.audioStreamController=u.default,t.hlsDefaultConfig.audioTrackController=l.default,t.hlsDefaultConfig.emeController=p.default},"./src/controller/abr-controller.js":function(e,r,l){(function(o){var i,t=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var m=l("./src/events.js"),n=l("./src/event-handler.js"),v=l("./src/utils/buffer-helper.js"),a=l("./src/errors.js"),y=l("./src/utils/logger.js"),s=l("./src/utils/ewma-bandwidth-estimator.js"),_=window.performance,e=function(r){function e(e){var t=r.call(this,e,m.default.FRAG_LOADING,m.default.FRAG_LOADED,m.default.FRAG_BUFFERED,m.default.ERROR)||this;return t.lastLoadedFragLevel=0,t._nextAutoLevel=-1,t.hls=e,t.timer=null,t._bwEstimator=null,t.onCheck=t._abandonRulesCheck.bind(t),t}return t(e,r),e.prototype.destroy=function(){this.clearTimer(),n.default.prototype.destroy.call(this)},e.prototype.onFragLoading=function(e){var t=e.frag;if("main"===t.type&&(this.timer||(this.fragCurrent=t,this.timer=setInterval(this.onCheck,100)),!this._bwEstimator)){var r=this.hls,i=r.config,n=void 0,a=void 0;a=r.levels[t.level].details.live?(n=i.abrEwmaFastLive,i.abrEwmaSlowLive):(n=i.abrEwmaFastVoD,i.abrEwmaSlowVoD),this._bwEstimator=new s.default(r,a,n,i.abrEwmaDefaultEstimate)}},e.prototype._abandonRulesCheck=function(){var e=this.hls,t=e.media,r=this.fragCurrent;if(r){var i=r.loader,n=e.minAutoLevel;if(!i||i.stats&&i.stats.aborted)return y.logger.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),void(this._nextAutoLevel=-1);var a=i.stats;if(t&&a&&(!t.paused&&0!==t.playbackRate||!t.readyState)&&r.autoLevel&&r.level){var o=_.now()-a.trequest,s=Math.abs(t.playbackRate);if(500*r.duration/s<o){var l=e.levels,u=Math.max(1,a.bw?a.bw/8:1e3*a.loaded/o),c=l[r.level],d=t.currentTime,h=((a.total?a.total:Math.max(a.loaded,Math.round(r.duration*(c.realBitrate?Math.max(c.realBitrate,c.bitrate):c.bitrate)/8)))-a.loaded)/u,f=(v.BufferHelper.bufferInfo(t,d,e.config.maxBufferHole).end-d)/s;if(f<2*r.duration/s&&f<h){var p=void 0,g=void 0;for(g=r.level-1;n<g;g--){if((p=r.duration*(l[g].realBitrate?Math.max(l[g].realBitrate,l[g].bitrate):l[g].bitrate)/(6.4*u))<f)break}p<h&&(y.logger.warn("loading too slow, abort fragment loading and switch to level "+g+":fragLoadedDelay["+g+"]<fragLoadedDelay["+(r.level-1)+"];bufferStarvationDelay:"+p.toFixed(1)+"<"+h.toFixed(1)+":"+f.toFixed(1)),e.nextLoadLevel=g,this._bwEstimator.sample(o,a.loaded),i.abort(),this.clearTimer(),e.trigger(m.default.FRAG_LOAD_EMERGENCY_ABORTED,{frag:r,stats:a}))}}}}},e.prototype.onFragLoaded=function(e){var t=e.frag;if("main"===t.type&&o.isFinite(t.sn)){if(this.clearTimer(),this.lastLoadedFragLevel=t.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var r=this.hls.levels[t.level],i=(r.loaded?r.loaded.bytes:0)+e.stats.loaded,n=(r.loaded?r.loaded.duration:0)+e.frag.duration;r.loaded={bytes:i,duration:n},r.realBitrate=Math.round(8*i/n)}if(e.frag.bitrateTest){var a=e.stats;a.tparsed=a.tbuffered=a.tload,this.onFragBuffered(e)}}},e.prototype.onFragBuffered=function(e){var t=e.stats,r=e.frag;if(!0!==t.aborted&&"main"===r.type&&o.isFinite(r.sn)&&(!r.bitrateTest||t.tload===t.tbuffered)){var i=t.tparsed-t.trequest;y.logger.log("latency/loading/parsing/append/kbps:"+Math.round(t.tfirst-t.trequest)+"/"+Math.round(t.tload-t.tfirst)+"/"+Math.round(t.tparsed-t.tload)+"/"+Math.round(t.tbuffered-t.tparsed)+"/"+Math.round(8*t.loaded/(t.tbuffered-t.trequest))),this._bwEstimator.sample(i,t.loaded),t.bwEstimate=this._bwEstimator.getEstimate(),this.bitrateTestDelay=r.bitrateTest?i/1e3:0}},e.prototype.onError=function(e){switch(e.details){case a.ErrorDetails.FRAG_LOAD_ERROR:case a.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer()}},e.prototype.clearTimer=function(){clearInterval(this.timer),this.timer=null},Object.defineProperty(e.prototype,"nextAutoLevel",{get:function(){var e=this._nextAutoLevel,t=this._bwEstimator;if(!(-1===e||t&&t.canEstimate()))return e;var r=this._nextABRAutoLevel;return-1!==e&&(r=Math.min(e,r)),r},set:function(e){this._nextAutoLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_nextABRAutoLevel",{get:function(){var e=this.hls,t=e.maxAutoLevel,r=e.levels,i=e.config,n=e.minAutoLevel,a=e.media,o=this.lastLoadedFragLevel,s=this.fragCurrent?this.fragCurrent.duration:0,l=a?a.currentTime:0,u=a&&0!==a.playbackRate?Math.abs(a.playbackRate):1,c=this._bwEstimator?this._bwEstimator.getEstimate():i.abrEwmaDefaultEstimate,d=(v.BufferHelper.bufferInfo(a,l,i.maxBufferHole).end-l)/u,h=this._findBestLevel(o,s,c,n,t,d,i.abrBandWidthFactor,i.abrBandWidthUpFactor,r);if(0<=h)return h;y.logger.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var f=s?Math.min(s,i.maxStarvationDelay):i.maxStarvationDelay,p=i.abrBandWidthFactor,g=i.abrBandWidthUpFactor;if(0===d){var m=this.bitrateTestDelay;if(m)f=(s?Math.min(s,i.maxLoadingDelay):i.maxLoadingDelay)-m,y.logger.trace("bitrate test took "+Math.round(1e3*m)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*f)+" ms"),p=g=1}return h=this._findBestLevel(o,s,c,n,t,d+f,p,g,r),Math.max(h,0)},enumerable:!0,configurable:!0}),e.prototype._findBestLevel=function(e,t,r,i,n,a,o,s,l){for(var u=n;i<=u;u--){var c=l[u];if(c){var d=c.details,h=d?d.totalduration/d.fragments.length:t,f=!!d&&d.live,p=void 0;p=u<=e?o*r:s*r;var g=l[u].realBitrate?Math.max(l[u].realBitrate,l[u].bitrate):l[u].bitrate,m=g*h/p;if(y.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+u+"/"+Math.round(p)+"/"+g+"/"+h+"/"+a+"/"+m),g<p&&(!m||f&&!this.bitrateTestDelay||m<a))return u}}return-1},e}(n.default);r.default=e}).call(this,l("./src/polyfills/number.js").Number)},"./src/controller/audio-stream-controller.js":function(e,r,a){(function(I){var i,t=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var P=a("./src/utils/binary-search.js"),x=a("./src/utils/buffer-helper.js"),f=a("./src/demux/demuxer.js"),R=a("./src/events.js"),d=a("./src/controller/level-helper.js"),n=a("./src/utils/time-ranges.js"),h=a("./src/errors.js"),O=a("./src/utils/logger.js"),D=a("./src/utils/discontinuities.js"),M=a("./src/controller/fragment-tracker.js"),p=a("./src/loader/fragment.js"),N=a("./src/controller/base-stream-controller.js"),F=window.performance,e=function(i){function e(e,t){var r=i.call(this,e,R.default.MEDIA_ATTACHED,R.default.MEDIA_DETACHING,R.default.AUDIO_TRACKS_UPDATED,R.default.AUDIO_TRACK_SWITCHING,R.default.AUDIO_TRACK_LOADED,R.default.KEY_LOADED,R.default.FRAG_LOADED,R.default.FRAG_PARSING_INIT_SEGMENT,R.default.FRAG_PARSING_DATA,R.default.FRAG_PARSED,R.default.ERROR,R.default.BUFFER_RESET,R.default.BUFFER_CREATED,R.default.BUFFER_APPENDED,R.default.BUFFER_FLUSHED,R.default.INIT_PTS_FOUND)||this;return r.fragmentTracker=t,r.config=e.config,r.audioCodecSwap=!1,r._state=N.State.STOPPED,r.initPTS=[],r.waitingFragment=null,r.videoTrackCC=null,r}return t(e,i),e.prototype.onInitPtsFound=function(e){var t=e.frag.cc,r=e.initPTS;"main"===e.id&&(this.initPTS[t]=r,O.logger.log("InitPTS for cc: "+(this.videoTrackCC=t)+" found from video track: "+r),this.state===N.State.WAITING_INIT_PTS&&this.tick())},e.prototype.startLoad=function(e){if(this.tracks){var t=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),this.fragLoadError=0,this.state=0<t&&-1===e?(O.logger.log("audio:override startPosition with lastCurrentTime @"+t.toFixed(3)),N.State.IDLE):(this.lastCurrentTime=this.startPosition?this.startPosition:e,N.State.STARTING),this.nextLoadPosition=this.startPosition=this.lastCurrentTime,this.tick()}else this.startPosition=e,this.state=N.State.STOPPED},Object.defineProperty(e.prototype,"state",{get:function(){return this._state},set:function(e){this.state!==e&&O.logger.log("audio stream:"+this.state+"->"+(this._state=e))},enumerable:!0,configurable:!0}),e.prototype.doTick=function(){var e,t,r,i=this.hls,n=i.config;switch(this.state){case N.State.ERROR:case N.State.PAUSED:case N.State.BUFFER_FLUSHING:break;case N.State.STARTING:this.state=N.State.WAITING_TRACK,this.loadedmetadata=!1;break;case N.State.IDLE:var a=this.tracks;if(!a)break;if(!this.media&&(this.startFragRequested||!n.startFragPrefetch))break;if(this.loadedmetadata)e=this.media.currentTime;else if(void 0===(e=this.nextLoadPosition))break;var o=this.mediaBuffer?this.mediaBuffer:this.media,s=this.videoBuffer?this.videoBuffer:this.media,l=x.BufferHelper.bufferInfo(o,e,n.maxBufferHole),u=x.BufferHelper.bufferInfo(s,e,n.maxBufferHole),c=l.end,d=this.fragPrevious,h=this.audioSwitch,f=this.trackId;if((l.len<Math.max(Math.min(n.maxBufferLength,n.maxMaxBufferLength),u.len)||h)&&f<a.length){if(void 0===(r=a[f].details)){this.state=N.State.WAITING_TRACK;break}if(!h&&this._streamEnded(l,r))return this.hls.trigger(R.default.BUFFER_EOS,{type:"audio"}),void(this.state=N.State.ENDED);var p=r.fragments,g=p.length,m=p[0].start,v=p[g-1].start+p[g-1].duration,y=void 0;if(h)if(r.live&&!r.PTSKnown)O.logger.log("switching audiotrack, live stream, unknown PTS,load first fragment"),c=0;else if(c=e,r.PTSKnown&&e<m){if(!(m<l.end||l.nextStart))return;O.logger.log("alt audio track ahead of main track, seek to start of alt audio track"),this.media.currentTime=m+.05}if(r.initSegment&&!r.initSegment.data)y=r.initSegment;else if(c<=m){if(y=p[0],null!==this.videoTrackCC&&y.cc!==this.videoTrackCC&&(y=D.findFragWithCC(p,this.videoTrackCC)),r.live&&y.loadIdx&&y.loadIdx===this.fragLoadIdx){var _=l.nextStart?l.nextStart:m;return O.logger.log("no alt audio available @currentTime:"+this.media.currentTime+", seeking @"+(_+.05)),void(this.media.currentTime=_+.05)}}else{var b=void 0,T=n.maxFragLookUpTolerance,S=d?p[d.sn-p[0].sn+1]:void 0,E=function(e){var t=Math.min(T,e.duration);return e.start+e.duration-t<=c?1:c<e.start-t&&e.start?-1:0};(b=c<v?(v-T<c&&(T=0),S&&!E(S)?S:P.default.search(p,E)):p[g-1])&&(m=(y=b).start,d&&y.level===d.level&&y.sn===d.sn&&(y.sn<r.endSN?O.logger.log("SN just loaded, load next one: "+(y=p[y.sn+1-r.startSN]).sn):y=null))}y&&(y.encrypted?(O.logger.log("Loading key for "+y.sn+" of ["+r.startSN+" ,"+r.endSN+"],track "+f),this.state=N.State.KEY_LOADING,i.trigger(R.default.KEY_LOADING,{frag:y})):(O.logger.log("Loading "+y.sn+", cc: "+y.cc+" of ["+r.startSN+" ,"+r.endSN+"],track "+f+", currentTime:"+e+",bufferEnd:"+c.toFixed(3)),this.fragCurrent=y,(h||this.fragmentTracker.getState(y)===M.FragmentState.NOT_LOADED)&&(this.startFragRequested=!0,I.isFinite(y.sn)&&(this.nextLoadPosition=y.start+y.duration),i.trigger(R.default.FRAG_LOADING,{frag:y}),this.state=N.State.FRAG_LOADING)))}break;case N.State.WAITING_TRACK:(t=this.tracks[this.trackId])&&t.details&&(this.state=N.State.IDLE);break;case N.State.FRAG_LOADING_WAITING_RETRY:var k=F.now(),w=this.retryDate;o=this.media,(!w||w<=k||o&&o.seeking)&&(O.logger.log("audioStreamController: retryDate reached, switch back to IDLE state"),this.state=N.State.IDLE);break;case N.State.WAITING_INIT_PTS:var C=this.videoTrackCC;if(void 0===this.initPTS[C])break;var A=this.waitingFragment;if(A){var L=A.frag.cc;C!==L?(t=this.tracks[this.trackId]).details&&t.details.live&&(O.logger.warn("Waiting fragment CC ("+L+") does not match video track CC ("+C+")"),this.waitingFragment=null,this.state=N.State.IDLE):(this.state=N.State.FRAG_LOADING,this.onFragLoaded(this.waitingFragment),this.waitingFragment=null)}else this.state=N.State.IDLE}},e.prototype.onMediaAttached=function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("ended",this.onvended);var r=this.config;this.tracks&&r.autoStartLoad&&this.startLoad(r.startPosition)},e.prototype.onMediaDetaching=function(){var e=this.media;e&&e.ended&&(O.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1,this.stopLoad()},e.prototype.onAudioTracksUpdated=function(e){O.logger.log("audio tracks updated"),this.tracks=e.audioTracks},e.prototype.onAudioTrackSwitching=function(e){var t=!!e.url;this.trackId=e.id,this.fragCurrent=null,this.state=N.State.PAUSED,this.waitingFragment=null,t?this.setInterval(100):this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),t&&(this.audioSwitch=!0,this.state=N.State.IDLE),this.tick()},e.prototype.onAudioTrackLoaded=function(e){var t=e.details,r=e.id,i=this.tracks[r];if(O.logger.log("track "+r+" loaded ["+t.startSN+","+t.endSN+"],duration:"+t.totalduration),t.live){var n=i.details;n&&0<t.fragments.length?(d.mergeDetails(n,t),O.logger.log(t.PTSKnown?"live audio playlist sliding:"+t.fragments[0].start.toFixed(3):"live audio playlist - outdated PTS, unknown sliding")):(t.PTSKnown=!1,O.logger.log("live audio playlist - first load, unknown sliding"))}else t.PTSKnown=!1;if(i.details=t,!this.startFragRequested){if(-1===this.startPosition){var a=t.startTimeOffset;this.startPosition=I.isFinite(a)?(O.logger.log("start time offset found in playlist, adjust startPosition to "+a),a):0}this.nextLoadPosition=this.startPosition}this.state===N.State.WAITING_TRACK&&(this.state=N.State.IDLE),this.tick()},e.prototype.onKeyLoaded=function(){this.state===N.State.KEY_LOADING&&(this.state=N.State.IDLE,this.tick())},e.prototype.onFragLoaded=function(e){var t=this.fragCurrent,r=e.frag;if(this.state===N.State.FRAG_LOADING&&t&&"audio"===r.type&&r.level===t.level&&r.sn===t.sn){var i=this.tracks[this.trackId],n=i.details,a=n.totalduration,o=t.level,s=t.sn,l=t.cc,u=this.config.defaultAudioCodec||i.audioCodec||"mp4a.40.2",c=this.stats=e.stats;if("initSegment"===s)this.state=N.State.IDLE,c.tparsed=c.tbuffered=F.now(),n.initSegment.data=e.payload,this.hls.trigger(R.default.FRAG_BUFFERED,{stats:c,frag:t,id:"audio"}),this.tick();else{this.state=N.State.PARSING,this.appended=!1,this.demuxer||(this.demuxer=new f.default(this.hls,"audio"));var d=this.initPTS[l],h=n.initSegment?n.initSegment.data:[];if(n.initSegment||void 0!==d){this.pendingBuffering=!0,O.logger.log("Demuxing "+s+" of ["+n.startSN+" ,"+n.endSN+"],track "+o);this.demuxer.push(e.payload,h,u,null,t,a,!1,d)}else O.logger.log("unknown video PTS for continuity counter "+l+", waiting for video PTS before demuxing audio frag "+s+" of ["+n.startSN+" ,"+n.endSN+"],track "+o),this.waitingFragment=e,this.state=N.State.WAITING_INIT_PTS}}this.fragLoadError=0},e.prototype.onFragParsingInitSegment=function(e){var t=this.fragCurrent,r=e.frag;if(t&&"audio"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===N.State.PARSING){var i=e.tracks,n=void 0;if(i.video&&delete i.video,n=i.audio){n.levelCodec=n.codec,n.id=e.id,this.hls.trigger(R.default.BUFFER_CODECS,i),O.logger.log("audio track:audio,container:"+n.container+",codecs[level/parsed]=["+n.levelCodec+"/"+n.codec+"]");var a=n.initSegment;if(a){var o={type:"audio",data:a,parent:"audio",content:"initSegment"};this.audioSwitch?this.pendingData=[o]:(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(R.default.BUFFER_APPENDING,o))}this.tick()}}},e.prototype.onFragParsingData=function(t){var r=this,e=this.fragCurrent,i=t.frag;if(e&&"audio"===t.id&&"audio"===t.type&&i.sn===e.sn&&i.level===e.level&&this.state===N.State.PARSING){var n=this.trackId,a=this.tracks[n],o=this.hls;I.isFinite(t.endPTS)||(t.endPTS=t.startPTS+e.duration,t.endDTS=t.startDTS+e.duration),e.addElementaryStream(p.default.ElementaryStreamTypes.AUDIO),O.logger.log("parsed "+t.type+",PTS:["+t.startPTS.toFixed(3)+","+t.endPTS.toFixed(3)+"],DTS:["+t.startDTS.toFixed(3)+"/"+t.endDTS.toFixed(3)+"],nb:"+t.nb),d.updateFragPTSDTS(a.details,e,t.startPTS,t.endPTS);var s=this.media,l=!1;if(this.audioSwitch&&s)if(s.readyState){var u=s.currentTime;O.logger.log("switching audio track : currentTime:"+u),t.startPTS<=u&&(O.logger.log("switching audio track : flushing all audio"),this.state=N.State.BUFFER_FLUSHING,o.trigger(R.default.BUFFER_FLUSHING,{startOffset:0,endOffset:I.POSITIVE_INFINITY,type:"audio"}),this.audioSwitch=!(l=!0),o.trigger(R.default.AUDIO_TRACK_SWITCHED,{id:n}))}else this.audioSwitch=!1,o.trigger(R.default.AUDIO_TRACK_SWITCHED,{id:n});var c=this.pendingData;if(!c)return O.logger.warn("Apparently attempt to enqueue media payload without codec initialization data upfront"),void o.trigger(R.default.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:null,fatal:!0});this.audioSwitch||([t.data1,t.data2].forEach(function(e){e&&e.length&&c.push({type:t.type,data:e,parent:"audio",content:"data"})}),!l&&c.length&&(c.forEach(function(e){r.state===N.State.PARSING&&(r.pendingBuffering=!0,r.hls.trigger(R.default.BUFFER_APPENDING,e))}),this.pendingData=[],this.appended=!0)),this.tick()}},e.prototype.onFragParsed=function(e){var t=this.fragCurrent,r=e.frag;t&&"audio"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===N.State.PARSING&&(this.stats.tparsed=F.now(),this.state=N.State.PARSED,this._checkAppendedParsed())},e.prototype.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},e.prototype.onBufferCreated=function(e){var t=e.tracks.audio;t&&(this.mediaBuffer=t.buffer,this.loadedmetadata=!0),e.tracks.video&&(this.videoBuffer=e.tracks.video.buffer)},e.prototype.onBufferAppended=function(e){if("audio"===e.parent){var t=this.state;t!==N.State.PARSING&&t!==N.State.PARSED||(this.pendingBuffering=0<e.pending,this._checkAppendedParsed())}},e.prototype._checkAppendedParsed=function(){if(!(this.state!==N.State.PARSED||this.appended&&this.pendingBuffering)){var e=this.fragCurrent,t=this.stats,r=this.hls;if(e)this.fragPrevious=e,t.tbuffered=F.now(),r.trigger(R.default.FRAG_BUFFERED,{stats:t,frag:e,id:"audio"}),O.logger.log("audio buffered : "+n.default.toString((this.mediaBuffer?this.mediaBuffer:this.media).buffered)),this.audioSwitch&&this.appended&&(this.audioSwitch=!1,r.trigger(R.default.AUDIO_TRACK_SWITCHED,{id:this.trackId})),this.state=N.State.IDLE;this.tick()}},e.prototype.onError=function(e){var t=e.frag;if(!t||"audio"===t.type)switch(e.details){case h.ErrorDetails.FRAG_LOAD_ERROR:case h.ErrorDetails.FRAG_LOAD_TIMEOUT:var r=e.frag;if(r&&"audio"!==r.type)break;if(!e.fatal){var i=this.fragLoadError;if(i?i++:i=1,i<=(a=this.config).fragLoadingMaxRetry){var n=Math.min(Math.pow(2,(this.fragLoadError=i)-1)*a.fragLoadingRetryDelay,a.fragLoadingMaxRetryTimeout);O.logger.warn("AudioStreamController: frag loading failed, retry in "+n+" ms"),this.retryDate=F.now()+n,this.state=N.State.FRAG_LOADING_WAITING_RETRY}else O.logger.error("AudioStreamController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.state=N.State.ERROR}break;case h.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case h.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:case h.ErrorDetails.KEY_LOAD_ERROR:case h.ErrorDetails.KEY_LOAD_TIMEOUT:this.state!==N.State.ERROR&&(this.state=e.fatal?N.State.ERROR:N.State.IDLE,O.logger.warn("AudioStreamController: "+e.details+" while loading frag, now switching to "+this.state+" state ..."));break;case h.ErrorDetails.BUFFER_FULL_ERROR:if("audio"===e.parent&&(this.state===N.State.PARSING||this.state===N.State.PARSED)){var a,o=this.mediaBuffer,s=this.media.currentTime;if(o&&x.BufferHelper.isBuffered(o,s)&&x.BufferHelper.isBuffered(o,s+.5))(a=this.config).maxBufferLength<=a.maxMaxBufferLength&&(a.maxMaxBufferLength/=2,O.logger.warn("AudioStreamController: reduce max buffer length to "+a.maxMaxBufferLength+"s")),this.state=N.State.IDLE;else O.logger.warn("AudioStreamController: buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,this.state=N.State.BUFFER_FLUSHING,this.hls.trigger(R.default.BUFFER_FLUSHING,{startOffset:0,endOffset:I.POSITIVE_INFINITY,type:"audio"})}}},e.prototype.onBufferFlushed=function(){var t=this,e=this.pendingData;e&&e.length?(O.logger.log("AudioStreamController: appending pending audio data after buffer flushed"),e.forEach(function(e){t.hls.trigger(R.default.BUFFER_APPENDING,e)}),this.appended=!0,this.pendingData=[],this.state=N.State.PARSED):(this.state=N.State.IDLE,this.fragPrevious=null,this.tick())},e}(N.default);r.default=e}).call(this,a("./src/polyfills/number.js").Number)},"./src/controller/audio-track-controller.js":function(e,t,r){var i,n=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var s=r("./src/events.js"),a=r("./src/task-loop.js"),l=r("./src/utils/logger.js"),u=r("./src/errors.js"),o=function(r){function e(e){var t=r.call(this,e,s.default.MANIFEST_LOADING,s.default.MANIFEST_PARSED,s.default.AUDIO_TRACK_LOADED,s.default.AUDIO_TRACK_SWITCHED,s.default.LEVEL_LOADED,s.default.ERROR)||this;return t._trackId=-1,t._selectDefaultTrack=!0,t.tracks=[],t.trackIdBlacklist=Object.create(null),t.audioGroupId=null,t}return n(e,r),e.prototype.onManifestLoading=function(){this.tracks=[],this._trackId=-1,this._selectDefaultTrack=!0},e.prototype.onManifestParsed=function(e){var t=this.tracks=e.audioTracks||[];this.hls.trigger(s.default.AUDIO_TRACKS_UPDATED,{audioTracks:t})},e.prototype.onAudioTrackLoaded=function(e){if(this.tracks.length<=e.id)l.logger.warn("Invalid audio track id:",e.id);else{if(l.logger.log("audioTrack "+e.id+" loaded"),this.tracks[e.id].details=e.details,e.details.live&&!this.hasInterval())this.setInterval(1e3*e.details.targetduration);!e.details.live&&this.hasInterval()&&this.clearInterval()}},e.prototype.onAudioTrackSwitched=function(e){var t=this.tracks[e.id].groupId;t&&this.audioGroupId!==t&&(this.audioGroupId=t)},e.prototype.onLevelLoaded=function(e){var t=this.hls.levels[e.level];if(t.audioGroupIds){var r=t.audioGroupIds[t.urlId];this.audioGroupId!==r&&(this.audioGroupId=r,this._selectInitialAudioTrack())}},e.prototype.onError=function(e){e.type===u.ErrorTypes.NETWORK_ERROR&&(e.fatal&&this.clearInterval(),e.details===u.ErrorDetails.AUDIO_TRACK_LOAD_ERROR&&(l.logger.warn("Network failure on audio-track id:",e.context.id),this._handleLoadError()))},Object.defineProperty(e.prototype,"audioTracks",{get:function(){return this.tracks},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"audioTrack",{get:function(){return this._trackId},set:function(e){this._setAudioTrack(e),this._selectDefaultTrack=!1},enumerable:!0,configurable:!0}),e.prototype._setAudioTrack=function(e){if(this._trackId===e&&this.tracks[this._trackId].details)l.logger.debug("Same id as current audio-track passed, and track details available -> no-op");else if(e<0||this.tracks.length<=e)l.logger.warn("Invalid id passed to audio-track controller");else{var t=this.tracks[e];l.logger.log("Now switching to audio-track index "+e),this.clearInterval(),this._trackId=e,this.hls.trigger(s.default.AUDIO_TRACK_SWITCHING,{id:t.id,type:t.type,url:t.url}),this._loadTrackDetailsIfNeeded(t)}},e.prototype.doTick=function(){this._updateTrack(this._trackId)},e.prototype._selectInitialAudioTrack=function(){var t=this,e=this.tracks;if(e.length){var r=this.tracks[this._trackId],i=null;if(r&&(i=r.name),this._selectDefaultTrack){var n=e.filter(function(e){return e.default});n.length?e=n:l.logger.warn("No default audio tracks defined")}var a=!1,o=function(){e.forEach(function(e){a||t.audioGroupId&&e.groupId!==t.audioGroupId||i&&i!==e.name||(t._setAudioTrack(e.id),a=!0)})};o(),a||(i=null,o()),a||(l.logger.error("No track found for running audio group-ID: "+this.audioGroupId),this.hls.trigger(s.default.ERROR,{type:u.ErrorTypes.MEDIA_ERROR,details:u.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))}},e.prototype._needsTrackLoading=function(e){var t=e.details;return!(t&&!t.live)&&!!e.url},e.prototype._loadTrackDetailsIfNeeded=function(e){if(this._needsTrackLoading(e)){var t=e.url,r=e.id;l.logger.log("loading audio-track playlist for id: "+r),this.hls.trigger(s.default.AUDIO_TRACK_LOADING,{url:t,id:r})}},e.prototype._updateTrack=function(e){e<0||this.tracks.length<=e||(this.clearInterval(),l.logger.log("trying to update audio-track "+(this._trackId=e)),this._loadTrackDetailsIfNeeded(this.tracks[e]))},e.prototype._handleLoadError=function(){this.trackIdBlacklist[this._trackId]=!0;var e=this._trackId,t=this.tracks[e],r=t.name,i=t.language;l.logger.warn("Loading failed on audio track id: "+e+", group-id: "+t.groupId+', name/language: "'+r+'" / "'+i+'"');for(var n=e,a=0;a<this.tracks.length;a++){if(!this.trackIdBlacklist[a])if(this.tracks[a].name===r){n=a;break}}n!==e?(l.logger.log("Attempting audio-track fallback id:",n,"group-id:",this.tracks[n].groupId),this._setAudioTrack(n)):l.logger.warn('No fallback audio-track found for name/language: "'+r+'" / "'+i+'"')},e}(a.default);t.default=o},"./src/controller/base-stream-controller.js":function(e,c,a){(function(s){var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(c,"__esModule",{value:!0});var e=a("./src/task-loop.js"),n=a("./src/controller/fragment-tracker.js"),l=a("./src/utils/buffer-helper.js"),u=a("./src/utils/logger.js");c.State={STOPPED:"STOPPED",STARTING:"STARTING",IDLE:"IDLE",PAUSED:"PAUSED",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};var t=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.doTick=function(){},t.prototype.startLoad=function(){},t.prototype.stopLoad=function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragmentTracker.removeFragment(e)),this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=c.State.STOPPED},t.prototype._streamEnded=function(e,t){var r=this.fragCurrent;if(t.live||!r||r.backtracked||r.sn!==t.endSN||e.nextStart)return!1;var i=this.fragmentTracker.getState(r);return i===n.FragmentState.PARTIAL||i===n.FragmentState.OK},t.prototype.onMediaSeeking=function(){var e=this.config,t=this.media,r=this.state,i=t?t.currentTime:null,n=l.BufferHelper.bufferInfo(this.mediaBuffer||t,i,this.config.maxBufferHole);if(s.isFinite(i)&&u.logger.log("media seeking to "+i.toFixed(3)),r===c.State.FRAG_LOADING){var a=this.fragCurrent;if(0===n.len&&a){var o=e.maxFragLookUpTolerance;i<a.start-o||a.start+a.duration+o<i?(a.loader&&(u.logger.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),a.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=c.State.IDLE):u.logger.log("seeking outside of buffer but within currently loaded fragment range")}}else r===c.State.ENDED&&(0===n.len&&(this.fragPrevious=null,this.fragCurrent=null),this.state=c.State.IDLE);t&&(this.lastCurrentTime=i),this.loadedmetadata||(this.nextLoadPosition=this.startPosition=i),this.tick()},t.prototype.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},t.prototype.onHandlerDestroying=function(){this.stopLoad(),e.prototype.onHandlerDestroying.call(this)},t.prototype.onHandlerDestroyed=function(){this.state=c.State.STOPPED,this.fragmentTracker=null},t}(e.default);c.default=t}).call(this,a("./src/polyfills/number.js").Number)},"./src/controller/buffer-controller.js":function(e,r,s){(function(i){var n,t=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var l=s("./src/events.js"),a=s("./src/event-handler.js"),u=s("./src/utils/logger.js"),c=s("./src/errors.js"),o=s("./src/utils/mediasource-helper.js").getMediaSource(),e=function(r){function e(e){var t=r.call(this,e,l.default.MEDIA_ATTACHING,l.default.MEDIA_DETACHING,l.default.MANIFEST_PARSED,l.default.BUFFER_RESET,l.default.BUFFER_APPENDING,l.default.BUFFER_CODECS,l.default.BUFFER_EOS,l.default.BUFFER_FLUSHING,l.default.LEVEL_PTS_UPDATED,l.default.LEVEL_UPDATED)||this;return t._msDuration=null,t._levelDuration=null,t._levelTargetDuration=10,t._live=null,t._objectUrl=null,t.bufferCodecEventsExpected=0,t.onsbue=t.onSBUpdateEnd.bind(t),t.onsbe=t.onSBUpdateError.bind(t),t.pendingTracks={},t.tracks={},t}return t(e,r),e.prototype.destroy=function(){a.default.prototype.destroy.call(this)},e.prototype.onLevelPtsUpdated=function(e){var t=this.tracks.audio;if("audio"===e.type&&t&&"audio/mpeg"===t.container){var r=this.sourceBuffer.audio;if(.1<Math.abs(r.timestampOffset-e.start)){var i=r.updating;try{r.abort()}catch(e){u.logger.warn("can not abort audio buffer: "+e)}i?this.audioTimestampOffset=e.start:(u.logger.warn("change mpeg audio timestamp offset from "+r.timestampOffset+" to "+e.start),r.timestampOffset=e.start)}}},e.prototype.onManifestParsed=function(e){this.bufferCodecEventsExpected=e.altAudio?2:1,u.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},e.prototype.onMediaAttaching=function(e){var t=this.media=e.media;if(t){var r=this.mediaSource=new o;this.onmso=this.onMediaSourceOpen.bind(this),this.onmse=this.onMediaSourceEnded.bind(this),this.onmsc=this.onMediaSourceClose.bind(this),r.addEventListener("sourceopen",this.onmso),r.addEventListener("sourceended",this.onmse),r.addEventListener("sourceclose",this.onmsc),t.src=window.URL.createObjectURL(r),this._objectUrl=t.src}},e.prototype.onMediaDetaching=function(){u.logger.log("media source detaching");var e=this.mediaSource;if(e){if("open"===e.readyState)try{e.endOfStream()}catch(e){u.logger.warn("onMediaDetaching:"+e.message+" while calling endOfStream")}e.removeEventListener("sourceopen",this.onmso),e.removeEventListener("sourceended",this.onmse),e.removeEventListener("sourceclose",this.onmsc),this.media&&(window.URL.revokeObjectURL(this._objectUrl),this.media.src===this._objectUrl?(this.media.removeAttribute("src"),this.media.load()):u.logger.warn("media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.pendingTracks={},this.tracks={},this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}this.onmso=this.onmse=this.onmsc=null,this.hls.trigger(l.default.MEDIA_DETACHED)},e.prototype.onMediaSourceOpen=function(){u.logger.log("media source opened"),this.hls.trigger(l.default.MEDIA_ATTACHED,{media:this.media});var e=this.mediaSource;e&&e.removeEventListener("sourceopen",this.onmso),this.checkPendingTracks()},e.prototype.checkPendingTracks=function(){var e=this.bufferCodecEventsExpected,t=this.pendingTracks,r=Object.keys(t).length;(r&&!e||2===r)&&(this.createSourceBuffers(t),this.pendingTracks={},this.doAppending())},e.prototype.onMediaSourceClose=function(){u.logger.log("media source closed")},e.prototype.onMediaSourceEnded=function(){u.logger.log("media source ended")},e.prototype.onSBUpdateEnd=function(){if(this.audioTimestampOffset){var e=this.sourceBuffer.audio;u.logger.warn("change mpeg audio timestamp offset from "+e.timestampOffset+" to "+this.audioTimestampOffset),e.timestampOffset=this.audioTimestampOffset,delete this.audioTimestampOffset}this._needsFlush&&this.doFlush(),this._needsEos&&this.checkEos(),this.appending=!1;var r=this.parent,t=this.segments.reduce(function(e,t){return t.parent===r?e+1:e},0),i={},n=this.sourceBuffer;for(var a in n)i[a]=n[a].buffered;this.hls.trigger(l.default.BUFFER_APPENDED,{parent:r,pending:t,timeRanges:i}),this._needsFlush||this.doAppending(),this.updateMediaElementDuration(),0===t&&this.flushLiveBackBuffer()},e.prototype.onSBUpdateError=function(e){u.logger.error("sourceBuffer error:",e),this.hls.trigger(l.default.ERROR,{type:c.ErrorTypes.MEDIA_ERROR,details:c.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})},e.prototype.onBufferReset=function(){var e=this.sourceBuffer;for(var t in e){var r=e[t];try{this.mediaSource.removeSourceBuffer(r),r.removeEventListener("updateend",this.onsbue),r.removeEventListener("error",this.onsbe)}catch(e){}}this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0},e.prototype.onBufferCodecs=function(t){var r=this;if(!Object.keys(this.sourceBuffer).length){Object.keys(t).forEach(function(e){r.pendingTracks[e]=t[e]});var e=this.mediaSource;this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),e&&"open"===e.readyState&&this.checkPendingTracks()}},e.prototype.createSourceBuffers=function(e){var t=this.sourceBuffer,r=this.mediaSource;for(var i in e)if(!t[i]){var n=e[i],a=n.levelCodec||n.codec,o=n.container+";codecs="+a;u.logger.log("creating sourceBuffer("+o+")");try{var s=t[i]=r.addSourceBuffer(o);s.addEventListener("updateend",this.onsbue),s.addEventListener("error",this.onsbe),this.tracks[i]={codec:a,container:n.container},n.buffer=s}catch(e){u.logger.error("error while trying to add sourceBuffer:"+e.message),this.hls.trigger(l.default.ERROR,{type:c.ErrorTypes.MEDIA_ERROR,details:c.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:e,mimeType:o})}}this.hls.trigger(l.default.BUFFER_CREATED,{tracks:e})},e.prototype.onBufferAppending=function(e){this._needsFlush||(this.segments?this.segments.push(e):this.segments=[e],this.doAppending())},e.prototype.onBufferAppendFail=function(e){u.logger.error("sourceBuffer error:",e.event),this.hls.trigger(l.default.ERROR,{type:c.ErrorTypes.MEDIA_ERROR,details:c.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})},e.prototype.onBufferEos=function(e){var t=this.sourceBuffer,r=e.type;for(var i in t)r&&i!==r||t[i].ended||(t[i].ended=!0,u.logger.log(i+" sourceBuffer now EOS"));this.checkEos()},e.prototype.checkEos=function(){var e=this.sourceBuffer,t=this.mediaSource;if(t&&"open"===t.readyState){for(var r in e){var i=e[r];if(!i.ended)return;if(i.updating)return void(this._needsEos=!0)}u.logger.log("all media data are available, signal endOfStream() to MediaSource and stop loading fragment");try{t.endOfStream()}catch(e){u.logger.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1}else this._needsEos=!1},e.prototype.onBufferFlushing=function(e){this.flushRange.push({start:e.startOffset,end:e.endOffset,type:e.type}),this.flushBufferCounter=0,this.doFlush()},e.prototype.flushLiveBackBuffer=function(){if(this._live){var e=this.hls.config.liveBackBufferLength;if(isFinite(e)&&!(e<0))for(var t=this.media.currentTime,r=this.sourceBuffer,i=Object.keys(r),n=t-Math.max(e,this._levelTargetDuration),a=i.length-1;0<=a;a--){var o=i[a],s=r[o].buffered;0<s.length&&n>s.start(0)&&this.removeBufferRange(o,r[o],0,n)}}},e.prototype.onLevelUpdated=function(e){var t=e.details;0<t.fragments.length&&(this._levelDuration=t.totalduration+t.fragments[0].start,this._levelTargetDuration=t.averagetargetduration||t.targetduration||10,this._live=t.live,this.updateMediaElementDuration())},e.prototype.updateMediaElementDuration=function(){var e,t=this.hls.config;if(null!==this._levelDuration&&this.media&&this.mediaSource&&this.sourceBuffer&&0!==this.media.readyState&&"open"===this.mediaSource.readyState){for(var r in this.sourceBuffer)if(!0===this.sourceBuffer[r].updating)return;e=this.media.duration,null===this._msDuration&&(this._msDuration=this.mediaSource.duration),!0===this._live&&!0===t.liveDurationInfinity?(u.logger.log("Media Source duration is set to Infinity"),this._msDuration=this.mediaSource.duration=1/0):(this._msDuration<this._levelDuration&&e<this._levelDuration||!i.isFinite(e))&&(u.logger.log("Updating Media Source duration to "+this._levelDuration.toFixed(3)),this._msDuration=this.mediaSource.duration=this._levelDuration)}},e.prototype.doFlush=function(){for(;this.flushRange.length;){var e=this.flushRange[0];if(!this.flushBuffer(e.start,e.end,e.type))return void(this._needsFlush=!0);this.flushRange.shift(),this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var t=0,r=this.sourceBuffer;try{for(var i in r)t+=r[i].buffered.length}catch(e){u.logger.error("error while accessing sourceBuffer.buffered")}this.appended=t,this.hls.trigger(l.default.BUFFER_FLUSHED)}},e.prototype.doAppending=function(){var t=this.hls,r=this.segments,e=this.sourceBuffer;if(Object.keys(e).length){if(this.media.error)return this.segments=[],void u.logger.error("trying to append although a media error occured, flush segment and abort");if(this.appending)return;if(r&&r.length){var i=r.shift();try{var n=e[i.type];n?n.updating?r.unshift(i):(n.ended=!1,this.parent=i.parent,n.appendBuffer(i.data),this.appendError=0,this.appended++,this.appending=!0):this.onSBUpdateEnd()}catch(e){u.logger.error("error while trying to append buffer:"+e.message),r.unshift(i);var a={type:c.ErrorTypes.MEDIA_ERROR,parent:i.parent};a.fatal=22!==e.code?(this.appendError?this.appendError++:this.appendError=1,a.details=c.ErrorDetails.BUFFER_APPEND_ERROR,t.config.appendErrorMaxRetry<this.appendError&&(u.logger.log("fail "+t.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),this.segments=[],!0)):(this.segments=[],a.details=c.ErrorDetails.BUFFER_FULL_ERROR,!1),t.trigger(l.default.ERROR,a)}}}},e.prototype.flushBuffer=function(e,t,r){var i,n=this.sourceBuffer;if(Object.keys(n).length){if(u.logger.log("flushBuffer,pos/start/end: "+this.media.currentTime.toFixed(3)+"/"+e+"/"+t),this.flushBufferCounter<this.appended){for(var a in n)if(!r||a===r){if((i=n[a]).ended=!1,i.updating)return u.logger.warn("cannot flush, sb updating in progress"),!1;if(this.removeBufferRange(a,i,e,t))return this.flushBufferCounter++,!1}}else u.logger.warn("abort flushing too many retries");u.logger.log("buffer flushed")}return!0},e.prototype.removeBufferRange=function(e,t,r,i){try{for(var n=0;n<t.buffered.length;n++){var a=t.buffered.start(n),o=t.buffered.end(n),s=Math.max(a,r),l=Math.min(o,i);if(.5<Math.min(l,o)-s)return u.logger.log("sb remove "+e+" ["+s+","+l+"], of ["+a+","+o+"], pos:"+this.media.currentTime),t.remove(s,l),!0}}catch(e){u.logger.warn("removeBufferRange failed",e)}return!1},e}(a.default);r.default=e}).call(this,s("./src/polyfills/number.js").Number)},"./src/controller/cap-level-controller.js":function(e,r,o){(function(i){var n,e=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var a=o("./src/events.js"),t=function(r){function n(e){var t=r.call(this,e,a.default.FPS_DROP_LEVEL_CAPPING,a.default.MEDIA_ATTACHING,a.default.MANIFEST_PARSED,a.default.BUFFER_CODECS,a.default.MEDIA_DETACHING)||this;return t.autoLevelCapping=i.POSITIVE_INFINITY,t.firstLevel=null,t.levels=[],t.media=null,t.restrictedLevels=[],t.timer=null,t}return e(n,r),n.prototype.destroy=function(){this.hls.config.capLevelToPlayerSize&&(this.media=null,this._stopCapping())},n.prototype.onFpsDropLevelCapping=function(e){n.isLevelAllowed(e.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(e.droppedLevel)},n.prototype.onMediaAttaching=function(e){this.media=e.media instanceof window.HTMLVideoElement?e.media:null},n.prototype.onManifestParsed=function(e){var t=this.hls;this.restrictedLevels=[],this.levels=e.levels,this.firstLevel=e.firstLevel,t.config.capLevelToPlayerSize&&e.video&&this._startCapping()},n.prototype.onBufferCodecs=function(e){this.hls.config.capLevelToPlayerSize&&e.video&&this._startCapping()},n.prototype.onLevelsUpdated=function(e){this.levels=e.levels},n.prototype.onMediaDetaching=function(){this._stopCapping()},n.prototype.detectPlayerSize=function(){if(this.media){var e=this.levels?this.levels.length:0;if(e){var t=this.hls;t.autoLevelCapping=this.getMaxLevel(e-1),this.autoLevelCapping<t.autoLevelCapping&&t.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}},n.prototype.getMaxLevel=function(r){var i=this;if(!this.levels)return-1;var e=this.levels.filter(function(e,t){return n.isLevelAllowed(t,i.restrictedLevels)&&t<=r});return n.getMaxLevelByMediaSize(e,this.mediaWidth,this.mediaHeight)},n.prototype._startCapping=function(){this.timer||(this.autoLevelCapping=i.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},n.prototype._stopCapping=function(){this.restrictedLevels=[],this.firstLevel=null,this.autoLevelCapping=i.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer),this.timer=null)},Object.defineProperty(n.prototype,"mediaWidth",{get:function(){var e,t=this.media;return t&&(e=t.width||t.clientWidth||t.offsetWidth,e*=n.contentScaleFactor),e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"mediaHeight",{get:function(){var e,t=this.media;return t&&(e=t.height||t.clientHeight||t.offsetHeight,e*=n.contentScaleFactor),e},enumerable:!0,configurable:!0}),Object.defineProperty(n,"contentScaleFactor",{get:function(){var e=1;try{e=window.devicePixelRatio}catch(e){}return e},enumerable:!0,configurable:!0}),n.isLevelAllowed=function(e,t){return void 0===t&&(t=[]),-1==t.indexOf(e)},n.getMaxLevelByMediaSize=function(e,t,r){if(!e||e&&!e.length)return-1;for(var i,n,a=e.length-1,o=0;o<e.length;o+=1){var s=e[o];if((t<=s.width||r<=s.height)&&(i=s,!(n=e[o+1])||i.width!==n.width||i.height!==n.height)){a=o;break}}return a},n}(o("./src/event-handler.js").default);r.default=t}).call(this,o("./src/polyfills/number.js").Number)},"./src/controller/eme-controller.js":function(e,t,r){var i,n=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var a=r("./src/event-handler.js"),o=r("./src/events.js"),s=r("./src/errors.js"),l=r("./src/utils/logger.js"),u=window.XMLHttpRequest,c="com.widevine.alpha",d="com.microsoft.playready",h=function(r){function e(e){var t=r.call(this,e,o.default.MEDIA_ATTACHED,o.default.MANIFEST_PARSED)||this;return t._widevineLicenseUrl=e.config.widevineLicenseUrl,t._licenseXhrSetup=e.config.licenseXhrSetup,t._emeEnabled=e.config.emeEnabled,t._requestMediaKeySystemAccess=e.config.requestMediaKeySystemAccessFunc,t._mediaKeysList=[],t._media=null,t._hasSetMediaKeys=!1,t._isMediaEncrypted=!1,t._requestLicenseFailureCount=0,t}return n(e,r),e.prototype.getLicenseServerUrl=function(e){var t;switch(e){case c:t=this._widevineLicenseUrl;break;default:t=null}return t||(l.logger.error('No license server URL configured for key-system "'+e+'"'),this.hls.trigger(o.default.ERROR,{type:s.ErrorTypes.KEY_SYSTEM_ERROR,details:s.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})),t},e.prototype._attemptKeySystemAccess=function(t,e,r){var i=this,n=function(e,t,r){switch(e){case c:return i={videoCapabilities:[]},r.forEach(function(e){i.videoCapabilities.push({contentType:'video/mp4; codecs="'+e+'"'})}),[i];default:throw Error("Unknown key-system: "+e)}var i}(t,0,r);n?(l.logger.log("Requesting encrypted media key-system access"),this.requestMediaKeySystemAccess(t,n).then(function(e){i._onMediaKeySystemAccessObtained(t,e)}).catch(function(e){l.logger.error('Failed to obtain key-system "'+t+'" access:',e)})):l.logger.warn("Can not create config for key-system (maybe because platform is not supported):",t)},Object.defineProperty(e.prototype,"requestMediaKeySystemAccess",{get:function(){if(!this._requestMediaKeySystemAccess)throw Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess},enumerable:!0,configurable:!0}),e.prototype._onMediaKeySystemAccessObtained=function(t,e){var r=this;l.logger.log('Access for key-system "'+t+'" obtained');var i={mediaKeys:null,mediaKeysSession:null,mediaKeysSessionInitialized:!1,mediaKeySystemAccess:e,mediaKeySystemDomain:t};this._mediaKeysList.push(i),e.createMediaKeys().then(function(e){i.mediaKeys=e,l.logger.log('Media-keys created for key-system "'+t+'"'),r._onMediaKeysCreated()}).catch(function(e){l.logger.error("Failed to create media-keys:",e)})},e.prototype._onMediaKeysCreated=function(){var t=this;this._mediaKeysList.forEach(function(e){e.mediaKeysSession||(e.mediaKeysSession=e.mediaKeys.createSession(),t._onNewMediaKeySession(e.mediaKeysSession))})},e.prototype._onNewMediaKeySession=function(t){var r=this;l.logger.log("New key-system session "+t.sessionId),t.addEventListener("message",function(e){r._onKeySessionMessage(t,e.message)},!1)},e.prototype._onKeySessionMessage=function(t,e){l.logger.log("Got EME message event, creating license request"),this._requestLicense(e,function(e){l.logger.log("Received license data, updating key-session"),t.update(e)})},e.prototype._onMediaEncrypted=function(e,t){l.logger.log('Media is encrypted using "'+e+'" init data type'),this._isMediaEncrypted=!0,this._mediaEncryptionInitDataType=e,this._mediaEncryptionInitData=t,this._attemptSetMediaKeys(),this._generateRequestWithPreferredKeySession()},e.prototype._attemptSetMediaKeys=function(){if(!this._hasSetMediaKeys){var e=this._mediaKeysList[0];if(!e||!e.mediaKeys)return l.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),void this.hls.trigger(o.default.ERROR,{type:s.ErrorTypes.KEY_SYSTEM_ERROR,details:s.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});l.logger.log("Setting keys for encrypted media"),this._media.setMediaKeys(e.mediaKeys),this._hasSetMediaKeys=!0}},e.prototype._generateRequestWithPreferredKeySession=function(){var t=this,e=this._mediaKeysList[0];if(!e)return l.logger.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),void this.hls.trigger(o.default.ERROR,{type:s.ErrorTypes.KEY_SYSTEM_ERROR,details:s.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});if(e.mediaKeysSessionInitialized)l.logger.warn("Key-Session already initialized but requested again");else{var r=e.mediaKeysSession;r||(l.logger.error("Fatal: Media is encrypted but no key-session existing"),this.hls.trigger(o.default.ERROR,{type:s.ErrorTypes.KEY_SYSTEM_ERROR,details:s.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!0}));var i=this._mediaEncryptionInitDataType,n=this._mediaEncryptionInitData;l.logger.log('Generating key-session request for "'+i+'" init data type'),e.mediaKeysSessionInitialized=!0,r.generateRequest(i,n).then(function(){l.logger.debug("Key-session generation succeeded")}).catch(function(e){l.logger.error("Error generating key-session request:",e),t.hls.trigger(o.default.ERROR,{type:s.ErrorTypes.KEY_SYSTEM_ERROR,details:s.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!1})})}},e.prototype._createLicenseXhr=function(t,e,r){var i=new u,n=this._licenseXhrSetup;try{if(n)try{n(i,t)}catch(e){i.open("POST",t,!0),n(i,t)}i.readyState||i.open("POST",t,!0)}catch(e){return l.logger.error("Error setting up key-system license XHR",e),void this.hls.trigger(o.default.ERROR,{type:s.ErrorTypes.KEY_SYSTEM_ERROR,details:s.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}return i.responseType="arraybuffer",i.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,i,t,e,r),i},e.prototype._onLicenseRequestReadyStageChange=function(e,t,r,i){switch(e.readyState){case 4:if(200===e.status)this._requestLicenseFailureCount=0,l.logger.log("License request succeeded"),i(e.response);else{if(l.logger.error("License Request XHR failed ("+t+"). Status: "+e.status+" ("+e.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount<=3)return l.logger.warn("Retrying license request, "+(3-this._requestLicenseFailureCount+1)+" attempts left"),void this._requestLicense(r,i);this.hls.trigger(o.default.ERROR,{type:s.ErrorTypes.KEY_SYSTEM_ERROR,details:s.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}}},e.prototype._generateLicenseRequestChallenge=function(e,t){var r;return e.mediaKeySystemDomain===d?l.logger.error("PlayReady is not supported (yet)"):e.mediaKeySystemDomain===c?r=t:l.logger.error("Unsupported key-system:",e.mediaKeySystemDomain),r},e.prototype._requestLicense=function(e,t){l.logger.log("Requesting content license for key-system");var r=this._mediaKeysList[0];if(!r)return l.logger.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),void this.hls.trigger(o.default.ERROR,{type:s.ErrorTypes.KEY_SYSTEM_ERROR,details:s.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});var i=this.getLicenseServerUrl(r.mediaKeySystemDomain),n=this._createLicenseXhr(i,e,t);l.logger.log("Sending license request to URL: "+i),n.send(this._generateLicenseRequestChallenge(r,e))},e.prototype.onMediaAttached=function(e){var t=this;if(this._emeEnabled){var r=e.media;(this._media=r).addEventListener("encrypted",function(e){t._onMediaEncrypted(e.initDataType,e.initData)})}},e.prototype.onManifestParsed=function(e){if(this._emeEnabled){var t=e.levels.map(function(e){return e.audioCodec}),r=e.levels.map(function(e){return e.videoCodec});this._attemptKeySystemAccess(c,t,r)}},e}(a.default);t.default=h},"./src/controller/fps-controller.js":function(e,t,r){var i,n=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var u=r("./src/events.js"),a=r("./src/event-handler.js"),c=r("./src/utils/logger.js"),d=window.performance,o=function(t){function e(e){return t.call(this,e,u.default.MEDIA_ATTACHING)||this}return n(e,t),e.prototype.destroy=function(){this.timer&&clearInterval(this.timer),this.isVideoPlaybackQualityAvailable=!1},e.prototype.onMediaAttaching=function(e){var t=this.hls.config;t.capLevelOnFPSDrop&&("function"==typeof(this.video=e.media instanceof window.HTMLVideoElement?e.media:null).getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),t.fpsDroppedMonitoringPeriod))},e.prototype.checkFPS=function(e,t,r){var i=d.now();if(t){if(this.lastTime){var n=r-this.lastDroppedFrames,a=t-this.lastDecodedFrames,o=1e3*n/(i-this.lastTime),s=this.hls;if(s.trigger(u.default.FPS_DROP,{currentDropped:n,currentDecoded:a,totalDroppedFrames:r}),0<o&&s.config.fpsDroppedMonitoringThreshold*a<n){var l=s.currentLevel;c.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+l),0<l&&(-1===s.autoLevelCapping||l<=s.autoLevelCapping)&&(s.trigger(u.default.FPS_DROP_LEVEL_CAPPING,{level:l-=1,droppedLevel:s.currentLevel}),s.autoLevelCapping=l,s.streamController.nextLevelSwitch())}}this.lastTime=i,this.lastDroppedFrames=r,this.lastDecodedFrames=t}},e.prototype.checkFPSInterval=function(){var e=this.video;if(e)if(this.isVideoPlaybackQualityAvailable){var t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)},e}(a.default);t.default=o},"./src/controller/fragment-finders.js":function(e,t,r){!function(a){Object.defineProperty(t,"__esModule",{value:!0});var o=r("./src/utils/binary-search.js");function s(e,t,r){void 0===e&&(e=0),void 0===t&&(t=0);var i=Math.min(t,r.duration+(r.deltaPTS?r.deltaPTS:0));return r.start+r.duration-i<=e?1:e<r.start-i&&r.start?-1:0}function l(e,t,r){return e<r.endProgramDateTime-1e3*Math.min(t,r.duration+(r.deltaPTS?r.deltaPTS:0))}t.findFragmentByPDT=function(e,t,r){if(!Array.isArray(e)||!e.length||!a.isFinite(t))return null;if(t<e[0].programDateTime)return null;if(e[e.length-1].endProgramDateTime<=t)return null;r=r||0;for(var i=0;i<e.length;++i){var n=e[i];if(l(t,r,n))return n}return null},t.findFragmentByPTS=function(e,t,r,i){void 0===r&&(r=0),void 0===i&&(i=0);var n=e?t[e.sn-t[0].sn+1]:null;return n&&!s(r,i,n)?n:o.default.search(t,s.bind(null,r,i))},t.fragmentWithinToleranceTest=s,t.pdtWithinToleranceTest=l}(r("./src/polyfills/number.js").Number)},"./src/controller/fragment-tracker.js":function(e,s,r){(function(i){var n,t=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(s,"__esModule",{value:!0});var a=r("./src/event-handler.js"),o=r("./src/events.js");s.FragmentState={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};var e=function(r){function e(e){var t=r.call(this,e,o.default.BUFFER_APPENDED,o.default.FRAG_BUFFERED,o.default.FRAG_LOADED)||this;return t.bufferPadding=.2,t.fragments=Object.create(null),t.timeRanges=Object.create(null),t.config=e.config,t}return t(e,r),e.prototype.destroy=function(){this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.config=null,a.default.prototype.destroy.call(this),r.prototype.destroy.call(this)},e.prototype.getBufferedFrag=function(i,n){var a=this.fragments,e=Object.keys(a).filter(function(e){var t=a[e];if(t.body.type!==n)return!1;if(!t.buffered)return!1;var r=t.body;return r.startPTS<=i&&i<=r.endPTS});if(0===e.length)return null;var t=e.pop();return a[t].body},e.prototype.detectEvictedFragments=function(n,a){var o,s,l=this;Object.keys(this.fragments).forEach(function(e){var t=l.fragments[e];if(!0===t.buffered){var r=t.range[n];if(r){o=r.time;for(var i=0;i<o.length;i++)if(!1===l.isTimeBuffered((s=o[i]).startPTS,s.endPTS,a)){l.removeFragment(t.body);break}}}})},e.prototype.detectPartialFragments=function(t){var r=this,e=this.getFragmentKey(t),i=this.fragments[e];i&&(i.buffered=!0,Object.keys(this.timeRanges).forEach(function(e){t.hasElementaryStream(e)&&(i.range[e]=r.getBufferedTimes(t.startPTS,t.endPTS,r.timeRanges[e]))}))},e.prototype.getBufferedTimes=function(e,t,r){for(var i,n,a=[],o=!1,s=0;s<r.length;s++){if(i=r.start(s)-this.bufferPadding,n=r.end(s)+this.bufferPadding,i<=e&&t<=n){a.push({startPTS:Math.max(e,r.start(s)),endPTS:Math.min(t,r.end(s))});break}if(e<n&&i<t)a.push({startPTS:Math.max(e,r.start(s)),endPTS:Math.min(t,r.end(s))}),o=!0;else if(t<=i)break}return{time:a,partial:o}},e.prototype.getFragmentKey=function(e){return e.type+"_"+e.level+"_"+e.urlId+"_"+e.sn},e.prototype.getPartialFragment=function(r){var i,n,a,o=this,s=null,l=0;return Object.keys(this.fragments).forEach(function(e){var t=o.fragments[e];o.isPartial(t)&&(a=t.body.endPTS+o.bufferPadding,(n=t.body.startPTS-o.bufferPadding)<=r&&r<=a&&l<=(i=Math.min(r-n,a-r))&&(s=t.body,l=i))}),s},e.prototype.getState=function(e){var t=this.getFragmentKey(e),r=this.fragments[t],i=s.FragmentState.NOT_LOADED;return void 0!==r&&(i=r.buffered?!0===this.isPartial(r)?s.FragmentState.PARTIAL:s.FragmentState.OK:s.FragmentState.APPENDING),i},e.prototype.isPartial=function(e){return!0===e.buffered&&(void 0!==e.range.video&&!0===e.range.video.partial||void 0!==e.range.audio&&!0===e.range.audio.partial)},e.prototype.isTimeBuffered=function(e,t,r){for(var i,n,a=0;a<r.length;a++){if(i=r.start(a)-this.bufferPadding,n=r.end(a)+this.bufferPadding,i<=e&&t<=n)return!0;if(t<=i)return!1}return!1},e.prototype.onFragLoaded=function(e){var t=e.frag;i.isFinite(t.sn)&&!t.bitrateTest&&(this.fragments[this.getFragmentKey(t)]={body:t,range:Object.create(null),buffered:!1})},e.prototype.onBufferAppended=function(e){var t=this;this.timeRanges=e.timeRanges,Object.keys(this.timeRanges).forEach(function(e){t.detectEvictedFragments(e,t.timeRanges[e])})},e.prototype.onFragBuffered=function(e){this.detectPartialFragments(e.frag)},e.prototype.hasFragment=function(e){var t=this.getFragmentKey(e);return void 0!==this.fragments[t]},e.prototype.removeFragment=function(e){var t=this.getFragmentKey(e);delete this.fragments[t]},e.prototype.removeAllFragments=function(){this.fragments=Object.create(null)},e}(a.default);s.FragmentTracker=e}).call(this,r("./src/polyfills/number.js").Number)},"./src/controller/gap-controller.js":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var l=r("./src/utils/buffer-helper.js"),s=r("./src/errors.js"),u=r("./src/events.js"),c=r("./src/utils/logger.js"),i=function(){function e(e,t,r,i){this.config=e,this.media=t,this.fragmentTracker=r,this.hls=i,this.stallReported=!1}return e.prototype.poll=function(e,t){var r=this.config,i=this.media,n=i.currentTime,a=window.performance.now();if(n!==e)return this.stallReported&&(c.logger.warn("playback not stuck anymore @"+n+", after "+Math.round(a-this.stalled)+"ms"),this.stallReported=!1),this.stalled=null,void(this.nudgeRetry=0);if(!(i.ended||!i.buffered.length||2<i.readyState||i.seeking&&l.BufferHelper.isBuffered(i,n))){var o=a-this.stalled,s=l.BufferHelper.bufferInfo(i,n,r.maxBufferHole);this.stalled?(1e3<=o&&this._reportStall(s.len),this._tryFixBufferStall(s,o)):this.stalled=a}},e.prototype._tryFixBufferStall=function(e,t){var r=this.config,i=this.fragmentTracker.getPartialFragment(this.media.currentTime);i&&this._trySkipBufferHole(i),.5<e.len&&1e3*r.highBufferWatchdogPeriod<t&&(this.stalled=null,this._tryNudgeBuffer())},e.prototype._reportStall=function(e){var t=this.hls,r=this.media;this.stallReported||(this.stallReported=!0,c.logger.warn("Playback stalling at @"+r.currentTime+" due to low buffer"),t.trigger(u.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:e}))},e.prototype._trySkipBufferHole=function(e){for(var t=this.hls,r=this.media,i=r.currentTime,n=0,a=0;a<r.buffered.length;a++){var o=r.buffered.start(a);if(n<=i&&i<o)return r.currentTime=Math.max(o,r.currentTime+.1),c.logger.warn("skipping hole, adjusting currentTime from "+i+" to "+r.currentTime),this.stalled=null,void t.trigger(u.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+i+" to "+r.currentTime,frag:e});n=r.buffered.end(a)}},e.prototype._tryNudgeBuffer=function(){var e=this.config,t=this.hls,r=this.media,i=r.currentTime,n=(this.nudgeRetry||0)+1;if((this.nudgeRetry=n)<e.nudgeMaxRetry){var a=i+n*e.nudgeOffset;c.logger.log("adjust currentTime from "+i+" to "+a),r.currentTime=a,t.trigger(u.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else c.logger.error("still stuck in high buffer @"+i+" after "+e.nudgeMaxRetry+", raise fatal error"),t.trigger(u.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})},e}();t.default=i},"./src/controller/id3-track-controller.js":function(e,t,r){var i,n=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var a=r("./src/events.js"),o=r("./src/event-handler.js"),d=r("./src/demux/id3.js"),s=r("./src/utils/texttrack-utils.js"),l=function(r){function e(e){var t=r.call(this,e,a.default.MEDIA_ATTACHED,a.default.MEDIA_DETACHING,a.default.FRAG_PARSING_METADATA)||this;return t.id3Track=void 0,t.media=void 0,t}return n(e,r),e.prototype.destroy=function(){o.default.prototype.destroy.call(this)},e.prototype.onMediaAttached=function(e){this.media=e.media},e.prototype.onMediaDetaching=function(){s.clearCurrentCues(this.id3Track),this.id3Track=void 0,this.media=void 0},e.prototype.getID3Track=function(e){for(var t=0;t<e.length;t++){var r=e[t];if("metadata"===r.kind&&"id3"===r.label)return s.sendAddTrackEvent(r,this.media),r}return this.media.addTextTrack("metadata","id3")},e.prototype.onFragParsingMetadata=function(e){var t=e.frag,r=e.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var i=window.WebKitDataCue||window.VTTCue||window.TextTrackCue,n=0;n<r.length;n++){var a=d.default.getID3Frames(r[n].data);if(a){var o=r[n].pts,s=n<r.length-1?r[n+1].pts:t.endPTS;o===s&&(s+=1e-4);for(var l=0;l<a.length;l++){var u=a[l];if(!d.default.isTimeStampFrame(u)){var c=new i(o,s,"");c.value=u,this.id3Track.addCue(c)}}}}},e}(o.default);t.default=l},"./src/controller/level-controller.js":function(e,t,r){var i,n=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var u,c=r("./src/events.js"),a=r("./src/event-handler.js"),d=r("./src/utils/logger.js"),h=r("./src/errors.js"),f=r("./src/utils/codecs.js"),p=r("./src/controller/level-helper.js"),o=(window,function(r){function e(e){var t=r.call(this,e,c.default.MANIFEST_LOADED,c.default.LEVEL_LOADED,c.default.AUDIO_TRACK_SWITCHED,c.default.FRAG_LOADED,c.default.ERROR)||this;return t.canload=!1,t.currentLevelIndex=null,t.manualLevelIndex=-1,t.timer=null,u=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),t}return n(e,r),e.prototype.onHandlerDestroying=function(){this.clearTimer(),this.manualLevelIndex=-1},e.prototype.clearTimer=function(){null!==this.timer&&(clearTimeout(this.timer),this.timer=null)},e.prototype.startLoad=function(){var e=this._levels;this.canload=!0,this.levelRetryCount=0,e&&e.forEach(function(e){e.loadError=0;var t=e.details;t&&t.live&&(e.details=void 0)}),null!==this.timer&&this.loadLevel()},e.prototype.stopLoad=function(){this.canload=!1},e.prototype.onManifestLoaded=function(e){var t,r=[],i=[],n={},a=null,o=!1,s=!1;if(e.levels.forEach(function(e){var t=e.attrs;e.loadError=0,e.fragmentError=!1,o=o||!!e.videoCodec,s=s||!!e.audioCodec,u&&e.audioCodec&&-1!=e.audioCodec.indexOf("mp4a.40.34")&&(e.audioCodec=void 0),(a=n[e.bitrate])?a.url.push(e.url):(e.url=[e.url],e.urlId=0,r.push(n[e.bitrate]=e)),t&&(t.AUDIO&&(s=!0,p.addGroupId(a||e,"audio",t.AUDIO)),t.SUBTITLES&&p.addGroupId(a||e,"text",t.SUBTITLES))}),o&&s&&(r=r.filter(function(e){return!!e.videoCodec})),r=r.filter(function(e){var t=e.audioCodec,r=e.videoCodec;return(!t||f.isCodecSupportedInMp4(t,"audio"))&&(!r||f.isCodecSupportedInMp4(r,"video"))}),e.audioTracks&&(i=e.audioTracks.filter(function(e){return!e.audioCodec||f.isCodecSupportedInMp4(e.audioCodec,"audio")})).forEach(function(e,t){e.id=t}),0<r.length){t=r[0].bitrate,r.sort(function(e,t){return e.bitrate-t.bitrate}),this._levels=r;for(var l=0;l<r.length;l++)if(r[l].bitrate===t){this._firstLevel=l,d.logger.log("manifest loaded,"+r.length+" level(s) found, first bitrate:"+t);break}this.hls.trigger(c.default.MANIFEST_PARSED,{levels:r,audioTracks:i,firstLevel:this._firstLevel,stats:e.stats,audio:s,video:o,altAudio:i.some(function(e){return!!e.url})})}else this.hls.trigger(c.default.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:h.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:this.hls.url,reason:"no level with compatible codecs found in manifest"})},Object.defineProperty(e.prototype,"levels",{get:function(){return this._levels},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"level",{get:function(){return this.currentLevelIndex},set:function(e){var t=this._levels;t&&(this.currentLevelIndex===(e=Math.min(e,t.length-1))&&t[e].details||this.setLevelInternal(e))},enumerable:!0,configurable:!0}),e.prototype.setLevelInternal=function(e){var t=this._levels,r=this.hls;if(0<=e&&e<t.length){if(this.clearTimer(),this.currentLevelIndex!==e){d.logger.log("switching to level "+e);var i=t[this.currentLevelIndex=e];i.level=e,r.trigger(c.default.LEVEL_SWITCHING,i)}var n=t[e],a=n.details;if(!a||a.live){var o=n.urlId;r.trigger(c.default.LEVEL_LOADING,{url:n.url[o],level:e,id:o})}}else r.trigger(c.default.ERROR,{type:h.ErrorTypes.OTHER_ERROR,details:h.ErrorDetails.LEVEL_SWITCH_ERROR,level:e,fatal:!1,reason:"invalid level idx"})},Object.defineProperty(e.prototype,"manualLevel",{get:function(){return this.manualLevelIndex},set:function(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstLevel",{get:function(){return this._firstLevel},set:function(e){this._firstLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"startLevel",{get:function(){if(void 0!==this._startLevel)return this._startLevel;var e=this.hls.config.startLevel;return void 0!==e?e:this._firstLevel},set:function(e){this._startLevel=e},enumerable:!0,configurable:!0}),e.prototype.onError=function(e){if(e.fatal)e.type===h.ErrorTypes.NETWORK_ERROR&&this.clearTimer();else{var t,r=!1,i=!1;switch(e.details){case h.ErrorDetails.FRAG_LOAD_ERROR:case h.ErrorDetails.FRAG_LOAD_TIMEOUT:case h.ErrorDetails.KEY_LOAD_ERROR:case h.ErrorDetails.KEY_LOAD_TIMEOUT:t=e.frag.level,i=!0;break;case h.ErrorDetails.LEVEL_LOAD_ERROR:case h.ErrorDetails.LEVEL_LOAD_TIMEOUT:t=e.context.level,r=!0;break;case h.ErrorDetails.REMUX_ALLOC_ERROR:t=e.level,r=!0}void 0!==t&&this.recoverLevel(e,t,r,i)}},e.prototype.recoverLevel=function(e,t,r,i){var n,a,o,s=this,l=this.hls.config,u=e.details,c=this._levels[t];if(c.loadError++,c.fragmentError=i,r){if(!(this.levelRetryCount+1<=l.levelLoadingMaxRetry))return d.logger.error("level controller, cannot recover from "+u+" error"),this.currentLevelIndex=null,this.clearTimer(),void(e.fatal=!0);this.timer=setTimeout(function(){return s.loadLevel()},a=Math.min(Math.pow(2,this.levelRetryCount)*l.levelLoadingRetryDelay,l.levelLoadingMaxRetryTimeout)),e.levelRetry=!0,this.levelRetryCount++,d.logger.warn("level controller, "+u+", retry in "+a+" ms, current retry count is "+this.levelRetryCount)}(r||i)&&(1<(n=c.url.length)&&c.loadError<n?(c.urlId=(c.urlId+1)%n,c.details=void 0,d.logger.warn("level controller, "+u+" for level "+t+": switching to redundant URL-id "+c.urlId)):-1===this.manualLevelIndex?(d.logger.warn("level controller, "+u+": switch to "+(o=0===t?this._levels.length-1:t-1)),this.hls.nextAutoLevel=this.currentLevelIndex=o):i&&(d.logger.warn("level controller, "+u+": reload a fragment"),this.currentLevelIndex=null))},e.prototype.onFragLoaded=function(e){var t=e.frag;if(void 0!==t&&"main"===t.type){var r=this._levels[t.level];void 0!==r&&(r.fragmentError=!1,this.levelRetryCount=r.loadError=0)}},e.prototype.onLevelLoaded=function(e){var t=this,r=e.level,i=e.details;if(r===this.currentLevelIndex){var n=this._levels[r];if(n.fragmentError||(this.levelRetryCount=n.loadError=0),i.live){var a=p.computeReloadInterval(n.details,i,e.stats.trequest);d.logger.log("live playlist, reload in "+Math.round(a)+" ms"),this.timer=setTimeout(function(){return t.loadLevel()},a)}else this.clearTimer()}},e.prototype.onAudioTrackSwitched=function(e){var t=this.hls.audioTracks[e.id].groupId,r=this.hls.levels[this.currentLevelIndex];if(r&&r.audioGroupIds){for(var i=-1,n=0;n<r.audioGroupIds.length;n++)if(r.audioGroupIds[n]===t){i=n;break}i!==r.urlId&&(r.urlId=i,this.startLoad())}},e.prototype.loadLevel=function(){if(d.logger.debug("call to loadLevel"),null!==this.currentLevelIndex&&this.canload){var e=this._levels[this.currentLevelIndex];if("object"==typeof e&&0<e.url.length){var t=this.currentLevelIndex,r=e.urlId,i=e.url[r];d.logger.log("Attempt loading level index "+t+" with URL-id "+r),this.hls.trigger(c.default.LEVEL_LOADING,{url:i,level:t,id:r})}}},Object.defineProperty(e.prototype,"nextLoadLevel",{get:function(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)},enumerable:!0,configurable:!0}),e}(a.default));t.default=o},"./src/controller/level-helper.js":function(e,t,r){!function(f){Object.defineProperty(t,"__esModule",{value:!0});var o=r("./src/utils/logger.js");function p(e,t,r){var i=e[t],n=e[r],a=n.startPTS;f.isFinite(a)?t<r?(i.duration=a-i.start,i.duration<0&&o.logger.warn("negative duration computed for frag "+i.sn+",level "+i.level+", there should be some duration drift between playlist and fragment!")):(n.duration=i.start-a,n.duration<0&&o.logger.warn("negative duration computed for frag "+n.sn+",level "+n.level+", there should be some duration drift between playlist and fragment!")):n.start=t<r?i.start+i.duration:Math.max(i.start-n.duration,0)}function s(e,t,r,i,n,a){var o=r;if(f.isFinite(t.startPTS)){var s=Math.abs(t.startPTS-r);t.deltaPTS=f.isFinite(t.deltaPTS)?Math.max(s,t.deltaPTS):s,o=Math.max(r,t.startPTS),r=Math.min(r,t.startPTS),i=Math.max(i,t.endPTS),n=Math.min(n,t.startDTS),a=Math.max(a,t.endDTS)}var l=r-t.start;t.start=t.startPTS=r,t.maxStartPTS=o,t.endPTS=i,t.startDTS=n,t.endDTS=a,t.duration=i-r;var u,c,d,h=t.sn;if(!e||h<e.startSN||e.endSN<h)return 0;for((c=e.fragments)[u=h-e.startSN]=t,d=u;0<d;d--)p(c,d,d-1);for(d=u;d<c.length-1;d++)p(c,d,d+1);return e.PTSKnown=!0,l}function l(e,t,r){if(e&&t)for(var i=Math.max(e.startSN,t.startSN)-t.startSN,n=Math.min(e.endSN,t.endSN)-t.startSN,a=t.startSN-e.startSN,o=i;o<=n;o++){var s=e.fragments[a+o],l=t.fragments[o];if(!s||!l)break;r(s,l,o)}}function u(e,t){var r=t.startSN-e.startSN,i=e.fragments,n=t.fragments;if(!(r<0||i.length<r))for(var a=0;a<n.length;a++)n[a].start+=i[r].start}t.addGroupId=function(e,t,r){switch(t){case"audio":e.audioGroupIds||(e.audioGroupIds=[]),e.audioGroupIds.push(r);break;case"text":e.textGroupIds||(e.textGroupIds=[]),e.textGroupIds.push(r)}},t.updatePTS=p,t.updateFragPTSDTS=s,t.mergeDetails=function(e,r){r.initSegment&&e.initSegment&&(r.initSegment=e.initSegment);var i,n=0;if(l(e,r,function(e,t){n=e.cc-t.cc,f.isFinite(e.startPTS)&&(t.start=t.startPTS=e.startPTS,t.endPTS=e.endPTS,t.duration=e.duration,t.backtracked=e.backtracked,t.dropped=e.dropped,i=t),r.PTSKnown=!0}),r.PTSKnown){if(n){o.logger.log("discontinuity sliding from playlist, take drift into account");for(var t=r.fragments,a=0;a<t.length;a++)t[a].cc+=n}i?s(r,i,i.startPTS,i.endPTS,i.startDTS,i.endDTS):u(e,r),r.PTSKnown=e.PTSKnown}},t.mergeSubtitlePlaylists=function(e,t,r){void 0===r&&(r=0);var i=-1;l(e,t,function(e,t,r){t.start=e.start,i=r});var n=t.fragments;if(i<0)n.forEach(function(e){e.start+=r});else for(var a=i+1;a<n.length;a++)n[a].start=n[a-1].start+n[a-1].duration},t.mapFragmentIntersection=l,t.adjustSliding=u,t.computeReloadInterval=function(e,t,r){var i=1e3*(t.averagetargetduration?t.averagetargetduration:t.targetduration),n=i/2;return e&&t.endSN===e.endSN&&(i=n),r&&(i=Math.max(n,i-(window.performance.now()-r))),Math.round(i)}}(r("./src/polyfills/number.js").Number)},"./src/controller/stream-controller.js":function(e,l,b){(function(u){var i,t=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(l,"__esModule",{value:!0});var f=b("./src/utils/binary-search.js"),h=b("./src/utils/buffer-helper.js"),d=b("./src/demux/demuxer.js"),p=b("./src/events.js"),r=b("./src/controller/fragment-tracker.js"),c=b("./src/loader/fragment.js"),n=b("./src/loader/playlist-loader.js"),g=b("./src/controller/level-helper.js"),a=b("./src/utils/time-ranges.js"),o=b("./src/errors.js"),m=b("./src/utils/logger.js"),v=b("./src/utils/discontinuities.js"),y=b("./src/controller/fragment-finders.js"),s=b("./src/controller/gap-controller.js"),_=b("./src/controller/base-stream-controller.js"),e=function(i){function e(e,t){var r=i.call(this,e,p.default.MEDIA_ATTACHED,p.default.MEDIA_DETACHING,p.default.MANIFEST_LOADING,p.default.MANIFEST_PARSED,p.default.LEVEL_LOADED,p.default.KEY_LOADED,p.default.FRAG_LOADED,p.default.FRAG_LOAD_EMERGENCY_ABORTED,p.default.FRAG_PARSING_INIT_SEGMENT,p.default.FRAG_PARSING_DATA,p.default.FRAG_PARSED,p.default.ERROR,p.default.AUDIO_TRACK_SWITCHING,p.default.AUDIO_TRACK_SWITCHED,p.default.BUFFER_CREATED,p.default.BUFFER_APPENDED,p.default.BUFFER_FLUSHED)||this;return r.fragmentTracker=t,r.config=e.config,r.audioCodecSwap=!1,r._state=_.State.STOPPED,r.stallReported=!1,r.gapController=null,r}return t(e,i),e.prototype.startLoad=function(e){if(this.levels){var t=this.lastCurrentTime,r=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var i=r.startLevel;-1===i&&(this.bitrateTest=!(i=0)),this.level=r.nextLoadLevel=i,this.loadedmetadata=!1}0<t&&-1===e&&(m.logger.log("override startPosition with lastCurrentTime @"+t.toFixed(3)),e=t),this.state=_.State.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this.forceStartLoad=!0,this.state=_.State.STOPPED},e.prototype.stopLoad=function(){this.forceStartLoad=!1,i.prototype.stopLoad.call(this)},e.prototype.doTick=function(){switch(this.state){case _.State.BUFFER_FLUSHING:this.fragLoadError=0;break;case _.State.IDLE:this._doTickIdle();break;case _.State.WAITING_LEVEL:var e=this.levels[this.level];e&&e.details&&(this.state=_.State.IDLE);break;case _.State.FRAG_LOADING_WAITING_RETRY:var t=window.performance.now(),r=this.retryDate;(!r||r<=t||this.media&&this.media.seeking)&&(m.logger.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=_.State.IDLE)}this._checkBuffer(),this._checkFragmentChanged()},e.prototype._doTickIdle=function(){var e=this.hls,t=e.config,r=this.media;if(void 0!==this.levelLastLoaded&&(r||!this.startFragRequested&&t.startFragPrefetch)){var i;i=this.loadedmetadata?r.currentTime:this.nextLoadPosition;var n=e.nextLoadLevel,a=this.levels[n];if(a){var o,s=a.bitrate;o=Math.min(o=s?Math.max(8*t.maxBufferSize/s,t.maxBufferLength):t.maxBufferLength,t.maxMaxBufferLength);var l=h.BufferHelper.bufferInfo(this.mediaBuffer?this.mediaBuffer:r,i,t.maxBufferHole),u=l.len;if(!(o<=u)){m.logger.trace("buffer length of "+u.toFixed(3)+" is below max of "+o.toFixed(3)+". checking for more payload ..."),this.level=e.nextLoadLevel=n;var c=a.details;if(!c||c.live&&this.levelLastLoaded!==n)this.state=_.State.WAITING_LEVEL;else{if(this._streamEnded(l,c)){var d={};return this.altAudio&&(d.type="video"),this.hls.trigger(p.default.BUFFER_EOS,d),void(this.state=_.State.ENDED)}this._fetchPayloadOrEos(i,l,c)}}}}},e.prototype._fetchPayloadOrEos=function(e,t,r){var i=this.fragPrevious,n=this.level,a=r.fragments,o=a.length;if(0!==o){var s,l=a[0].start,u=a[o-1].start+a[o-1].duration,c=t.end;if(r.initSegment&&!r.initSegment.data)s=r.initSegment;else if(r.live){var d=this.config.initialLiveManifestSize;if(o<d)return void m.logger.warn("Can not start playback of a level, reason: not enough fragments "+o+" < "+d);if(null===(s=this._ensureFragmentAtLivePoint(r,c,l,u,i,a,o)))return}else c<l&&(s=a[0]);s||(s=this._findFragment(l,i,o,a,c,u,r)),s&&(s.encrypted?(m.logger.log("Loading key for "+s.sn+" of ["+r.startSN+" ,"+r.endSN+"],level "+n),this._loadKey(s)):(m.logger.log("Loading "+s.sn+" of ["+r.startSN+" ,"+r.endSN+"],level "+n+", currentTime:"+e.toFixed(3)+",bufferEnd:"+c.toFixed(3)),this._loadFragment(s)))}},e.prototype._ensureFragmentAtLivePoint=function(e,t,r,i,n,a,o){var s,l=this.hls.config,u=this.media;if(t<Math.max(r-l.maxFragLookUpTolerance,i-(void 0!==l.liveMaxLatencyDuration?l.liveMaxLatencyDuration:l.liveMaxLatencyDurationCount*e.targetduration))){var c=this.liveSyncPosition=this.computeLivePosition(r,e);m.logger.log("buffer end: "+t.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+c.toFixed(3)),t=c,u&&u.readyState&&c<u.duration&&(u.currentTime=c),this.nextLoadPosition=c}if(e.PTSKnown&&i<t&&u&&u.readyState)return null;if(this.startFragRequested&&!e.PTSKnown){if(n)if(e.hasProgramDateTime)m.logger.log("live playlist, switching playlist, load frag with same PDT: "+n.programDateTime),s=y.findFragmentByPDT(a,n.endProgramDateTime,l.maxFragLookUpTolerance);else{var d=n.sn+1;if(e.startSN<=d&&d<=e.endSN){var h=a[d-e.startSN];n.cc===h.cc&&m.logger.log("live playlist, switching playlist, load frag with next SN: "+(s=h).sn)}s||(s=f.default.search(a,function(e){return n.cc-e.cc}))&&m.logger.log("live playlist, switching playlist, load frag with same CC: "+s.sn)}s||m.logger.log("live playlist, switching playlist, unknown, load middle frag : "+(s=a[Math.min(o-1,Math.round(o/2))]).sn)}return s},e.prototype._findFragment=function(e,t,r,i,n,a,o){var s,l=this.hls.config;n<a?s=y.findFragmentByPTS(t,i,n,a-l.maxFragLookUpTolerance<n?0:l.maxFragLookUpTolerance):s=i[r-1];if(s){var u=s.sn-o.startSN,c=i[u-1],d=i[u+1];if(t&&s.sn===t.sn)if(t&&s.level===t.level&&!s.backtracked)if(s.sn<o.endSN){var h=t.deltaPTS;h&&l.maxBufferHole<h&&t.dropped&&u?(s=c,m.logger.warn("SN just loaded, with large PTS gap between audio and video, maybe frag is not starting with a keyframe ? load previous one to try to overcome this")):m.logger.log("SN just loaded, load next one: "+(s=d).sn,s)}else s=null;else s.backtracked&&(d&&d.backtracked?(m.logger.warn("Already backtracked from fragment "+d.sn+", will not backtrack to fragment "+s.sn+". Loading fragment "+d.sn),s=d):(m.logger.warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe"),s.dropped=0,c?(s=c).backtracked=!0:u&&(s=null)))}return s},e.prototype._loadKey=function(e){this.state=_.State.KEY_LOADING,this.hls.trigger(p.default.KEY_LOADING,{frag:e})},e.prototype._loadFragment=function(e){var t=this.fragmentTracker.getState(e);this.fragCurrent=e,this.startFragRequested=!0,u.isFinite(e.sn)&&!e.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),e.backtracked||t===r.FragmentState.NOT_LOADED||t===r.FragmentState.PARTIAL?(e.autoLevel=this.hls.autoLevelEnabled,e.bitrateTest=this.bitrateTest,this.hls.trigger(p.default.FRAG_LOADING,{frag:e}),this.demuxer||(this.demuxer=new d.default(this.hls,"main")),this.state=_.State.FRAG_LOADING):t===r.FragmentState.APPENDING&&this._reduceMaxBufferLength(e.duration)&&this.fragmentTracker.removeFragment(e)},Object.defineProperty(e.prototype,"state",{get:function(){return this._state},set:function(e){if(this.state!==e){var t=this.state;m.logger.log("main stream:"+t+"->"+(this._state=e)),this.hls.trigger(p.default.STREAM_STATE_TRANSITION,{previousState:t,nextState:e})}},enumerable:!0,configurable:!0}),e.prototype.getBufferedFrag=function(e){return this.fragmentTracker.getBufferedFrag(e,n.default.LevelType.MAIN)},Object.defineProperty(e.prototype,"currentLevel",{get:function(){var e=this.media;if(e){var t=this.getBufferedFrag(e.currentTime);if(t)return t.level}return-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextBufferedFrag",{get:function(){var e=this.media;return e?this.followingBufferedFrag(this.getBufferedFrag(e.currentTime)):null},enumerable:!0,configurable:!0}),e.prototype.followingBufferedFrag=function(e){return e?this.getBufferedFrag(e.endPTS+.5):null},Object.defineProperty(e.prototype,"nextLevel",{get:function(){var e=this.nextBufferedFrag;return e?e.level:-1},enumerable:!0,configurable:!0}),e.prototype._checkFragmentChanged=function(){var e,t,r=this.media;if(r&&r.readyState&&!1===r.seeking&&(this.lastCurrentTime<(t=r.currentTime)&&(this.lastCurrentTime=t),h.BufferHelper.isBuffered(r,t)?e=this.getBufferedFrag(t):h.BufferHelper.isBuffered(r,t+.1)&&(e=this.getBufferedFrag(t+.1)),e)){var i=e;if(i!==this.fragPlaying){this.hls.trigger(p.default.FRAG_CHANGED,{frag:i});var n=i.level;this.fragPlaying&&this.fragPlaying.level===n||this.hls.trigger(p.default.LEVEL_SWITCHED,{level:n}),this.fragPlaying=i}}},e.prototype.immediateLevelSwitch=function(){if(m.logger.log("immediateLevelSwitch"),!this.immediateSwitch){this.immediateSwitch=!0;var e=this.media,t=void 0;e?(t=e.paused,e.pause()):t=!0,this.previouslyPaused=t}var r=this.fragCurrent;r&&r.loader&&r.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(0,u.POSITIVE_INFINITY)},e.prototype.immediateLevelSwitchEnd=function(){var e=this.media;e&&e.buffered.length&&(this.immediateSwitch=!1,h.BufferHelper.isBuffered(e,e.currentTime)&&(e.currentTime-=1e-4),this.previouslyPaused||e.play())},e.prototype.nextLevelSwitch=function(){var e=this.media;if(e&&e.readyState){var t,r=void 0,i=void 0;if((t=this.getBufferedFrag(e.currentTime))&&1<t.startPTS&&this.flushMainBuffer(0,t.startPTS-1),e.paused)r=0;else{var n=this.fragLastKbps;r=n&&this.fragCurrent?this.fragCurrent.duration*this.levels[this.hls.nextLoadLevel].bitrate/(1e3*n)+1:0}if((i=this.getBufferedFrag(e.currentTime+r))&&(i=this.followingBufferedFrag(i))){var a=this.fragCurrent;a&&a.loader&&a.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(i.maxStartPTS,u.POSITIVE_INFINITY)}}},e.prototype.flushMainBuffer=function(e,t){this.state=_.State.BUFFER_FLUSHING;var r={startOffset:e,endOffset:t};this.altAudio&&(r.type="video"),this.hls.trigger(p.default.BUFFER_FLUSHING,r)},e.prototype.onMediaAttached=function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("seeked",this.onvseeked),t.addEventListener("ended",this.onvended);var r=this.config;this.levels&&r.autoStartLoad&&this.hls.startLoad(r.startPosition),this.gapController=new s.default(r,t,this.fragmentTracker,this.hls)},e.prototype.onMediaDetaching=function(){var e=this.media;e&&e.ended&&(m.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var t=this.levels;t&&t.forEach(function(e){e.details&&e.details.fragments.forEach(function(e){e.backtracked=void 0})}),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("seeked",this.onvseeked),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()},e.prototype.onMediaSeeked=function(){var e=this.media,t=e?e.currentTime:void 0;u.isFinite(t)&&m.logger.log("media seeked to "+t.toFixed(3)),this.tick()},e.prototype.onManifestLoading=function(){m.logger.log("trigger BUFFER_RESET"),this.hls.trigger(p.default.BUFFER_RESET),this.fragmentTracker.removeAllFragments(),this.stalled=!1,this.startPosition=this.lastCurrentTime=0},e.prototype.onManifestParsed=function(e){var t,r=!1,i=!1;e.levels.forEach(function(e){(t=e.audioCodec)&&(-1!=t.indexOf("mp4a.40.2")&&(r=!0),-1!=t.indexOf("mp4a.40.5")&&(i=!0))}),this.audioCodecSwitch=r&&i,this.audioCodecSwitch&&m.logger.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=e.levels,this.startFragRequested=!1;var n=this.config;(n.autoStartLoad||this.forceStartLoad)&&this.hls.startLoad(n.startPosition)},e.prototype.onLevelLoaded=function(e){var t=e.details,r=e.level,i=this.levels[this.levelLastLoaded],n=this.levels[r],a=t.totalduration,o=0;if(m.logger.log("level "+r+" loaded ["+t.startSN+","+t.endSN+"],duration:"+a),t.live){var s=n.details;s&&0<t.fragments.length?(g.mergeDetails(s,t),this.liveSyncPosition=this.computeLivePosition(o=t.fragments[0].start,s),t.PTSKnown&&u.isFinite(o)?m.logger.log("live playlist sliding:"+o.toFixed(3)):(m.logger.log("live playlist - outdated PTS, unknown sliding"),v.alignStream(this.fragPrevious,i,t))):(m.logger.log("live playlist - first load, unknown sliding"),t.PTSKnown=!1,v.alignStream(this.fragPrevious,i,t))}else t.PTSKnown=!1;if(n.details=t,this.levelLastLoaded=r,this.hls.trigger(p.default.LEVEL_UPDATED,{details:t,level:r}),!1===this.startFragRequested){if(-1===this.startPosition||-1===this.lastCurrentTime){var l=t.startTimeOffset;u.isFinite(l)?(l<0&&(m.logger.log("negative start time offset "+l+", count from end of last fragment"),l=o+a+l),m.logger.log("start time offset found in playlist, adjust startPosition to "+l),this.startPosition=l):t.live?(this.startPosition=this.computeLivePosition(o,t),m.logger.log("configure startPosition to "+this.startPosition)):this.startPosition=0,this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}this.state===_.State.WAITING_LEVEL&&(this.state=_.State.IDLE),this.tick()},e.prototype.onKeyLoaded=function(){this.state===_.State.KEY_LOADING&&(this.state=_.State.IDLE,this.tick())},e.prototype.onFragLoaded=function(e){var t=this.fragCurrent,r=this.hls,i=this.media,n=e.frag;if(this.state===_.State.FRAG_LOADING&&t&&"main"===n.type&&n.level===t.level&&n.sn===t.sn){var a=e.stats,o=this.levels[t.level],s=o.details;if(this.bitrateTest=!1,this.stats=a,m.logger.log("Loaded "+t.sn+" of ["+s.startSN+" ,"+s.endSN+"],level "+t.level),n.bitrateTest&&r.nextLoadLevel)this.state=_.State.IDLE,this.startFragRequested=!1,a.tparsed=a.tbuffered=window.performance.now(),r.trigger(p.default.FRAG_BUFFERED,{stats:a,frag:t,id:"main"}),this.tick();else if("initSegment"===n.sn)this.state=_.State.IDLE,a.tparsed=a.tbuffered=window.performance.now(),s.initSegment.data=e.payload,r.trigger(p.default.FRAG_BUFFERED,{stats:a,frag:t,id:"main"}),this.tick();else{m.logger.log("Parsing "+t.sn+" of ["+s.startSN+" ,"+s.endSN+"],level "+t.level+", cc "+t.cc),this.state=_.State.PARSING,this.pendingBuffering=!0,this.appended=!1,n.bitrateTest&&(n.bitrateTest=!1,this.fragmentTracker.onFragLoaded({frag:n}));var l=!(i&&i.seeking)&&(s.PTSKnown||!s.live),u=s.initSegment?s.initSegment.data:[],c=this._getAudioCodec(o);(this.demuxer=this.demuxer||new d.default(this.hls,"main")).push(e.payload,u,c,o.videoCodec,t,s.totalduration,l)}}this.fragLoadError=0},e.prototype.onFragParsingInitSegment=function(e){var t=this.fragCurrent,r=e.frag;if(t&&"main"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===_.State.PARSING){var i=e.tracks,n=void 0,a=void 0;if(i.audio&&this.altAudio&&delete i.audio,a=i.audio){var o=this.levels[this.level].audioCodec,s=navigator.userAgent.toLowerCase();o&&this.audioCodecSwap&&(m.logger.log("swapping playlist audio codec"),o=-1!=o.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),this.audioCodecSwitch&&1!==a.metadata.channelCount&&-1==s.indexOf("firefox")&&(o="mp4a.40.5"),-1!=s.indexOf("android")&&"audio/mpeg"!==a.container&&m.logger.log("Android: force audio codec to "+(o="mp4a.40.2")),a.levelCodec=o,a.id=e.id}for(n in(a=i.video)&&(a.levelCodec=this.levels[this.level].videoCodec,a.id=e.id),this.hls.trigger(p.default.BUFFER_CODECS,i),i){m.logger.log("main track:"+n+",container:"+(a=i[n]).container+",codecs[level/parsed]=["+a.levelCodec+"/"+a.codec+"]");var l=a.initSegment;l&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(p.default.BUFFER_APPENDING,{type:n,data:l,parent:"main",content:"initSegment"}))}this.tick()}},e.prototype.onFragParsingData=function(t){var r=this,e=this.fragCurrent,i=t.frag;if(e&&"main"===t.id&&i.sn===e.sn&&i.level===e.level&&("audio"!==t.type||!this.altAudio)&&this.state===_.State.PARSING){var n=this.levels[this.level],a=e;if(u.isFinite(t.endPTS)||(t.endPTS=t.startPTS+e.duration,t.endDTS=t.startDTS+e.duration),!0===t.hasAudio&&a.addElementaryStream(c.default.ElementaryStreamTypes.AUDIO),!0===t.hasVideo&&a.addElementaryStream(c.default.ElementaryStreamTypes.VIDEO),m.logger.log("Parsed "+t.type+",PTS:["+t.startPTS.toFixed(3)+","+t.endPTS.toFixed(3)+"],DTS:["+t.startDTS.toFixed(3)+"/"+t.endDTS.toFixed(3)+"],nb:"+t.nb+",dropped:"+(t.dropped||0)),"video"===t.type)if(a.dropped=t.dropped,a.dropped)if(a.backtracked)m.logger.warn("Already backtracked on this fragment, appending with the gap",a.sn);else{var o=n.details;if(!o||a.sn!==o.startSN)return m.logger.warn("missing video frame(s), backtracking fragment",a.sn),this.fragmentTracker.removeFragment(a),a.backtracked=!0,this.nextLoadPosition=t.startPTS,this.state=_.State.IDLE,this.fragPrevious=a,void this.tick();m.logger.warn("missing video frame(s) on first frag, appending with gap",a.sn)}else a.backtracked=!1;var s=g.updateFragPTSDTS(n.details,a,t.startPTS,t.endPTS,t.startDTS,t.endDTS),l=this.hls;l.trigger(p.default.LEVEL_PTS_UPDATED,{details:n.details,level:this.level,drift:s,type:t.type,start:t.startPTS,end:t.endPTS}),[t.data1,t.data2].forEach(function(e){e&&e.length&&r.state===_.State.PARSING&&(r.appended=!0,r.pendingBuffering=!0,l.trigger(p.default.BUFFER_APPENDING,{type:t.type,data:e,parent:"main",content:"data"}))}),this.tick()}},e.prototype.onFragParsed=function(e){var t=this.fragCurrent,r=e.frag;t&&"main"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===_.State.PARSING&&(this.stats.tparsed=window.performance.now(),this.state=_.State.PARSED,this._checkAppendedParsed())},e.prototype.onAudioTrackSwitching=function(e){var t=e.id;if(!!!e.url){if(this.mediaBuffer!==this.media){m.logger.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var r=this.fragCurrent;r.loader&&(m.logger.log("switching to main audio track, cancel main fragment load"),r.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=_.State.IDLE}var i=this.hls;i.trigger(p.default.BUFFER_FLUSHING,{startOffset:0,endOffset:u.POSITIVE_INFINITY,type:"audio"}),i.trigger(p.default.AUDIO_TRACK_SWITCHED,{id:t}),this.altAudio=!1}},e.prototype.onAudioTrackSwitched=function(e){var t=!!this.hls.audioTracks[e.id].url;if(t){var r=this.videoBuffer;r&&this.mediaBuffer!==r&&(m.logger.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=r)}this.altAudio=t,this.tick()},e.prototype.onBufferCreated=function(e){var t,r,i=e.tracks,n=!1;for(var a in i){var o=i[a];"main"===o.id?(t=o,"video"===(r=a)&&(this.videoBuffer=i[a].buffer)):n=!0}this.mediaBuffer=n&&t?(m.logger.log("alternate track found, use "+r+".buffered to schedule main fragment loading"),t.buffer):this.media},e.prototype.onBufferAppended=function(e){if("main"===e.parent){var t=this.state;t!==_.State.PARSING&&t!==_.State.PARSED||(this.pendingBuffering=0<e.pending,this._checkAppendedParsed())}},e.prototype._checkAppendedParsed=function(){if(!(this.state!==_.State.PARSED||this.appended&&this.pendingBuffering)){var e=this.fragCurrent;if(e){m.logger.log("main buffered : "+a.default.toString((this.mediaBuffer?this.mediaBuffer:this.media).buffered)),this.fragPrevious=e;var t=this.stats;t.tbuffered=window.performance.now(),this.fragLastKbps=Math.round(8*t.total/(t.tbuffered-t.tfirst)),this.hls.trigger(p.default.FRAG_BUFFERED,{stats:t,frag:e,id:"main"}),this.state=_.State.IDLE}this.tick()}},e.prototype.onError=function(e){var t=e.frag||this.fragCurrent;if(!t||"main"===t.type){var r=!!this.media&&h.BufferHelper.isBuffered(this.media,this.media.currentTime)&&h.BufferHelper.isBuffered(this.media,this.media.currentTime+.5);switch(e.details){case o.ErrorDetails.FRAG_LOAD_ERROR:case o.ErrorDetails.FRAG_LOAD_TIMEOUT:case o.ErrorDetails.KEY_LOAD_ERROR:case o.ErrorDetails.KEY_LOAD_TIMEOUT:if(!e.fatal)if(this.fragLoadError+1<=this.config.fragLoadingMaxRetry){var i=Math.min(Math.pow(2,this.fragLoadError)*this.config.fragLoadingRetryDelay,this.config.fragLoadingMaxRetryTimeout);m.logger.warn("mediaController: frag loading failed, retry in "+i+" ms"),this.retryDate=window.performance.now()+i,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.fragLoadError++,this.state=_.State.FRAG_LOADING_WAITING_RETRY}else m.logger.error("mediaController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.state=_.State.ERROR;break;case o.ErrorDetails.LEVEL_LOAD_ERROR:case o.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==_.State.ERROR&&(e.fatal?(this.state=_.State.ERROR,m.logger.warn("streamController: "+e.details+",switch to "+this.state+" state ...")):e.levelRetry||this.state!==_.State.WAITING_LEVEL||(this.state=_.State.IDLE));break;case o.ErrorDetails.BUFFER_FULL_ERROR:"main"!==e.parent||this.state!==_.State.PARSING&&this.state!==_.State.PARSED||(r?(this._reduceMaxBufferLength(this.config.maxBufferLength),this.state=_.State.IDLE):(m.logger.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,u.POSITIVE_INFINITY)))}}},e.prototype._reduceMaxBufferLength=function(e){var t=this.config;return e<=t.maxMaxBufferLength&&(t.maxMaxBufferLength/=2,m.logger.warn("main:reduce max buffer length to "+t.maxMaxBufferLength+"s"),!0)},e.prototype._checkBuffer=function(){var e=this.media;if(e&&0!==e.readyState){var t=(this.mediaBuffer?this.mediaBuffer:e).buffered;!this.loadedmetadata&&t.length?(this.loadedmetadata=!0,this._seekToStartPos()):this.immediateSwitch?this.immediateLevelSwitchEnd():this.gapController.poll(this.lastCurrentTime,t)}},e.prototype.onFragLoadEmergencyAborted=function(){this.state=_.State.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()},e.prototype.onBufferFlushed=function(){var e=this.mediaBuffer?this.mediaBuffer:this.media;e&&this.fragmentTracker.detectEvictedFragments(c.default.ElementaryStreamTypes.VIDEO,e.buffered),this.state=_.State.IDLE,this.fragPrevious=null},e.prototype.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},e.prototype.computeLivePosition=function(e,t){return e+Math.max(0,t.totalduration-(void 0!==this.config.liveSyncDuration?this.config.liveSyncDuration:this.config.liveSyncDurationCount*t.targetduration))},e.prototype._seekToStartPos=function(){var e=this.media,t=e.currentTime,r=e.seeking?t:this.startPosition;t!==r&&(m.logger.log("target start position not buffered, seek to buffered.start(0) "+r+" from current time "+t+" "),e.currentTime=r)},e.prototype._getAudioCodec=function(e){var t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&(m.logger.log("swapping playlist audio codec"),t&&(t=-1!=t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5")),t},Object.defineProperty(e.prototype,"liveSyncPosition",{get:function(){return this._liveSyncPosition},set:function(e){this._liveSyncPosition=e},enumerable:!0,configurable:!0}),e}(_.default);l.default=e}).call(this,b("./src/polyfills/number.js").Number)},"./src/controller/subtitle-stream-controller.js":function(e,t,r){var i,n=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var g=r("./src/events.js"),m=r("./src/utils/logger.js"),a=r("./src/crypt/decrypter.js"),v=r("./src/utils/buffer-helper.js"),y=r("./src/controller/fragment-finders.js"),_=r("./src/controller/fragment-tracker.js"),b=r("./src/controller/base-stream-controller.js"),o=r("./src/controller/level-helper.js"),s=window.performance,l=function(i){function e(e,t){var r=i.call(this,e,g.default.MEDIA_ATTACHED,g.default.MEDIA_DETACHING,g.default.ERROR,g.default.KEY_LOADED,g.default.FRAG_LOADED,g.default.SUBTITLE_TRACKS_UPDATED,g.default.SUBTITLE_TRACK_SWITCH,g.default.SUBTITLE_TRACK_LOADED,g.default.SUBTITLE_FRAG_PROCESSED,g.default.LEVEL_UPDATED)||this;return r.fragmentTracker=t,r.config=e.config,r.state=b.State.STOPPED,r.tracks=[],r.tracksBuffered=[],r.currentTrackId=-1,r.decrypter=new a.default(e,e.config),r.lastAVStart=0,r._onMediaSeeking=r.onMediaSeeking.bind(r),r}return n(e,i),e.prototype.onSubtitleFragProcessed=function(e){var t=e.frag,r=e.success;if(this.fragPrevious=t,this.state=b.State.IDLE,r){var i=this.tracksBuffered[this.currentTrackId];if(i){for(var n,a=t.start,o=0;o<i.length;o++)if(i[o].start<=a&&a<=i[o].end){n=i[o];break}var s=t.start+t.duration;n?n.end=s:i.push(n={start:a,end:s})}}},e.prototype.onMediaAttached=function(e){var t=e.media;(this.media=t).addEventListener("seeking",this._onMediaSeeking),this.state=b.State.IDLE},e.prototype.onMediaDetaching=function(){this.media.removeEventListener("seeking",this._onMediaSeeking),this.media=null,this.state=b.State.STOPPED},e.prototype.onError=function(e){var t=e.frag;t&&"subtitle"===t.type&&(this.state=b.State.IDLE)},e.prototype.onSubtitleTracksUpdated=function(e){var t=this;m.logger.log("subtitle tracks updated"),this.tracksBuffered=[],this.tracks=e.subtitleTracks,this.tracks.forEach(function(e){t.tracksBuffered[e.id]=[]})},e.prototype.onSubtitleTrackSwitch=function(e){if(this.currentTrackId=e.id,this.tracks&&-1!==this.currentTrackId){var t=this.tracks[this.currentTrackId];t&&t.details&&this.setInterval(500)}else this.clearInterval()},e.prototype.onSubtitleTrackLoaded=function(e){var t=e.id,r=e.details,i=this.currentTrackId,n=this.tracks,a=n[i];n.length<=t||t!==i||!a||(r.live&&o.mergeSubtitlePlaylists(a.details,r,this.lastAVStart),a.details=r,this.setInterval(500))},e.prototype.onKeyLoaded=function(){this.state===b.State.KEY_LOADING&&(this.state=b.State.IDLE)},e.prototype.onFragLoaded=function(e){var t=this.fragCurrent,r=e.frag.decryptdata,i=e.frag,n=this.hls;if(this.state===b.State.FRAG_LOADING&&t&&"subtitle"===e.frag.type&&t.sn===e.frag.sn&&0<e.payload.byteLength&&r&&r.key&&"AES-128"===r.method){var a=s.now();this.decrypter.decrypt(e.payload,r.key.buffer,r.iv.buffer,function(e){var t=s.now();n.trigger(g.default.FRAG_DECRYPTED,{frag:i,payload:e,stats:{tstart:a,tdecrypt:t}})})}},e.prototype.onLevelUpdated=function(e){var t=e.details.fragments;this.lastAVStart=t.length?t[0].start:0},e.prototype.doTick=function(){if(this.media)switch(this.state){case b.State.IDLE:var e=this.config,t=this.currentTrackId,r=this.fragmentTracker,i=this.media,n=this.tracks;if(!n||!n[t]||!n[t].details)break;var a=e.maxBufferHole,o=e.maxFragLookUpTolerance,s=Math.min(e.maxBufferLength,e.maxMaxBufferLength),l=v.BufferHelper.bufferedInfo(this._getBuffered(),i.currentTime,a),u=l.end,c=n[t].details,d=c.fragments,h=d.length;if(s<l.len)return;var f=void 0,p=this.fragPrevious;u<d[h-1].start+d[h-1].duration?(p&&c.hasProgramDateTime&&(f=y.findFragmentByPDT(d,p.endProgramDateTime,o)),f||(f=y.findFragmentByPTS(p,d,u,o))):f=d[h-1],f&&f.encrypted?(m.logger.log("Loading key for "+f.sn),this.state=b.State.KEY_LOADING,this.hls.trigger(g.default.KEY_LOADING,{frag:f})):f&&r.getState(f)===_.FragmentState.NOT_LOADED&&(this.fragCurrent=f,this.state=b.State.FRAG_LOADING,this.hls.trigger(g.default.FRAG_LOADING,{frag:f}))}else this.state=b.State.IDLE},e.prototype.stopLoad=function(){this.lastAVStart=0,i.prototype.stopLoad.call(this)},e.prototype._getBuffered=function(){return this.tracksBuffered[this.currentTrackId]||[]},e.prototype.onMediaSeeking=function(){this.fragPrevious=null},e}(b.default);t.SubtitleStreamController=l},"./src/controller/subtitle-track-controller.js":function(e,r,c){(function(i){var n,t=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var a=c("./src/events.js"),o=c("./src/event-handler.js"),l=c("./src/utils/logger.js"),u=c("./src/controller/level-helper.js"),e=function(r){function e(e){var t=r.call(this,e,a.default.MEDIA_ATTACHED,a.default.MEDIA_DETACHING,a.default.MANIFEST_LOADED,a.default.SUBTITLE_TRACK_LOADED)||this;return t.tracks=[],t.trackId=-1,t.media=null,t.stopped=!0,t.subtitleDisplay=!0,t}return t(e,r),e.prototype.destroy=function(){o.default.prototype.destroy.call(this)},e.prototype.onMediaAttached=function(e){var t=this;this.media=e.media,this.media&&(this.queuedDefaultTrack&&(this.subtitleTrack=this.queuedDefaultTrack,delete this.queuedDefaultTrack),this.trackChangeListener=this._onTextTracksChanged.bind(this),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.subtitlePollingInterval=setInterval(function(){t.trackChangeListener()},500):this.media.textTracks.addEventListener("change",this.trackChangeListener))},e.prototype.onMediaDetaching=function(){this.media&&(this.useTextTrackPolling?clearInterval(this.subtitlePollingInterval):this.media.textTracks.removeEventListener("change",this.trackChangeListener),this.media=null)},e.prototype.onManifestLoaded=function(e){var t=this,r=e.subtitles||[];this.tracks=r,this.hls.trigger(a.default.SUBTITLE_TRACKS_UPDATED,{subtitleTracks:r}),r.forEach(function(e){e.default&&(t.media?t.subtitleTrack=e.id:t.queuedDefaultTrack=e.id)})},e.prototype.onSubtitleTrackLoaded=function(e){var t=this,r=e.id,i=e.details,n=this.trackId,a=this.tracks,o=a[n];if(a.length<=r||r!==n||!o||this.stopped)this._clearReloadTimer();else if(l.logger.log("subtitle track "+r+" loaded"),i.live){var s=u.computeReloadInterval(o.details,i,e.stats.trequest);l.logger.log("Reloading live subtitle playlist in "+s+"ms"),this.timer=setTimeout(function(){t._loadCurrentTrack()},s)}else this._clearReloadTimer()},e.prototype.startLoad=function(){this.stopped=!1,this._loadCurrentTrack()},e.prototype.stopLoad=function(){this.stopped=!0,this._clearReloadTimer()},Object.defineProperty(e.prototype,"subtitleTracks",{get:function(){return this.tracks},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"subtitleTrack",{get:function(){return this.trackId},set:function(e){this.trackId!==e&&(this._toggleTrackModes(e),this._setSubtitleTrackInternal(e))},enumerable:!0,configurable:!0}),e.prototype._clearReloadTimer=function(){this.timer&&(clearTimeout(this.timer),this.timer=null)},e.prototype._loadCurrentTrack=function(){var e=this.trackId,t=this.hls,r=this.tracks[e];e<0||!r||r.details&&!r.details.live||(l.logger.log("Loading subtitle track "+e),t.trigger(a.default.SUBTITLE_TRACK_LOADING,{url:r.url,id:e}))},e.prototype._toggleTrackModes=function(e){var t=this.media,r=this.subtitleDisplay,i=this.trackId;if(t){var n=s(t.textTracks);if(-1===e)[].slice.call(n).forEach(function(e){e.mode="disabled"});else{var a=n[i];a&&(a.mode="disabled")}var o=n[e];o&&(o.mode=r?"showing":"hidden")}},e.prototype._setSubtitleTrackInternal=function(e){var t=this.hls,r=this.tracks;!i.isFinite(e)||e<-1||r.length<=e||(l.logger.log("Switching to subtitle track "+(this.trackId=e)),t.trigger(a.default.SUBTITLE_TRACK_SWITCH,{id:e}),this._loadCurrentTrack())},e.prototype._onTextTracksChanged=function(){if(this.media){for(var e=-1,t=s(this.media.textTracks),r=0;r<t.length;r++)if("hidden"===t[r].mode)e=r;else if("showing"===t[r].mode){e=r;break}this.subtitleTrack=e}},e}(o.default);function s(e){for(var t=[],r=0;r<e.length;r++){var i=e[r];"subtitles"===i.kind&&i.label&&t.push(e[r])}return t}r.default=e}).call(this,c("./src/polyfills/number.js").Number)},"./src/controller/timeline-controller.js":function(e,n,h){(function(o){var i,t=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(n,"__esModule",{value:!0});var s=h("./src/events.js"),r=h("./src/event-handler.js"),a=h("./src/utils/cea-608-parser.js"),l=h("./src/utils/output-filter.js"),u=h("./src/utils/webvtt-parser.js"),c=h("./src/utils/logger.js"),d=h("./src/utils/texttrack-utils.js");var e=function(n){function e(e){var t=n.call(this,e,s.default.MEDIA_ATTACHING,s.default.MEDIA_DETACHING,s.default.FRAG_PARSING_USERDATA,s.default.FRAG_DECRYPTED,s.default.MANIFEST_LOADING,s.default.MANIFEST_LOADED,s.default.FRAG_LOADED,s.default.LEVEL_SWITCHING,s.default.INIT_PTS_FOUND)||this;if(t.hls=e,t.config=e.config,t.enabled=!0,t.Cues=e.config.cueHandler,t.textTracks=[],t.tracks=[],t.unparsedVttFrags=[],t.initPTS=[],t.cueRanges=[],t.captionsTracks={},t.captionsProperties={textTrack1:{label:t.config.captionsTextTrack1Label,languageCode:t.config.captionsTextTrack1LanguageCode},textTrack2:{label:t.config.captionsTextTrack2Label,languageCode:t.config.captionsTextTrack2LanguageCode}},t.config.enableCEA708Captions){var r=new l.default(t,"textTrack1"),i=new l.default(t,"textTrack2");t.cea608Parser=new a.default(0,r,i)}return t}return t(e,n),e.prototype.addCues=function(e,t,r,i){for(var n,a,o=this.cueRanges,s=!1,l=o.length;l--;){var u=o[l],c=(n=u[0],a=t,Math.min(u[1],r)-Math.max(n,a));if(0<=c&&(u[0]=Math.min(u[0],t),u[1]=Math.max(u[1],r),s=!0,.5<c/(r-t)))return}s||o.push([t,r]),this.Cues.newCue(this.captionsTracks[e],t,r,i)},e.prototype.onInitPtsFound=function(e){var t=this;if("main"===e.id&&(this.initPTS[e.frag.cc]=e.initPTS),this.unparsedVttFrags.length){var r=this.unparsedVttFrags;this.unparsedVttFrags=[],r.forEach(function(e){t.onFragLoaded(e)})}},e.prototype.getExistingTrack=function(e){var t=this.media;if(t)for(var r=0;r<t.textTracks.length;r++){var i=t.textTracks[r];if(i[e])return i}return null},e.prototype.createCaptionsTrack=function(e){var t=this.captionsProperties[e],r=t.label,i=t.languageCode,n=this.captionsTracks;if(!n[e]){var a=this.getExistingTrack(e);if(a)n[e]=a,d.clearCurrentCues(n[e]),d.sendAddTrackEvent(n[e],this.media);else{var o=this.createTextTrack("captions",r,i);o&&(o[e]=!0,n[e]=o)}}},e.prototype.createTextTrack=function(e,t,r){var i=this.media;if(i)return i.addTextTrack(e,t,r)},e.prototype.destroy=function(){r.default.prototype.destroy.call(this)},e.prototype.onMediaAttaching=function(e){this.media=e.media,this._cleanTracks()},e.prototype.onMediaDetaching=function(){var t=this.captionsTracks;Object.keys(t).forEach(function(e){d.clearCurrentCues(t[e]),delete t[e]})},e.prototype.onManifestLoading=function(){this.lastSn=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}},this._cleanTracks()},e.prototype._cleanTracks=function(){var e=this.media;if(e){var t=e.textTracks;if(t)for(var r=0;r<t.length;r++)d.clearCurrentCues(t[r])}},e.prototype.onManifestLoaded=function(e){var s=this;if(this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.cueRanges=[],this.config.enableWebVTT){this.tracks=e.subtitles||[];var l=this.media?this.media.textTracks:[];this.tracks.forEach(function(e,t){var r,i,n;if(t<l.length){for(var a=null,o=0;o<l.length;o++)if(n=e,(i=l[o])&&i.label===n.name&&!i.textTrack1&&!i.textTrack2){a=l[o];break}a&&(r=a)}r||(r=s.createTextTrack("subtitles",e.name,e.lang)),r.mode=e.default?s.hls.subtitleDisplay?"showing":"hidden":"disabled",s.textTracks.push(r)})}},e.prototype.onLevelSwitching=function(){this.enabled="NONE"!==this.hls.currentLevel.closedCaptions},e.prototype.onFragLoaded=function(e){var t=e.frag,r=e.payload;if("main"===t.type){var i=t.sn;if(i!==this.lastSn+1){var n=this.cea608Parser;n&&n.reset()}this.lastSn=i}else if("subtitle"===t.type)if(r.byteLength){if(!o.isFinite(this.initPTS[t.cc]))return this.unparsedVttFrags.push(e),void(this.initPTS.length&&this.hls.trigger(s.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t}));var a=t.decryptdata;null!=a&&null!=a.key&&"AES-128"===a.method||this._parseVTTs(t,r)}else this.hls.trigger(s.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t})},e.prototype._parseVTTs=function(t,e){var r=this.vttCCs;r[t.cc]||(r[t.cc]={start:t.start,prevCC:this.prevCC,new:!0},this.prevCC=t.cc);var n=this.textTracks,a=this.hls;u.default.parse(e,this.initPTS[t.cc],r,t.cc,function(e){var i=n[t.level];"disabled"!==i.mode?(e.forEach(function(t){if(!i.cues.getCueById(t.id))try{i.addCue(t)}catch(e){var r=new window.TextTrackCue(t.startTime,t.endTime,t.text);r.id=t.id,i.addCue(r)}}),a.trigger(s.default.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:t})):a.trigger(s.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t})},function(e){c.logger.log("Failed to parse VTT cue: "+e),a.trigger(s.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t})})},e.prototype.onFragDecrypted=function(e){var t=e.payload,r=e.frag;if("subtitle"===r.type){if(!o.isFinite(this.initPTS[r.cc]))return void this.unparsedVttFrags.push(e);this._parseVTTs(r,t)}},e.prototype.onFragParsingUserdata=function(e){if(this.enabled&&this.config.enableCEA708Captions)for(var t=0;t<e.samples.length;t++){var r=this.extractCea608Data(e.samples[t].bytes);this.cea608Parser.addData(e.samples[t].pts,r)}},e.prototype.extractCea608Data=function(e){for(var t,r,i,n=31&e[0],a=2,o=[],s=0;s<n;s++)t=e[a++],r=127&e[a++],i=127&e[a++],0===r&&0===i||0!=(4&t)&&0===(3&t)&&(o.push(r),o.push(i));return o},e}(r.default);n.default=e}).call(this,h("./src/polyfills/number.js").Number)},"./src/crypt/aes-crypto.js":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){this.subtle=e,this.aesIV=t}return e.prototype.decrypt=function(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)},e}();t.default=i},"./src/crypt/aes-decryptor.js":function(e,t,r){function D(e){var t=e.byteLength,r=t&&new DataView(e).getUint8(t-1);return r?e.slice(0,t-r):e}Object.defineProperty(t,"__esModule",{value:!0}),t.removePadding=D;var i=function(){function e(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.initTable()}return e.prototype.uint8ArrayToUint32Array_=function(e){for(var t=new DataView(e),r=new Uint32Array(4),i=0;i<4;i++)r[i]=t.getUint32(4*i);return r},e.prototype.initTable=function(){var e=this.sBox,t=this.invSBox,r=this.subMix,i=r[0],n=r[1],a=r[2],o=r[3],s=this.invSubMix,l=s[0],u=s[1],c=s[2],d=s[3],h=new Uint32Array(256),f=0,p=0,g=0;for(g=0;g<256;g++)h[g]=g<128?g<<1:g<<1^283;for(g=0;g<256;g++){var m=p^p<<1^p<<2^p<<3^p<<4,v=h[t[e[f]=m=m>>>8^255&m^99]=f],y=h[v],_=h[y],b=257*h[m]^16843008*m;i[f]=b<<24|b>>>8,n[f]=b<<16|b>>>16,a[f]=b<<8|b>>>24,o[f]=b,l[m]=(b=16843009*_^65537*y^257*v^16843008*f)<<24|b>>>8,u[m]=b<<16|b>>>16,c[m]=b<<8|b>>>24,d[m]=b,f?(f=v^h[h[h[_^v]]],p^=h[h[p]]):f=p=1}},e.prototype.expandKey=function(e){for(var t=this.uint8ArrayToUint32Array_(e),r=!0,i=0;i<t.length&&r;)r=t[i]===this.key[i],i++;if(!r){this.key=t;var n=this.keySize=t.length;if(4!==n&&6!==n&&8!==n)throw Error("Invalid aes key size="+n);var a,o,s,l,u=this.ksRows=4*(n+6+1),c=this.keySchedule=new Uint32Array(u),d=this.invKeySchedule=new Uint32Array(u),h=this.sBox,f=this.rcon,p=this.invSubMix,g=p[0],m=p[1],v=p[2],y=p[3];for(a=0;a<u;a++)a<n?s=c[a]=t[a]:(l=s,a%n==0?(l=h[(l=l<<8|l>>>24)>>>24]<<24|h[l>>>16&255]<<16|h[l>>>8&255]<<8|h[255&l],l^=f[a/n|0]<<24):6<n&&a%n==4&&(l=h[l>>>24]<<24|h[l>>>16&255]<<16|h[l>>>8&255]<<8|h[255&l]),c[a]=s=(c[a-n]^l)>>>0);for(o=0;o<u;o++)a=u-o,l=3&o?c[a]:c[a-4],d[o]=o<4||a<=4?l:g[h[l>>>24]]^m[h[l>>>16&255]]^v[h[l>>>8&255]]^y[h[255&l]],d[o]=d[o]>>>0}},e.prototype.networkToHostOrderSwap=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},e.prototype.decrypt=function(e,t,r,i){for(var n,a,o,s,l,u,c,d,h,f,p,g,m,v,y=this.keySize+6,_=this.invKeySchedule,b=this.invSBox,T=this.invSubMix,S=T[0],E=T[1],k=T[2],w=T[3],C=this.uint8ArrayToUint32Array_(r),A=C[0],L=C[1],I=C[2],P=C[3],x=new Int32Array(e),R=new Int32Array(x.length),O=this.networkToHostOrderSwap;t<x.length;){for(h=O(x[t]),f=O(x[t+1]),p=O(x[t+2]),g=O(x[t+3]),l=h^_[0],u=g^_[1],c=p^_[2],d=f^_[3],m=4,v=1;v<y;v++)a=S[u>>>24]^E[c>>16&255]^k[d>>8&255]^w[255&l]^_[m+1],o=S[c>>>24]^E[d>>16&255]^k[l>>8&255]^w[255&u]^_[m+2],s=S[d>>>24]^E[l>>16&255]^k[u>>8&255]^w[255&c]^_[m+3],l=n=S[l>>>24]^E[u>>16&255]^k[c>>8&255]^w[255&d]^_[m],u=a,c=o,d=s,m+=4;n=b[l>>>24]<<24^b[u>>16&255]<<16^b[c>>8&255]<<8^b[255&d]^_[m],a=b[u>>>24]<<24^b[c>>16&255]<<16^b[d>>8&255]<<8^b[255&l]^_[m+1],o=b[c>>>24]<<24^b[d>>16&255]<<16^b[l>>8&255]<<8^b[255&u]^_[m+2],s=b[d>>>24]<<24^b[l>>16&255]<<16^b[u>>8&255]<<8^b[255&c]^_[m+3],m+=3,R[t]=O(n^A),R[t+1]=O(s^L),R[t+2]=O(o^I),R[t+3]=O(a^P),A=h,L=f,I=p,P=g,t+=4}return i?D(R.buffer):R.buffer},e.prototype.destroy=function(){this.key=void 0,this.keySize=void 0,this.ksRows=void 0,this.sBox=void 0,this.invSBox=void 0,this.subMix=void 0,this.invSubMix=void 0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.rcon=void 0},e}();t.default=i},"./src/crypt/decrypter.js":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var s=r("./src/crypt/aes-crypto.js"),l=r("./src/crypt/fast-aes-key.js"),u=r("./src/crypt/aes-decryptor.js"),a=r("./src/errors.js"),c=r("./src/utils/logger.js"),o=r("./src/events.js"),d=r("./src/utils/get-self-scope.js").getSelfScope(),i=function(){function e(e,t,r){var i=(void 0===r?{}:r).removePKCS7Padding,n=void 0===i||i;if(this.logEnabled=!0,this.observer=e,this.config=t,this.removePKCS7Padding=n)try{var a=d.crypto;a&&(this.subtle=a.subtle||a.webkitSubtle)}catch(e){}this.disableWebCrypto=!this.subtle}return e.prototype.isSync=function(){return this.disableWebCrypto&&this.config.enableSoftwareAES},e.prototype.decrypt=function(t,r,i,n){var a=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){this.logEnabled&&(c.logger.log("JS AES decrypt"),this.logEnabled=!1);var e=this.decryptor;e||(this.decryptor=e=new u.default),e.expandKey(r),n(e.decrypt(t,0,i,this.removePKCS7Padding))}else{this.logEnabled&&(c.logger.log("WebCrypto AES decrypt"),this.logEnabled=!1);var o=this.subtle;this.key!==r&&(this.key=r,this.fastAesKey=new l.default(o,r)),this.fastAesKey.expandKey().then(function(e){new s.default(o,i).decrypt(t,e).catch(function(e){a.onWebCryptoError(e,t,r,i,n)}).then(function(e){n(e)})}).catch(function(e){a.onWebCryptoError(e,t,r,i,n)})}},e.prototype.onWebCryptoError=function(e,t,r,i,n){this.config.enableSoftwareAES?(c.logger.log("WebCrypto Error, disable WebCrypto API"),this.disableWebCrypto=!0,this.logEnabled=!0,this.decrypt(t,r,i,n)):(c.logger.error("decrypting error : "+e.message),this.observer.trigger(o.default.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!0,reason:e.message}))},e.prototype.destroy=function(){var e=this.decryptor;e&&(e.destroy(),this.decryptor=void 0)},e}();t.default=i},"./src/crypt/fast-aes-key.js":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){this.subtle=e,this.key=t}return e.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},e}();t.default=i},"./src/demux/aacdemuxer.js":function(e,t,r){!function(p){Object.defineProperty(t,"__esModule",{value:!0});var g=r("./src/demux/adts.js"),m=r("./src/utils/logger.js"),v=r("./src/demux/id3.js"),e=function(){function e(e,t,r){this.observer=e,this.config=r,this.remuxer=t}return e.prototype.resetInitSegment=function(e,t,r,i){this._audioTrack={container:"audio/adts",type:"audio",id:0,sequenceNumber:0,isAAC:!0,samples:[],len:0,manifestCodec:t,duration:i,inputTimeScale:9e4}},e.prototype.resetTimeStamp=function(){},e.probe=function(e){if(!e)return!1;for(var t=(v.default.getID3Data(e,0)||[]).length,r=e.length;t<r;t++)if(g.probe(e,t))return m.logger.log("ADTS sync word found !"),!0;return!1},e.prototype.append=function(e,t,r,i){for(var n=this._audioTrack,a=v.default.getID3Data(e,0)||[],o=v.default.getTimeStamp(a),s=p.isFinite(o)?90*o:9e4*t,l=0,u=s,c=e.length,d=a.length,h=[{pts:u,dts:u,data:a}];d<c-1;)if(g.isHeader(e,d)&&d+5<c){g.initTrackConfig(n,this.observer,e,d,n.manifestCodec);var f=g.appendFrame(n,e,d,s,l);if(!f){m.logger.log("Unable to parse AAC frame");break}d+=f.length,u=f.sample.pts,l++}else v.default.isHeader(e,d)?(a=v.default.getID3Data(e,d),h.push({pts:u,dts:u,data:a}),d+=a.length):d++;this.remuxer.remux(n,{samples:[]},{samples:h,inputTimeScale:9e4},{samples:[]},t,r,i)},e.prototype.destroy=function(){},e}();t.default=e}(r("./src/polyfills/number.js").Number)},"./src/demux/adts.js":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var h=r("./src/utils/logger.js"),f=r("./src/errors.js"),p=r("./src/events.js");function o(e,t,r,i){var n,a,o,s,l,u=navigator.userAgent.toLowerCase(),c=i,d=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];if(n=1+((192&t[r+2])>>>6),!(d.length-1<(a=(60&t[r+2])>>>2)))return s=(1&t[r+2])<<2,h.logger.log("manifest codec:"+i+",ADTS data:type:"+n+",sampleingIndex:"+a+"["+d[a]+"Hz],channelConfig:"+(s|=(192&t[r+3])>>>6)),o=/firefox/i.test(u)?6<=a?(n=5,l=Array(4),a-3):(l=Array(n=2),a):-1!=u.indexOf("android")?(l=Array(n=2),a):(n=5,l=Array(4),i&&(-1!=i.indexOf("mp4a.40.29")||-1!=i.indexOf("mp4a.40.5"))||!i&&6<=a?a-3:((i&&-1!=i.indexOf("mp4a.40.2")&&(6<=a&&1===s||/vivaldi/i.test(u))||!i&&1===s)&&(l=Array(n=2)),a)),l[0]=n<<3,l[0]|=(14&a)>>1,l[1]|=(1&a)<<7,l[1]|=s<<3,5===n&&(l[1]|=(14&o)>>1,l[2]=(1&o)<<7,l[2]|=8,l[3]=0),{config:l,samplerate:d[a],channelCount:s,codec:"mp4a.40."+n,manifestCodec:c};e.trigger(p.default.ERROR,{type:f.ErrorTypes.MEDIA_ERROR,details:f.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+a})}function n(e,t){return 255===e[t]&&240==(246&e[t+1])}function l(e,t){return 1&e[t+1]?7:9}function u(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function c(e){return 9216e4/e}function d(e,t,r,i,n){var a,o,s=e.length;if(a=l(e,t),o=u(e,t),0<(o-=a)&&t+a+o<=s)return{headerLength:a,frameLength:o,stamp:r+i*n}}t.getAudioConfig=o,t.isHeaderPattern=n,t.getHeaderLength=l,t.getFullFrameLength=u,t.isHeader=function(e,t){return!!(t+1<e.length&&n(e,t))},t.probe=function(e,t){if(t+1<e.length&&n(e,t)){var r=l(e,t);t+5<e.length&&(r=u(e,t));var i=t+r;if(i===e.length||i+1<e.length&&n(e,i))return!0}return!1},t.initTrackConfig=function(e,t,r,i,n){if(!e.samplerate){var a=o(t,r,i,n);e.config=a.config,e.samplerate=a.samplerate,e.channelCount=a.channelCount,e.codec=a.codec,e.manifestCodec=a.manifestCodec,h.logger.log("parsed codec:"+e.codec+",rate:"+a.samplerate+",nb channel:"+a.channelCount)}},t.getFrameDuration=c,t.parseFrameHeader=d,t.appendFrame=function(e,t,r,i,n){var a=d(t,r,i,n,c(e.samplerate));if(a){var o=a.stamp,s=a.headerLength,l=a.frameLength,u={unit:t.subarray(r+s,r+s+l),pts:o,dts:o};return e.samples.push(u),e.len+=l,{sample:u,length:l+s}}}},"./src/demux/demuxer-inline.js":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var g,E=r("./src/events.js"),k=r("./src/errors.js"),m=r("./src/crypt/decrypter.js"),w=r("./src/demux/aacdemuxer.js"),C=r("./src/demux/mp4demuxer.js"),A=r("./src/demux/tsdemuxer.js"),L=r("./src/demux/mp3demuxer.js"),I=r("./src/remux/mp4-remuxer.js"),P=r("./src/remux/passthrough-remuxer.js"),i=r("./src/utils/get-self-scope.js"),n=r("./src/utils/logger.js"),a=i.getSelfScope();try{g=a.performance.now.bind(a.performance)}catch(e){n.logger.debug("Unable to use Performance API on this environment"),g=a.Date.now}var o=function(){function e(e,t,r,i){this.observer=e,this.typeSupported=t,this.config=r,this.vendor=i}return e.prototype.destroy=function(){var e=this.demuxer;e&&e.destroy()},e.prototype.push=function(e,r,i,n,a,o,s,l,u,c,d,h){var f=this;if(0<e.byteLength&&null!=r&&null!=r.key&&"AES-128"===r.method){var t=this.decrypter;null==t&&(t=this.decrypter=new m.default(this.observer,this.config));var p=g();t.decrypt(e,r.key.buffer,r.iv.buffer,function(e){var t=g();f.observer.trigger(E.default.FRAG_DECRYPTED,{stats:{tstart:p,tdecrypt:t}}),f.pushDecrypted(new Uint8Array(e),r,new Uint8Array(i),n,a,o,s,l,u,c,d,h)})}else this.pushDecrypted(new Uint8Array(e),r,new Uint8Array(i),n,a,o,s,l,u,c,d,h)},e.prototype.pushDecrypted=function(e,t,r,i,n,a,o,s,l,u,c,d){var h=this.demuxer;if(!h||(o||s)&&!this.probe(e)){for(var f=this.observer,p=this.typeSupported,g=this.config,m=[{demux:A.default,remux:I.default},{demux:C.default,remux:P.default},{demux:w.default,remux:I.default},{demux:L.default,remux:I.default}],v=0,y=m.length;v<y;v++){var _=m[v],b=_.demux.probe;if(b(e)){var T=this.remuxer=new _.remux(f,g,p,this.vendor);h=new _.demux(f,T,g,p),this.probe=b;break}}if(!h)return void f.trigger(E.default.ERROR,{type:k.ErrorTypes.MEDIA_ERROR,details:k.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});this.demuxer=h}var S=this.remuxer;(o||s)&&(h.resetInitSegment(r,i,n,u),S.resetInitSegment()),o&&(h.resetTimeStamp(d),S.resetTimeStamp(d)),"function"==typeof h.setDecryptData&&h.setDecryptData(t),h.append(e,a,l,c)},e}();t.default=o},"./src/demux/demuxer-worker.js":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var o=r("./src/demux/demuxer-inline.js"),s=r("./src/events.js"),l=r("./src/utils/logger.js"),u=r("./node_modules/node-libs-browser/node_modules/events/events.js");t.default=function(n){var i=new u.EventEmitter;i.trigger=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];i.emit.apply(i,[e,e].concat(t))},i.off=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];i.removeListener.apply(i,[e].concat(t))};var a=function(e,t){n.postMessage({event:e,data:t})};n.addEventListener("message",function(e){var t=e.data;switch(t.cmd){case"init":var r=JSON.parse(t.config);n.demuxer=new o.default(i,t.typeSupported,r,t.vendor),l.enableLogs(r.debug),a("init",null);break;case"demux":n.demuxer.push(t.data,t.decryptdata,t.initSegment,t.audioCodec,t.videoCodec,t.timeOffset,t.discontinuity,t.trackSwitch,t.contiguous,t.duration,t.accurateTimeOffset,t.defaultInitPTS)}}),i.on(s.default.FRAG_DECRYPTED,a),i.on(s.default.FRAG_PARSING_INIT_SEGMENT,a),i.on(s.default.FRAG_PARSED,a),i.on(s.default.ERROR,a),i.on(s.default.FRAG_PARSING_METADATA,a),i.on(s.default.FRAG_PARSING_USERDATA,a),i.on(s.default.INIT_PTS_FOUND,a),i.on(s.default.FRAG_PARSING_DATA,function(e,t){var r=[],i={event:e,data:t};t.data1&&(i.data1=t.data1.buffer,r.push(t.data1.buffer),delete t.data1),t.data2&&(i.data2=t.data2.buffer,r.push(t.data2.buffer),delete t.data2),n.postMessage(i,r)})}},"./src/demux/demuxer.js":function(e,i,n){!function(m){Object.defineProperty(i,"__esModule",{value:!0});var u=n("./node_modules/webworkify-webpack/index.js"),c=n("./src/events.js"),d=n("./src/demux/demuxer-inline.js"),v=n("./src/utils/logger.js"),h=n("./src/errors.js"),e=n("./src/utils/mediasource-helper.js"),t=n("./src/utils/get-self-scope.js"),f=n("./src/observer.js"),p=t.getSelfScope(),g=e.getMediaSource(),r=function(){function e(r,e){var i=this;this.hls=r,this.id=e;var t=this.observer=new f.Observer,n=r.config,a=function(e,t){(t=t||{}).frag=i.frag,t.id=i.id,r.trigger(e,t)};t.on(c.default.FRAG_DECRYPTED,a),t.on(c.default.FRAG_PARSING_INIT_SEGMENT,a),t.on(c.default.FRAG_PARSING_DATA,a),t.on(c.default.FRAG_PARSED,a),t.on(c.default.ERROR,a),t.on(c.default.FRAG_PARSING_METADATA,a),t.on(c.default.FRAG_PARSING_USERDATA,a),t.on(c.default.INIT_PTS_FOUND,a);var o={mp4:g.isTypeSupported("video/mp4"),mpeg:g.isTypeSupported("audio/mpeg"),mp3:g.isTypeSupported('audio/mp4; codecs="mp3"')},s=navigator.vendor;if(n.enableWorker&&"undefined"!=typeof Worker){v.logger.log("demuxing in webworker");var l=void 0;try{l=this.w=u("./src/demux/demuxer-worker.js"),this.onwmsg=this.onWorkerMessage.bind(this),l.addEventListener("message",this.onwmsg),l.onerror=function(e){r.trigger(c.default.ERROR,{type:h.ErrorTypes.OTHER_ERROR,details:h.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:e.message+" ("+e.filename+":"+e.lineno+")"}})},l.postMessage({cmd:"init",typeSupported:o,vendor:s,id:e,config:JSON.stringify(n)})}catch(e){v.logger.warn("Error in worker:",e),v.logger.error("Error while initializing DemuxerWorker, fallback on DemuxerInline"),l&&p.URL.revokeObjectURL(l.objectURL),this.demuxer=new d.default(t,o,n,s),this.w=void 0}}else this.demuxer=new d.default(t,o,n,s)}return e.prototype.destroy=function(){var e=this.w;if(e)e.removeEventListener("message",this.onwmsg),e.terminate(),this.w=null;else{var t=this.demuxer;t&&(t.destroy(),this.demuxer=null)}var r=this.observer;r&&(r.removeAllListeners(),this.observer=null)},e.prototype.push=function(e,t,r,i,n,a,o,s){var l=this.w,u=m.isFinite(n.startPTS)?n.startPTS:n.start,c=n.decryptdata,d=this.frag,h=!(d&&n.cc===d.cc),f=!(d&&n.level===d.level),p=!f&&(d&&n.sn===d.sn+1);if(h&&v.logger.log(this.id+":discontinuity detected"),f&&v.logger.log(this.id+":switch detected"),this.frag=n,l)l.postMessage({cmd:"demux",data:e,decryptdata:c,initSegment:t,audioCodec:r,videoCodec:i,timeOffset:u,discontinuity:h,trackSwitch:f,contiguous:p,duration:a,accurateTimeOffset:o,defaultInitPTS:s},e instanceof ArrayBuffer?[e]:[]);else{var g=this.demuxer;g&&g.push(e,c,t,r,i,u,h,f,p,a,o,s)}},e.prototype.onWorkerMessage=function(e){var t=e.data,r=this.hls;switch(t.event){case"init":p.URL.revokeObjectURL(this.w.objectURL);break;case c.default.FRAG_PARSING_DATA:t.data.data1=new Uint8Array(t.data1),t.data2&&(t.data.data2=new Uint8Array(t.data2));default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,r.trigger(t.event,t.data)}},e}();i.default=r}(n("./src/polyfills/number.js").Number)},"./src/demux/exp-golomb.js":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var i=r("./src/utils/logger.js"),n=function(){function e(e){this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}return e.prototype.loadWord=function(){var e=this.data,t=this.bytesAvailable,r=e.byteLength-t,i=new Uint8Array(4),n=Math.min(4,t);if(0===n)throw Error("no bytes available");i.set(e.subarray(r,r+n)),this.word=new DataView(i.buffer).getUint32(0),this.bitsAvailable=8*n,this.bytesAvailable-=n},e.prototype.skipBits=function(e){var t;e<this.bitsAvailable||(e-=this.bitsAvailable,e-=(t=e>>3)>>3,this.bytesAvailable-=t,this.loadWord()),this.word<<=e,this.bitsAvailable-=e},e.prototype.readBits=function(e){var t=Math.min(this.bitsAvailable,e),r=this.word>>>32-t;return 32<e&&i.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,0<this.bitsAvailable?this.word<<=t:0<this.bytesAvailable&&this.loadWord(),0<(t=e-t)&&this.bitsAvailable?r<<t|this.readBits(t):r},e.prototype.skipLZ=function(){var e;for(e=0;e<this.bitsAvailable;++e)if(0!=(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()},e.prototype.skipUEG=function(){this.skipBits(1+this.skipLZ())},e.prototype.skipEG=function(){this.skipBits(1+this.skipLZ())},e.prototype.readUEG=function(){var e=this.skipLZ();return this.readBits(e+1)-1},e.prototype.readEG=function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)},e.prototype.readBoolean=function(){return 1===this.readBits(1)},e.prototype.readUByte=function(){return this.readBits(8)},e.prototype.readUShort=function(){return this.readBits(16)},e.prototype.readUInt=function(){return this.readBits(32)},e.prototype.skipScalingList=function(e){var t,r=8,i=8;for(t=0;t<e;t++)0!==i&&(i=(r+this.readEG()+256)%256),r=0===i?r:i},e.prototype.readSPS=function(){var e,t,r,i,n,a,o,s=0,l=0,u=0,c=0,d=this.readUByte.bind(this),h=this.readBits.bind(this),f=this.readUEG.bind(this),p=this.readBoolean.bind(this),g=this.skipBits.bind(this),m=this.skipEG.bind(this),v=this.skipUEG.bind(this),y=this.skipScalingList.bind(this);if(d(),e=d(),h(5),g(3),d(),v(),100===e||110===e||122===e||244===e||44===e||83===e||86===e||118===e||128===e){var _=f();if(3===_&&g(1),v(),v(),g(1),p())for(a=3!==_?8:12,o=0;o<a;o++)p()&&y(o<6?16:64)}v();var b=f();if(0===b)f();else if(1===b)for(g(1),m(),m(),t=f(),o=0;o<t;o++)m();v(),g(1),r=f(),i=f(),0===(n=h(1))&&g(1),g(1),p()&&(s=f(),l=f(),u=f(),c=f());var T=[1,1];if(p()&&p())switch(d()){case 1:T=[1,1];break;case 2:T=[12,11];break;case 3:T=[10,11];break;case 4:T=[16,11];break;case 5:T=[40,33];break;case 6:T=[24,11];break;case 7:T=[20,11];break;case 8:T=[32,11];break;case 9:T=[80,33];break;case 10:T=[18,11];break;case 11:T=[15,11];break;case 12:T=[64,33];break;case 13:T=[160,99];break;case 14:T=[4,3];break;case 15:T=[3,2];break;case 16:T=[2,1];break;case 255:T=[d()<<8|d(),d()<<8|d()]}return{width:Math.ceil(16*(r+1)-2*s-2*l),height:(2-n)*(i+1)*16-(n?2:4)*(u+c),pixelRatio:T}},e.prototype.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},e}();t.default=n},"./src/demux/id3.js":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function s(){}return s.isHeader=function(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},s.isFooter=function(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},s.getID3Data=function(e,t){for(var r=t,i=0;s.isHeader(e,t);){i+=10,i+=s._readSize(e,t+6),s.isFooter(e,t+10)&&(i+=10),t+=i}if(0<i)return e.subarray(r,r+i)},s._readSize=function(e,t){var r=0;return r=(127&e[t])<<21,r|=(127&e[t+1])<<14,r|=(127&e[t+2])<<7,r|=127&e[t+3]},s.getTimeStamp=function(e){for(var t=s.getID3Frames(e),r=0;r<t.length;r++){var i=t[r];if(s.isTimeStampFrame(i))return s._readTimeStamp(i)}},s.isTimeStampFrame=function(e){return e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info},s._getFrameData=function(e){var t=String.fromCharCode(e[0],e[1],e[2],e[3]),r=s._readSize(e,4);return{type:t,size:r,data:e.subarray(10,10+r)}},s.getID3Frames=function(e){for(var t=0,r=[];s.isHeader(e,t);){for(var i=s._readSize(e,t+6),n=(t+=10)+i;t+8<n;){var a=s._getFrameData(e.subarray(t)),o=s._decodeFrame(a);o&&r.push(o),t+=a.size+10}s.isFooter(e,t)&&(t+=10)}return r},s._decodeFrame=function(e){return"PRIV"===e.type?s._decodePrivFrame(e):"T"===e.type[0]?s._decodeTextFrame(e):"W"===e.type[0]?s._decodeURLFrame(e):void 0},s._readTimeStamp=function(e){if(8===e.data.byteLength){var t=new Uint8Array(e.data),r=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return r/=45,1&t[3]&&(r+=47721858.84),Math.round(r)}},s._decodePrivFrame=function(e){if(!(e.size<2)){var t=s._utf8ArrayToStr(e.data,!0),r=new Uint8Array(e.data.subarray(t.length+1));return{key:e.type,info:t,data:r.buffer}}},s._decodeTextFrame=function(e){if(!(e.size<2)){if("TXXX"===e.type){var t=1,r=s._utf8ArrayToStr(e.data.subarray(t)),i=s._utf8ArrayToStr(e.data.subarray(t+=r.length+1));return{key:e.type,info:r,data:i}}var n=s._utf8ArrayToStr(e.data.subarray(1));return{key:e.type,data:n}}},s._decodeURLFrame=function(e){if("WXXX"===e.type){if(e.size<2)return;var t=1,r=s._utf8ArrayToStr(e.data.subarray(t)),i=s._utf8ArrayToStr(e.data.subarray(t+=r.length+1));return{key:e.type,info:r,data:i}}var n=s._utf8ArrayToStr(e.data);return{key:e.type,data:n}},s._utf8ArrayToStr=function(e,t){void 0===t&&(t=!1);for(var r,i,n,a=e.length,o="",s=0;s<a;){if(0===(r=e[s++])&&t)return o;if(0!==r&&3!==r)switch(r>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:o+=String.fromCharCode(r);break;case 12:case 13:i=e[s++],o+=String.fromCharCode((31&r)<<6|63&i);break;case 14:i=e[s++],n=e[s++],o+=String.fromCharCode((15&r)<<12|(63&i)<<6|(63&n)<<0)}}return o},s}();t.utf8ArrayToStr=i._utf8ArrayToStr,t.default=i},"./src/demux/mp3demuxer.js":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var p=r("./src/demux/id3.js"),n=r("./src/utils/logger.js"),g=r("./src/demux/mpegaudio.js"),i=function(){function e(e,t,r){this.observer=e,this.config=r,this.remuxer=t}return e.prototype.resetInitSegment=function(e,t,r,i){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:!1,samples:[],len:0,manifestCodec:t,duration:i,inputTimeScale:9e4}},e.prototype.resetTimeStamp=function(){},e.probe=function(e){var t,r,i=p.default.getID3Data(e,0);if(i&&void 0!==p.default.getTimeStamp(i))for(r=Math.min(e.length-1,(t=i.length)+100);t<r;t++)if(g.default.probe(e,t))return n.logger.log("MPEG Audio sync word found !"),!0;return!1},e.prototype.append=function(e,t,r,i){for(var n=p.default.getID3Data(e,0),a=p.default.getTimeStamp(n),o=a?90*a:9e4*t,s=n.length,l=e.length,u=0,c=0,d=this._audioTrack,h=[{pts:o,dts:o,data:n}];s<l;)if(g.default.isHeader(e,s)){var f=g.default.appendFrame(d,e,s,o,u);if(!f)break;s+=f.length,c=f.sample.pts,u++}else p.default.isHeader(e,s)?(n=p.default.getID3Data(e,s),h.push({pts:c,dts:c,data:n}),s+=n.length):s++;this.remuxer.remux(d,{samples:[]},{samples:h,inputTimeScale:9e4},{samples:[]},t,r,i)},e.prototype.destroy=function(){},e}();t.default=i},"./src/demux/mp4demuxer.js":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var h=r("./src/utils/logger.js"),l=r("./src/events.js"),i=function(){function g(e,t){this.observer=e,this.remuxer=t}return g.prototype.resetTimeStamp=function(e){this.initPTS=e},g.prototype.resetInitSegment=function(e,t,r,i){if(e&&e.byteLength){var n=this.initData=g.parseInitSegment(e);null==t&&(t="mp4a.40.5"),null==r&&(r="avc1.42e01e");var a={};n.audio&&n.video?a.audiovideo={container:"video/mp4",codec:t+","+r,initSegment:i?e:null}:(n.audio&&(a.audio={container:"audio/mp4",codec:t,initSegment:i?e:null}),n.video&&(a.video={container:"video/mp4",codec:r,initSegment:i?e:null})),this.observer.trigger(l.default.FRAG_PARSING_INIT_SEGMENT,{tracks:a})}else t&&(this.audioCodec=t),r&&(this.videoCodec=r)},g.probe=function(e){return 0<g.findBox({data:e,start:0,end:Math.min(e.length,16384)},["moof"]).length},g.bin2str=function(e){return String.fromCharCode.apply(null,e)},g.readUint16=function(e,t){e.data&&(t+=e.start,e=e.data);var r=e[t]<<8|e[t+1];return r<0?65536+r:r},g.readUint32=function(e,t){e.data&&(t+=e.start,e=e.data);var r=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3];return r<0?4294967296+r:r},g.writeUint32=function(e,t,r){e.data&&(t+=e.start,e=e.data),e[t]=r>>24,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r},g.findBox=function(e,t){var r,i,n,a,o,s,l=[];if(e.data?(o=e.start,n=e.end,e=e.data):(o=0,n=e.byteLength),!t.length)return null;for(r=o;r<n;)s=1<(i=g.readUint32(e,r))?r+i:n,g.bin2str(e.subarray(r+4,r+8))===t[0]&&(1===t.length?l.push({data:e,start:r+8,end:s}):(a=g.findBox({data:e,start:r+8,end:s},t.slice(1))).length&&(l=l.concat(a))),r=s;return l},g.parseSegmentIndex=function(e){var t,r=g.findBox(e,["moov"])[0],i=r?r.end:null,n=0,a=g.findBox(e,["sidx"]);if(!a||!a[0])return null;t=[];var o=(a=a[0]).data[0],s=g.readUint32(a,n=0===o?8:16);n+=4;n+=0===o?8:16;var l=a.end+0,u=g.readUint16(a,n+=2);n+=2;for(var c=0;c<u;c++){var d=n,h=g.readUint32(a,d);d+=4;var f=2147483647&h;if(1===(2147483648&h)>>>31)return void console.warn("SIDX has hierarchical references (not supported)");var p=g.readUint32(a,d);d+=4,t.push({referenceSize:f,subsegmentDuration:p,info:{duration:p/s,start:l,end:l+f-1}}),l+=f,n=d+=4}return{earliestPresentationTime:0,timescale:s,version:o,referencesCount:u,references:t,moovEndOffset:i}},g.parseInitSegment=function(e){var d=[];return g.findBox(e,["moov","trak"]).forEach(function(e){var t=g.findBox(e,["tkhd"])[0];if(t){var r=t.data[t.start],i=0===r?12:20,n=g.readUint32(t,i),a=g.findBox(e,["mdia","mdhd"])[0];if(a){var o=g.readUint32(a,i=0===(r=a.data[a.start])?12:20),s=g.findBox(e,["mdia","hdlr"])[0];if(s){var l={soun:"audio",vide:"video"}[g.bin2str(s.data.subarray(s.start+8,s.start+12))];if(l){var u=g.findBox(e,["mdia","minf","stbl","stsd"]);if(u.length){var c=g.bin2str((u=u[0]).data.subarray(u.start+12,u.start+16));h.logger.log("MP4Demuxer:"+l+":"+c+" found")}d[n]={timescale:o,type:l},d[l]={timescale:o,id:n}}}}}}),d},g.getStartDTS=function(n,e){var t,r,i;return t=g.findBox(e,["moof","traf"]),r=[].concat.apply([],t.map(function(i){return g.findBox(i,["tfhd"]).map(function(e){var t,r;return t=g.readUint32(e,4),r=n[t].timescale||9e4,g.findBox(i,["tfdt"]).map(function(e){var t,r;return t=e.data[e.start],r=g.readUint32(e,4),1===t&&(r*=4294967296,r+=g.readUint32(e,8)),r})[0]/r})})),i=Math.min.apply(null,r),isFinite(i)?i:0},g.offsetStartDTS=function(i,e,o){g.findBox(e,["moof","traf"]).map(function(r){return g.findBox(r,["tfhd"]).map(function(e){var t=g.readUint32(e,4),a=i[t].timescale||9e4;g.findBox(r,["tfdt"]).map(function(e){var t=e.data[e.start],r=g.readUint32(e,4);if(0===t)g.writeUint32(e,4,r-o*a);else{r*=4294967296,r+=g.readUint32(e,8);var i=Math.floor((r=Math.max(r-=o*a,0))/4294967296),n=Math.floor(r%4294967296);g.writeUint32(e,4,i),g.writeUint32(e,8,n)}})})})},g.prototype.append=function(e,t,r,i){var n=this.initData;n||(this.resetInitSegment(e,this.audioCodec,this.videoCodec,!1),n=this.initData);var a,o=this.initPTS;if(void 0===o){var s=g.getStartDTS(n,e);this.initPTS=o=s-t,this.observer.trigger(l.default.INIT_PTS_FOUND,{initPTS:o})}g.offsetStartDTS(n,e,o),a=g.getStartDTS(n,e),this.remuxer.remux(n.audio,n.video,null,null,a,r,i,e)},g.prototype.destroy=function(){},g}();t.default=i},"./src/demux/mpegaudio.js":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var c={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients:[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot:[0,1,1,4],appendFrame:function(e,t,r,i,n){if(!(t.length<r+24)){var a=this.parseHeader(t,r);if(a&&r+a.frameLength<=t.length){var o=i+n*(9e4*a.samplesPerFrame/a.sampleRate),s={unit:t.subarray(r,r+a.frameLength),pts:o,dts:o};return e.config=[],e.channelCount=a.channelCount,e.samplerate=a.sampleRate,e.samples.push(s),e.len+=a.frameLength,{sample:s,length:a.frameLength}}}},parseHeader:function(e,t){var r=e[t+1]>>3&3,i=e[t+1]>>1&3,n=e[t+2]>>4&15,a=e[t+2]>>2&3;if(1!==r&&0!==n&&15!==n&&3!==a){var o=c.SamplingRateMap[3*(3===r?0:2===r?1:2)+a],s=c.SamplesCoefficients[r][i],l=c.BytesInSlot[i],u=8*s*l;return{sampleRate:o,channelCount:e[t+3]>>6==3?1:2,frameLength:parseInt(s*(1e3*c.BitratesMap[14*(3===r?3-i:3===i?3:4)+n-1])/o+(e[t+2]>>1&1),10)*l,samplesPerFrame:u}}},isHeaderPattern:function(e,t){return 255===e[t]&&224==(224&e[t+1])&&0!=(6&e[t+1])},isHeader:function(e,t){return!!(t+1<e.length&&this.isHeaderPattern(e,t))},probe:function(e,t){if(t+1<e.length&&this.isHeaderPattern(e,t)){var r=this.parseHeader(e,t),i=4;r&&r.frameLength&&(i=r.frameLength);var n=t+i;if(n===e.length||n+1<e.length&&this.isHeaderPattern(e,n))return!0}return!1}};t.default=c},"./src/demux/sample-aes.js":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r("./src/crypt/decrypter.js"),i=function(){function e(e,t,r,i){this.decryptdata=r,this.discardEPB=i,this.decrypter=new n.default(e,t,{removePKCS7Padding:!1})}return e.prototype.decryptBuffer=function(e,t){this.decrypter.decrypt(e,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,t)},e.prototype.decryptAacSample=function(t,r,i,n){var a=t[r].unit,e=a.subarray(16,a.length-a.length%16),o=e.buffer.slice(e.byteOffset,e.byteOffset+e.length),s=this;this.decryptBuffer(o,function(e){e=new Uint8Array(e),a.set(e,16),n||s.decryptAacSamples(t,r+1,i)})},e.prototype.decryptAacSamples=function(e,t,r){for(;;t++){if(e.length<=t)return void r();if(!(e[t].unit.length<32)){var i=this.decrypter.isSync();if(this.decryptAacSample(e,t,r,i),!i)return}}},e.prototype.getAvcEncryptedData=function(e){for(var t=new Int8Array(16*Math.floor((e.length-48)/160)+16),r=0,i=32;i<=e.length-16;i+=160,r+=16)t.set(e.subarray(i,i+16),r);return t},e.prototype.getAvcDecryptedUnit=function(e,t){t=new Uint8Array(t);for(var r=0,i=32;i<=e.length-16;i+=160,r+=16)e.set(t.subarray(r,r+16),i);return e},e.prototype.decryptAvcSample=function(t,r,i,n,a,o){var s=this.discardEPB(a.data),e=this.getAvcEncryptedData(s),l=this;this.decryptBuffer(e.buffer,function(e){a.data=l.getAvcDecryptedUnit(s,e),o||l.decryptAvcSamples(t,r,i+1,n)})},e.prototype.decryptAvcSamples=function(e,t,r,i){for(;;t++,r=0){if(e.length<=t)return void i();for(var n=e[t].units;!(n.length<=r);r++){var a=n[r];if(!(a.length<=48||1!==a.type&&5!==a.type)){var o=this.decrypter.isSync();if(this.decryptAvcSample(e,t,r,i,a,o),!o)return}}}},e}();t.default=i},"./src/demux/tsdemuxer.js":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var m=r("./src/demux/adts.js"),s=r("./src/demux/mpegaudio.js"),R=r("./src/events.js"),k=r("./src/demux/exp-golomb.js"),i=r("./src/demux/sample-aes.js"),O=r("./src/utils/logger.js"),D=r("./src/errors.js"),n={video:1,audio:2,id3:3,text:4},a=function(){function x(e,t,r,i){this.observer=e,this.config=r,this.typeSupported=i,this.remuxer=t,this.sampleAes=null}return x.prototype.setDecryptData=function(e){this.sampleAes=null!=e&&null!=e.key&&"SAMPLE-AES"===e.method?new i.default(this.observer,this.config,e,this.discardEPB):null},x.probe=function(e){var t=x._syncOffset(e);return!(t<0)&&(t&&O.logger.warn("MPEG2-TS detected but first sync word found @ offset "+t+", junk ahead ?"),!0)},x._syncOffset=function(e){for(var t=Math.min(1e3,e.length-564),r=0;r<t;){if(71===e[r]&&71===e[r+188]&&71===e[r+376])return r;r++}return-1},x.createTrack=function(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:n[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],len:0,dropped:"video"===e?0:void 0,isAAC:"audio"===e||void 0,duration:"audio"===e?t:void 0}},x.prototype.resetInitSegment=function(e,t,r,i){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=x.createTrack("video",i),this._audioTrack=x.createTrack("audio",i),this._id3Track=x.createTrack("id3",i),this._txtTrack=x.createTrack("text",i),this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=t,this.videoCodec=r,this._duration=i},x.prototype.resetTimeStamp=function(){},x.prototype.append=function(e,t,r,i){var n,a,o,s,l,u=e.length,c=!1;this.contiguous=r;var d=this.pmtParsed,h=this._avcTrack,f=this._audioTrack,p=this._id3Track,g=h.pid,m=f.pid,v=p.pid,y=this._pmtId,_=h.pesData,b=f.pesData,T=p.pesData,S=this._parsePAT,E=this._parsePMT,k=this._parsePES,w=this._parseAVCPES.bind(this),C=this._parseAACPES.bind(this),A=this._parseMPEGPES.bind(this),L=this._parseID3PES.bind(this),I=x._syncOffset(e);for(u-=(u+I)%188,n=I;n<u;n+=188)if(71===e[n]){if(a=!!(64&e[n+1]),o=((31&e[n+1])<<8)+e[n+2],1<(48&e[n+3])>>4){if((s=n+5+e[n+4])===n+188)continue}else s=n+4;switch(o){case g:a&&(_&&(l=k(_))&&void 0!==l.pts&&w(l,!1),_={data:[],size:0}),_&&(_.data.push(e.subarray(s,n+188)),_.size+=n+188-s);break;case m:a&&(b&&(l=k(b))&&void 0!==l.pts&&(f.isAAC?C(l):A(l)),b={data:[],size:0}),b&&(b.data.push(e.subarray(s,n+188)),b.size+=n+188-s);break;case v:a&&(T&&(l=k(T))&&void 0!==l.pts&&L(l),T={data:[],size:0}),T&&(T.data.push(e.subarray(s,n+188)),T.size+=n+188-s);break;case 0:a&&(s+=e[s]+1),y=this._pmtId=S(e,s);break;case y:a&&(s+=e[s]+1);var P=E(e,s,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3,null!=this.sampleAes);0<(g=P.avc)&&(h.pid=g),0<(m=P.audio)&&(f.pid=m,f.isAAC=P.isAAC),0<(v=P.id3)&&(p.pid=v),c&&!d&&(O.logger.log("reparse from beginning"),c=!1,n=I-188),d=this.pmtParsed=!0;break;case 17:case 8191:break;default:c=!0}}else this.observer.trigger(R.default.ERROR,{type:D.ErrorTypes.MEDIA_ERROR,details:D.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});h.pesData=_&&(l=k(_))&&void 0!==l.pts?(w(l,!0),null):_,f.pesData=b&&(l=k(b))&&void 0!==l.pts?(f.isAAC?C(l):A(l),null):(b&&b.size&&O.logger.log("last AAC PES packet truncated,might overlap between fragments"),b),p.pesData=T&&(l=k(T))&&void 0!==l.pts?(L(l),null):T,null==this.sampleAes?this.remuxer.remux(f,h,p,this._txtTrack,t,r,i):this.decryptAndRemux(f,h,p,this._txtTrack,t,r,i)},x.prototype.decryptAndRemux=function(e,t,r,i,n,a,o){if(e.samples&&e.isAAC){var s=this;this.sampleAes.decryptAacSamples(e.samples,0,function(){s.decryptAndRemuxAvc(e,t,r,i,n,a,o)})}else this.decryptAndRemuxAvc(e,t,r,i,n,a,o)},x.prototype.decryptAndRemuxAvc=function(e,t,r,i,n,a,o){if(t.samples){var s=this;this.sampleAes.decryptAvcSamples(t.samples,0,0,function(){s.remuxer.remux(e,t,r,i,n,a,o)})}else this.remuxer.remux(e,t,r,i,n,a,o)},x.prototype.destroy=function(){this._initPTS=this._initDTS=void 0,this._duration=0},x.prototype._parsePAT=function(e,t){return(31&e[t+10])<<8|e[t+11]},x.prototype._parsePMT=function(e,t,r,i){var n,a,o={audio:-1,avc:-1,id3:-1,isAAC:!0};for(n=t+3+((15&e[t+1])<<8|e[t+2])-4,t+=12+((15&e[t+10])<<8|e[t+11]);t<n;){switch(a=(31&e[t+1])<<8|e[t+2],e[t]){case 207:if(!i){O.logger.log("unkown stream type:"+e[t]);break}case 15:-1===o.audio&&(o.audio=a);break;case 21:-1===o.id3&&(o.id3=a);break;case 219:if(!i){O.logger.log("unkown stream type:"+e[t]);break}case 27:-1===o.avc&&(o.avc=a);break;case 3:case 4:r?-1===o.audio&&(o.audio=a,o.isAAC=!1):O.logger.log("MPEG audio found, not supported in this browser for now");break;case 36:O.logger.warn("HEVC stream type found, not supported for now");break;default:O.logger.log("unkown stream type:"+e[t])}t+=5+((15&e[t+3])<<8|e[t+4])}return o},x.prototype._parsePES=function(e){var t,r,i,n,a,o,s,l,u=0,c=e.data;if(!e||0===e.size)return null;for(;c[0].length<19&&1<c.length;){var d=new Uint8Array(c[0].length+c[1].length);d.set(c[0]),d.set(c[1],c[0].length),c[0]=d,c.splice(1,1)}if(1!==((t=c[0])[0]<<16)+(t[1]<<8)+t[2])return null;if((i=(t[4]<<8)+t[5])&&e.size-6<i)return null;192&(r=t[7])&&(4294967295<(o=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2)&&(o-=8589934592),64&r?(4294967295<(s=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2)&&(s-=8589934592),54e5<o-s&&(O.logger.warn(Math.round((o-s)/9e4)+"s delta between PTS and DTS, align them"),o=s)):s=o),e.size-=l=(n=t[8])+9,a=new Uint8Array(e.size);for(var h=0,f=c.length;h<f;h++){var p=(t=c[h]).byteLength;if(l){if(p<l){l-=p;continue}t=t.subarray(l),p-=l,l=0}a.set(t,u),u+=p}return i&&(i-=n+3),{data:a,pts:o,dts:s,len:i}},x.prototype.pushAccesUnit=function(e,t){if(e.units.length&&e.frame){var r=t.samples,i=r.length;!this.config.forceKeyFrameOnDiscontinuity||!0===e.key||t.sps&&(i||this.contiguous)?(e.id=i,r.push(e)):t.dropped++}e.debug.length&&O.logger.log(e.pts+"/"+e.dts+":"+e.debug)},x.prototype._parseAVCPES=function(p,e){var g,m,v,y=this,_=this._avcTrack,t=this._parseAVCNALu(p.data),b=this.avcSample,T=!1,S=this.pushAccesUnit.bind(this),E=function(e,t,r,i){return{key:e,pts:t,dts:r,units:[],debug:i}};p.data=null,b&&t.length&&!_.audFound&&(S(b,_),b=this.avcSample=E(!1,p.pts,p.dts,"")),t.forEach(function(e){switch(e.type){case 1:m=!0,b||(b=y.avcSample=E(!0,p.pts,p.dts,"")),b.frame=!0;var t=e.data;if(T&&4<t.length){var r=new k.default(t).readSliceType();2!==r&&4!==r&&7!==r&&9!==r||(b.key=!0)}break;case 5:m=!0,b||(b=y.avcSample=E(!0,p.pts,p.dts,"")),b.key=!0,b.frame=!0;break;case 6:m=!0,(g=new k.default(y.discardEPB(e.data))).readUByte();for(var i=0,n=0,a=!1,o=0;!a&&1<g.bytesAvailable;){for(i=0;i+=o=g.readUByte(),255===o;);for(n=0;n+=o=g.readUByte(),255===o;);if(4===i&&0!==g.bytesAvailable){if(a=!0,181===g.readUByte())if(49===g.readUShort())if(1195456820===g.readUInt())if(3===g.readUByte()){var s=g.readUByte(),l=31&s,u=[s,g.readUByte()];for(v=0;v<l;v++)u.push(g.readUByte()),u.push(g.readUByte()),u.push(g.readUByte());y._insertSampleInOrder(y._txtTrack.samples,{type:3,pts:p.pts,bytes:u})}}else if(n<g.bytesAvailable)for(v=0;v<n;v++)g.readUByte()}break;case 7:if(T=m=!0,!_.sps){var c=(g=new k.default(e.data)).readSPS();_.width=c.width,_.height=c.height,_.pixelRatio=c.pixelRatio,_.sps=[e.data],_.duration=y._duration;var d=e.data.subarray(1,4),h="avc1.";for(v=0;v<3;v++){var f=d[v].toString(16);f.length<2&&(f="0"+f),h+=f}_.codec=h}break;case 8:m=!0,_.pps||(_.pps=[e.data]);break;case 9:_.audFound=!(m=!1),b&&S(b,_),b=y.avcSample=E(!1,p.pts,p.dts,"");break;case 12:m=!1;break;default:m=!1,b&&(b.debug+="unknown NAL "+e.type+" ")}b&&m&&b.units.push(e)}),e&&b&&(S(b,_),this.avcSample=null)},x.prototype._insertSampleInOrder=function(e,t){var r=e.length;if(0<r){if(e[r-1].pts<=t.pts)e.push(t);else for(var i=r-1;0<=i;i--)if(t.pts<e[i].pts){e.splice(i,0,t);break}}else e.push(t)},x.prototype._getLastNalUnit=function(){var e,t=this.avcSample;if(!t||0===t.units.length){var r=this._avcTrack.samples;t=r[r.length-1]}if(t){var i=t.units;e=i[i.length-1]}return e},x.prototype._parseAVCNALu=function(e){var t,r,i,n,a=0,o=e.byteLength,s=this._avcTrack,l=s.naluState||0,u=l,c=[],d=-1;for(-1===l&&(n=31&e[d=0],l=0,a=1);a<o;)if(t=e[a++],l)if(1!==l)if(t)if(1===t){var h,f;if(0<=d)i={data:e.subarray(d,a-l-1),type:n},c.push(i);else if(h=this._getLastNalUnit())if(u&&a<=4-u&&h.state&&(h.data=h.data.subarray(0,h.data.byteLength-u)),0<(r=a-l-1))(f=new Uint8Array(h.data.byteLength+r)).set(h.data,0),f.set(e.subarray(0,r),h.data.byteLength),h.data=f;l=a<o?(n=31&e[d=a],0):-1}else l=0;else l=3;else l=t?0:2;else l=t?0:1;(0<=d&&0<=l&&(i={data:e.subarray(d,o),type:n,state:l},c.push(i)),0===c.length)&&((h=this._getLastNalUnit())&&((f=new Uint8Array(h.data.byteLength+e.byteLength)).set(h.data,0),f.set(e,h.data.byteLength),h.data=f));return s.naluState=l,c},x.prototype.discardEPB=function(e){for(var t,r,i=e.byteLength,n=[],a=1;a<i-2;)0===e[a]&&0===e[a+1]&&3===e[a+2]?(n.push(a+2),a+=2):a++;if(0===n.length)return e;t=i-n.length,r=new Uint8Array(t);var o=0;for(a=0;a<t;o++,a++)o===n[0]&&(o++,n.shift()),r[a]=e[o];return r},x.prototype._parseAACPES=function(e){var t,r,i,n,a,o=this._audioTrack,s=e.data,l=e.pts,u=this.aacOverFlow,c=this.aacLastPTS;if(u){var d=new Uint8Array(u.byteLength+s.byteLength);d.set(u,0),d.set(s,u.byteLength),s=d}for(i=0,a=s.length;i<a-1&&!m.isHeader(s,i);i++);if(i){var h=void 0,f=void 0;if(f=i<a-1?(h="AAC PES did not start with ADTS header,offset:"+i,!1):(h="no ADTS header found in AAC PES",!0),O.logger.warn("parsing error:"+h),this.observer.trigger(R.default.ERROR,{type:D.ErrorTypes.MEDIA_ERROR,details:D.ErrorDetails.FRAG_PARSING_ERROR,fatal:f,reason:h}),f)return}if(m.initTrackConfig(o,this.observer,s,i,this.audioCodec),r=0,t=m.getFrameDuration(o.samplerate),u&&c){var p=c+t;1<Math.abs(p-l)&&(O.logger.log("AAC: align PTS for overlapping frames by "+Math.round((p-l)/90)),l=p)}for(;i<a;)if(m.isHeader(s,i)&&i+5<a){var g=m.appendFrame(o,s,i,l,r);if(!g)break;i+=g.length,n=g.sample.pts,r++}else i++;u=i<a?s.subarray(i,a):null,this.aacOverFlow=u,this.aacLastPTS=n},x.prototype._parseMPEGPES=function(e){for(var t=e.data,r=t.length,i=0,n=0,a=e.pts;n<r;)if(s.default.isHeader(t,n)){var o=s.default.appendFrame(this._audioTrack,t,n,a,i);if(!o)break;n+=o.length,i++}else n++},x.prototype._parseID3PES=function(e){this._id3Track.samples.push(e)},x}();t.default=a},"./src/errors.js":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorTypes={NETWORK_ERROR:"networkError",MEDIA_ERROR:"mediaError",KEY_SYSTEM_ERROR:"keySystemError",MUX_ERROR:"muxError",OTHER_ERROR:"otherError"},t.ErrorDetails={KEY_SYSTEM_NO_KEYS:"keySystemNoKeys",KEY_SYSTEM_NO_ACCESS:"keySystemNoAccess",KEY_SYSTEM_NO_SESSION:"keySystemNoSession",KEY_SYSTEM_LICENSE_REQUEST_FAILED:"keySystemLicenseRequestFailed",MANIFEST_LOAD_ERROR:"manifestLoadError",MANIFEST_LOAD_TIMEOUT:"manifestLoadTimeOut",MANIFEST_PARSING_ERROR:"manifestParsingError",MANIFEST_INCOMPATIBLE_CODECS_ERROR:"manifestIncompatibleCodecsError",LEVEL_LOAD_ERROR:"levelLoadError",LEVEL_LOAD_TIMEOUT:"levelLoadTimeOut",LEVEL_SWITCH_ERROR:"levelSwitchError",AUDIO_TRACK_LOAD_ERROR:"audioTrackLoadError",AUDIO_TRACK_LOAD_TIMEOUT:"audioTrackLoadTimeOut",FRAG_LOAD_ERROR:"fragLoadError",FRAG_LOAD_TIMEOUT:"fragLoadTimeOut",FRAG_DECRYPT_ERROR:"fragDecryptError",FRAG_PARSING_ERROR:"fragParsingError",REMUX_ALLOC_ERROR:"remuxAllocError",KEY_LOAD_ERROR:"keyLoadError",KEY_LOAD_TIMEOUT:"keyLoadTimeOut",BUFFER_ADD_CODEC_ERROR:"bufferAddCodecError",BUFFER_APPEND_ERROR:"bufferAppendError",BUFFER_APPENDING_ERROR:"bufferAppendingError",BUFFER_STALLED_ERROR:"bufferStalledError",BUFFER_FULL_ERROR:"bufferFullError",BUFFER_SEEK_OVER_HOLE:"bufferSeekOverHole",BUFFER_NUDGE_ON_STALL:"bufferNudgeOnStall",INTERNAL_EXCEPTION:"internalException"}},"./src/event-handler.js":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var i=r("./src/utils/logger.js"),n=r("./src/errors.js"),a=r("./src/events.js"),o={hlsEventGeneric:!0,hlsHandlerDestroying:!0,hlsHandlerDestroyed:!0},s=function(){function e(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this.hls=e,this.onEvent=this.onEvent.bind(this),this.handledEvents=t,this.useGenericHandler=!0,this.registerListeners()}return e.prototype.destroy=function(){this.onHandlerDestroying(),this.unregisterListeners(),this.onHandlerDestroyed()},e.prototype.onHandlerDestroying=function(){},e.prototype.onHandlerDestroyed=function(){},e.prototype.isEventHandler=function(){return"object"==typeof this.handledEvents&&this.handledEvents.length&&"function"==typeof this.onEvent},e.prototype.registerListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){if(o[e])throw Error("Forbidden event-name: "+e);this.hls.on(e,this.onEvent)},this)},e.prototype.unregisterListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){this.hls.off(e,this.onEvent)},this)},e.prototype.onEvent=function(e,t){this.onEventGeneric(e,t)},e.prototype.onEventGeneric=function(t,e){try{(function(e,t){var r="on"+e.replace("hls","");if("function"!=typeof this[r])throw Error("Event "+e+" has no generic handler in this "+this.constructor.name+" class (tried "+r+")");return this[r].bind(this,t)}).call(this,t,e).call()}catch(e){i.logger.error("An internal error happened while handling event "+t+'. Error message: "'+e.message+'". Here is a stacktrace:',e),this.hls.trigger(a.default.ERROR,{type:n.ErrorTypes.OTHER_ERROR,details:n.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:t,err:e})}},e}();t.default=s},"./src/events.js":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});t.default={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition"}},"./src/hls.js":function(e,t,r){var i,n=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var a=r("./node_modules/url-toolkit/src/url-toolkit.js"),o=r("./src/errors.js"),S=r("./src/loader/playlist-loader.js"),E=r("./src/loader/fragment-loader.js"),k=r("./src/loader/key-loader.js"),w=r("./src/controller/fragment-tracker.js"),C=r("./src/controller/stream-controller.js"),A=r("./src/controller/level-controller.js"),L=r("./src/controller/id3-track-controller.js"),s=r("./src/is-supported.js"),I=r("./src/utils/logger.js"),l=r("./src/config.js"),u=r("./src/events.js"),c=function(b){function T(e){void 0===e&&(e={});var t=b.call(this)||this,r=T.DefaultConfig;if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");for(var i in r)i in e||(e[i]=r[i]);if(void 0!==e.liveMaxLatencyDurationCount&&e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount)throw Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==e.liveMaxLatencyDuration&&(e.liveMaxLatencyDuration<=e.liveSyncDuration||void 0===e.liveSyncDuration))throw Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');I.enableLogs(e.debug),t.config=e,t._autoLevelCapping=-1;var n=t.abrController=new e.abrController(t),a=new e.bufferController(t),o=new e.capLevelController(t),s=new e.fpsController(t),l=new S.default(t),u=new E.default(t),c=new k.default(t),d=new L.default(t),h=t.levelController=new A.default(t),f=new w.FragmentTracker(t),p=[h,t.streamController=new C.default(t,f)],g=e.audioStreamController;g&&p.push(new g(t,f)),t.networkControllers=p;var m=[l,u,c,n,a,o,s,d,f];if(g=e.audioTrackController){var v=new g(t);m.push(t.audioTrackController=v)}if(g=e.subtitleTrackController){var y=new g(t);p.push(t.subtitleTrackController=y)}if(g=e.emeController){var _=new g(t);m.push(t.emeController=_)}return(g=e.subtitleStreamController)&&p.push(new g(t,f)),(g=e.timelineController)&&m.push(new g(t)),t.coreComponents=m,t}return n(T,b),Object.defineProperty(T,"version",{get:function(){return"0.12.4"},enumerable:!0,configurable:!0}),T.isSupported=function(){return s.isSupported()},Object.defineProperty(T,"Events",{get:function(){return u.default},enumerable:!0,configurable:!0}),Object.defineProperty(T,"ErrorTypes",{get:function(){return o.ErrorTypes},enumerable:!0,configurable:!0}),Object.defineProperty(T,"ErrorDetails",{get:function(){return o.ErrorDetails},enumerable:!0,configurable:!0}),Object.defineProperty(T,"DefaultConfig",{get:function(){return T.defaultConfig?T.defaultConfig:l.hlsDefaultConfig},set:function(e){T.defaultConfig=e},enumerable:!0,configurable:!0}),T.prototype.destroy=function(){I.logger.log("destroy"),this.trigger(u.default.DESTROYING),this.detachMedia(),this.coreComponents.concat(this.networkControllers).forEach(function(e){e.destroy()}),this.url=null,this.removeAllListeners(),this._autoLevelCapping=-1},T.prototype.attachMedia=function(e){I.logger.log("attachMedia"),this.media=e,this.trigger(u.default.MEDIA_ATTACHING,{media:e})},T.prototype.detachMedia=function(){I.logger.log("detachMedia"),this.trigger(u.default.MEDIA_DETACHING),this.media=null},T.prototype.loadSource=function(e){e=a.buildAbsoluteURL(window.location.href,e,{alwaysNormalize:!0}),I.logger.log("loadSource:"+e),this.url=e,this.trigger(u.default.MANIFEST_LOADING,{url:e})},T.prototype.startLoad=function(t){void 0===t&&(t=-1),I.logger.log("startLoad("+t+")"),this.networkControllers.forEach(function(e){e.startLoad(t)})},T.prototype.stopLoad=function(){I.logger.log("stopLoad"),this.networkControllers.forEach(function(e){e.stopLoad()})},T.prototype.swapAudioCodec=function(){I.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},T.prototype.recoverMediaError=function(){I.logger.log("recoverMediaError");var e=this.media;this.detachMedia(),this.attachMedia(e)},Object.defineProperty(T.prototype,"levels",{get:function(){return this.levelController.levels},enumerable:!0,configurable:!0}),Object.defineProperty(T.prototype,"currentLevel",{get:function(){return this.streamController.currentLevel},set:function(e){I.logger.log("set currentLevel:"+e),this.loadLevel=e,this.streamController.immediateLevelSwitch()},enumerable:!0,configurable:!0}),Object.defineProperty(T.prototype,"nextLevel",{get:function(){return this.streamController.nextLevel},set:function(e){I.logger.log("set nextLevel:"+e),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()},enumerable:!0,configurable:!0}),Object.defineProperty(T.prototype,"loadLevel",{get:function(){return this.levelController.level},set:function(e){I.logger.log("set loadLevel:"+e),this.levelController.manualLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(T.prototype,"nextLoadLevel",{get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(T.prototype,"firstLevel",{get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(e){I.logger.log("set firstLevel:"+e),this.levelController.firstLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(T.prototype,"startLevel",{get:function(){return this.levelController.startLevel},set:function(e){I.logger.log("set startLevel:"+e);-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(T.prototype,"autoLevelCapping",{get:function(){return this._autoLevelCapping},set:function(e){I.logger.log("set autoLevelCapping:"+e),this._autoLevelCapping=e},enumerable:!0,configurable:!0}),Object.defineProperty(T.prototype,"autoLevelEnabled",{get:function(){return-1===this.levelController.manualLevel},enumerable:!0,configurable:!0}),Object.defineProperty(T.prototype,"manualLevel",{get:function(){return this.levelController.manualLevel},enumerable:!0,configurable:!0}),Object.defineProperty(T.prototype,"minAutoLevel",{get:function(){for(var e=this.levels,t=this.config.minAutoBitrate,r=e?e.length:0,i=0;i<r;i++){if(t<(e[i].realBitrate?Math.max(e[i].realBitrate,e[i].bitrate):e[i].bitrate))return i}return 0},enumerable:!0,configurable:!0}),Object.defineProperty(T.prototype,"maxAutoLevel",{get:function(){var e=this.levels,t=this.autoLevelCapping;return-1===t&&e&&e.length?e.length-1:t},enumerable:!0,configurable:!0}),Object.defineProperty(T.prototype,"nextAutoLevel",{get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(e){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,e)},enumerable:!0,configurable:!0}),Object.defineProperty(T.prototype,"audioTracks",{get:function(){var e=this.audioTrackController;return e?e.audioTracks:[]},enumerable:!0,configurable:!0}),Object.defineProperty(T.prototype,"audioTrack",{get:function(){var e=this.audioTrackController;return e?e.audioTrack:-1},set:function(e){var t=this.audioTrackController;t&&(t.audioTrack=e)},enumerable:!0,configurable:!0}),Object.defineProperty(T.prototype,"liveSyncPosition",{get:function(){return this.streamController.liveSyncPosition},enumerable:!0,configurable:!0}),Object.defineProperty(T.prototype,"subtitleTracks",{get:function(){var e=this.subtitleTrackController;return e?e.subtitleTracks:[]},enumerable:!0,configurable:!0}),Object.defineProperty(T.prototype,"subtitleTrack",{get:function(){var e=this.subtitleTrackController;return e?e.subtitleTrack:-1},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleTrack=e)},enumerable:!0,configurable:!0}),Object.defineProperty(T.prototype,"subtitleDisplay",{get:function(){var e=this.subtitleTrackController;return!!e&&e.subtitleDisplay},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)},enumerable:!0,configurable:!0}),T}(r("./src/observer.js").Observer);t.default=c},"./src/is-supported.js":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var i=r("./src/utils/mediasource-helper.js");t.isSupported=function(){var e=i.getMediaSource(),t=window.SourceBuffer||window.WebKitSourceBuffer;return!(!e||"function"!=typeof e.isTypeSupported||!e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')||t&&(!t.prototype||"function"!=typeof t.prototype.appendBuffer||"function"!=typeof t.prototype.remove))}},"./src/loader/fragment-loader.js":function(e,n,s){(function(f){var i,t=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(n,"__esModule",{value:!0});var o=s("./src/events.js"),e=s("./src/event-handler.js"),a=s("./src/errors.js"),p=s("./src/utils/logger.js"),r=function(i){function e(e){var t=i.call(this,e,o.default.FRAG_LOADING)||this;return t.loaders={},t}return t(e,i),e.prototype.destroy=function(){var e=this.loaders;for(var t in e){var r=e[t];r&&r.destroy()}this.loaders={},i.prototype.destroy.call(this)},e.prototype.onFragLoading=function(e){var t=e.frag,r=t.type,i=this.loaders,n=this.hls.config,a=n.fLoader,o=n.loader;t.loaded=0;var s,l,u,c=i[r];c&&(p.logger.warn("abort previous fragment loader for type: "+r),c.abort()),c=i[r]=t.loader=n.fLoader?new a(n):new o(n),s={url:t.url,frag:t,responseType:"arraybuffer",progressData:!1};var d=t.byteRangeStartOffset,h=t.byteRangeEndOffset;f.isFinite(d)&&f.isFinite(h)&&(s.rangeStart=d,s.rangeEnd=h),l={timeout:n.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:n.fragLoadingMaxRetryTimeout},u={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)},c.load(s,l,u)},e.prototype.loadsuccess=function(e,t,r,i){void 0===i&&(i=null);var n=e.data,a=r.frag;a.loader=void 0,this.loaders[a.type]=void 0,this.hls.trigger(o.default.FRAG_LOADED,{payload:n,frag:a,stats:t,networkDetails:i})},e.prototype.loaderror=function(e,t,r){void 0===r&&(r=null);var i=t.frag,n=i.loader;n&&n.abort(),this.loaders[i.type]=void 0,this.hls.trigger(o.default.ERROR,{type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:t.frag,response:e,networkDetails:r})},e.prototype.loadtimeout=function(e,t,r){void 0===r&&(r=null);var i=t.frag,n=i.loader;n&&n.abort(),this.loaders[i.type]=void 0,this.hls.trigger(o.default.ERROR,{type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t.frag,networkDetails:r})},e.prototype.loadprogress=function(e,t,r,i){void 0===i&&(i=null);var n=t.frag;n.loaded=e.loaded,this.hls.trigger(o.default.FRAG_LOAD_PROGRESS,{frag:n,stats:e,networkDetails:i})},e}(e.default);n.default=r}).call(this,s("./src/polyfills/number.js").Number)},"./src/loader/fragment.js":function(e,n,a){!function(r){Object.defineProperty(n,"__esModule",{value:!0});var e=a("./node_modules/url-toolkit/src/url-toolkit.js"),i=a("./src/loader/level-key.js"),t=function(){function t(){var e;this._url=null,this._byteRange=null,this._decryptdata=null,this.tagList=[],this.programDateTime=null,this.rawProgramDateTime=null,this._elementaryStreams=((e={})[t.ElementaryStreamTypes.AUDIO]=!1,e[t.ElementaryStreamTypes.VIDEO]=!1,e)}return Object.defineProperty(t,"ElementaryStreamTypes",{get:function(){return{AUDIO:"audio",VIDEO:"video"}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"url",{get:function(){return!this._url&&this.relurl&&(this._url=e.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url},set:function(e){this._url=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"byteRange",{get:function(){if(!this._byteRange&&!this.rawByteRange)return[];if(this._byteRange)return this._byteRange;var e=[];if(this.rawByteRange){var t=this.rawByteRange.split("@",2);if(1===t.length)e[0]=this.lastByteRangeEndOffset||0;else e[0]=parseInt(t[1]);e[1]=parseInt(t[0])+e[0],this._byteRange=e}return e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"byteRangeStartOffset",{get:function(){return this.byteRange[0]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"byteRangeEndOffset",{get:function(){return this.byteRange[1]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"decryptdata",{get:function(){return this._decryptdata||(this._decryptdata=this.fragmentDecryptdataFromLevelkey(this.levelkey,this.sn)),this._decryptdata},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"endProgramDateTime",{get:function(){if(!r.isFinite(this.programDateTime))return null;var e=r.isFinite(this.duration)?this.duration:0;return this.programDateTime+1e3*e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"encrypted",{get:function(){return!(!this.decryptdata||null===this.decryptdata.uri||null!==this.decryptdata.key)},enumerable:!0,configurable:!0}),t.prototype.addElementaryStream=function(e){this._elementaryStreams[e]=!0},t.prototype.hasElementaryStream=function(e){return!0===this._elementaryStreams[e]},t.prototype.createInitializationVector=function(e){for(var t=new Uint8Array(16),r=12;r<16;r++)t[r]=e>>8*(15-r)&255;return t},t.prototype.fragmentDecryptdataFromLevelkey=function(e,t){var r=e;return e&&e.method&&e.uri&&!e.iv&&((r=new i.default).method=e.method,r.baseuri=e.baseuri,r.reluri=e.reluri,r.iv=this.createInitializationVector(t)),r},t}();n.default=t}(a("./src/polyfills/number.js").Number)},"./src/loader/key-loader.js":function(e,t,r){var i,n=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var c=r("./src/events.js"),a=r("./src/event-handler.js"),o=r("./src/errors.js"),d=r("./src/utils/logger.js"),s=function(r){function e(e){var t=r.call(this,e,c.default.KEY_LOADING)||this;return t.loaders={},t.decryptkey=null,t.decrypturl=null,t}return n(e,r),e.prototype.destroy=function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy()}this.loaders={},a.default.prototype.destroy.call(this)},e.prototype.onKeyLoading=function(e){var t=e.frag,r=t.type,i=this.loaders[r],n=t.decryptdata,a=n.uri;if(a!==this.decrypturl||null===this.decryptkey){var o=this.hls.config;i&&(d.logger.warn("abort previous key loader for type:"+r),i.abort()),t.loader=this.loaders[r]=new o.loader(o),this.decrypturl=a,this.decryptkey=null;var s,l,u;s={url:a,frag:t,responseType:"arraybuffer"},l={timeout:o.fragLoadingTimeOut,maxRetry:0,retryDelay:o.fragLoadingRetryDelay,maxRetryDelay:o.fragLoadingMaxRetryTimeout},u={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},t.loader.load(s,l,u)}else this.decryptkey&&(n.key=this.decryptkey,this.hls.trigger(c.default.KEY_LOADED,{frag:t}))},e.prototype.loadsuccess=function(e,t,r){var i=r.frag;this.decryptkey=i.decryptdata.key=new Uint8Array(e.data),i.loader=void 0,this.loaders[i.type]=void 0,this.hls.trigger(c.default.KEY_LOADED,{frag:i})},e.prototype.loaderror=function(e,t){var r=t.frag,i=r.loader;i&&i.abort(),this.loaders[t.type]=void 0,this.hls.trigger(c.default.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:r,response:e})},e.prototype.loadtimeout=function(e,t){var r=t.frag,i=r.loader;i&&i.abort(),this.loaders[t.type]=void 0,this.hls.trigger(c.default.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:r})},e}(a.default);t.default=s},"./src/loader/level-key.js":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var i=r("./node_modules/url-toolkit/src/url-toolkit.js"),n=function(){function e(){this.method=null,this.key=null,this.iv=null,this._uri=null}return Object.defineProperty(e.prototype,"uri",{get:function(){return!this._uri&&this.reluri&&(this._uri=i.buildAbsoluteURL(this.baseuri,this.reluri,{alwaysNormalize:!0})),this._uri},enumerable:!0,configurable:!0}),e}();t.default=n},"./src/loader/level.js":function(e,r,t){!function(t){Object.defineProperty(r,"__esModule",{value:!0});var e=function(){function e(e){this.endCC=0,this.endSN=0,this.fragments=[],this.initSegment=null,this.live=!0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=e,this.version=null}return Object.defineProperty(e.prototype,"hasProgramDateTime",{get:function(){return!(!this.fragments[0]||!t.isFinite(this.fragments[0].programDateTime))},enumerable:!0,configurable:!0}),e}();r.default=e}(t("./src/polyfills/number.js").Number)},"./src/loader/m3u8-parser.js":function(e,t,i){!function(A){Object.defineProperty(t,"__esModule",{value:!0});var r=i("./node_modules/url-toolkit/src/url-toolkit.js"),L=i("./src/loader/fragment.js"),I=i("./src/loader/level.js"),P=i("./src/loader/level-key.js"),x=i("./src/utils/attr-list.js"),R=i("./src/utils/logger.js"),l=i("./src/utils/codecs.js"),u=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g,d=/#EXT-X-MEDIA:(.*)/g,O=RegExp(""+/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source+/|(?!#)([\S+ ?]+)/.source+/|#EXT-X-BYTERANGE:*(.+)/.source+/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source+/|#.*/.source,"g"),D=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)([^:]*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,M=/\.(mp4|m4s|m4v|m4a)$/i,e=function(){function c(){}return c.findGroup=function(e,t){if(!e)return null;for(var r=null,i=0;i<e.length;i++){var n=e[i];n.id===t&&(r=n)}return r},c.convertAVC1ToAVCOTI=function(e){var t,r=e.split(".");return 2<r.length?(t=r.shift()+".",t+=parseInt(r.shift()).toString(16),t+=("000"+parseInt(r.shift()).toString(16)).substr(-4)):t=e,t},c.resolve=function(e,t){return r.buildAbsoluteURL(t,e,{alwaysNormalize:!0})},c.parseMasterPlaylist=function(e,t){var r,i=[];function n(i,n){["video","audio"].forEach(function(t){var r=i.filter(function(e){return l.isCodecType(e,t)});if(r.length){var e=r.filter(function(e){return 0==e.lastIndexOf("avc1",0)||0==e.lastIndexOf("mp4a",0)});n[t+"Codec"]=0<e.length?e[0]:r[0],i=i.filter(function(e){return-1==r.indexOf(e)})}}),n.unknownCodecs=i}for(u.lastIndex=0;null!=(r=u.exec(e));){var a={},o=a.attrs=new x.default(r[1]);a.url=c.resolve(r[2],t);var s=o.decimalResolution("RESOLUTION");s&&(a.width=s.width,a.height=s.height),a.bitrate=o.decimalInteger("AVERAGE-BANDWIDTH")||o.decimalInteger("BANDWIDTH"),a.name=o.NAME,n([].concat((o.CODECS||"").split(/[ ,]+/)),a),a.videoCodec&&-1!=a.videoCodec.indexOf("avc1")&&(a.videoCodec=c.convertAVC1ToAVCOTI(a.videoCodec)),i.push(a)}return i},c.parseMasterPlaylistMedia=function(e,t,r,i){var n;void 0===i&&(i=[]);var a=[],o=0;for(d.lastIndex=0;null!==(n=d.exec(e));){var s={},l=new x.default(n[1]);if(l.TYPE===r){if(s.groupId=l["GROUP-ID"],s.name=l.NAME,s.type=r,s.default="YES"===l.DEFAULT,s.autoselect="YES"===l.AUTOSELECT,s.forced="YES"===l.FORCED,l.URI&&(s.url=c.resolve(l.URI,t)),s.lang=l.LANGUAGE,s.name||(s.name=s.lang),i.length){var u=c.findGroup(i,s.groupId);s.audioCodec=u?u.codec:i[0].codec}s.id=o++,a.push(s)}}return a},c.parseLevelPlaylist=function(e,t,r,i,n){var a,o,s=0,l=0,u=new I.default(t),c=new P.default,d=0,h=null,f=new L.default,p=null;for(O.lastIndex=0;null!==(a=O.exec(e));){var g=a[1];if(g){f.duration=parseFloat(g);var m=(" "+a[2]).slice(1);f.title=m||null,f.tagList.push(m?["INF",g,m]:["INF",g])}else if(a[3]){if(A.isFinite(f.duration)){var v=s++;f.type=i,f.start=l,f.levelkey=c,f.sn=v,f.level=r,f.cc=d,f.urlId=n,f.baseurl=t,f.relurl=(" "+a[3]).slice(1),N(f,h),u.fragments.push(f),l+=(h=f).duration,f=new L.default}}else if(a[4]){if(f.rawByteRange=(" "+a[4]).slice(1),h){var y=h.byteRangeEndOffset;y&&(f.lastByteRangeEndOffset=y)}}else if(a[5])f.rawProgramDateTime=(" "+a[5]).slice(1),f.tagList.push(["PROGRAM-DATE-TIME",f.rawProgramDateTime]),null===p&&(p=u.fragments.length);else{for(a=a[0].match(D),o=1;o<a.length&&void 0===a[o];o++);var _=(" "+a[o+1]).slice(1),b=(" "+a[o+2]).slice(1);switch(a[o]){case"#":f.tagList.push(b?[_,b]:[_]);break;case"PLAYLIST-TYPE":u.type=_.toUpperCase();break;case"MEDIA-SEQUENCE":s=u.startSN=parseInt(_);break;case"TARGETDURATION":u.targetduration=parseFloat(_);break;case"VERSION":u.version=parseInt(_);break;case"EXTM3U":break;case"ENDLIST":u.live=!1;break;case"DIS":d++,f.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":d=parseInt(_);break;case"KEY":var T=new x.default(_),S=T.enumeratedString("METHOD"),E=T.URI,k=T.hexadecimalInteger("IV");S&&(c=new P.default,E&&0<=["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(S)&&(c.method=S,c.baseuri=t,c.reluri=E,c.key=null,c.iv=k));break;case"START":var w=new x.default(_).decimalFloatingPoint("TIME-OFFSET");A.isFinite(w)&&(u.startTimeOffset=w);break;case"MAP":var C=new x.default(_);f.relurl=C.URI,f.rawByteRange=C.BYTERANGE,f.baseurl=t,f.level=r,f.type=i,f.sn="initSegment",u.initSegment=f,(f=new L.default).rawProgramDateTime=u.initSegment.rawProgramDateTime;break;default:R.logger.warn("line parsed but not handled: "+a)}}}return(f=h)&&!f.relurl&&(u.fragments.pop(),l-=f.duration),u.totalduration=l,u.averagetargetduration=l/u.fragments.length,u.endSN=s-1,u.startCC=u.fragments[0]?u.fragments[0].cc:0,u.endCC=d,!u.initSegment&&u.fragments.length&&u.fragments.every(function(e){return M.test(e.relurl)})&&(R.logger.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),(f=new L.default).relurl=u.fragments[0].relurl,f.baseurl=t,f.level=r,f.type=i,f.sn="initSegment",u.initSegment=f,u.needSidxRanges=!0),p&&function(e,t){for(var r=e[t],i=t-1;0<=i;i--){var n=e[i];n.programDateTime=r.programDateTime-1e3*n.duration,r=n}}(u.fragments,p),u},c}();function N(e,t){e.rawProgramDateTime?e.programDateTime=Date.parse(e.rawProgramDateTime):t&&t.programDateTime&&(e.programDateTime=t.endProgramDateTime),A.isFinite(e.programDateTime)||(e.programDateTime=null,e.rawProgramDateTime=null)}t.default=e}(i("./src/polyfills/number.js").Number)},"./src/loader/playlist-loader.js":function(e,o,s){(function(p){var i,e=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(o,"__esModule",{value:!0});var g=s("./src/events.js"),t=s("./src/event-handler.js"),l=s("./src/errors.js"),h=s("./src/utils/logger.js"),a=s("./src/demux/mp4demuxer.js"),m=s("./src/loader/m3u8-parser.js"),v=window.performance,y={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},n={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"},r=function(r){function f(e){var t=r.call(this,e,g.default.MANIFEST_LOADING,g.default.LEVEL_LOADING,g.default.AUDIO_TRACK_LOADING,g.default.SUBTITLE_TRACK_LOADING)||this;return t.loaders={},t}return e(f,r),Object.defineProperty(f,"ContextType",{get:function(){return y},enumerable:!0,configurable:!0}),Object.defineProperty(f,"LevelType",{get:function(){return n},enumerable:!0,configurable:!0}),f.canHaveQualityLevels=function(e){return e!==y.AUDIO_TRACK&&e!==y.SUBTITLE_TRACK},f.mapContextToLevelType=function(e){switch(e.type){case y.AUDIO_TRACK:return n.AUDIO;case y.SUBTITLE_TRACK:return n.SUBTITLE;default:return n.MAIN}},f.getResponseUrl=function(e,t){var r=e.url;return void 0!==r&&0!=r.indexOf("data:")||(r=t.url),r},f.prototype.createInternalLoader=function(e){var t=this.hls.config,r=new(t.pLoader||t.loader)(t);return e.loader=r,this.loaders[e.type]=r},f.prototype.getInternalLoader=function(e){return this.loaders[e.type]},f.prototype.resetInternalLoader=function(e){this.loaders[e]&&delete this.loaders[e]},f.prototype.destroyInternalLoaders=function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}},f.prototype.destroy=function(){this.destroyInternalLoaders(),r.prototype.destroy.call(this)},f.prototype.onManifestLoading=function(e){this.load(e.url,{type:y.MANIFEST,level:0,id:null})},f.prototype.onLevelLoading=function(e){this.load(e.url,{type:y.LEVEL,level:e.level,id:e.id})},f.prototype.onAudioTrackLoading=function(e){this.load(e.url,{type:y.AUDIO_TRACK,level:null,id:e.id})},f.prototype.onSubtitleTrackLoading=function(e){this.load(e.url,{type:y.SUBTITLE_TRACK,level:null,id:e.id})},f.prototype.load=function(e,t){var r=this.hls.config;h.logger.debug("Loading playlist of type "+t.type+", level: "+t.level+", id: "+t.id);var i,n,a,o,s=this.getInternalLoader(t);if(s){var l=s.context;if(l&&l.url===e)return h.logger.trace("playlist request ongoing"),!1;h.logger.warn("aborting previous loader for type: "+t.type),s.abort()}switch(t.type){case y.MANIFEST:i=r.manifestLoadingMaxRetry,n=r.manifestLoadingTimeOut,a=r.manifestLoadingRetryDelay,o=r.manifestLoadingMaxRetryTimeout;break;case y.LEVEL:i=0,n=r.levelLoadingTimeOut;break;default:i=r.levelLoadingMaxRetry,n=r.levelLoadingTimeOut,a=r.levelLoadingRetryDelay,o=r.levelLoadingMaxRetryTimeout}s=this.createInternalLoader(t),t.url=e,t.responseType=t.responseType||"";var u={timeout:n,maxRetry:i,retryDelay:a,maxRetryDelay:o},c={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};return h.logger.debug("Calling internal loader delegate for URL: "+e),s.load(t,u,c),!0},f.prototype.loadsuccess=function(e,t,r,i){if(void 0===i&&(i=null),r.isSidxRequest)return this._handleSidxRequest(e,r),void this._handlePlaylistLoaded(e,t,r,i);this.resetInternalLoader(r.type);var n=e.data;t.tload=v.now(),0==n.indexOf("#EXTM3U")?0<n.indexOf("#EXTINF:")||0<n.indexOf("#EXT-X-TARGETDURATION:")?this._handleTrackOrLevelPlaylist(e,t,r,i):this._handleMasterPlaylist(e,t,r,i):this._handleManifestParsingError(e,r,"no EXTM3U delimiter",i)},f.prototype.loaderror=function(e,t,r){void 0===r&&(r=null),this._handleNetworkError(t,r,!1,e)},f.prototype.loadtimeout=function(e,t,r){void 0===r&&(r=null),this._handleNetworkError(t,r,!0)},f.prototype._handleMasterPlaylist=function(e,t,r,i){var n=this.hls,a=e.data,o=f.getResponseUrl(e,r),s=m.default.parseMasterPlaylist(a,o);if(s.length){var l=s.map(function(e){return{id:e.attrs.AUDIO,codec:e.audioCodec}}),u=m.default.parseMasterPlaylistMedia(a,o,"AUDIO",l),c=m.default.parseMasterPlaylistMedia(a,o,"SUBTITLES");if(u.length){var d=!1;u.forEach(function(e){e.url||(d=!0)}),!1===d&&s[0].audioCodec&&!s[0].attrs.AUDIO&&(h.logger.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),u.unshift({type:"main",name:"main"}))}n.trigger(g.default.MANIFEST_LOADED,{levels:s,audioTracks:u,subtitles:c,url:o,stats:t,networkDetails:i})}else this._handleManifestParsingError(e,r,"no level found in manifest",i)},f.prototype._handleTrackOrLevelPlaylist=function(e,t,r,i){var n=this.hls,a=r.id,o=r.level,s=r.type,l=f.getResponseUrl(e,r),u=p.isFinite(a)?a:0,c=p.isFinite(o)?o:u,d=f.mapContextToLevelType(r),h=m.default.parseLevelPlaylist(e.data,l,c,d,u);(h.tload=t.tload,s===y.MANIFEST)&&n.trigger(g.default.MANIFEST_LOADED,{levels:[{url:l,details:h}],audioTracks:[],url:l,stats:t,networkDetails:i});(t.tparsed=v.now(),h.needSidxRanges)?this.load(h.initSegment.url,{isSidxRequest:!0,type:s,level:o,levelDetails:h,id:a,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer"}):(r.levelDetails=h,this._handlePlaylistLoaded(e,t,r,i))},f.prototype._handleSidxRequest=function(e,t){var r=a.default.parseSegmentIndex(new Uint8Array(e.data));if(r){var n=t.levelDetails;r.references.forEach(function(e,t){var r=e.info,i=n.fragments[t];0===i.byteRange.length&&(i.rawByteRange=1+r.end-r.start+"@"+r.start)}),n.initSegment.rawByteRange=r.moovEndOffset+"@0"}},f.prototype._handleManifestParsingError=function(e,t,r,i){this.hls.trigger(g.default.ERROR,{type:l.ErrorTypes.NETWORK_ERROR,details:l.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:e.url,reason:r,networkDetails:i})},f.prototype._handleNetworkError=function(e,t,r,i){var n,a;void 0===r&&(r=!1),void 0===i&&(i=null),h.logger.info("A network error occured while loading a "+e.type+"-type playlist");var o=this.getInternalLoader(e);switch(e.type){case y.MANIFEST:n=r?l.ErrorDetails.MANIFEST_LOAD_TIMEOUT:l.ErrorDetails.MANIFEST_LOAD_ERROR,a=!0;break;case y.LEVEL:n=r?l.ErrorDetails.LEVEL_LOAD_TIMEOUT:l.ErrorDetails.LEVEL_LOAD_ERROR,a=!1;break;case y.AUDIO_TRACK:n=r?l.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:l.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,a=!1;break;default:a=!1}o&&(o.abort(),this.resetInternalLoader(e.type));var s={type:l.ErrorTypes.NETWORK_ERROR,details:n,fatal:a,url:o.url,loader:o,context:e,networkDetails:t};i&&(s.response=i),this.hls.trigger(g.default.ERROR,s)},f.prototype._handlePlaylistLoaded=function(e,t,r,i){var n=r.type,a=r.level,o=r.id,s=r.levelDetails;if(s.targetduration)if(f.canHaveQualityLevels(r.type))this.hls.trigger(g.default.LEVEL_LOADED,{details:s,level:a||0,id:o||0,stats:t,networkDetails:i});else switch(n){case y.AUDIO_TRACK:this.hls.trigger(g.default.AUDIO_TRACK_LOADED,{details:s,id:o,stats:t,networkDetails:i});break;case y.SUBTITLE_TRACK:this.hls.trigger(g.default.SUBTITLE_TRACK_LOADED,{details:s,id:o,stats:t,networkDetails:i})}else this._handleManifestParsingError(e,r,"invalid target duration",i)},f}(t.default);o.default=r}).call(this,s("./src/polyfills/number.js").Number)},"./src/observer.js":function(e,t,r){var i,n=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.trigger=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this.emit.apply(this,[e,e].concat(t))},t}(r("./node_modules/eventemitter3/index.js").EventEmitter);t.Observer=a},"./src/polyfills/number.js":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var i=r("./src/utils/get-self-scope.js").getSelfScope().Number;(t.Number=i).isFinite=i.isFinite||function(e){return"number"==typeof e&&isFinite(e)}},"./src/remux/aac-helper.js":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.getSilentFrame=function(e,t){switch(e){case"mp4a.40.2":if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},e}();t.default=i},"./src/remux/mp4-generator.js":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var s=4294967295,i=function(){function h(){}return h.init=function(){var e;for(e in h.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]})h.types.hasOwnProperty(e)&&(h.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);var t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),r=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);h.HDLR_TYPES={video:t,audio:r};var i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),n=new Uint8Array([0,0,0,0,0,0,0,0]);h.STTS=h.STSC=h.STCO=n,h.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),h.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),h.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),h.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var a=new Uint8Array([105,115,111,109]),o=new Uint8Array([97,118,99,49]),s=new Uint8Array([0,0,0,1]);h.FTYP=h.box(h.types.ftyp,a,s,a,o),h.DINF=h.box(h.types.dinf,h.box(h.types.dref,i))},h.box=function(e){for(var t,r=Array.prototype.slice.call(arguments,1),i=8,n=r.length,a=n;n--;)i+=r[n].byteLength;for((t=new Uint8Array(i))[0]=i>>24&255,t[1]=i>>16&255,t[2]=i>>8&255,t[3]=255&i,t.set(e,4),n=0,i=8;n<a;n++)t.set(r[n],i),i+=r[n].byteLength;return t},h.hdlr=function(e){return h.box(h.types.hdlr,h.HDLR_TYPES[e])},h.mdat=function(e){return h.box(h.types.mdat,e)},h.mdhd=function(e,t){var r=Math.floor((t*=e)/(s+1)),i=Math.floor(t%(s+1));return h.box(h.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,r>>24,r>>16&255,r>>8&255,255&r,i>>24,i>>16&255,i>>8&255,255&i,85,196,0,0]))},h.mdia=function(e){return h.box(h.types.mdia,h.mdhd(e.timescale,e.duration),h.hdlr(e.type),h.minf(e))},h.mfhd=function(e){return h.box(h.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e]))},h.minf=function(e){return h.box(h.types.minf,"audio"===e.type?h.box(h.types.smhd,h.SMHD):h.box(h.types.vmhd,h.VMHD),h.DINF,h.stbl(e))},h.moof=function(e,t,r){return h.box(h.types.moof,h.mfhd(e),h.traf(r,t))},h.moov=function(e){for(var t=e.length,r=[];t--;)r[t]=h.trak(e[t]);return h.box.apply(null,[h.types.moov,h.mvhd(e[0].timescale,e[0].duration)].concat(r).concat(h.mvex(e)))},h.mvex=function(e){for(var t=e.length,r=[];t--;)r[t]=h.trex(e[t]);return h.box.apply(null,[h.types.mvex].concat(r))},h.mvhd=function(e,t){var r=Math.floor((t*=e)/(s+1)),i=Math.floor(t%(s+1)),n=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,r>>24,r>>16&255,r>>8&255,255&r,i>>24,i>>16&255,i>>8&255,255&i,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return h.box(h.types.mvhd,n)},h.sdtp=function(e){var t,r,i=e.samples||[],n=new Uint8Array(4+i.length);for(r=0;r<i.length;r++)n[r+4]=(t=i[r].flags).dependsOn<<4|t.isDependedOn<<2|t.hasRedundancy;return h.box(h.types.sdtp,n)},h.stbl=function(e){return h.box(h.types.stbl,h.stsd(e),h.box(h.types.stts,h.STTS),h.box(h.types.stsc,h.STSC),h.box(h.types.stsz,h.STSZ),h.box(h.types.stco,h.STCO))},h.avc1=function(e){var t,r,i,n=[],a=[];for(t=0;t<e.sps.length;t++)n.push((i=(r=e.sps[t]).byteLength)>>>8&255),n.push(255&i),n=n.concat(Array.prototype.slice.call(r));for(t=0;t<e.pps.length;t++)a.push((i=(r=e.pps[t]).byteLength)>>>8&255),a.push(255&i),a=a.concat(Array.prototype.slice.call(r));var o=h.box(h.types.avcC,new Uint8Array([1,n[3],n[4],n[5],255,224|e.sps.length].concat(n).concat([e.pps.length]).concat(a))),s=e.width,l=e.height,u=e.pixelRatio[0],c=e.pixelRatio[1];return h.box(h.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,s>>8&255,255&s,l>>8&255,255&l,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o,h.box(h.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),h.box(h.types.pasp,new Uint8Array([u>>24,u>>16&255,u>>8&255,255&u,c>>24,c>>16&255,c>>8&255,255&c])))},h.esds=function(e){var t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))},h.mp4a=function(e){var t=e.samplerate;return h.box(h.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,255&t,0,0]),h.box(h.types.esds,h.esds(e)))},h.mp3=function(e){var t=e.samplerate;return h.box(h.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,255&t,0,0]))},h.stsd=function(e){return h.box(h.types.stsd,h.STSD,"audio"===e.type?e.isAAC||"mp3"!==e.codec?h.mp4a(e):h.mp3(e):h.avc1(e))},h.tkhd=function(e){var t=e.id,r=e.duration*e.timescale,i=e.width,n=e.height,a=Math.floor(r/(s+1)),o=Math.floor(r%(s+1));return h.box(h.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,0,0,0,0,a>>24,a>>16&255,a>>8&255,255&a,o>>24,o>>16&255,o>>8&255,255&o,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,255&i,0,0,n>>8&255,255&n,0,0]))},h.traf=function(e,t){var r=h.sdtp(e),i=e.id,n=Math.floor(t/(s+1)),a=Math.floor(t%(s+1));return h.box(h.types.traf,h.box(h.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i])),h.box(h.types.tfdt,new Uint8Array([1,0,0,0,n>>24,n>>16&255,n>>8&255,255&n,a>>24,a>>16&255,a>>8&255,255&a])),h.trun(e,r.length+16+20+8+16+8+8),r)},h.trak=function(e){return e.duration=e.duration||4294967295,h.box(h.types.trak,h.tkhd(e),h.mdia(e))},h.trex=function(e){var t=e.id;return h.box(h.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},h.trun=function(e,t){var r,i,n,a,o,s,l=e.samples||[],u=l.length,c=12+16*u,d=new Uint8Array(c);for(d.set([0,0,15,1,u>>>24&255,u>>>16&255,u>>>8&255,255&u,(t+=8+c)>>>24&255,t>>>16&255,t>>>8&255,255&t],0),r=0;r<u;r++)d.set([(n=(i=l[r]).duration)>>>24&255,n>>>16&255,n>>>8&255,255&n,(a=i.size)>>>24&255,a>>>16&255,a>>>8&255,255&a,(o=i.flags).isLeading<<2|o.dependsOn,o.isDependedOn<<6|o.hasRedundancy<<4|o.paddingValue<<1|o.isNonSync,61440&o.degradPrio,15&o.degradPrio,(s=i.cts)>>>24&255,s>>>16&255,s>>>8&255,255&s],12+16*r);return h.box(h.types.trun,d)},h.initSegment=function(e){h.types||h.init();var t,r=h.moov(e);return(t=new Uint8Array(h.FTYP.byteLength+r.byteLength)).set(h.FTYP),t.set(r,h.FTYP.byteLength),t},h}();t.default=i},"./src/remux/mp4-remuxer.js":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var G=r("./src/remux/aac-helper.js"),z=r("./src/remux/mp4-generator.js"),K=r("./src/events.js"),Y=r("./src/errors.js"),X=r("./src/utils/logger.js"),i=function(){function e(e,t,r,i){this.observer=e,this.config=t,this.typeSupported=r;var n=navigator.userAgent;this.isSafari=i&&-1<i.indexOf("Apple")&&n&&!n.match("CriOS"),this.ISGenerated=!1}return e.prototype.destroy=function(){},e.prototype.resetTimeStamp=function(e){this._initPTS=this._initDTS=e},e.prototype.resetInitSegment=function(){this.ISGenerated=!1},e.prototype.remux=function(e,t,r,i,n,a,o){if(this.ISGenerated||this.generateIS(e,t,n),this.ISGenerated){var s=e.samples.length,l=t.samples.length,u=n,c=n;if(s&&l){var d=(e.samples[0].pts-t.samples[0].pts)/t.inputTimeScale;u+=Math.max(0,d),c+=Math.max(0,-d)}if(s){e.timescale||(X.logger.warn("regenerate InitSegment as audio detected"),this.generateIS(e,t,n));var h=this.remuxAudio(e,u,a,o);if(l){var f=void 0;h&&(f=h.endPTS-h.startPTS),t.timescale||(X.logger.warn("regenerate InitSegment as video detected"),this.generateIS(e,t,n)),this.remuxVideo(t,c,a,f,o)}}else if(l){var p=this.remuxVideo(t,c,a,0,o);p&&e.codec&&this.remuxEmptyAudio(e,u,a,p)}}r.samples.length&&this.remuxID3(r,n),i.samples.length&&this.remuxText(i,n),this.observer.trigger(K.default.FRAG_PARSED)},e.prototype.generateIS=function(e,t,r){var i,n,a=this.observer,o=e.samples,s=t.samples,l=this.typeSupported,u="audio/mp4",c={},d={tracks:c},h=void 0===this._initPTS;if(h&&(i=n=1/0),e.config&&o.length&&(e.timescale=e.samplerate,X.logger.log("audio sampling rate : "+e.samplerate),e.isAAC||(l.mpeg?(u="audio/mpeg",e.codec=""):l.mp3&&(e.codec="mp3")),c.audio={container:u,codec:e.codec,initSegment:!e.isAAC&&l.mpeg?new Uint8Array:z.default.initSegment([e]),metadata:{channelCount:e.channelCount}},h&&(i=n=o[0].pts-e.inputTimeScale*r)),t.sps&&t.pps&&s.length){var f=t.inputTimeScale;t.timescale=f,c.video={container:"video/mp4",codec:t.codec,initSegment:z.default.initSegment([t]),metadata:{width:t.width,height:t.height}},h&&(i=Math.min(i,s[0].pts-f*r),n=Math.min(n,s[0].dts-f*r),this.observer.trigger(K.default.INIT_PTS_FOUND,{initPTS:i}))}Object.keys(c).length?(a.trigger(K.default.FRAG_PARSING_INIT_SEGMENT,d),this.ISGenerated=!0,h&&(this._initPTS=i,this._initDTS=n)):a.trigger(K.default.ERROR,{type:Y.ErrorTypes.MEDIA_ERROR,details:Y.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})},e.prototype.remuxVideo=function(e,t,r,i,n){var a,o,s,l,u,c,d=8,h=e.timescale,f=e.samples,p=[],g=f.length,m=this._PTSNormalize,v=this._initPTS,y=this.nextAvcDts,_=this.isSafari;if(0!==g){_&&(r|=f.length&&y&&(n&&Math.abs(t-y/h)<.1||Math.abs(f[0].pts-y-v)<h/5)),r||(y=t*h),f.forEach(function(e){e.pts=m(e.pts-v,y),e.dts=m(e.dts-v,y)}),f.sort(function(e,t){return e.dts-t.dts||e.pts-t.pts||e.id-t.id});var b=f.reduce(function(e,t){return Math.max(Math.min(e,t.pts-t.dts),-18e3)},0);if(b<0){X.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+Math.round(b/90)+" ms to overcome this issue");for(var T=0;T<f.length;T++)f[T].dts+=b}var S=f[0];l=Math.max(S.dts,0),s=Math.max(S.pts,0);var E=Math.round((l-y)/90);r&&E&&(1<E?X.logger.log("AVC:"+E+" ms hole between fragments detected,filling it"):E<-1&&X.logger.log("AVC:"+-E+" ms overlapping between fragments detected"),f[0].dts=l=y,X.logger.log("Video/PTS/DTS adjusted: "+Math.round((f[0].pts=s=Math.max(s-E,y))/90)+"/"+Math.round(l/90)+",delta:"+E+" ms")),u=Math.max((S=f[f.length-1]).pts,0,c=Math.max(S.dts,0)),_&&(a=Math.round((c-l)/(f.length-1)));var k=0,w=0;for(T=0;T<g;T++){for(var C=f[T],A=C.units,L=A.length,I=0,P=0;P<L;P++)I+=A[P].data.length;w+=I,k+=L,C.length=I,C.dts=_?l+T*a:Math.max(C.dts,l),C.pts=Math.max(C.pts,C.dts)}var x=w+4*k+8;try{o=new Uint8Array(x)}catch(e){return void this.observer.trigger(K.default.ERROR,{type:Y.ErrorTypes.MUX_ERROR,details:Y.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:x,reason:"fail allocating video mdat "+x})}var R=new DataView(o.buffer);R.setUint32(0,x),o.set(z.default.types.mdat,4);for(T=0;T<g;T++){var O=f[T],D=O.units,M=0,N=void 0;for(P=0,L=D.length;P<L;P++){var F=D[P],j=F.data,B=F.data.byteLength;R.setUint32(d,B),o.set(j,d+=4),d+=B,M+=4+B}if(_)N=Math.max(0,a*Math.round((O.pts-O.dts)/a));else{if(T<g-1)a=f[T+1].dts-O.dts;else{var U=this.config,H=O.dts-f[0<T?T-1:T].dts;if(U.stretchShortVideoTrack){var G=(i?s+i*h:this.nextAudioPts)-O.pts;Math.floor(U.maxBufferHole*h)<G?((a=G-H)<0&&(a=H),X.logger.log("It is approximately "+G/90+" ms to the next segment; using duration "+a/90+" ms for the last video frame.")):a=H}else a=H}N=Math.round(O.pts-O.dts)}p.push({size:M,duration:a,cts:N,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:O.key?2:1,isNonSync:O.key?0:1}})}this.nextAvcDts=c+a;var q=e.dropped;if(e.len=0,e.nbNalu=0,e.dropped=0,p.length&&-1<navigator.userAgent.toLowerCase().indexOf("chrome")){var V=p[0].flags;V.dependsOn=2,V.isNonSync=0}e.samples=p;var W={data1:z.default.moof(e.sequenceNumber++,l,e),data2:o,startPTS:s/h,endPTS:(u+a)/h,startDTS:l/h,endDTS:this.nextAvcDts/h,type:"video",hasAudio:!(e.samples=[]),hasVideo:!0,nb:p.length,dropped:q};return this.observer.trigger(K.default.FRAG_PARSING_DATA,W),W}},e.prototype.remuxAudio=function(e,t,r,i){var n,a,o,s,l,u,c,d=e.inputTimeScale,h=d/e.timescale,f=(e.isAAC?1024:1152)*h,p=this._PTSNormalize,g=this._initPTS,m=!e.isAAC&&this.typeSupported.mpeg,v=e.samples,y=[],_=this.nextAudioPts;if(r|=v.length&&_&&(i&&Math.abs(t-_/d)<.1||Math.abs(v[0].pts-_-g)<20*f),v.forEach(function(e){e.pts=e.dts=p(e.pts-g,t*d)}),0!==(v=v.filter(function(e){return 0<=e.pts})).length){if(r||(_=i?t*d:v[0].pts),e.isAAC)for(var b=this.config.maxAudioFramesDrift,T=0,S=_;T<v.length;){var E,k=v[T],w=Math.abs(1e3*(E=(R=k.pts)-S)/d);if(E<=-b*f)X.logger.warn("Dropping 1 audio frame @ "+(S/d).toFixed(3)+"s due to "+Math.round(w)+" ms overlap."),v.splice(T,1),e.len-=k.unit.length;else if(b*f<=E&&w<1e4&&S){var C=Math.round(E/f);X.logger.warn("Injecting "+C+" audio frame @ "+(S/d).toFixed(3)+"s due to "+Math.round(1e3*E/d)+" ms gap.");for(var A=0;A<C;A++){var L=Math.max(S,0);(o=G.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(X.logger.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),o=k.unit.subarray()),v.splice(T,0,{unit:o,pts:L,dts:L}),e.len+=o.length,S+=f,T++}k.pts=k.dts=S,S+=f,T++}else k.pts=k.dts=S,S+=f,T++}A=0;for(var I=v.length;A<I;A++){var P=v[A],x=P.unit,R=P.pts;if(void 0!==c)a.duration=Math.round((R-c)/h);else{var O=Math.round(1e3*(R-_)/d),D=0;if(r&&e.isAAC&&O){if(0<O&&O<1e4)D=Math.round((R-_)/f),X.logger.log(O+" ms hole between AAC samples detected,filling it"),0<D&&((o=G.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(o=x.subarray()),e.len+=D*o.length);else if(O<-12){X.logger.log("drop overlapping AAC sample, expected/parsed/delta:"+(_/d).toFixed(3)+"s/"+(R/d).toFixed(3)+"s/"+-O+"ms"),e.len-=x.byteLength;continue}R=_}if(u=R,!(0<e.len))return;var M=m?e.len:e.len+8;n=m?0:8;try{s=new Uint8Array(M)}catch(e){return void this.observer.trigger(K.default.ERROR,{type:Y.ErrorTypes.MUX_ERROR,details:Y.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:M,reason:"fail allocating audio mdat "+M})}m||(new DataView(s.buffer).setUint32(0,M),s.set(z.default.types.mdat,4));for(T=0;T<D;T++)(o=G.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(X.logger.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),o=x.subarray()),s.set(o,n),n+=o.byteLength,y.push(a={size:o.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}})}s.set(x,n);var N=x.byteLength;n+=N,y.push(a={size:N,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}}),c=R}var F=0,j=y.length;if(2<=j&&(a.duration=F=y[j-2].duration),j){this.nextAudioPts=_=c+h*F,e.len=0,e.samples=y,l=m?new Uint8Array:z.default.moof(e.sequenceNumber++,u/h,e);var B=u/d,U=_/d,H={data1:l,data2:s,startPTS:B,endPTS:U,startDTS:B,endDTS:U,type:"audio",hasAudio:!0,hasVideo:!(e.samples=[]),nb:j};return this.observer.trigger(K.default.FRAG_PARSING_DATA,H),H}return null}},e.prototype.remuxEmptyAudio=function(e,t,r,i){var n=e.inputTimeScale,a=this.nextAudioPts,o=(void 0!==a?a:i.startDTS*n)+this._initDTS,s=1024*(n/(e.samplerate?e.samplerate:n)),l=Math.ceil((i.endDTS*n+this._initDTS-o)/s),u=G.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(X.logger.warn("remux empty Audio"),u){for(var c=[],d=0;d<l;d++){var h=o+d*s;c.push({unit:u,pts:h,dts:h}),e.len+=u.length}e.samples=c,this.remuxAudio(e,t,r)}else X.logger.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!")},e.prototype.remuxID3=function(e){var t,r=e.samples.length,i=e.inputTimeScale,n=this._initPTS,a=this._initDTS;if(r){for(var o=0;o<r;o++)(t=e.samples[o]).pts=(t.pts-n)/i,t.dts=(t.dts-a)/i;this.observer.trigger(K.default.FRAG_PARSING_METADATA,{samples:e.samples})}e.samples=[]},e.prototype.remuxText=function(e){e.samples.sort(function(e,t){return e.pts-t.pts});var t,r=e.samples.length,i=e.inputTimeScale,n=this._initPTS;if(r){for(var a=0;a<r;a++)(t=e.samples[a]).pts=(t.pts-n)/i;this.observer.trigger(K.default.FRAG_PARSING_USERDATA,{samples:e.samples})}e.samples=[]},e.prototype._PTSNormalize=function(e,t){var r;if(void 0===t)return e;for(r=t<e?-8589934592:8589934592;4294967296<Math.abs(e-t);)e+=r;return e},e}();t.default=i},"./src/remux/passthrough-remuxer.js":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var c=r("./src/events.js"),i=function(){function e(e){this.observer=e}return e.prototype.destroy=function(){},e.prototype.resetTimeStamp=function(){},e.prototype.resetInitSegment=function(){},e.prototype.remux=function(e,t,r,i,n,a,o,s){var l=this.observer,u="";e&&(u+="audio"),t&&(u+="video"),l.trigger(c.default.FRAG_PARSING_DATA,{data1:s,startPTS:n,startDTS:n,type:u,hasAudio:!!e,hasVideo:!!t,nb:1,dropped:0}),l.trigger(c.default.FRAG_PARSED)},e}();t.default=i},"./src/task-loop.js":function(e,t,r){var i,a=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){function e(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var i=n.apply(this,[e].concat(t))||this;return i._tickInterval=null,i._tickTimer=null,i._tickCallCount=0,i._boundTick=i.tick.bind(i),i}return a(e,n),e.prototype.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},e.prototype.hasInterval=function(){return!!this._tickInterval},e.prototype.hasNextTick=function(){return!!this._tickTimer},e.prototype.setInterval=function(e){return!this._tickInterval&&(this._tickInterval=setInterval(this._boundTick,e),!0)},e.prototype.clearInterval=function(){return!!this._tickInterval&&(clearInterval(this._tickInterval),!(this._tickInterval=null))},e.prototype.clearNextTick=function(){return!!this._tickTimer&&(clearTimeout(this._tickTimer),!(this._tickTimer=null))},e.prototype.tick=function(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),1<this._tickCallCount&&(this.clearNextTick(),this._tickTimer=setTimeout(this._boundTick,0)),this._tickCallCount=0)},e.prototype.doTick=function(){},e}(r("./src/event-handler.js").default);t.default=n},"./src/utils/attr-list.js":function(e,t,r){!function(i){Object.defineProperty(t,"__esModule",{value:!0});var n=/^(\d+)x(\d+)$/,a=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,e=function(){function r(e){for(var t in"string"==typeof e&&(e=r.parseAttrList(e)),e)e.hasOwnProperty(t)&&(this[t]=e[t])}return r.prototype.decimalInteger=function(e){var t=parseInt(this[e],10);return i.MAX_SAFE_INTEGER<t?1/0:t},r.prototype.hexadecimalInteger=function(e){if(this[e]){var t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;for(var r=new Uint8Array(t.length/2),i=0;i<t.length/2;i++)r[i]=parseInt(t.slice(2*i,2*i+2),16);return r}return null},r.prototype.hexadecimalIntegerAsNumber=function(e){var t=parseInt(this[e],16);return i.MAX_SAFE_INTEGER<t?1/0:t},r.prototype.decimalFloatingPoint=function(e){return parseFloat(this[e])},r.prototype.enumeratedString=function(e){return this[e]},r.prototype.decimalResolution=function(e){var t=n.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}},r.parseAttrList=function(e){var t,r={};for(a.lastIndex=0;null!==(t=a.exec(e));){var i=t[2];0==i.indexOf('"')&&i.lastIndexOf('"')==i.length-1&&(i=i.slice(1,-1)),r[t[1]]=i}return r},r}();t.default=e}(r("./src/polyfills/number.js").Number)},"./src/utils/binary-search.js":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});t.default={search:function(e,t){for(var r=0,i=e.length-1,n=null,a=null;r<=i;){var o=t(a=e[n=(r+i)/2|0]);if(0<o)r=n+1;else{if(!(o<0))return a;i=n-1}}return null}}},"./src/utils/buffer-helper.js":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.isBuffered=function(e,t){try{if(e)for(var r=e.buffered,i=0;i<r.length;i++)if(t>=r.start(i)&&t<=r.end(i))return!0}catch(e){}return!1},e.bufferInfo=function(e,t,r){try{if(e){var i=e.buffered,n=[],a=void 0;for(a=0;a<i.length;a++)n.push({start:i.start(a),end:i.end(a)});return this.bufferedInfo(n,t,r)}}catch(e){}return{len:0,start:t,end:t,nextStart:void 0}},e.bufferedInfo=function(e,t,r){var i,n,a,o,s,l=[];for(e.sort(function(e,t){var r=e.start-t.start;return r||t.end-e.end}),s=0;s<e.length;s++){var u=l.length;if(u){var c=l[u-1].end;e[s].start-c<r?c<e[s].end&&(l[u-1].end=e[s].end):l.push(e[s])}else l.push(e[s])}for(i=s=0,n=a=t;s<l.length;s++){var d=l[s].start,h=l[s].end;if(d<=t+r&&t<h)n=d,i=(a=h)-t;else if(t+r<d){o=d;break}}return{len:i,start:n,end:a,nextStart:o}},e}();t.BufferHelper=i},"./src/utils/cea-608-parser.js":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var i={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},s=function(e){var t=e;return i.hasOwnProperty(e)&&(t=i[e]),String.fromCharCode(t)},n={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},a={17:2,18:4,21:6,22:8,23:10,19:13,20:15},o={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},l={25:2,26:4,29:6,30:8,31:10,27:13,28:15},u=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],c={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(e){this.time=e},log:function(e,t){}},d=function(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r].toString(16));return t},h=function(){function e(e,t,r,i,n){this.foreground=e||"white",this.underline=t||!1,this.italics=r||!1,this.background=i||"black",this.flash=n||!1}return e.prototype.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},e.prototype.setStyles=function(e){for(var t=["foreground","underline","italics","background","flash"],r=0;r<t.length;r++){var i=t[r];e.hasOwnProperty(i)&&(this[i]=e[i])}},e.prototype.isDefault=function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},e.prototype.equals=function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash},e.prototype.copy=function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash},e.prototype.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},e}(),f=function(){function e(e,t,r,i,n,a){this.uchar=e||" ",this.penState=new h(t,r,i,n,a)}return e.prototype.reset=function(){this.uchar=" ",this.penState.reset()},e.prototype.setChar=function(e,t){this.uchar=e,this.penState.copy(t)},e.prototype.setPenState=function(e){this.penState.copy(e)},e.prototype.equals=function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)},e.prototype.copy=function(e){this.uchar=e.uchar,this.penState.copy(e.penState)},e.prototype.isEmpty=function(){return" "===this.uchar&&this.penState.isDefault()},e}(),p=function(){function e(){this.chars=[];for(var e=0;e<100;e++)this.chars.push(new f);this.pos=0,this.currPenState=new h}return e.prototype.equals=function(e){for(var t=!0,r=0;r<100;r++)if(!this.chars[r].equals(e.chars[r])){t=!1;break}return t},e.prototype.copy=function(e){for(var t=0;t<100;t++)this.chars[t].copy(e.chars[t])},e.prototype.isEmpty=function(){for(var e=!0,t=0;t<100;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e},e.prototype.setCursor=function(e){this.pos!==e&&(this.pos=e),this.pos<0?(c.log("ERROR","Negative cursor position "+this.pos),this.pos=0):100<this.pos&&(c.log("ERROR","Too large cursor position "+this.pos),this.pos=100)},e.prototype.moveCursor=function(e){var t=this.pos+e;if(1<e)for(var r=this.pos+1;r<t+1;r++)this.chars[r].setPenState(this.currPenState);this.setCursor(t)},e.prototype.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},e.prototype.insertChar=function(e){144<=e&&this.backSpace();var t=s(e);100<=this.pos?c.log("ERROR","Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))},e.prototype.clearFromPos=function(e){var t;for(t=e;t<100;t++)this.chars[t].reset()},e.prototype.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},e.prototype.clearToEndOfRow=function(){this.clearFromPos(this.pos)},e.prototype.getTextString=function(){for(var e=[],t=!0,r=0;r<100;r++){var i=this.chars[r].uchar;" "!==i&&(t=!1),e.push(i)}return t?"":e.join("")},e.prototype.setPenStyles=function(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)},e}(),g=function(){function e(){this.rows=[];for(var e=0;e<15;e++)this.rows.push(new p);this.currRow=14,this.nrRollUpRows=null,this.reset()}return e.prototype.reset=function(){for(var e=0;e<15;e++)this.rows[e].clear();this.currRow=14},e.prototype.equals=function(e){for(var t=!0,r=0;r<15;r++)if(!this.rows[r].equals(e.rows[r])){t=!1;break}return t},e.prototype.copy=function(e){for(var t=0;t<15;t++)this.rows[t].copy(e.rows[t])},e.prototype.isEmpty=function(){for(var e=!0,t=0;t<15;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e},e.prototype.backSpace=function(){this.rows[this.currRow].backSpace()},e.prototype.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},e.prototype.insertChar=function(e){this.rows[this.currRow].insertChar(e)},e.prototype.setPen=function(e){this.rows[this.currRow].setPenStyles(e)},e.prototype.moveCursor=function(e){this.rows[this.currRow].moveCursor(e)},e.prototype.setCursor=function(e){c.log("INFO","setCursor: "+e),this.rows[this.currRow].setCursor(e)},e.prototype.setPAC=function(e){c.log("INFO","pacData = "+JSON.stringify(e));var t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(var r=0;r<15;r++)this.rows[r].clear();var i=this.currRow+1-this.nrRollUpRows,n=this.lastOutputScreen;if(n){var a=n.rows[i].cueStartTime;if(a&&a<c.time)for(r=0;r<this.nrRollUpRows;r++)this.rows[t-this.nrRollUpRows+r+1].copy(n.rows[i+r])}}this.currRow=t;var o=this.rows[this.currRow];if(null!==e.indent){var s=Math.max(e.indent-1,0);o.setCursor(e.indent),e.color=o.chars[s].penState.foreground}this.setPen({foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1})},e.prototype.setBkgData=function(e){c.log("INFO","bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)},e.prototype.setRollUpRows=function(e){this.nrRollUpRows=e},e.prototype.rollUp=function(){if(null!==this.nrRollUpRows){c.log("TEXT",this.getDisplayText());var e=this.rows.splice(this.currRow+1-this.nrRollUpRows,1)[0];e.clear(),this.rows.splice(this.currRow,0,e),c.log("INFO","Rolling up")}else c.log("DEBUG","roll_up but nrRollUpRows not set yet")},e.prototype.getDisplayText=function(e){e=e||!1;for(var t=[],r="",i=0;i<15;i++){var n=this.rows[i].getTextString();n&&t.push(e?"Row "+(i+1)+": '"+n+"'":n.trim())}return 0<t.length&&(r=e?"["+t.join(" | ")+"]":t.join("\n")),r},e.prototype.getTextAndFormat=function(){return this.rows},e}(),m=function(){function e(e,t){this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new g,this.nonDisplayedMemory=new g,this.lastOutputScreen=new g,this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}return e.prototype.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null},e.prototype.getHandler=function(){return this.outputFilter},e.prototype.setHandler=function(e){this.outputFilter=e},e.prototype.setPAC=function(e){this.writeScreen.setPAC(e)},e.prototype.setBkgData=function(e){this.writeScreen.setBkgData(e)},e.prototype.setMode=function(e){e!==this.mode&&(c.log("INFO","MODE="+(this.mode=e)),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)},e.prototype.insertChars=function(e){for(var t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);c.log("INFO",(this.writeScreen===this.displayedMemory?"DISP":"NON_DISP")+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(c.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},e.prototype.ccRCL=function(){c.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},e.prototype.ccBS=function(){c.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},e.prototype.ccAOF=function(){},e.prototype.ccAON=function(){},e.prototype.ccDER=function(){c.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},e.prototype.ccRU=function(e){c.log("INFO","RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)},e.prototype.ccFON=function(){c.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})},e.prototype.ccRDC=function(){c.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},e.prototype.ccTR=function(){c.log("INFO","TR"),this.setMode("MODE_TEXT")},e.prototype.ccRTD=function(){c.log("INFO","RTD"),this.setMode("MODE_TEXT")},e.prototype.ccEDM=function(){c.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},e.prototype.ccCR=function(){c.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},e.prototype.ccENM=function(){c.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},e.prototype.ccEOC=function(){if(c.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,c.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},e.prototype.ccTO=function(e){c.log("INFO","TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)},e.prototype.ccMIDROW=function(e){var t={flash:!1};if(t.underline=e%2==1,t.italics=46<=e,t.italics)t.foreground="white";else{t.foreground=["white","green","blue","cyan","red","yellow","magenta"][Math.floor(e/2)-16]}c.log("INFO","MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)},e.prototype.outputDataUpdate=function(e){void 0===e&&(e=!1)},e.prototype.cueSplitAtTime=function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))},e}(),v=function(){function e(e,t,r){this.field=e||1,this.outputs=[t,r],this.channels=[new m(1,t),new m(2,r)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0}}return e.prototype.getHandler=function(e){return this.channels[e].getHandler()},e.prototype.setHandler=function(e,t){this.channels[e].setHandler(t)},e.prototype.addData=function(e,t){var r,i,n,a=!1;c.setTime(this.lastTime=e);for(var o=0;o<t.length;o+=2)if(n=127&t[o+1],0!==(i=127&t[o])||0!==n){if(c.log("DATA","["+d([t[o],t[o+1]])+"] -> ("+d([i,n])+")"),(r=this.parseCmd(i,n))||(r=this.parseMidrow(i,n)),r||(r=this.parsePAC(i,n)),r||(r=this.parseBackgroundAttributes(i,n)),!r)if(a=this.parseChars(i,n))if(this.currChNr&&0<=this.currChNr)this.channels[this.currChNr-1].insertChars(a);else c.log("WARNING","No channel found yet. TEXT-MODE?");r?this.dataCounters.cmd+=2:a?this.dataCounters.char+=2:(this.dataCounters.other+=2,c.log("WARNING","Couldn't parse cleaned data "+d([i,n])+" orig: "+d([t[o],t[o+1]])))}else this.dataCounters.padding+=2},e.prototype.parseCmd=function(e,t){var r=null;if(!((20===e||28===e)&&32<=t&&t<=47)&&!((23===e||31===e)&&33<=t&&t<=35))return!1;if(e===this.lastCmdA&&t===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,c.log("DEBUG","Repeated command ("+d([e,t])+") is dropped"),!0;var i=this.channels[(r=20===e||23===e?1:2)-1];return 20===e||28===e?32===t?i.ccRCL():33===t?i.ccBS():34===t?i.ccAOF():35===t?i.ccAON():36===t?i.ccDER():37===t?i.ccRU(2):38===t?i.ccRU(3):39===t?i.ccRU(4):40===t?i.ccFON():41===t?i.ccRDC():42===t?i.ccTR():43===t?i.ccRTD():44===t?i.ccEDM():45===t?i.ccCR():46===t?i.ccENM():47===t&&i.ccEOC():i.ccTO(t-32),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=r,!0},e.prototype.parseMidrow=function(e,t){var r=null;return(17===e||25===e)&&32<=t&&t<=47&&((r=17===e?1:2)!==this.currChNr?(c.log("ERROR","Mismatch channel in midrow parsing"),!1):(this.channels[r-1].ccMIDROW(t),c.log("DEBUG","MIDROW ("+d([e,t])+")"),!0))},e.prototype.parsePAC=function(e,t){var r;if(!((17<=e&&e<=23||25<=e&&e<=31)&&64<=t&&t<=127)&&!((16===e||24===e)&&64<=t&&t<=95))return!1;if(e===this.lastCmdA&&t===this.lastCmdB)return this.lastCmdA=null,!(this.lastCmdB=null);r=e<=23?1:2;var i=this.interpretPAC(64<=t&&t<=95?1===r?n[e]:o[e]:1===r?a[e]:l[e],t);return this.channels[r-1].setPAC(i),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=r,!0},e.prototype.interpretPAC=function(e,t){var r=t,i={color:null,italics:!1,indent:null,underline:!1,row:e};return i.underline=1==(1&(r=95<t?t-96:t-64)),r<=13?i.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(r/2)]:r<=15?(i.italics=!0,i.color="white"):i.indent=4*Math.floor((r-16)/2),i},e.prototype.parseChars=function(e,t){var r=null,i=null,n=null;if(17<=(n=25<=e?(r=2,e-8):(r=1,e))&&n<=19){var a=t;c.log("INFO","Special char '"+s(a=17===n?t+80:18===n?t+112:t+144)+"' in channel "+r),i=[a]}else 32<=e&&e<=127&&(i=0===t?[e]:[e,t]);if(i){var o=d(i);c.log("DEBUG","Char codes =  "+o.join(",")),this.lastCmdA=null,this.lastCmdB=null}return i},e.prototype.parseBackgroundAttributes=function(e,t){var r;return((16===e||24===e)&&32<=t&&t<=47||(23===e||31===e)&&45<=t&&t<=47)&&(r={},16===e||24===e?(r.background=u[Math.floor((t-32)/2)],t%2==1&&(r.background=r.background+"_semi")):45===t?r.background="transparent":(r.foreground="black",47===t&&(r.underline=!0)),this.channels[(e<24?1:2)-1].setBkgData(r),this.lastCmdA=null,!(this.lastCmdB=null))},e.prototype.reset=function(){for(var e=0;e<this.channels.length;e++)this.channels[e]&&this.channels[e].reset();this.lastCmdA=null,this.lastCmdB=null},e.prototype.cueSplitAtTime=function(e){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].cueSplitAtTime(e)},e}();t.default=v},"./src/utils/codecs.js":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var i={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0}};t.isCodecType=function(e,t){var r=i[t];return!!r&&!0===r[e.slice(0,4)]},t.isCodecSupportedInMp4=function(e,t){return window.MediaSource.isTypeSupported((t||"video")+'/mp4;codecs="'+e+'"')}},"./src/utils/cues.js":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var h=r("./src/utils/vttparser.js");t.newCue=function(e,t,r,i){for(var n,a,o,s,l,u=window.VTTCue||window.TextTrackCue,c=0;c<i.rows.length;c++)if(o=!0,s=0,l="",!(n=i.rows[c]).isEmpty()){for(var d=0;d<n.chars.length;d++)n.chars[d].uchar.match(/\s/)&&o?s++:(l+=n.chars[d].uchar,o=!1);(n.cueStartTime=t)===r&&(r+=1e-4),16<=s?s--:s++,(a=new u(t,r,h.fixLineBreaks(l.trim()))).line=navigator.userAgent.match(/Firefox\//)?c+1:7<c?c-2:c+1,a.align="left",a.position=Math.max(0,Math.min(100,s/32*100+(navigator.userAgent.match(/Firefox\//)?50:0))),e.addCue(a)}}},"./src/utils/discontinuities.js":function(e,t,d){!function(i){Object.defineProperty(t,"__esModule",{value:!0});var r=d("./src/utils/binary-search.js"),a=d("./src/utils/logger.js");function o(e,t){for(var r=null,i=0;i<e.length;i+=1){var n=e[i];if(n&&n.cc===t){r=n;break}}return r}function n(e,t,r){var i=!1;return t&&t.details&&r&&(r.startCC<r.endCC||e&&e.cc<r.startCC)&&(i=!0),i}function s(e,t){var r=e.fragments,i=t.fragments;if(i.length&&r.length){var n=o(r,i[0].cc);if(n&&(!n||n.startPTS))return n;a.logger.log("No frag in previous level to align on")}else a.logger.log("No fragments to align")}function l(r,e){e.fragments.forEach(function(e){if(e){var t=e.start+r;e.start=e.startPTS=t,e.endPTS=t+e.duration}}),e.PTSKnown=!0}function u(e,t,r){if(n(e,r,t)){var i=s(r.details,t);i&&(a.logger.log("Adjusting PTS using last level due to CC increase within current level"),l(i.start,t))}}function c(e,t){if(t&&t.fragments.length){if(!e.hasProgramDateTime||!t.hasProgramDateTime)return;var r=(e.fragments[0].programDateTime-t.fragments[0].programDateTime)/1e3+t.fragments[0].start;i.isFinite(r)&&(a.logger.log("adjusting PTS using programDateTime delta, sliding:"+r.toFixed(3)),l(r,e))}}t.findFirstFragWithCC=o,t.findFragWithCC=function(e,t){return r.default.search(e,function(e){return e.cc<t?1:t<e.cc?-1:0})},t.shouldAlignOnDiscontinuities=n,t.findDiscontinuousReferenceFrag=s,t.adjustPts=l,t.alignStream=function(e,t,r){u(e,r,t),!r.PTSKnown&&t&&c(r,t.details)},t.alignDiscontinuities=u,t.alignPDT=c}(d("./src/polyfills/number.js").Number)},"./src/utils/ewma-bandwidth-estimator.js":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r("./src/utils/ewma.js"),i=function(){function e(e,t,r,i){this.hls=e,this.defaultEstimate_=i,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new n.default(t),this.fast_=new n.default(r)}return e.prototype.sample=function(e,t){var r=8e3*t/(e=Math.max(e,this.minDelayMs_)),i=e/1e3;this.fast_.sample(i,r),this.slow_.sample(i,r)},e.prototype.canEstimate=function(){var e=this.fast_;return e&&e.getTotalWeight()>=this.minWeight_},e.prototype.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},e.prototype.destroy=function(){},e}();t.default=i},"./src/utils/ewma.js":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=0,this.totalWeight_=0}return e.prototype.sample=function(e,t){var r=Math.pow(this.alpha_,e);this.estimate_=t*(1-r)+r*this.estimate_,this.totalWeight_+=e},e.prototype.getTotalWeight=function(){return this.totalWeight_},e.prototype.getEstimate=function(){return this.alpha_?this.estimate_/(1-Math.pow(this.alpha_,this.totalWeight_)):this.estimate_},e}();t.default=i},"./src/utils/get-self-scope.js":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getSelfScope=function(){return"undefined"==typeof window?self:window}},"./src/utils/logger.js":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var i=r("./src/utils/get-self-scope.js");function n(){}var a={trace:n,debug:n,log:n,warn:n,info:n,error:n},o=a;var s=i.getSelfScope();function l(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];e.forEach(function(e){var r,i;o[e]=t[e]?t[e].bind(t):(i=s.console[r=e])?function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e[0]&&(e[0]="["+r+"] > "+e[0]),i.apply(s.console,e)}:n})}t.enableLogs=function(e){if(!0===e||"object"==typeof e){l(e,"debug","log","info","warn","error");try{o.log()}catch(e){o=a}}else o=a},t.logger=o},"./src/utils/mediakeys-helper.js":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var i="undefined"!=typeof window&&window.navigator&&window.navigator.requestMediaKeySystemAccess?window.navigator.requestMediaKeySystemAccess.bind(window.navigator):null;t.requestMediaKeySystemAccess=i},"./src/utils/mediasource-helper.js":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getMediaSource=function(){if("undefined"!=typeof window)return window.MediaSource||window.WebKitMediaSource}},"./src/utils/output-filter.js":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){this.timelineController=e,this.trackName=t,this.startTime=null,this.endTime=null,this.screen=null}return e.prototype.dispatchCue=function(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen),this.startTime=null)},e.prototype.newCue=function(e,t,r){(null===this.startTime||e<this.startTime)&&(this.startTime=e),this.endTime=t,this.screen=r,this.timelineController.createCaptionsTrack(this.trackName)},e}();t.default=i},"./src/utils/texttrack-utils.js":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.sendAddTrackEvent=function(e,t){var r=null;try{r=new window.Event("addtrack")}catch(e){(r=document.createEvent("Event")).initEvent("addtrack",!1,!1)}r.track=e,t.dispatchEvent(r)},t.clearCurrentCues=function(e){if(e&&e.cues)for(;0<e.cues.length;)e.removeCue(e.cues[0])}},"./src/utils/time-ranges.js":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});t.default={toString:function(e){for(var t="",r=e.length,i=0;i<r;i++)t+="["+e.start(i).toFixed(3)+","+e.end(i).toFixed(3)+"]";return t}}},"./src/utils/vttcue.js":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){if("undefined"!=typeof window&&window.VTTCue)return window.VTTCue;var b={"":!0,lr:!0,rl:!0},t={start:!0,middle:!0,end:!0,left:!0,right:!0};function T(e){return"string"==typeof e&&(!!t[e.toLowerCase()]&&e.toLowerCase())}function S(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)e[i]=r[i]}return e}function e(e,t,r){var i=this,n=function(){if("undefined"!=typeof navigator)return/MSIE\s8\.0/.test(navigator.userAgent)}(),a={};n?i=document.createElement("custom"):a.enumerable=!0;var o="",s=i.hasBeenReset=!1,l=e,u=t,c=r,d=null,h="",f=!0,p="auto",g="start",m=50,v="middle",y=50,_="middle";if(Object.defineProperty(i,"id",S({},a,{get:function(){return o},set:function(e){o=""+e}})),Object.defineProperty(i,"pauseOnExit",S({},a,{get:function(){return s},set:function(e){s=!!e}})),Object.defineProperty(i,"startTime",S({},a,{get:function(){return l},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");l=e,this.hasBeenReset=!0}})),Object.defineProperty(i,"endTime",S({},a,{get:function(){return u},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");u=e,this.hasBeenReset=!0}})),Object.defineProperty(i,"text",S({},a,{get:function(){return c},set:function(e){c=""+e,this.hasBeenReset=!0}})),Object.defineProperty(i,"region",S({},a,{get:function(){return d},set:function(e){d=e,this.hasBeenReset=!0}})),Object.defineProperty(i,"vertical",S({},a,{get:function(){return h},set:function(e){var t,r="string"==typeof(t=e)&&!!b[t.toLowerCase()]&&t.toLowerCase();if(!1===r)throw new SyntaxError("An invalid or illegal string was specified.");h=r,this.hasBeenReset=!0}})),Object.defineProperty(i,"snapToLines",S({},a,{get:function(){return f},set:function(e){f=!!e,this.hasBeenReset=!0}})),Object.defineProperty(i,"line",S({},a,{get:function(){return p},set:function(e){if("number"!=typeof e&&"auto"!==e)throw new SyntaxError("An invalid number or illegal string was specified.");p=e,this.hasBeenReset=!0}})),Object.defineProperty(i,"lineAlign",S({},a,{get:function(){return g},set:function(e){var t=T(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");g=t,this.hasBeenReset=!0}})),Object.defineProperty(i,"position",S({},a,{get:function(){return m},set:function(e){if(e<0||100<e)throw Error("Position must be between 0 and 100.");m=e,this.hasBeenReset=!0}})),Object.defineProperty(i,"positionAlign",S({},a,{get:function(){return v},set:function(e){var t=T(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");v=t,this.hasBeenReset=!0}})),Object.defineProperty(i,"size",S({},a,{get:function(){return y},set:function(e){if(e<0||100<e)throw Error("Size must be between 0 and 100.");y=e,this.hasBeenReset=!0}})),Object.defineProperty(i,"align",S({},a,{get:function(){return _},set:function(e){var t=T(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");_=t,this.hasBeenReset=!0}})),i.displayState=void 0,n)return i}return e.prototype.getCueAsHTML=function(){return window.WebVTT.convertCueToDOMTree(window,this.text)},e}()},"./src/utils/vttparser.js":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var s=r("./src/utils/vttcue.js"),i=function(){return{decode:function(e){if(!e)return"";if("string"!=typeof e)throw Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}};function n(){this.window=window,this.state="INITIAL",this.buffer="",this.decoder=new i,this.regionList=[]}function l(){this.values=Object.create(null)}function u(e,t,r,i){var n=i?e.split(i):[e];for(var a in n)if("string"==typeof n[a]){var o=n[a].split(r);if(2===o.length)t(o[0],o[1])}}l.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,r){return r?this.has(e)?this.values[e]:t[r]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,r){for(var i=0;i<r.length;++i)if(t===r[i]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&0<=(t=parseFloat(t))&&t<=100)&&(this.set(e,t),!0)}};var c=new s.default(0,0,0),d="middle"===c.align?"middle":"center";function h(t,e,o){var r=t;function i(){var e=function(e){function t(e,t,r,i){return 3600*(0|e)+60*(0|t)+(0|r)+(0|i)/1e3}var r=e.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return r?r[3]?t(r[1],r[2],r[3].replace(":",""),r[4]):59<r[1]?t(r[1],r[2],0,r[4]):t(0,r[1],r[2],r[4]):null}(t);if(null===e)throw Error("Malformed timestamp: "+r);return t=t.replace(/^[^\sa-zA-Z-]+/,""),e}function n(){t=t.replace(/^\s+/,"")}if(n(),e.startTime=i(),n(),"--\x3e"!==t.substr(0,3))throw Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+r);t=t.substr(3),n(),e.endTime=i(),n(),function(e,t){var a=new l;u(e,function(e,t){switch(e){case"region":for(var r=o.length-1;0<=r;r--)if(o[r].id===t){a.set(e,o[r].region);break}break;case"vertical":a.alt(e,t,["rl","lr"]);break;case"line":var i=t.split(","),n=i[0];a.integer(e,n),a.percent(e,n)&&a.set("snapToLines",!1),a.alt(e,n,["auto"]),2===i.length&&a.alt("lineAlign",i[1],["start",d,"end"]);break;case"position":i=t.split(","),a.percent(e,i[0]),2===i.length&&a.alt("positionAlign",i[1],["start",d,"end","line-left","line-right","auto"]);break;case"size":a.percent(e,t);break;case"align":a.alt(e,t,["start",d,"end","left","right"])}},/:/,/\s/),t.region=a.get("region",null),t.vertical=a.get("vertical","");var r=a.get("line","auto");"auto"===r&&-1===c.line&&(r=-1),t.line=r,t.lineAlign=a.get("lineAlign","start"),t.snapToLines=a.get("snapToLines",!0),t.size=a.get("size",100),t.align=a.get("align",d);var i=a.get("position","auto");"auto"===i&&50===c.position&&(i="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50),t.position=i}(t,e)}function f(e){return e.replace(/<br(?: \/)?>/gi,"\n")}t.fixLineBreaks=f,n.prototype={parse:function(e){var i=this;function t(){var e=i.buffer,t=0;for(e=f(e);t<e.length&&"\r"!==e[t]&&"\n"!==e[t];)++t;var r=e.substr(0,t);return"\r"===e[t]&&++t,"\n"===e[t]&&++t,i.buffer=e.substr(t),r}e&&(i.buffer+=i.decoder.decode(e,{stream:!0}));try{var r=void 0;if("INITIAL"===i.state){if(!/\r\n|\n/.test(i.buffer))return this;var n=(r=t()).match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!n||!n[0])throw Error("Malformed WebVTT signature.");i.state="HEADER"}for(var a=!1;i.buffer;){if(!/\r\n|\n/.test(i.buffer))return this;switch(a?a=!1:r=t(),i.state){case"HEADER":/:/.test(r)?u(r,function(e,t){},/:/):r||(i.state="ID");continue;case"NOTE":r||(i.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(r)){i.state="NOTE";break}if(!r)continue;if(i.cue=new s.default(0,0,""),i.state="CUE",-1==r.indexOf("--\x3e")){i.cue.id=r;continue}case"CUE":try{h(r,i.cue,i.regionList)}catch(e){i.cue=null,i.state="BADCUE";continue}i.state="CUETEXT";continue;case"CUETEXT":var o=-1!=r.indexOf("--\x3e");if(!r||o&&(a=!0)){i.oncue&&i.oncue(i.cue),i.cue=null,i.state="ID";continue}i.cue.text&&(i.cue.text+="\n"),i.cue.text+=r;continue;case"BADCUE":r||(i.state="ID");continue}}}catch(e){"CUETEXT"===i.state&&i.cue&&i.oncue&&i.oncue(i.cue),i.cue=null,i.state="INITIAL"===i.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){try{if(this.buffer+=this.decoder.decode(),(this.cue||"HEADER"===this.state)&&(this.buffer+="\n\n",this.parse()),"INITIAL"===this.state)throw Error("Malformed WebVTT signature.")}catch(e){throw e}return this.onflush&&this.onflush(),this}},t.default=n},"./src/utils/webvtt-parser.js":function(e,t,r){!function(m){Object.defineProperty(t,"__esModule",{value:!0});var a=r("./src/utils/vttparser.js"),v=r("./src/demux/id3.js"),y=function(e,t,r){return e.substr(r||0,t.length)===t},_=function(e){for(var t=5381,r=e.length;r;)t=33*t^e.charCodeAt(--r);return""+(t>>>0)};t.default={parse:function(e,o,s,l,t,r){var u,i=v.utf8ArrayToStr(new Uint8Array(e)).trim().replace(/\r\n|\n\r|\n|\r/g,"\n").split("\n"),c="00:00.000",d=0,h=0,f=0,n=[],p=!0,g=new a.default;g.oncue=function(e){var t=s[l],r=s.ccOffset;t&&t.new&&(void 0!==h?r=s.ccOffset=t.start:function(e,t,r){var i=e[t],n=e[i.prevCC];if(!n||!n.new&&i.new)return e.ccOffset=e.presentationOffset=i.start,i.new=!1;for(;n&&n.new;)e.ccOffset+=i.start-n.start,i.new=!1,n=e[(i=n).prevCC];e.presentationOffset=r}(s,l,f)),f&&(r=f-s.presentationOffset),e.startTime+=r-h,e.endTime+=r-h,e.id=_(""+e.startTime)+_(""+e.endTime)+_(e.text),e.text=decodeURIComponent(encodeURIComponent(e.text)),0<e.endTime&&n.push(e)},g.onparsingerror=function(e){u=e},g.onflush=function(){u&&r?r(u):t(n)},i.forEach(function(t){if(p){if(y(t,"X-TIMESTAMP-MAP=")){p=!1,t.substr(16).split(",").forEach(function(e){y(e,"LOCAL:")?c=e.substr(6):y(e,"MPEGTS:")&&(d=parseInt(e.substr(7)))});try{o+(9e4*s[l].start||0)<0&&(o+=8589934592),d-=o,r=parseInt((e=c).substr(-3)),i=parseInt(e.substr(-6,2)),n=parseInt(e.substr(-9,2)),a=9<e.length?parseInt(e.substr(0,e.indexOf(":"))):0,h=(m.isFinite(r)&&m.isFinite(i)&&m.isFinite(n)&&m.isFinite(a)?(r+=1e3*i,r+=6e4*n,r+=36e5*a):-1)/1e3,f=d/9e4,-1===h&&(u=Error("Malformed X-TIMESTAMP-MAP: "+t))}catch(e){u=Error("Malformed X-TIMESTAMP-MAP: "+t)}return}""===t&&(p=!1)}var e,r,i,n,a;g.parse(t+"\n")}),g.flush()}}}(r("./src/polyfills/number.js").Number)},"./src/utils/xhr-loader.js":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var u=r("./src/utils/logger.js"),c=window.performance,n=window.XMLHttpRequest,i=function(){function e(e){e&&e.xhrSetup&&(this.xhrSetup=e.xhrSetup)}return e.prototype.destroy=function(){this.abort(),this.loader=null},e.prototype.abort=function(){var e=this.loader;e&&4!==e.readyState&&(this.stats.aborted=!0,e.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null},e.prototype.load=function(e,t,r){this.context=e,this.config=t,this.callbacks=r,this.stats={trequest:c.now(),retry:0},this.retryDelay=t.retryDelay,this.loadInternal()},e.prototype.loadInternal=function(){var t,r=this.context;t=this.loader=new n;var e=this.stats;e.tfirst=0,e.loaded=0;var i=this.xhrSetup;try{if(i)try{i(t,r.url)}catch(e){t.open("GET",r.url,!0),i(t,r.url)}t.readyState||t.open("GET",r.url,!0)}catch(e){return void this.callbacks.onError({code:t.status,text:e.message},r,t)}r.rangeEnd&&t.setRequestHeader("Range","bytes="+r.rangeStart+"-"+(r.rangeEnd-1)),t.onreadystatechange=this.readystatechange.bind(this),t.onprogress=this.loadprogress.bind(this),t.responseType=r.responseType,this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),t.send()},e.prototype.readystatechange=function(e){var t=e.currentTarget,r=t.readyState,i=this.stats,n=this.context,a=this.config;if(!i.aborted&&2<=r)if(window.clearTimeout(this.requestTimeout),0===i.tfirst&&(i.tfirst=Math.max(c.now(),i.trequest)),4===r){var o=t.status;if(200<=o&&o<300){i.tload=Math.max(i.tfirst,c.now());var s=void 0,l=void 0;l="arraybuffer"===n.responseType?(s=t.response).byteLength:(s=t.responseText).length,i.loaded=i.total=l,this.callbacks.onSuccess({url:t.responseURL,data:s},i,n,t)}else a.maxRetry<=i.retry||400<=o&&o<499?(u.logger.error(o+" while loading "+n.url),this.callbacks.onError({code:o,text:t.statusText},n,t)):(u.logger.warn(o+" while loading "+n.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,a.maxRetryDelay),i.retry++)}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),a.timeout)},e.prototype.loadtimeout=function(){u.logger.warn("timeout while loading "+this.context.url),this.callbacks.onTimeout(this.stats,this.context,null)},e.prototype.loadprogress=function(e){var t=e.currentTarget,r=this.stats;r.loaded=e.loaded,e.lengthComputable&&(r.total=e.total);var i=this.callbacks.onProgress;i&&i(r,this.context,null,t)},e}();t.default=i}}).default}())})),nm=function(){function t(e){_r(this,t),this.vol=1,this.options={},Rr(!0,this,e),this.events=new rn,this._lastVolume=this.vol,this._fragStartTime=0,this.userData={},this.playerId="_sunlplayer"+t.id,t.id+=1,this._init()}return Cr(t,[{key:"start",value:function(){if(!this._player){var e={autoStartLoad:!0};Rr(!0,e,this.options),this._player=new im(e),this._player.attachMedia(this.video)}}},{key:"setSrc",value:function(e){this._player.loadSource(e),this._player.attachMedia(this.video)}},{key:"_init",value:function(){this._initDom(),this.start(),this._initEvents()}},{key:"_initDom",value:function(){var e=document.createElement("video");e.id=this.playerId,e.style.cssText="height:100%;width:100%;object-fit:fill;background:#000;";var t=document.createElement("p");t.textContent="您的播放器暂不支持播放此视频",e.appendChild(t);var r=Bi(this.el)?this.el:document.querySelector("#"+this.el);if(!r)throw Error("请传入正确的el");this.video=r.appendChild(e)}},{key:"on",value:function(e,t){this.events.on(e,t)}},{key:"trigger",value:function(e){for(var t,r=arguments.length,i=Array(1<r?r-1:0),n=1;n<r;n++)i[n-1]=arguments[n];(t=this.events).trigger.apply(t,[e].concat(i))}},{key:"_initEvents",value:function(){var s=this,e={ready:"MEDIA_ATTACHED",reset:"MANIFEST_PARSED",auto_play:"MANIFEST_PARSED",user_data:"FRAG_PARSING_DATA",frag_changed:"FRAG_CHANGED",hls_error:"ERROR"};this.on("reset",function(){s.userData={},s._currentFragData=null,s._lastFragData=null,s._fragStartTime=0}),this.on("auto_play,loaded_metadata,can_play",function(){if(s.paused()){var e=s.video.play();e&&e.then(function(){s.trigger("autoplay_success,status_change","playing")}).catch(function(e){s.trigger("autoplay_fail",e)})}}),this.on("frag_changed",function(e,t){var r=t.frag,i=(r=void 0===r?{}:r).relurl;s._currentFragData=s.userData[i],delete s.userData[i]}),this.on("user_data",function(e,t){var r=t.data2,i=t.frag,n=(i=void 0===i?{}:i).relurl;if("video"===t.type&&r.buffer){var a=function(e){for(var t=new DataView(e),r=[],i=[185,156,144,12,111,208,17,233,187,178,0,12,41,249,134,227],n=8;n<t.byteLength;){if(6==(31&t.getUint8(n+4))&&5===t.getUint8(n+5)){for(var a=[],o=0,s=0,l=0;s+=o=t.getUint8(n+6+l),l+=1,255===o;);for(var u=0;u<s;u+=1)if(o=t.getUint8(n+6+l+u),16<=u)a.push(o);else if(i[u]!==o)break;0<a.length&&r.push(parseInt(String.fromCharCode.apply(null,a),10))}n+=4+t.getUint32(n)}return r}(r.buffer),o=yr(a,1);s.userData[n]=o[0]}}),this.on("_time_update",function(e){if(s._currentFragData){var t=s.currentTime(),r=0;s._currentFragData!==s._lastFragData?s._fragStartTime=t||0:r=parseInt(1e3*(t-s._fragStartTime),10),s.trigger("metadata_update",{user_data:s._currentFragData+r,currentTime:t}),s._lastFragData=s._currentFragData}}),this.on("_volume_change",function(){s.trigger("volume_change",s.volume())}),this.on("waiting",function(){var e=s.video,t=e.duration;Math.floor(e.currentTime)==Math.floor(t)&&(s.status="stop",s.trigger("status_change","stop"))}),this.on("ended,hls_error",function(){s.status="stop",s.trigger("status_change","stop")}),this.on("canplay",function(){s._status="playing",s.trigger("status_change","playing")}),Gt(e).forEach(function(i){s._player.on(im.Events[e[i]],function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];s.trigger.apply(s,[i].concat(t))})});var a=["time_update","volume_change"];this.events.videoEvents.forEach(function(n){if(!a[n]){var e=n.replace(/_/g,"");s.video.addEventListener(e,function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=-1<a.indexOf(n)?"_"+n:n;s.trigger.apply(s,[i].concat(t))})}}),Vi(this.video,{dblclick:function(){s.isFullScreen?zi(function(){}):Wi(s.video,function(){}),s.isFullScreen=!s.isFullScreen}})}},{key:"duration",value:function(){return this.video.duration}},{key:"playbackRate",value:function(e){this.video.playbackRate=e}},{key:"paused",value:function(){return this.video.paused}},{key:"play",value:function(){this.video.play(),this._player.startLoad()}},{key:"stop",value:function(){this.video.pause(),this._player.stopLoad(),this._player.detachMedia()}},{key:"volume",value:function(e){return void 0!==e&&(this.vol=e,0<(this.video.volume=e)&&(this._lastVolume=e),this.trigger("volume_change",e)),this.vol}},{key:"muted",value:function(e){return void 0===e?!this.vol:(this.volume(e?0:this._lastVolume),!1)}},{key:"buffered",value:function(){return this.video.buffered}},{key:"bufferedEnd",value:function(){var e=this.buffered(),t=this.duration(),r=0;return e.length&&(r=e.end(e.length-1)),t<r&&(r=t),r}},{key:"currentTime",value:function(){return this.video.currentTime}}],[{key:"supportHls",value:function(){return im.isSupported()}}]),t}();nm.id=100;var am,om=function e(u){var c=this;_r(this,e),this.seekTime=5,u.hotkey&&!u.isLive&&document.addEventListener("keydown",Fi(function(e){if(u.focus&&u.show){var t=document.activeElement&&document.activeElement.tagName.toUpperCase(),r=document.activeElement&&document.activeElement.getAttribute("contenteditable");if("INPUT"!==t&&"TEXTAREA"!==t&&""!==r&&"true"!==r){var i=e||window.event;switch(i.keyCode){case 32:i.preventDefault(),u.hendlePlayClick();var n=u.player.paused()?"暂停":"播放";u._info(n);break;case 37:i.preventDefault();var a=u._getCurrentTime()-c.seekTime;u.sunlPlayer.trigger("progress_click,progress_move",a=0<a?a:0),u._info("后退 "+c.seekTime+" 秒");break;case 39:i.preventDefault();var o=u._getCurrentTime(),s=u._getDuration(),l=o+c.seekTime;if(s<l)return;u.sunlPlayer.trigger("progress_click,progress_move",l),u._info("快进 "+c.seekTime+" 秒")}}}},200))},sm=[1,1.25,1.5,2],lm=function(){function e(){_r(this,e),this.uid=Hi(10),this.iconCfg={play:{path:'\n                    <g id="播放" transform="translate(-19.000000, -824.000000)">\n                        <g id="Group-11" transform="translate(20.000000, 825.000000)">\n                            <path d="M16.7249851,10.5338574 L8.82529189,6.07217527 C8.6550567,5.97596257 8.44527446,5.97594018 8.27501781,6.07211653 C8.10476115,6.16829289 7.99991552,6.34604555 8.00000008,6.53837472 L8.00000008,15.4616492 C7.99989147,15.6539858 8.10474016,15.8317517 8.27501162,15.9279179 C8.44528308,16.0240841 8.65507851,16.0240235 8.82529189,15.927759 L16.7248934,11.4661666 C16.8951156,11.3700083 16.9999811,11.1923288 17,11.0000379 C17.0000189,10.8077469 16.8951884,10.6300476 16.7249851,10.5338574 Z" id="Shape" fill="#F9FAFC" fill-rule="nonzero"></path>\n                            <circle id="Oval-5" stroke="#FBFBFD" cx="11" cy="11" r="11"></circle>\n                        </g>\n                    </g>\n                ',size:[24,24]},pause:{path:'\n                    <g transform="translate(-19.000000, -890.000000)">\n                        <g transform="translate(0.000000, 778.000000)">\n                            <g id="Group-4">\n                                <g id="Group">\n                                    <g id="Group-6" transform="translate(0.000000, 90.000000)">\n                                        <g id="Group-5">\n                                            <g id="Group-8" transform="translate(20.000000, 23.000000)">\n                                                <g id="Group-9">\n                                                    <circle id="Oval-5" stroke="#FFFFFF" cx="11" cy="11" r="11"></circle>\n                                                    <g id="Group-2" transform="translate(7.000000, 6.000000)"></g>\n                                                </g>\n                                                <rect id="rect-pause-1" fill="#FFFFFF" x="7" y="6" width="2" height="10" rx="1"></rect>\n                                                <rect id="rect-pause-2" fill="#FFFFFF" x="13" y="6" width="2" height="10" rx="1"></rect>\n                                            </g>\n                                        </g>\n                                    </g>\n                                </g>\n                            </g>\n                        </g>\n                    </g>\n                ',size:[24,24]},replay:{path:'\n                    <g transform="translate(-51.000000, -828.000000)" fill="#FFFFFF" fill-rule="nonzero" stroke="#FFFFFF" stroke-width="0.2">\n                        <g transform="translate(52.000000, 827.000000)">\n                            <path d="M12.6585,4.1025 C10.488,1.236 6.3635,0.65 3.465,2.7955 C2.525,3.4915 1.7965,4.426 1.3465,5.4865 L1.0075,4.3315 C0.9295,4.0665 0.652,3.9135 0.387,3.9925 C0.122,4.0705 -0.03,4.3485 0.048,4.6135 L0.7895,7.141 C0.8535,7.3585 1.0525,7.5 1.269,7.5 C1.3155,7.5 1.624,7.41 1.6725,7.392 L4.192,6.466 C4.451,6.371 4.584,6.0835 4.4885,5.824 C4.3935,5.565 4.1075,5.4325 3.8465,5.5275 L2.1595,6.1475 C2.5255,5.1385 3.184,4.247 4.0595,3.599 C6.5185,1.7775 10.0185,2.2745 11.861,4.706 C12.749,5.878 13.1235,7.3225 12.9155,8.7725 C12.7065,10.23 11.9345,11.518 10.7425,12.4005 C8.281,14.221 4.7805,13.7245 2.9395,11.2955 C2.7725,11.075 2.4595,11.032 2.239,11.199 C2.019,11.3655 1.976,11.6795 2.1425,11.899 C3.431,13.5995 5.408,14.4965 7.4085,14.4965 C8.7785,14.4965 10.159,14.076 11.3375,13.204 C12.746,12.1615 13.658,10.638 13.9055,8.9145 C14.153,7.1985 13.71,5.4895 12.6585,4.1025 Z" id="Shape"></path>\n                        </g>\n                    </g>\n                ',size:[16,14]},volume:{path:'\n                    <g transform="translate(-976.000000, -827.000000)" fill="#FFFFFF" fill-rule="nonzero">\n                        <g id="Group-10" transform="translate(0.000000, 812.000000)">\n                            <path d="M986.001162,31.8068816 C986.001162,33.740756 984.519274,32.7423322 984.519274,32.7423322 L978.102373,27.3381774 L977.111353,27.3381774 C976.497406,27.3381774 976,26.8310979 976,26.2056136 L976,21.6762113 C976,21.0507295 976.497406,20.5438475 977.111353,20.5438475 L978.296724,20.5438475 L984.5193,15.2596923 C984.5193,15.2596923 986.001188,14.2531248 986.001188,16.2033617 L986.001188,31.8068824 L986.001162,31.8068816 Z M989.334624,26.9603912 C991.187046,25.4506886 991.063369,22.5882826 989.334624,21.2987997 C988.655918,20.8900131 988.223693,22.2424941 988.223693,22.2424941 C988.223693,22.2424941 989.952089,24.4127982 988.223693,26.0169717 C987.883982,26.4572311 988.532291,27.3695027 989.334624,26.9603912 Z M990.260786,18.0905776 C990.01388,17.8702355 988.810241,18.6881336 989.520117,19.4114359 C993.193245,22.5255594 993.254834,25.4506661 989.520117,28.6589881 C988.964291,29.193646 989.704935,30.2004884 990.260786,29.9799213 C995.353641,27.6208453 995.138003,20.2923571 990.260786,18.0905776 Z" id="Shape"></path>\n                        </g>\n                    </g>\n                ',size:[18,18]},volumeMute:{path:'\n                    <g transform="translate(-976.000000, -827.000000)" fill="#FFFFFF">\n                        <g id="Group-10" transform="translate(0.000000, 697.000000)">\n                            <g id="Group-2" transform="translate(976.000000, 130.000000)">\n                                <path d="M10.0011624,16.8068816 C10.0011624,18.740756 8.51927366,17.7423322 8.51927366,17.7423322 L2.10237307,12.3381774 L1.11135286,12.3381774 C0.497406415,12.3381774 0,11.8310979 0,11.2056136 L0,6.67621133 C0,6.05072952 0.497406415,5.54384754 1.11135286,5.54384754 L2.29672403,5.54384754 L8.51929968,0.2596923 C8.51929968,0.2596923 10.0011884,-0.746875236 10.0011884,1.20336171 L10.0011884,16.8068824 L10.0011624,16.8068816 Z" id="Shape" fill-rule="nonzero"></path>\n                                <path d="M16.7759478,8.72368657 L18.8259225,6.5297666 C19.1497156,6.18440685 19.1497156,5.60659341 18.8259225,5.25901982 C18.5021294,4.91366006 17.9617595,4.91366006 17.6379665,5.25901982 L15.5879918,7.45293979 L13.5380171,5.26123366 C13.214224,4.91587391 12.6738541,4.91587391 12.3500611,5.26123366 C12.026268,5.60659341 12.026268,6.18440685 12.3500611,6.53198044 L14.2928195,8.72590042 L12.2428448,10.9198204 C11.9190517,11.267394 11.9190517,11.8429936 12.2428448,12.1905672 C12.5666379,12.5359269 13.1070078,12.5359269 13.4308008,12.1905672 L15.4807755,9.9966472 L17.6722757,12.2946179 C17.9960687,12.6399776 18.5364386,12.6399776 18.8602317,12.2946179 C19.1840248,11.9492581 19.1840248,11.3714447 18.8602317,11.0238711 L16.7759478,8.72368657 Z" id="Path" stroke="#FFFFFF" stroke-width="0.3"></path>\n                            </g>\n                        </g>\n                    </g>\n                ',size:[20,18]},fullScreen:{path:'\n                    <g transform="translate(-1034.000000, -828.000000)" fill="#FFFFFF" fill-rule="nonzero">\n                        <g id="Group-10" transform="translate(0.000000, 697.000000)">\n                            <g transform="translate(1034.000000, 131.000000)">\n                                <g id="Group-3">\n                                    <g id="Group-7">\n                                        <path d="M9.84615385,6.15064935 C10.174359,6.48311688 10.7487179,6.48311688 11.0769231,6.15064935 L14.2358974,2.99220779 L14.2358974,5.52727273 C14.2358974,5.9012987 14.5230769,6.19220779 14.8512821,6.19220779 L15.3025641,6.19220779 C15.6717949,6.19220779 16,5.94285714 16,5.61038961 L16,0.997402597 C16,0.997402597 16,0.997402597 16,0.997402597 L16,0.664935065 C16,0.498701299 15.9589744,0.332467532 15.8358974,0.207792208 C15.7128205,0.0831168831 15.5487179,0 15.3435897,0 L15.0153846,0 C15.0153846,0 15.0153846,0 15.0153846,0 L10.4615385,0 C10.0923077,0 9.80512821,0.290909091 9.80512821,0.664935065 L9.80512821,1.12207792 C9.84615385,1.53766234 10.174359,1.78701299 10.5435897,1.78701299 L12.9641026,1.78701299 L9.84615385,4.9038961 C9.51794872,5.27792208 9.51794872,5.81818182 9.84615385,6.15064935 Z M6.15384615,9.84935065 C5.82564103,9.51688312 5.25128205,9.51688312 4.92307692,9.84935065 L1.76410256,12.9662338 L1.76410256,10.4727273 C1.76410256,10.0987013 1.47692308,9.76623377 1.14871795,9.76623377 L0.697435897,9.76623377 C0.328205128,9.76623377 0,10.0571429 0,10.3896104 L0,15.0025974 C0,15.0025974 0,15.0025974 0,15.0025974 L0,15.3350649 C0,15.5012987 0.041025641,15.6675325 0.164102564,15.7922078 C0.246153846,15.9168831 0.41025641,16 0.615384615,16 L0.943589744,16 C0.943589744,16 0.943589744,16 0.943589744,16 L5.4974359,16 C5.86666667,16 6.15384615,15.7090909 6.15384615,15.3350649 L6.15384615,14.8779221 C6.15384615,14.4623377 5.78461538,14.2545455 5.41538462,14.2545455 L2.99487179,14.2545455 L6.15384615,11.0961039 C6.48205128,10.7220779 6.48205128,10.1818182 6.15384615,9.84935065 Z" id="Shape"></path>\n                                    </g>\n                                </g>\n                            </g>\n                        </g>\n                    </g>\n                ',size:[16,16]},outFullScreen:{path:'\n                    <g transform="translate(-1039.000000, -827.000000)" fill="#FFFFFF" fill-rule="nonzero">\n                        <g transform="translate(0.000000, 712.000000)">\n                            <g transform="translate(1039.000000, 115.000000)">\n                                <g id="Group-3">\n                                    <g id="Group-7">\n                                        <path d="M0.246153846,15.7506494 C0.574358974,16.0831169 1.14871795,16.0831169 1.47692308,15.7506494 L4.63589744,12.5922078 L4.63589744,15.1272727 C4.63589744,15.5012987 4.92307692,15.7922078 5.25128205,15.7922078 L5.7025641,15.7922078 C6.07179487,15.7922078 6.4,15.5428571 6.4,15.2103896 L6.4,10.5974026 C6.4,10.5974026 6.4,10.5974026 6.4,10.5974026 L6.4,10.2649351 C6.4,10.0987013 6.35897436,9.93246753 6.23589744,9.80779221 C6.11282051,9.68311688 5.94871795,9.6 5.74358974,9.6 L5.41538462,9.6 C5.41538462,9.6 5.41538462,9.6 5.41538462,9.6 L0.861538462,9.6 C0.492307692,9.6 0.205128205,9.89090909 0.205128205,10.2649351 L0.205128205,10.7220779 C0.246153846,11.1376623 0.574358974,11.387013 0.943589744,11.387013 L3.36410256,11.387013 L0.246153846,14.5038961 C-0.0820512821,14.8779221 -0.0820512821,15.4181818 0.246153846,15.7506494 Z M13.9230769,0.849350649 L10.7641026,3.96623377 L10.7641026,1.47272727 C10.7641026,1.0987013 10.4769231,0.766233766 10.1487179,0.766233766 L9.6974359,0.766233766 C9.32820513,0.766233766 9,1.05714286 9,1.38961039 L9,6.0025974 C9,6.0025974 9,6.11341991 9,6.33506494 C9,6.5012987 9.04102564,6.66753247 9.16410256,6.79220779 C9.24615385,6.91688312 9.41025641,7 9.61538462,7 L9.94358974,7 C9.94358974,7 11.4615385,7 14.4974359,7 C14.8666667,7 15.1538462,6.70909091 15.1538462,6.33506494 L15.1538462,5.87792208 C15.1538462,5.46233766 14.7846154,5.25454545 14.4153846,5.25454545 L11.9948718,5.25454545 L15.1538462,2.0961039 C15.4820513,1.72207792 15.4820513,1.18181818 15.1538462,0.849350649 C14.825641,0.516883117 14.2512821,0.516883117 13.9230769,0.849350649 Z" id="Shape"></path>\n                                    </g>\n                                </g>\n                            </g>\n                        </g>\n                    </g>\n                ',size:[16,16]},setting:{path:'\n                    <g fill="#FFFFFF">\n                        <path d="M1008.512 414.848l-99.264-25.728c-7.616-24.704-17.408-48.576-29.312-71.168l51.904-88.256c4.8-8.128 3.456-18.432-3.136-25.088l-109.184-109.248c-6.72-6.656-17.024-7.936-25.152-3.2l-88.32 51.904c-22.528-11.84-46.336-21.632-71.104-29.312l-25.664-99.328c-2.368-9.088-10.624-15.424-20.032-15.424l-154.432 0c-9.344 0-17.6 6.336-19.968 15.424l-25.792 99.328c-24.704 7.68-48.512 17.472-70.976 29.376l-88.32-52.032c-8.192-4.736-18.56-3.52-25.088 3.2l-109.312 109.248c-6.656 6.656-8 16.96-3.136 25.024l51.968 88.384c-11.904 22.464-21.632 46.272-29.376 70.976l-99.328 25.792c-9.152 2.368-15.488 10.624-15.488 20.032l0 154.432c0 9.408 6.336 17.664 15.488 19.968l99.264 25.728c7.68 24.832 17.536 48.64 29.312 71.04l-52.032 88.32c-4.736 8.128-3.456 18.432 3.2 25.088l109.184 109.248c6.72 6.656 17.024 7.936 25.152 3.136l88.32-51.968c22.528 11.84 46.336 21.76 71.04 29.312l25.664 99.328c2.496 9.216 10.752 15.616 20.16 15.616l154.432 0c9.408 0 17.6-6.336 19.968-15.488l25.792-99.328c24.768-7.68 48.576-17.472 71.104-29.312l88.192 51.968c8.192 4.672 18.432 3.456 25.088-3.2l109.248-109.12c6.72-6.656 8-16.96 3.2-25.088l-51.968-88.32c11.968-22.528 21.76-46.336 29.376-71.04l99.264-25.728c9.216-2.432 15.552-10.688 15.552-20.096l0-154.432c0-9.344-6.336-17.664-15.488-19.968l0 0zM512.064 738.624c-124.992 0-226.624-101.632-226.624-226.624s101.632-226.624 226.624-226.624c124.928 0 226.496 101.632 226.496 226.624s-101.632 226.624-226.496 226.624l0 0z" p-id="1115">\n                    </g>\n                ',size:[18,18],viewSize:[1024,1024]}}}return Cr(e,[{key:"getSvgElement",value:function(e,t){var r=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],i=this.iconCfg[e],n=i.path,a=yr(i.size,2),o=a[0],s=a[1],l=i.viewSize,u=yr(void 0===l?[]:l,2),c=u[0],d=u[1],h='\n            <svg class="sunl-icon" width="'+o+'px" height="'+s+'px" viewBox="0 0 '+(void 0===c?o:c)+" "+(void 0===d?s:d)+'" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n                <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                    '+n+" \n                </g>  \n            </svg>\n        ";if(r)return h;var f=document.createElement("content");return f.innerHTML=h,f.firstElementChild}},{key:"getDomElement",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=t.volume,i=void 0===r?1:r,n=t.type,a=t.isShow?"":"hide",o={progress:{dom:'\n                    <div class="sunl-progress-control '+a+'" key='+e+'>\n                        <div class="sunl-progress-control__loaded" style="width:0%;" ></div>\n                        <div class="sunl-progress-control__holder">\n                            <div class="sunl-tooltip" style="left: 0px;">0:00</div>\n                            <div class="sunl-progress-control__play" style="width: 0%;"></div>\n                        </div>\n                        <div class="sunl-progress-control__slider" style="left: 0%;"></div>\n                    </div>\n                ',aliginRight:!1},play:{dom:'\n                    <div class="sunl-button-control play-control '+a+'" key='+e+">\n                        "+this.getSvgElement("play","sunl-icon")+' \n                        <div class="sunl-tooltip">播放</div>\n                    </div>\n                ',aliginRight:!1},time:{dom:'\n                    <div class="sunl-button-control time-control '+a+'" key='+e+'>\n                        <span class="pre-time">00:00</span>\n                        <span>00:00</span>\n                    </div>\n                ',aliginRight:!1},switchbutton:{dom:'\n                    <div class="sunl-button-control switch-control '+a+'" key='+e+'>\n                        <span class="switch-pre-label">小窗口</span>\n                        <input type="checkbox" id="switchBtn-'+this.uid+'" class="switch-button" checked>\n                        <label for="switchBtn-'+this.uid+'" class="switch-label"></label>\n                        <div class="sunl-tooltip">开启</div>\n                    </div>\n                ',aliginRight:!0},playbackrate:{dom:'\n                    <div class="sunl-button-control playrate-control '+a+'" key='+e+'>\n                        <a href="javascript:;" class="playrate-button">倍速</a>\n                        <div class="sunl-tooltip">倍速:1x</div>\n                        <div class="sunl-menu">\n                            <ul class="menu-content">\n                                '+sm.map(function(e,t){return'<li class="'+(t?"":"active")+'">倍速:'+e+"x</li>"}).join("")+"\n                            </ul>\n                        </div>\n                    </div>\n                ",aliginRight:!0},settingbutton:{dom:'\n                    <div class="sunl-button-control setting-control '+a+'" key='+e+'>\n                        <a tabindex="1" href="javascript:;" class="setting-control-icon">\n                            '+this.getSvgElement("setting","sunl-icon")+'\n                        </a>\n                        <div class="setting-control-item">\n                            '+[{label:"HTML5播放器",value:"hls"},{label:"FLASH播放器",value:"flash"}].map(function(e,t){var r=e.value;return'<label class="sunl-radio-label  '+(r===n?"sunl-radio-checked":"")+'" key='+t+'>\n                                        <span class="sunl-radio-wrapper">\n                                            <input type="radio" class="sunl-radio-input" value="'+r+'" />\n                                            <span class="sunl-radio-icon"></span>\n                                        </span>\n                                        <span>'+e.label+"</span>\n                                    </label>"}).join("")+"\n                        </div>\n                    </div>\n                ",aliginRight:!0},volume:{dom:'\n                    <div class="sunl-button-control volume-control '+a+'" key='+e+">\n                        "+this.getSvgElement("volume","sunl-icon")+'\n                        \x3c!--div class="sunl-tooltip">音量</div--\x3e\n                        <div class="volume-popup">\n                            <div class="volume-button">\n                                <div class="volume-button__tips">'+Math.round(100*i)+'%</div>\n                                <div class="volume-button__holder">\n                                    <div class="volume-button__slider-bar" style="height: '+100*i+'%;"></div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                ',aliginRight:!0},fullscreen:{dom:'\n                    <div class="sunl-button-control fullscreen-control '+a+'" key='+e+">\n                        "+this.getSvgElement("fullScreen","sunl-icon")+'\n                        <div class="sunl-tooltip">全屏</div>\n                    </div>\n                ',aliginRight:!0},loading:{dom:'\n                    <div class="sunl-loading player-loading">\n                        <img src="'+ln+'" class="sunl-loading-icon" />\n                        <div>视频加载中...</div>\n                    </div>\n                '},bigPlayBtn:{dom:'\n                    <div class="sunl-player-btn">\n                        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGgAAABGCAYAAAAgutHnAAAAAXNSR0IArs4c6QAABelJREFUeAHtnV1LI1cYx5sXjTXFBrvYDb6lBY2wi0rXm9agpGJFo9hSpRRUUOjdIrV4W3rR7p0g9QP4CWptWpddXYwKJW1sqrRQlQXtlvqyhF3XlRqJ0aT/J83ImNfRZjNnMmdgmMmZZzLP+f9yzjznzJwczUsSlrGxsWtardYSDoevazSaQpxixL5ewqncJKoAdDvF7hF082P/cSgUejQ6OvoknUCaVAbj4+Nv4gsbsL6ayo4fu5oCAPUcq3dkZGQr2TckBDQxMVF0enpqB5iSZCfy9MwpAEg+vV6/MDw8fBj7rXGAUGrMKH6tMDTEGvPPL1SBAG4jD1Ca9sRXuQCI4JydnTlA9EK6+AS+/+IUQI0V1ul0d8WQtMLlqFqjksPhCIpkf0vaEwNiIVz9HBDdc5DIqzVBGfm2hiiLiAcRQNFojQcE8kG5cGUKzogJJUYAIaHhggX/ILsCAhMNNUJR9X0gu0fcgTgFAGkakZ3WEneEJzChALHRgtJ1JrzhTsQpQGy0qN6ob40vDCpAbChIMDLoG3fpPwWMVMXxXmlGfw7EJhJmM+ofdwsKcECM/wwUVb3Z7fZbZrPZivAzf29vb31pacmLbpEzxjX+X+4pAhCelegGBgZum0ymG0JuS0pK3qmpqelaW1ubXlhY+FVIz7Wtrq2t7Rbrmeru7u5EybHF+glwRqQ31NbW3kRI6tvd3X0aa6P0z4q4BxGEVEIbjcY3mpqaRoeGhm5brVZzKlulHVMEoIKCgtelCIsqsNbhcHzR19c3UFpaapJyDus2igAEES/jpxb3J1tvb+9XPT097xcVFb3MOoRU/l0m46m+h7ljFOlVVFR0DA4O3uns7GzJz8/XMeekBIcUEcVJyEdSEzzjf6W6uvqjysrKlvX19WmXy/VLUmMGD+Q8IEFzg8Fwrb6+/hPAem9lZWVqeXl5QzjG8jZnq7hkohcWFlbabLbPEPENox1VmsyOlXTVARKER8R3s6Oj43NEfINlZWXFQjprW9UCioKgiO9tRHtfIur7sLi4mLlnY2oHFOGEiC+vvLy8rb+//05XV1cr7lfM3JuZcYSFqgURn7GqqqoXEd+7iPic8/PzP8vtFweUgADaTK/V1dUNAVbr6urqlMfjWUtglpUkXsWlkBkRX3ljY+OnH2NBx6ws76tzQCkACYfQWWtvb2+nER9ZXzggiZJbLJYWiaYZNeOAJMqZl5dnwpp1vbJ+QYl6MGcWCASeBIPBULYd44AkKr6zs/OjRNOMmnFAEuT0+XzumZmZ+xJMM27C20EpJD0+Pv6ber7lbAdxQAkAnZycPKWeBLwt5MGQxHACk6wlcUAiqTGA+mhra+ve3NycC0EB/fGE7AsHBAQoJUEEAS70vd3b39/3y05F5IDaAYUQAHgWFxed29vb+yJdmNlVLaCDg4M/3G73NxsbGzvM0EjgiOoA+f3+v5T0ToJqAFFPACKz7/BWz3KCHyqzSTkPCJHZP5ubm3cRmS0ifFbcSIicBYTI7ASR2fzs7Oz9w8PDY2aLSBrHlAKIGotSH5hRZOZGI/N7ADpIk3/mDysCEHqRn6GrP+2rUYjMfkdk9i0is13mlZfooCIAYTTdT3jP2pEsT4jM/vR6vVNYHyazUWq6IgA5nc4f8EqURTzCjgRHZObL9RF2igBED8omJye/bm5ufgvjfqxgo0fLnxqav/ExqgzVDRg0vAJ3aFXNwh/YMY6a/quHiW51xnWSxT28khykEnQky9X5RdMqgL+C8dN/9TD1/COt1yoyiABCFfdYRXlWVFaJjRZ9Vo8U5bWKnCU2WprgAaSeqyjfisgqMSE2kTAbH7yK8FpFTgpMIoBo9g0k+FSUf6azSiyEGVHOG6o0+wa8DjDtuTqcC0RZRHJ7DoimRkHD6AFCO1lf1FMHg8S5JO2JgXiamriHYHx6msTiZSE1/fQ0ghN8gidBiexs6Z5D1Zq45AhXjitBwgHaRifd4FOkiUXJ4D7AXG2KtFgf+CSDsYpc/jNgXGmSwX8Ba+kcLlCMXTUAAAAASUVORK5CYII=" class="sunl-player-btn-icon" />\n                    </div>  \n                '}}[e];return void 0===o?{}:o}}]),e}(),um=["progress","play","time","switchbutton","playbackrate","settingbutton","volume","fullscreen"],cm=["switchbutton","settingbutton","volume","fullscreen"],dm=function(e){function r(e){_r(this,r);var t=It(this,(r.__proto__||B(r)).call(this,e));if(t.volume=1,t.duration=0,t.show=!0,t.inactivityTimeout=5e3,t.loading=!0,t.hotkey=!0,t.type=null,t._userActivity=!0,t._userActived=!1,t._videoWasPlaying=null,t._progressClicked=!1,t._isFullscreen=!1,t._playsuccess=!1,t._seekInfo={},t._isMoving=!1,t._currentTime=0,t._playRate=1,Rr(!(t._isPlayBtnShow=!1),t,e),!t.el)throw Error("必须传入控制条父容器ID或DOM");return t.parentDom=Bi(t.el)?t.el:document.querySelector("#"+t.el),document.addEventListener("click",function(){t.focus=!1}),t.parentDom.addEventListener("click",function(e){e.stopPropagation(),t.focus=!0}),t.hotKey=new om(t),t._init(),t}return Ft(r,lm),Cr(r,[{key:"_init",value:function(){this._initControlBar(),this._render(),this._bindElEvents(),this._bindPlayerEvents()}},{key:"_initControlBar",value:function(){var e=this.children,t=this.isLive,r=void 0!==t&&t?cm:um;this.childrenItem=Array.isArray(e)?e:void 0===e?r:e?r:[]}},{key:"_bindElEvents",value:function(){this._handleUserAcitivity(),this._handleParentAcitivity()}},{key:"_bindPlayerEvents",value:function(){var e=this.sunlPlayer;e&&(this.player=e.getPlayer?e.getPlayer():e,this._handleControlActivity())}},{key:"_render",value:function(){var e,t,r,l=this,i=this.childrenItem,u=void 0===i?[]:i,c=this.volume,n=this.info,a=(n=void 0===n?{}:n).title,o=n.teacher,s=this.loading,d=this.type,h=um.reduce(function(e,t){var r=yr(e,2),i=r[0],n=r[1],a=-1<u.indexOf(t),o=l.getDomElement(t,{volume:c,isShow:a,type:d}),s="settingbutton"!==t||d?o.dom:null;return s&&(o.aliginRight?n:i).push(s),[i,n]},[[],[]]),f=yr(h,2),p=f[0],g=f[1],m=o?'<span class="sunl-player-title-right">授课老师: '+o+"</span>":"",v=(s?this.getDomElement("loading"):"").dom,y='\n            <div class="sunl-player-title">\n                <span class="sunl-player-title-left">'+a+"</span>\n                "+m+"\n            </div>\n            "+(void 0===v?"":v)+"\n            "+this.getDomElement("bigPlayBtn").dom+'\n            <div class="sunl-player-info"></div>\n            <div class="sunl-control-bar sunl-has-started sunl-control-default">\n                '+p.join("")+'\n                \x3c!--pull-right--\x3e\n                <div class="sunl-pull-right">\n                    '+g.join("")+"\n                </div>\n            </div>\n        ",_=document.createElement("container");_.innerHTML=y,e=this.parentDom,t=ur(_.childNodes),r=document.createDocumentFragment(),t.forEach(function(e){var t=e instanceof Node;r.appendChild(t?e:document.createTextNode(e+""))}),e.appendChild(r),this.titleBar=this.parentDom.querySelector(".sunl-player-title"),this.toolBar=this.parentDom.querySelector(".sunl-control-bar"),this.loadingEle=this.parentDom.querySelector(".player-loading"),this.infoTips=this.parentDom.querySelector(".sunl-player-info"),this.playBtn=this.parentDom.querySelector(".sunl-player-btn"),this.playControl=this.toolBar.querySelector('[key="play"]'),this.fullscreenControl=this.toolBar.querySelector('[key="fullscreen"]'),this.volumeControl=this.toolBar.querySelector('[key="volume"]'),this.switchbutton=this.toolBar.querySelector('[key="switchbutton"]'),this.settingbutton=this.toolBar.querySelector('[key="settingbutton"]')}},{key:"_on",value:function(e,t){var r=this,i=2<arguments.length&&void 0!==arguments[2]&&arguments[2];this.sunlPlayer&&this.sunlPlayer.on(e,function(e){(r.show||i)&&t.call(r,e)})}},{key:"_trigger",value:function(e,t){this.sunlPlayer&&(this.show||2<arguments.length&&void 0!==arguments[2]&&arguments[2])&&this.sunlPlayer.trigger(e,t)}},{key:"_handleActivity",value:function(){this._userActivity=!0}},{key:"_handleUserAcitivity",value:function(){var t=this,r=void 0,i=void 0,n=void 0;this.parentDom.addEventListener("mouseleave",function(e){t._userActived=!0,t._userActive(!1)}),this.parentDom.addEventListener("mousedown",function(){t._handleActivity(),clearInterval(r),r=setInterval(t._handleActivity,250)}),this.parentDom.addEventListener("mousemove",function(e){e.screenX===i&&e.screenY===n||(i=e.screenX,n=e.screenY,t._handleActivity())}),this.parentDom.addEventListener("mouseup",function(e){t._handleActivity(),clearInterval(r)}),this.parentDom.addEventListener("keydown",this._handleActivity),this.parentDom.addEventListener("keyup",this._handleActivity);var e=void 0;this._userActivityTimer=setInterval(function(){t._userActivity&&(t._userActivity=!1,t._userActive(t.show),clearTimeout(e),t.inactivityTimeout<=0||(e=setTimeout(function(){t._userActivity||t._userActive(!1)},t.inactivityTimeout)))},250)}},{key:"_handleParentAcitivity",value:function(){var t=this;["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"].forEach(function(e){window.addEventListener(e,function(e){return t.handleFullScreenChange()})}),Vi(this.parentDom,{click:function(e){return t._handleParentClick(e)},dblclick:function(e){return t._handleParentClick(e,!0)}})}},{key:"_handleControlActivity",value:function(){var u=this,l=this.sunlPlayer,c=this.toolBar.querySelector('[key="progress"]'),r=c.firstElementChild,d=c.querySelector(".sunl-progress-control__holder").lastElementChild,h=c.lastElementChild,e=this.toolBar.querySelector('[key="time"]'),f=e.firstElementChild,t=e.lastElementChild,i=this.toolBar.querySelector(".playrate-button"),n=this.toolBar.querySelector(".sunl-menu"),a=this.toolBar.querySelector(".volume-button__holder"),o=a.firstElementChild,s=a.previousElementSibling,p=function(e){var t=l.currentTime()||0,r=u._seekInfo,i=r.trueStartTime,n=r.currentTime;r.isChangeUrl||e?t=e||(void 0===n?0:n):t+=void 0===i?0:i;var a=u._getDuration(),o=(t=a<t?a:t)/a;o<0&&(o=0);var s=(100*o).toFixed(2)+"%";h.style.left=d.style.width=s,f.textContent=Mi(t||0),u._currentTime=t},g=Fi(p.bind(this),30);this._on("load_start",function(){u.handleLoading(!1)}),this._on("autoplay_fail",function(e){!u._playsuccess&&u.show&&u.playBtn.classList.add("active"),u._isPlayBtnShow=!0},!0),this._on("progress",function(){var e=u._getDuration(),t=l.bufferedEnd()/e||0;r.style.width=100*(1<=t?1:t)+"%"},!0),this._on("canplay",function(){u.handleLoading(!1)}),this._on("canplay_through",function(){u.handleLoading(!1)});var m=function(){clearInterval(u._updateInterval),u._updateInterval=setInterval(function(){requestAnimationFrame(function(){g()})},30)};this._on("playing",function(){u.handleLoading(!1),m(),l.paused()||(!u._playsuccess&&u.show&&(u._playsuccess=!0,u.playBtn.classList.remove("active")),u._isPlayBtnShow=!1)},!0),this._on("_time_update",function(){g(),u._isWating&&u.handleLoading(!1)},!0),this._on("waiting",function(){u.handleLoading(!0),clearInterval(u._updateInterval)},!0),this._on("pause",function(){clearInterval(u._updateInterval),u.handlePause()},!0),this._on("play",function(){u.handlePlay()},!0),this._on("duration_change",function(){var e=u._getDuration();e&&u._duration!==e&&(t.textContent=Mi(u._duration=e))},!0),this._on("ended",function(){var e=u._getDuration(),t=u.sunlPlayer.currentTime(),r=u._seekInfo.trueStartTime;t+(void 0===r?0:r)+.9<e||(clearInterval(u._updateInterval),h.style.left=d.style.width="100%",e&&(f.textContent=Mi(e)),setTimeout(function(){u.handleEnded()},0))},!0),this._on("seeking",function(){u.handleLoading(!0)}),this._on("_seeked",function(){u.handleLoading(!1),l.paused()?u.handlePause():u.handlePlay(),u.videoWasPlaying&&l.play()},!0),this._on("rate_change",function(e){e!==u._playRate&&l.playbackRate(u._playRate)},!0),this._on("playback_rate_list_click",function(e){i.textContent=1===(u._playRate=e)?"倍速":e+"x",i.nextElementSibling.textContent="倍速:"+e+"x"},!0),this._on("status_change",function(e){u.handleLoading("loading"===e)}),this._on("volume_change",function(e){var t=Math.round(100*e)+"%",r=e;l.muted()||!e?(t="静音",r=0,u.handleVolumeMute()):u.handleVolumeUp(),o.style.height=(100*r).toFixed(2)+"%",s.textContent=t},!0),this._on("progress_move",function(e){p(e)},!0);var v=Fi(function(e){e.stopPropagation(),u._isMoving=!0;var t=c.getBoundingClientRect(),r=c.offsetWidth,i=Math.max(0,Math.min(1,(e.pageX-Math.round(t.left))/r)),n=i*u._getDuration();n===u._getDuration()&&(n-=.1);var a=d.previousElementSibling,o=Math.max(0,Math.min(1,a.offsetWidth/r)),s=Math.max(0,Math.min(1,(r-a.offsetWidth)/r)),l=i;i<=o&&(l=o),s<=i&&(l=s),a.style.left=(100*l).toFixed(2)+"%",a.textContent=Mi(n||0),u._progressClicked&&(u.seekTime=n,u._trigger("progress_move",n,!0))},30),y=function e(t){t.stopPropagation(),u._progressClicked=!1,u._isMoving=!1,document.removeEventListener("mouseup",e),l.scrubbing(!1),u._trigger("progress_click",u.seekTime||0)};c.addEventListener("mousedown",function(e){e.stopPropagation(),l.scrubbing(u._progressClicked=!0),u.videoWasPlaying=!l.paused(),l.pause(),document.addEventListener("mousemove",v),document.addEventListener("mouseup",y),v(e)}),c.addEventListener("mousemove",v),this.playControl.addEventListener("click",function(e){e.stopPropagation(),u.focus=!0,Gi(u.playControl.querySelector("svg"),e.target)&&(l.paused()?l.play():l.pause())}),i.addEventListener("click",function(e){e.stopPropagation(),u.focus=!0,n.style.display="",u._trigger("playback_rate_button_click")}),n.addEventListener("click",function(e){if(e.stopPropagation(),n.style.display="none",qi(e.target,"li")){var t=e.target,r=t.textContent.replace(/[^(0-9|.)]/g,"");if(+r===u._playRate)return;ur(t.parentNode.childNodes).forEach(function(e){1===e.nodeType&&e!==t&&e.classList.remove("active")}),t.classList.add("active"),u._trigger("playback_rate_list_click",+r),l.playbackRate(r)}}),this.fullscreenControl.addEventListener("click",function(e){e.stopPropagation(),u.focus=!0,Gi(u.fullscreenControl.querySelector("svg"),e.target)&&(u._isFullscreen?u.handleExitFullScreen():u.handleFullScreen())});var _=Fi(function(e){e.stopPropagation(),l.muted()&&l.muted(!1);var t=a.getBoundingClientRect(),r=a.offsetHeight,i=Math.round(100*Math.max(0,Math.min(1,(Math.round(t.top)-e.pageY+r)/r)))/100;l.volume(u.volume=i)},25),b=function e(t){t.stopPropagation(),document.removeEventListener("mousemove",_),document.removeEventListener("mouseup",e);var r=l.muted()?0:l.volume();r<0&&(r=0),o.style.height=(100*r).toFixed(2)+"%"};a.addEventListener("mousedown",function(e){document.addEventListener("mousemove",_),document.addEventListener("mouseup",b),_(e)}),this.volumeControl.addEventListener("click",function(e){e.stopPropagation(),u.focus=!0,Gi(u.volumeControl.querySelector("svg"),e.target)&&(l.muted()?l.muted(!1):l.muted(!0))}),this._on("switch_button_show",function(e){e&&u.handleSwitchButton(!0),u.switchbutton.classList[e?"add":"remove"]("switch-control-active")},!0),this.switchbutton.addEventListener("click",function(e){(e.preventDefault(),qi(e.target,"label"))&&u._trigger("switch_button_click",!e.target.previousElementSibling.checked,!0)},!0),this._on("switch_button_click",function(e){return u.handleSwitchButton(e)},!0),this._on("screen_status_change",function(e){u._isFullscreen=e;var t=u.getSvgElement((e?"outFull":"full")+"Screen","sunl-icon",!1);u.fullscreenControl.replaceChild(t,u.fullscreenControl.firstElementChild),u.fullscreenControl.lastElementChild.textContent=(e?"退出":"")+"全屏"},!0),this._on("update_controlbar",this._handleUpdateControlBar.bind(this),!0),"hidden"in document&&"visibilityState"in document&&document.addEventListener("visibilitychange",function(){document.hidden?clearInterval(u._updateInterval):(m(),p())}),this.playBtn.addEventListener("click",function(e){e.stopPropagation(),l.paused()&&(l.play(),u.playBtn.classList.remove("active"))}),this.settingbutton&&this.settingbutton.addEventListener("click",function(e){e.stopPropagation();var t=[e.target,e.currentTarget],r=t[0],i=t[1];if(qi(r,"input")){var n=r.value;if(u.type===n)return;var a=i.querySelectorAll("label");ur(a).forEach(function(e){e.querySelector("input").value===n?e.classList.add("sunl-radio-checked"):e.classList.remove("sunl-radio-checked")}),u.type=n,setTimeout(function(){i.querySelector(".setting-control-item").style.display="",u._trigger("tech_change",u.type,!1)})}})}},{key:"_handleUpdateControlBar",value:function(e){this._seekInfo=dr({},this._seekInfo,e),this.handleLoading()}},{key:"_userActive",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];if(void 0!==e&&e!==this._userActived){this._userActived=e;var t=[this.toolBar,this.titleBar],r=[t[0].classList,t[1].classList];if(this._userActived)return this._userActivity=!0,void r.forEach(function(e){e.remove("sunl-user-inactive"),e.add("sunl-user-active")});this.sunlPlayer&&this.sunlPlayer._player&&this.show&&this.sunlPlayer._player.trigger("one","mousemove",function(e){e.stopPropagation(),e.preventDefault()}),this._userActivity=!1,r.forEach(function(e){e.remove("sunl-user-active"),e.add("sunl-user-inactive")})}}},{key:"_getDuration",value:function(){return this.duration?this.duration:this.sunlPlayer.duration()}},{key:"_getCurrentTime",value:function(){return this._currentTime||0}},{key:"_info",value:function(e){var t=this,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:2e3,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:.8;this.infoTips.textContent=e,this.infoTips.style.opacity=i,this._infoTime&&clearTimeout(this._infoTime),0<r&&(this._infoTime=setTimeout(function(){t.infoTips.style.opacity=0},r))}},{key:"_setToolBarIconAndText",value:function(e,t,r){var i=this.getSvgElement(t,"sunl-icon",!1);e.replaceChild(i,e.firstElementChild),r&&(e.lastElementChild.textContent=r)}},{key:"_handleParentClick",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],r=this.parentDom.querySelector("svg.sunl-board-svg"),i=e.target;if(i.contains?Gi(r,i):"SVG"===Object.prototype.toString.call(i).substr(8,3))if(t){if(!this.show)return;this._isFullscreen?this.handleExitFullScreen():this.handleFullScreen()}else this.focus=!0,this.hendlePlayClick()}},{key:"hendlePlayClick",value:function(){var e=this.player;this.isLive||(e.paused()?e.play():e.pause())}},{key:"handlePlay",value:function(){this._setToolBarIconAndText(this.playControl,"pause","暂停")}},{key:"handlePause",value:function(){this._setToolBarIconAndText(this.playControl,"play","播放")}},{key:"handleEnded",value:function(){this._setToolBarIconAndText(this.playControl,"replay","重新播放")}},{key:"handleVolumeMute",value:function(){this._setToolBarIconAndText(this.volumeControl,"volumeMute")}},{key:"handleVolumeUp",value:function(){this._setToolBarIconAndText(this.volumeControl,"volume")}},{key:"handleExitFullScreen",value:function(){var e=this,t=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];return this._trigger("switch_button_show,screen_status_change",!1,!0),this.onExitFullScreen&&this.onExitFullScreen()||t&&zi(function(){e.parentDom.classList.remove("sunl-fullscreen")}),!1}},{key:"handleFullScreen",value:function(){var e=this;return this._trigger("switch_button_show,screen_status_change",!0,!0),this.onFullScreen&&this.onFullScreen()||Wi(this.parentDom,function(){e.parentDom.classList.add("sunl-fullscreen")}),!1}},{key:"handleFullScreenChange",value:function(){!(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)&&this._isFullscreen&&this.handleExitFullScreen(!1)}},{key:"handleSwitchButton",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.switchbutton.querySelector(".sunl-tooltip").textContent=e?"关闭":"开启",this.switchbutton.querySelector("input").checked=e}},{key:"handlePlayBtn",value:function(e){this.playBtn.classList[e&&this._isPlayBtnShow?"add":"remove"]("active")}},{key:"showControlBar",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];this._userActivity=!0,this._userActived=!e,this.show=e,this._userActive(e),this.handlePlayBtn(e)}},{key:"handleLoading",value:function(e){this.loadingEle&&(this._seekInfo.isChangeUrl||e?(this._isWating=!0,this.loadingEle.classList.add("waiting")):(this._isWating=!1,this.loadingEle.classList.remove("waiting")))}},{key:"dispose",value:function(){clearInterval(this._updateInterval),clearInterval(this._userActivityTimer),clearTimeout(this._infoTime)}}]),r}(),hm=Or.RoomStatus,fm=hm.READY,pm=hm.LIVE,gm=hm.PAUSE,mm=hm.END,vm=Or.StreamProtocol,ym=vm.HLS_PROTOCOL,_m=vm.FLV_PROTOCOL,bm=Or.eUrlType.COMMON,Tm={live:"svgBoard",replay:"svgBoard",camera:"sunlPlayer",chat:"chats"},Sm={live:(am={},Ar(am,fm,"讲师正在赶来的路上，稍等哦..."),Ar(am,gm,"直播暂停，请过一会儿来观看..."),Ar(am,mm,"直播已结束，感谢观看！"),am),vod:Ar({},fm,"讲师正在赶来的路上，稍等哦...")},Em=function(){function j(e){if(_r(this,j),this.roomInfo={},this.index=0,this.swfFilePath=null,this.sketchpad={},this.camera={},this.chat={},this.svgBoard=null,this.isplayReady=!1,this._initializedPlayer=!1,this._reconnectCount=0,this._player={},this._record={},this._start=0,this._sharedStart=0,this._trueStartTime=0,this._playbackrate=1,this._isEnded=!1,this._isPause=!1,this._isSeeking=!1,this._duration=0,this._currentTime=0,this._events={},this._type="flash",Rr(!0,this,e),this.isLive="live"===this.loginType?1:0,!this.liveToken)throw Error("token信息未正确配置");if(this.isLive&&!this.camera.swfPath)throw Error("播放器的路径未正确配置");if(!this.camera.el||!this.sketchpad.el)throw Error("画板或播放器的容器ID或DOM未正确配置");this._init()}return Cr(j,[{key:"on",value:function(){var e=arguments[1],t=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:"").split(":"),r=yr(t,2),i=r[1],n=Tm[r[0]];if(n&&i){var a=i.trim();this[n]?this[n].on(a,e):(this._events[n]=this._events[n]||{},this._events[n][a]=this._events[n][a]||[],this._events[n][a].push(e))}}},{key:"off",value:function(e){var t=this;if(void 0!==e){var r=(e||"").split(":"),i=yr(r,2),n=i[1],a=Tm[i[0]];if(a&&n){var o=n.trim();this[a]&&this[a].events.removeListener(o)}}else["svgBoard","sunlPlayer","chats"].forEach(function(e){t[e]&&t[e].events.removeAllListeners()})}},{key:"_init",value:function(){this._initParams(),this._initBoard(),this._initPlayer()}},{key:"_initParams",value:function(){var e=localStorage.getItem("debug"),t=localStorage.getItem("tech");this.debug=null===e?this.debug:"true"===e,this._type=t||this._type}},{key:"_initBoard",value:function(){var e=this.isLive;this.svgBoard=new(e?va:Ua)({el:this.sketchpad.el,isLive:e,liveToken:this.liveToken,debug:this.debug}),this.svgBoard.init(),this._bindBoardEvts()}},{key:"_initPlayerDom",value:function(){var e=this.camera,t=e.el,r=e.options,i=(r=void 0===r?{}:r).aspectRatio,n=void 0===i?"4:3":i,a=Bi(t)?t:document.getElementById(t),o=a.offsetWidth,s=void 0===o?398:o,l=a.offsetHeight;if(!l){var u=n.split(":"),c=yr(u,2);l=s*c[1]/c[0]}var d=document.createElement("div");d.style.cssText="width: 100%;height:100%;position:relative;overflow:hidden;",d.innerHTML='\n                    <div class="sunl-player-poster">\n                        <div class="no-stream"></div>\n                        <div class="no-flash">\n                            <p class="sunl-player-poster__text">请下载最新的flash插件</p>\n                            <a\n                                href="http://get.adobe.com/cn/flashplayer/"\n                                target="_blank"\n                                rel="noopener noreferrer"\n                                class="sunl-btn"\n                            >下载\n                            </a>\n                        </div>\n                        <img src=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJoAAAB0CAYAAAB9sSvlAAAAAXNSR0IArs4c6QAAHaJJREFUeAHtXXuQZFV5P/d2z/Q89w0Um2UhYELEpAyJwQAWCYaXImAAiSKKSURZCqSQSCSpkE0RUgYrRUoK1+QPIxpBdnmULj54iZGXxTMGJVIJxl2eAvPaefd0983v933nu/f2MLvMbPfM9Myeszv3nvud7zuP3/nd7zxu9+3ILdNw8zd3ri+Xo/cmSXKIi9xAXHB3ffTMjT9Zps1t+WZFLV/DOVbw37a+8NvOVa9xLjrFuSQ288hF1SiKrj7/Awf9ncnCeeEQWDZE+/fv9K2ojI78U5JEf5Yn2HQo49h97PyzD75xujxczy8Cy4JoN259/qhaVLvZJe7QN4MLXu2FruSgQ845J6q+mW5Ibx4C6dDSvCwXNqcbt+34ZM3VHpwNyVgzzNk2jLmdGF5DWEgElizRQJjoxq07rq0l7ksArG0uoMXFaHIu+kG3cQSKjWexODmAZF9Noui8uZaORcEPw+pzrqg1rr/kPBo92RVX3fIPe0cy90hUjM9sHLaQw1wRWFJEO+XUTaeffNpF/1kuT1w5l4bCi72IVc8nD95v43Hnn7mhby62Qbc5CCyJofPkUzedkETJNdUkOQqTfjc0+PosWh+9ho3a7xQid/NBaw+67/jjo8osjILKPCHQ0kQ7+fSL3pLUkutqSfI+EszCiy/8T/WVl3/x8wPX/+pbOJRGkRtE+k9xfqYWxY85V3jgT89e/zPTD+fFR6Al99FO+shfdCeDo38V1dzliUtKOZhIt22FQnTV97615dmbtr+0ztUKhXPPOOCXOZ0QbUEEWo5oJ5164QeB0+fBqA15vOC27o5c8Yq77rz+x3l5iC8NBFqGaO8585IN1cmpL4NgJ9ZDF/08juNP37X9hm/Wy8PVUkKgJVadJ5+26dxKufJ0nmRYKY7GLvrr4qHFIwLJlhKlZq7ronq0kz9w2Zra2PgWVO2cfPUwqb+j3XVecued172Yl4f40kVg0Yj2ntM2/X4lcbfh4eN6gw9ebCCK3cV3bd9yk8nCeXkgsChD5ymnXfShSi25P08yfH7s21Gp9LZAsuVBrOmtWHCPdtL7LtqcJLW/tYpgmCzDk116151b+HA8hGWKQGGh2rV58+a4veetX8EG66VpmZH7ZVSI33v39i13pLIQWZYILBjR2np+4wvYvb8gRTGKHiu5znd/d/v1z6SyEFm2CCzIHO3EUy/8G5DsYkMRm6/fX9XZ8QdhVWmILP/zvM/RTjx903mumnzNoATJHihFB5yyffvmMZOF8/JHYF6JdtIfX7g/pvo/w/PK1YQSE/9HO+IVJ3zrW9cOL39oQwvzCMzv0DkVXZeSzEW7iu2FcwLJ8vDvO/F5Ixr2yt6FFea5OSg/9Z3bb9iRuw7RfQiBeSNarZZ8xHDE+PzDu7+95Ua7Dud9D4GmzNG2bk0K49HOjycu+kN4sSMx4e8eHxs5sJbUZPuk1N7VVywWXkX6U5in3Xv+2Qd9BTp4hh7CvoJAw0T7+m07Di3XopvwOOmdswUNTwJ+WCzEHz7vrA0vzNYm6C1tBBoaOu+/PylO1dytcyEZ4cIC4bhKtfoNeL+Gyl/a0O9btW+oo3e8/vylSeKO3BvIMG4ee+O2nR/fG9tgs/QQaIhoaO5JjTQZXys5uRH7YLt0EGiMaIn7nUaaGmHh0Ih9sF06CDRGNJesaKSpWIWubMQ+2C4dBN6w6ty8OYn7Rq87NqlOnYj32G10Sa0XX8R1eJmKE1biI7DYtpD4qrUb3o8HSxBjeo/0NDPsYajAzv6SuCANiwDRhUl5aOClO5F7lr/oMMuaz5rnmcuXogXrYJ/2zyLhh74cRtfujJLonrUrP/PQ5s34smQupNyg7JLLPn8Cvg1+HT6Y+Ju8xjYEKSSkIEFIHmQoclykcdVBus+NRAr2+zJ+7icuji/bct1n7hUi4JB+Hu2iS6+9DJ7qayDZAUowpJI44IzQRhkmjiqTG9lUh/xSb0WCBvsMJ8WR13IPprguV/zc/mjpeUcdc9LwYz+650dGBXfhpz73QTDjZm02xRo8HoaXidMzdvc9sShS75cmikQJaPnk0xgP9ssfP3Tyh770hc9+I/rEX35uZTSaPAeSrU1dGEjjR0rQQV2ZXStpxF953uRpZPG525fLk65arYK4VVcotLlisQ1nvhpEy4endZXKlC8Tb95ra68rX9P5HhfoJ5FrL5WQXw1/Zcjoo50rtpXkbDdUrVpx1RqnEomLo4IroMwqyuAclIpxVEQdODPN2qMtrG8/66x109QIrwBvQ146g9D6Ez+2UUPiimhjhBfqGuZ19ccMuL29XepfqZTlhvQVF3PaFVAGb1Sz13y1fMpqtQrKK8s5QtuKbUUpM8aU2tpfb8OrzN762/C3a9Wob7/qzGwP/b6kOzqsmIzWLkDJa+sLx5XkpSAxI513+SER11opZm4T+3zhs7dnB40M97spIRGbkYXOzi7X06ML02ql4gYG9C1CxWLRrV4N7yxBy69Wqml6Aelr2vZH55fd4KC9pSpxq1bt5wmq9Z+YnHAjI7sE3q7uHtdVWOHGJ8bc2NiI5NxNWRcX1ntu/9TkpBvc1Q89rX9cKLi1aw4QO+s84jcEnRrIz/w6O3t827T+Ndxk09tXrU7V1d/ypz3jbSBjd/cK115sZw0h0zAyMoR2jEKNZRmmidy4vStWy02Ql1Mjby9Xkp2Wo9ca11JMzvL23P9IXetGkwuKYNAZXLFoSCMmwDkvqy/AlDKNLGZpb2Y/tKsPXsTeKAXPAg+ineHQ4aNC8J6eVZKdkZ0eS+NaipSKWy6VQcA45akM8eFdg271mv3UiKk+H9VTe95gZkMILZ6VlHWczwidOg49XslB2kPvpV5XZaIr5anV+PioK5U6xXNTAy1Py5JryXDP5ZdB8PLka27lyjXwgB2Sy8Q4b5Tsc6Ux3ttleFaA8+Bgv1uzai1wzl4kldUwi2kteczLGH9j+zONLJa3h8UZRdxgh6M5ImfbxBtLZpQp13lmt3EAoovP62Q27KC52dPjVKYqkh+9wMoV62Sompgch5cblDpNAszu7gQbIBrY8djMSDvWysSrrerKF4KgYy2wNRV4CHqw7u5eXKEDfD46LCDf7I5TMxgp0Xbf/hqG3onyhOhzyKcXYpiYHAOJOLwrjsSPMeZn5Q3vGnArV63DNXHN1d9uABr4wGG9G96VerWk4iYnJsRj49INDw/Bw/M1vrGbBHYWerpXuY7OTji2xA0MvQbCYWqC+hLTjk6dltBe+3Pu/ce2zcYeN9Hh8GhuXa49YqhkUpIZMKy8QqUVYty6kYVZYHy29manNsgBGTLe3tbhVmOYI/nSNMnXl4I4iZUvn3oMog8w1U7Jo3MZpCF9bHxE7n52nAjMJmdPwlnna5w5U12VJG/EWf4kSMaOZOjo6HITGHqnpsogwrgnRtaRUinoqb3DdKEiw3RXV68lyZlzxOn1x3tIcvPSErxhtxsaeA03D+aZIBCnAR2lLt46csOw/ryRrC28iRnwwhw5T8dPhDhouXQmbB2JRCw0dab2M4U2Fma2T9YVcUdKnqasmXIyqQWonAVqVkyXuBUOeSqDylzsY0xoyS4Sk8Nn3+uvYNLahjlESbxBCelWPuvDRjOwXy1OEcvMpzPP/DV1U28D/V3ek9A2y0c7SK/Nw1i77axlSTV8+yfGOWwiI4Qi6t3WVgHRpmQiT6/T5oc0qqjXJa6xdDgXI6Ojw2hzuyw8LJ+Z6k/buj5B+aWOTjcFD81QQZm1Nl1klF1Z6jQCTzc2OiIEpXflAkNvIBg0of9YLtv15v2P1yMCQlGWMwzZGFl1Me4BNIAsYwGEwLHzG7Bn9j29mOyjplb+FFZKY+PDGA76Xf/AqyijknYQy2eYqXxI8U/T0vqLRFMK8I6cEzFwATKOeYy0K9WhnrVJB+o3az/nPOUpHTZ5g3A1yJUtEJRyxjF8MuTx4zVvrG7xYtrqkeFdmC5m9Wc6g5UvWr4veLL2R5zX+fpXahgWYdPR0S3zPtozrQY5h/GRkUEsNl4TD2r2jfbfXOxjVpzzDNaS4zcry6FAMqEMCrymnDLqSpxy6uLQiD29wMoVa1xnRy+W35jTcPmN6rAsduTQUP+08lkq0mcsP18nxKGq9Yc+atuBMpTUzo1ioaHbKVoWG5O1X2WZ/czt51xS2w8vhXnVOIZlejMuMlh/zoWq8FqGn+HKupOQbSA+7WWoxeIg1YOsHn9kyTZPw78CoKx8+Ehf/8j19q4GkVfCg3WJ5ySeZs85Kof7mfGbv/4vGrvljMbQo7JSckSEDdHgI3JiAvtMPRHjDdnjAUUJ8wvejXTDBIJLdObJeQwJJ/M1XxMhO0DPl48PUkq9+QFxehZSg/ZQk8B2RHHkukC24dEhyBLHFZq1zzqWyt5E7S0Dk0oiDvhfxrzI7Ce4R4a/DD9mhDIwfHLuRgOapubIl5P7yhTJWNMVNtJZf9Wrrz+FkkOaATxzeSotn3t30kZfRgEetruElSj0OSqMju2SfTUk44whHTd4Hr+G+o9180Bk7ZcKp/XDHE07TJsH4niPZQbseDQftZUWIurjJJnpihLTczJciWQP9mPocG4NUJN7Zp2dWFWhHHq5GHlWkD+zrsL9cz7HzUYOi5zPTWF1V4y5lmGV8KYYvxnKBnPz1bxH1i50E/KmF2kvj2PI42amJyfs2YnMS9qEPFht5qVS32bIrP0VdB49kZWfliM2REIlk1PjmEuBaCjbOoPo044HetlR4KDDPerBNOrij31Tly+vCQjOUyDoBPbKqMH2c++Q7Rkceh1nfOgBspVcUOGmi4BTW7ED9wFuBshr2HOUnBvsv7n0v3o0NgcNJDiGkO0MQMzEVC4Np4xVlf9ysVf2hbgNoIwIUKOYtFarJFlROpAeSkpB9tyhZyncK9KNSO6J9btSe6d4Lw5PXO3J/j8awVWr1kqrLvVnjUVIUq+Ep2SHsMNVU+JyTUX8Rz4TuAmMwKyLBa7uZEikHv7RG3PlaOWTJIPYTgBbHOecfNrAfSuWL2TLnds4hOKP2xKGv5DNF2b4c2uGbcaHRbFNwScawMeXT49JjNhJJB3lHAS5fdIOr0ZCTOLmsvZrXcQYWjgjzHf/Sw9K41E/jttsrDZOypeD1B3jvKXZNRNVhsruhX2BIGM1NIX9NAbeodNDZ0ePDHkkApf0HFbZyZxfcasiHwia6KNThTjsC0VXrxHnJYdQ9SS6V5fqSDpz0U7QcvIlaFwIz/kZ9RA4DDGk+CFeYLvQuQyy9YBpActJy0J7GIgf56f0UDbXZbasv7SBFUbgTVit2iMsEcmBdeko9Uic5XNUGB4ekE4kroatWeDhFcjXLXlT1kj/zcW+KM3AgQCwULZf7wqJKDC4vQ1Ucb1Qoi7jjdr39K7BXGlU7jjeqSxHhkm4fJJGVnEymdUye3vXYtI9irkNCMe7GvqyXYBVZaesuPzb4qWDsK2BYYOehm2STsaZHdgOkpfp+cwzUB9/PNHTSsu8De2t/fR03GTGk0YocpMUJ0/sPH7yrJPtQYZc5fLMYUyeNbIclCvzKtiz/iWQZQqrQ+Ipz0Cpg3+cBtjzScOcuLNdxfaStINGbBPTuY2zApjS83NDnMOptB9Tj3Zso3SAiBKQP/NheTzMd/9Hf/LRq1gMSmNnSBWkUI1RkKWxbrxW4DVOu7yOSFUR0fq02djr0t5XZBb2ApBUvDXq32j7m21PPElkQjQb/JtdvnEjnaNRkPKDpSHwO75WOZ6NNlwaZbrCPmjnZWK+l/ZGstmWT0/F8ppVvtadx8Vpf3PLZ6/xZly4/pu5/jmipTRKNTMyaVpKKYtk1GO34C9NkDyCvUEZ8CviWdnLQhBOPgQPkMXGUOIktwISyCGmMwifqMcLMYIMZ4kG+4CfEIPkEP5wqlXc+YtnH4BrPYfgWDJdrYR0YNf5j4o9kUTF4noO9gpbwE/IAccDRoijiv8FC7z4SixzZOdRx3JPHiMelTn/IYbCJE/IjFU+Q+bJuUCwF4ADfp4u8YttqzqvKLy0878H1m98Kz9ZeIwBpKzyxDLiCNM8iRgn0UhCIeK0a9EN9oLRvo6fcx9+/P6tT8uHkzrjjmvgp/hZZDovIZHxx4gk1yYkyYxMZsMzQ7AP+Hn/g73Lrz/5yB343i4/konw4IM3DYAfVzMuxMKF8EgOIpWhVmM4Uk6yWSABTdfHgz3AMUwYzcX3Cfyi6LVCZ8+lRhH9uCWuDttQ+CI48pygYySyM7XTOCJp3LIBiubtiKKl2znYZ5gQnDwuAuEyxC+KLn70vq/aN4PUo7Gt27Zt40/lfFba/QYkMmTSFZXXyW7U/IZppj89v2BviClGdsUbPPN6Sxs/PIn45pMP3bZV+16PqUfj5eMP334rPNPDusZkY/2zsJyvV8fFNELkV6BCOsS9Vwv2is0+iR9/376QbAI56kId0SQlartcCZPda+rrlT4KngGpdNMcme7JJ4QL9hnSemMqIrx5ly9++Br2p5944HY8BKgP0320pP7u0WfdAjDOqVcFOCSQoKVxDoOSQSqnRQZisM8jsPzxAw3ueeLh22d8OeMbPRqwwSdKrgSr9ENiwi1PHpzSu5G4+SFTN2mzNNXxIAf7OsyWLX5xNIJvzn8if2vl4+nbhPJC2cQ95IjVQOhoUkwoRdeFPyGXkAdxykSsczlLszPTgr1HaJnjBzJc/tgD2+5ma2cKM3o0Kna60t9jYOwXfHigN1PWyFlIRhmVkU4VHqgjMn+mPNWVBNVJZd4u2C9d/PCJ5YeeePDWG9iVuwu7JRo3cZHB1UYeZRKyAUOEFHU5qkcjyUggI42QCRdCUDMK9ssKPywcJ/D90j/H2buROmKkF7slGjUOWx99EafnuAoVEuFC52N6zZzJH1kUGJEgoVw8GyJKvmC/fPGLNj/+0LZn0eV7DCk9dqf1jmM+cDbe4LAtIxNJg0EVlvxsfxdeIiJsIuX4n+TSaDqEQoLs4QkhF6L6OMtkSrBXfFoVv1F8/5VfnGH/sR+t/9GjT/a2/9Y7f/CDzfY6KCrMGMR0xpSc8MhjznoIisfIigmYiIcDRfjikd4efEsppyvEQRoHWCEVasf0OrnXN3mwzwCsw0mHg0XFjz25a2Q47XN2JPsfYQrfq/29Rx+85cdZ7Xcfy16StXsdZFy83CWVR4Q8njKM44s34o3klJMzK75LQs4Ei8GzSuQQkbRM0Tz1WtWUdsG+NfDjt6gsTOv/f5wtyWg/4/aGZWznl5//6QsHbjziCHiot+l8jUMnigUn2vDVeyNRejbDdGICQT6uXCK71Jb6Fld8Kam3Cfb1OAs+OEzHssn4VfEtKn3dBDLGf+1/98xhG+Jzn3nmmYyFrM8ewqyIRvsNBx/5JOZqm9AuvjzVkwDviuU7Xkk66OhQmeEh5IFc0nJnIR0BUSNELMqWZPrBXqBZVPz4jl9+WVt6WPo5qmFqfvq937t1p9ZudsdZE+2lnU8P/MrBb5VNXGM2eVLEl2cxG0tLs5hNGHktBPQaKqel3CAKog2vXiZpkAmfKcunizzYC0Y4EIk6fJiAoDgrxnXpc8SvineMVDhHYh+QaFH0z/hkxpe1lNkfZzVHs+y4iYu3UXwM86c1GaH4rgS8vSdPBm9grwiQS6RnNjY/UyCYHuwNnQyTlsAvim+Iotr3o0IBC8+kFq1Znf5Ihe/mWZ3UNcxKVZWOPPasd4DXG/G1fSm4q714OTI5TuFBTG6xXIZ11wSTdwWJRR29Vm0fr9MX9Qx5rx/sFw6/Qhy9+z/uu+l+7aO9P87Jo7GYpx667XGc+CfhXcefi6f1NRCNjQdZ8McJY3adIxbEHGYx7Kdky28oB/vWw6+QdMxpLiYdP8NhzkSbngc2Ofqrss+h5GG6vHDEey0SicSiWwLl/Etk9I7U4ZL7bUwP9v7+bCX8klJpxQvaO40dGyYayILPhStTjDCsksXtrLJMjyTTpbJnWc4m2LcGfvAVr3z3u9e/8V1Z7KA5hoaJhhe+9ZFV2fQ+qwEH0Ho5SUWpBvVoKqnX0/Rgv+j4NWXYZG82TDS8JLiPm3oM9vYdGQLAKZWqnOn0btN1SD3+MUxPC/YZLowtOH74/U2tQePHxokWV/ADR1oRm4vxqTo9VLooQDrJRAKmCwGRZTrMIdgTBSDVIvjhBYA7WKNmhIaJVsUPFstbE7MRUUjGytnQaBXlHclgZ8FUD2Chpkk6ZQjB3gMmaGS4LRx+LeTRCpW2PvyIIFBQrtRD42Xq8wUu8kl0eEgvVJi/FGVTCfbASu/EFKOFwK+JQ2dsHbq35xNO+PUheB75ZQXuZIu7klsOgyfO8sfMfRpfc66eikipvrxOFOnBvrXwq1WjHXvLi+l2eptMl87x+qij3/86Hkvhh2URiBVOeufp3pl5LpGnt6Rop7rp0BnsU0xknktgPGYLjV9xRfvaR+7api//0e7a62PDczSWDA/Vhz8QDVDQxZMsBEfTNCIXGiVggibPVKfAhMFesGgB/EabRTJ2c1OI5qIaiMbsEGSI1GjKOyMSScUVKs7kYcoti9Ms2HtgFBS57xYFv+YNm+zWphANT6D8pq0SiBmTRUYkuc7LuLWRIxv1jHg8Swj2i4of+qFpe2jszyYRLemP6IlQOz72TEmDiDkoyhiEVF6BcSpTRwLiwb5V8Etaj2jY0cdeGtgiLPLEIYE4TDIYmXCmTp5Ystlr6cG+DqvFxA/f6W09ooEsmKOBVZhQyNftSBgGnGWO4edl4q7AOj/fh/tSNdVV5WCfuxEXET88WtyR652Go00ZOrEM1zf7wVXJ0Dfdc7GaRj5E6obHfFqwbxn8MEK1nkerJdV+DofkF4+6Ieu55QnGk6aLkvAu5R5EWXqwbwn8irXWIxq+SCyf4FDi4Og9GillZEqX6ZDl49S1OVuw94gtOn5RrTi18UXWplmhSUNnVfbRUgJ5dqXXJFNuPmbEYnr6aQ7y00gX7KV/UzwWGD/Mk1964ql/xY/DNy80hWj4dUs8WJfHnXU104/9ZEOmDK+eTOmna0Eqm9cZAS2TYK9IADIJC4UfuqSpwyYr3xSiTa52/cmr6obqwWARfs7FZLszhWx84K5ejFpGMpPZOdgvPH74/dod7JNmhqYQ7b/uvnv0bW//I3y2PJGf/xWSoJZKHiUgK40lM+ZsuM5EEs9fUi/Yyz25aPjhvUGt6dGEHNjiAI3WK7kyLqXzDBII//LXaudBxUU+zchXLwv2eTzmCz885WldokWJPFhfLytOIuCXkySMeCg/0ZDJv082iqVzNNvYZXqwF+AWAz98KbI1h07SopbwR8vAFFtdYuliQyDTxdMRNc7PKBBSIWYy+VwMLoI90QFOi4dflBRb16Nh/4KfSVMnJTjx68IKluCGg3DKE0qIRz3KmcBUUWCcOAf7xcKvvb1FV50kBp51ymMoIxBZY7zh2eLYBBFykWK2Ay72OGSkU4nZBPsFxW/XE0/cO8QeaGZoyqpTK5T02TNMzuqNRCSJzfLzoyPvVgYZQRkBy4K93myLiV8cNfdhOruWoWlESyLM0eDOlGAgEXlkS6TMzaW3ptDM6xgpCXOwJyj489gQU/ljbzGIXE+m00z88N6Ups/PWO2mEQ3uSD8q5MGQYdC7KIlDXrePBsCUhzqUyiMqfkYo2AuLFg2/OG5xojnM0cRzcVBUwsjNh4MNj/J1OiDIaT7RlEdMjPIKehoN9ouJX1xr/lMB9m/TPFoS4RvrSUVIJjTKzdPycw5ysG6ZwGu6Nkp9WrBXTNIhMY/lPOOHN9a2tkfDY4t+Ekg2JXLzClkAcAhlUD75uCCmcfGEmh7s/TzVY7LQ+BUKzd/aYCc3zaN1ROW+MRCKvw8gfAKPdA6GUiQOKcAjfvLJDU++9FMcNMIYG+wXF79qYX6Gzphsa0Yold6OJwMgEggkczEbCoVQJBheHp+LC/ugw59+YZAvtwT7RcUPjqFy5OEb3/Drwc3gB/1I08Khv3YU3sNRW1E/Rlr24ufsAufp10wymZ1z6mmayfaks6e0YK8IzIRRvOP//vfRQwyhZp6bNnSyUklSvQVD4zr1VlrNGB9uUq+FMTMNdKTqyVIRflkqk2W6wX4B8Yuqb/ordVl/zS32/4RO6ssQrmGBAAAAAElFTkSuQmCC alt="" class="sunl-player-poster__img">\n                    </div>\n                ',this.playerEle=a&&a.appendChild(d),Rr(!0,this.camera,{height:l,width:s,el:this.playerEle})}},{key:"_initPlayer",value:function(){if(this._initPlayerDom(),this._Player=this._getTech(),this.isLive){var e=function(){var t=!1,r="",i=function(e){var t=e.match(/[\d]+/g);return t.length=3,t.join(".")};if(navigator.plugins&&navigator.plugins.length){var e=navigator.plugins["Shockwave Flash"];e&&(t=!0,e.description&&(r=i(e.description))),navigator.plugins["Shockwave Flash 2.0"]&&(t=!0,r="2.0.0.11")}else if(navigator.mimeTypes&&navigator.mimeTypes.length){var n=navigator.mimeTypes["application/x-shockwave-flash"];(t=n&&n.enabledPlugin)&&(r=i(n.enabledPlugin.description))}else try{var a=new window.ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");t=!0,r=i(a.GetVariable("$version"))}catch(e){try{new window.ActiveXObject("ShockwaveFlash.ShockwaveFlash.6"),t=!0,r="6.0.21"}catch(e){try{var o=new window.ActiveXObject("ShockwaveFlash.ShockwaveFlash");t=!0,r=i(o.GetVariable("$version"))}catch(e){}}}return{hasFlash:t,flashVersion:r}}(),t=e.hasFlash;this.flashVersion=e.flashVersion,this._isNeedFlash=!t&&!this._isPlayHlsUrl,this._isNeedFlash&&this._setPlayerTips(!0)}this._setPlayerTips()}},{key:"_initPlayerEvts",value:function(){var e=this.camera,t=e.el,r=e.width,i=e.height,n=e.options,a=void 0===n?{}:n,o=e.swfPath,s=hr(e,["el","width","height","options","swfPath"]),l=this.isLive,u=this.debug,c=this.roomInfo,d=(c=void 0===c?{}:c).sName,h=void 0===d?"":d,f=c.sTeacher,p=void 0===f?"":f,g=this._Player,m=this._getStreamInfo(),v=m.sharedInfoArr;this._duration=m.duration,this.sunlPlayer=new g({width:r,height:i,debug:u,swfPath:o,isLive:l,options:a,el:t});var y=dr({isLive:l,type:!1,info:{title:h,teacher:p},sunlPlayer:this.sunlPlayer,duration:v.length?this._duration:0},s);this.controlBars=[{el:this.svgBoard.boardContainer,show:!0,parent:this.svgBoard,loading:!1},{el:this.playerEle,show:!1,parent:this.sunlPlayer,loading:!0}].reduce(function(e,t){var r=t.parent,i=new dm(dr({},y,t));return e.push(i),r.controlbar=i,e},[]),this._bindPlayerEvts(),this.sunlPlayer.start(),this._uploadPlayerInfo()}},{key:"_initChat",value:function(){var e=this,t=this.roomInfo,r=(t=void 0===t?{}:t).iImId,i=this.userToken,n=this.isLive;if(r){var a={liveId:r,debug:this.debug,url:Zi((n?"LIVE":"VOD")+"_CHAT_ENTRY")};if(n){if(!i)return;return this.chats=new Qa(dr({},a,{userToken:i})),this.bindAsyncEvts("chats"),void this.chats.connect(function(){e.onChatReady(e.chats)})}var o=this._getStreamInfo(),s=o.sequenceArr,l=o.sharedInfoArr,u=o.sequenceMap,c=o.sharedInfoMap,d=void 0===c?{}:c;if(s.length||l.length){var h=j._getTimeRange(s,void 0===u?{}:u),f=j._getTimeRange(l,d,!1),p=Math.min.apply(Math,cr(h).concat(cr(f))),g=Math.max.apply(Math,cr(h).concat(cr(f)));this.chats=new Qa(dr({},a,{startTime:Math.floor(p/1e3)-5,endTime:5+Math.ceil(g/1e3)})),this.bindAsyncEvts("chats"),this.onChatReady(this.chats)}}else console.error("无效的imLiveId")}},{key:"_setSource",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.url,r=e.hlsUrl,i=hr(e,["url","hlsUrl"]),n=this._isPlayHlsUrl&&r||t;if(n){this._url=t,this._isChangeUrl=!0,this.sunlPlayer&&this.sunlPlayer.setSrc(n,i);var a=i.type;a&&this._type!==a&&(this._type=a,this.svgBoard.trigger("video_type_change",a)),this.sunlPlayer&&this.sunlPlayer.trigger("update_controlbar",{isChangeUrl:this._isChangeUrl,currentTime:this._currentTime})}}},{key:"_setDuration",value:function(e){this.sunlPlayer&&this.sunlPlayer.duration(e)}},{key:"_startPlay",value:function(){var e=this._getCurrentSequenceInfo();this._setSource(e),this._reconnectPlayer()}},{key:"_reconnectPlayer",value:function(){var e=this;if(this.isLive){var t=this._getStreamInfo();clearInterval(this.connectPlayerTimer),this.connectPlayerTimer=setInterval(function(){e._reconnectCount+=1,"stop"===e.status&&e._reconnectCount<=20?(ji("info",["%c[播放器重连]: 第"+e._reconnectCount+"次","color:green"],!0),e._setSource(t)):(20<e._reconnectCount&&(ji("log",["%c播放器重连失败!","color:red"],!0),e.sunlPlayer.stop(),e._setPlayerTips(null,!0)),e._reconnectCount=0,clearInterval(e.connectPlayerTimer))},3e3)}}},{key:"_getStreamInfo",value:function(){var e=this.roomInfo.streams,t=void 0===e?[]:e;if(this.isLive){var r=this._isPlayHlsUrl?ym:_m,i=t.filter(function(e){return e.eStreamProtocol===r}),n=yr(i,1)[0];return void 0===n?{}:n}return t[0]}},{key:"_getCurrentSequenceInfo",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],r=this._getStreamInfo(),i=r.sequenceArr,n=r.sharedInfoArr,a=r.sequenceMap,o=void 0===a?{}:a,s=r.sharedInfoMap,l=void 0===s?{}:s,u=r.url,c=r.hlsUrl,d=r.type,h=r.bufferTime,f=e,p=!1,g=0,m=this._record.endTime;if(0!==f&&(void 0===m?0:m)<f+.45*this._playbackrate&&!t&&(f+=.45*this._playbackrate,p=!0),n.length){var v=t?f:f+this._trueStartTime,y=j._getArrayByValue(n,v),_=yr(y,3),b=_[0],T=_[1],S=_[2];if(b.length){var E=yr(b,1)[0],k=l[E],w=(k=void 0===k?{}:k).iDuration,C=k.iBufferTimeMs,A=void 0===C?h:C,L={url:k.url,hlsUrl:k.hlsUrl,isEnd:p,type:k.eUrlType,startTime:k.iStartTime,currentTime:v,sequence:k.lSequence+Math.round(1e3*(v-E)),duration:w,endTime:w,totalDuration:S,bufferTime:A};return this._sharedStart=E,this._record=L,this._sharedStart1=E,L}g=S,this._sharedStart=T}if(t&&(f-=g),p){var I=this._record,P=I.startTime;f=I.type!==bm?void 0===P?f:P:f}var x=0,R=!1;if(i.length){var O=o[j._getArraryValueByValue(i,f)],D=O.lSequence,M=O.iStart,N=O.iDuration;this._start!==+M&&(R=!0,this._start=+M);var F={url:u,hlsUrl:c,isEnd:p,type:1,currentTime:f,sequence:x=D+Math.round(1e3*(f-M)),duration:N,endTime:N+M,startTime:M,seeked:R,totalDuration:g,bufferTime:h};return this._record=F}return{sequence:x,seeked:R,url:u,type:d,bufferTime:h,hlsUrl:c}}},{key:"_filterStreams",value:function(){var L=this;return(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).reduce(function(e,t){var r=t.eStreamProtocol,i=t.sFormat,n=t.sHttpsUrl,a=void 0===n?t.sUrl:n,o=t.sHttpsHlsUrl,s=void 0===o?t.sHlsUrl:o,l=t.sFileName,u=t.bIsConcat,c=t.lSequence,d=void 0===c?0:c,h=t.eUrlType,f=void 0===h?bm:h,p=t.iBufferTimeMs,g=void 0===p?1800:p,m=t.sequenceInfos,v=void 0===m?[]:m,y=t.sharedPlaybackUrlInfos,_=void 0===y?[]:y,b=t.iDuration,T=void 0===b?0:b,S=!!L.isLive||"MP4"===(void 0===i?"":i).toUpperCase(),E=S?v.reduce(function(e,t){return Kt(e,Ar({},t.iStart,t)),e},{}):{},k=_.reduce(function(e,t){var r=yr(e,3),i=r[0],n=r[1],a=r[2],o=t.sFormat,s=t.iDuration,l=void 0===s?0:s,u=t.iStartTime,c=void 0===u?0:u,d=t.sHttpsUrl,h=void 0===d?t.sUrl:d,f=t.sHttpsHlsUrl,p=void 0===f?t.sHlsUrl:f;if("MP4"===(void 0===o?"":o).toUpperCase()){var g=c+n;i[g]=dr({},t,{url:h,hlsUrl:p}),a.push([g,l+g]),n+=l}return[i,n,a]},[{},0,[]]),w=yr(k,3),C=w[0],A=w[2];return(S||A.length)&&e.push({url:S?a:"",hlsUrl:S?s:"",bufferTime:g/1e3,name:l,type:f,isConcat:u,sequence:d,duration:T+w[1],sequenceMap:E,sequenceArr:Gt(E),sharedInfoMap:C,sharedInfoArr:A,eStreamProtocol:r}),e},[])}},{key:"_onRoomInfoChange",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.streams,r=void 0===t?[]:t,i=e.iImId;if(this.roomInfo=dr({},this.roomInfo,e,{streams:this._filterStreams(r)}),i&&this._initChat(),(!this._isNeedFlash||!this.isLive)&&r.length){if(this._setPlayerTips(),!this._initializedPlayer)return this._initializedPlayer=!0,this._initPlayerEvts(),void(this.isLive&&$i(4,{uri:this._url,rid:this.roomInfo.iImId,uid:this.roomInfo.iUserId,player_type:this._type}));this._startPlay()}}},{key:"_uploadPlayerInfo",value:function(){var n=this;this._uploadTimer&&clearTimeout(this._uploadTimer),this._uploadTimer=setTimeout(function(){if(!(n.isLive&&n._isNeedFlash||n.isplayReady)){var e=n.roomInfo,t=(e=void 0===e?{}:e).sName,r=n.camera,i={title:void 0===t?"":t,isLive:n.isLive,url:n._url,width:r.width,height:r.height,flashVersion:n.flashVersion,ua:navigator.userAgent,href:window.location.href};$i(3,{failMsg:Ut(i)})}},1e4)}},{key:"_bindBoardEvts",value:function(){var t=this,e=this.svgBoard;e.on("error",function(e){return t._onError(e)}),e.on("room_info_change",function(e){return t._onRoomInfoChange(e)}),e.on("kicked",function(){t.sunlPlayer&&t.sunlPlayer.stop()}),e.getPlayerStatus=function(){return!(!t.sunlPlayer||!t.sunlPlayer.paused)&&t.sunlPlayer.paused()},this.bindAsyncEvts("svgBoard"),this.onBoardReady(e)}},{key:"bindAsyncEvts",value:function(r){var i=this,e=this._events[r],n=void 0===e?{}:e;Gt(n).forEach(function(t){n[t].forEach(function(e){return i[r].on(t,e)})})}},{key:"_onPlayerReady",value:function(){this.isplayReady=!0,this._startPlay()}},{key:"_onMetaDataUpdate",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(this.isLive||!this.sunlPlayer.paused()){var r=e.user_data,i=e.currentTime;if(this.isLive||!this._isChangeUrl&&i&&!this._isSeeking||t){var n=r,a=t,o=[];if(!r){var s=this._getCurrentSequenceInfo(i),l=s.url,u=s.totalDuration,c=void 0===u?0:u,d=s.currentTime,h=void 0===d?0:d,f=s.sequence,p=s.type!==bm;this._currentTime=p?h:h+c,this._url!==l&&(this._seekedTime=p?i-this._sharedStart:h,this._trueStartTime=p?this._sharedStart:c,this._setSource(s),a=!0),n=f,o.push("总进度："+this._currentTime,p?"分享视频进度："+i:"视频进度："+h)}this.svgBoard.onPlayerMetadata({sequence:n,seeked:a}),this.sunlPlayer.trigger("time_update",{timestamp:n,duration:this._duration,currentTime:this._currentTime}),ji("log",["[序列]:"+n+", 切换："+a].concat(o),this.debug)}}}},{key:"_onPlayerStatus",value:function(e){(ji("info",["%c[播放器状态]: "+(this.status=e),"color:blue"],this.debug),"playing"===e&&this._removePlayerTips(),"stop"===e&&this.isLive)&&(this._setPlayerTips(),this._getBoardStatus()===pm?this._reconnectPlayer():this.sunlPlayer.stop())}},{key:"_onPlayerSeeked",value:function(e){if(this.svgBoard.onPlayerSeeked){var t=this._getCurrentSequenceInfo(e,!0),r=t.sequence,i=t.url,n=t.currentTime,a=t.totalDuration,o=t.type!==bm;this._seekedTime=o?n-this._sharedStart:n,this._trueStartTime=o?this._sharedStart:a,this._currentTime=e,this._url!==i?this._setSource(t):(this.sunlPlayer.currentTime(this._seekedTime),this.sunlPlayer.trigger("update_controlbar",{trueStartTime:this._trueStartTime,isChangeUrl:!1})),this.svgBoard.onPlayerSeeked({sequence:r,seeked:!0})}}},{key:"_bindPlayerEvts",value:function(){var i=this,r=this.sunlPlayer;r.on("ready",function(){i._onPlayerReady()}),r.on("metadata_update",Fi(function(e){i._onMetaDataUpdate(e)},450)),r.on("metadata_update",function(e){if(i._isEnded&&!parseInt(e.currentTime,10)&&(i._isEnded=!1,i._record={},i._start=null,i._sharedStart=0,r.trigger("update_controlbar",{trueStartTime:i._trueStartTime=0,isChangeUrl:!1}),i._onMetaDataUpdate(e,!0)),i.isLive&&i._lastMetaDataUpdate){var t=Date.now()-i._lastMetaDataUpdate;2e3<=t&&$i(1,{uri:i._url,loadTime:t,rid:i.roomInfo.iImId,uid:i.roomInfo.iUserId,failMsg:Ut({time:(new Date).toLocaleString(),ver:i._type})})}i._lastMetaDataUpdate=Date.now()}),r.on("seeking",function(){i._isSeeking=!0}),r.on("_seeked",function(){i._isSeeking=!1;var e=i._record,t=e.currentTime;r.trigger("seeked",{timestamp:e.sequence,currentTime:e.type!==bm?t:t+e.totalDuration})}),r.on("status_change",function(e){i._onPlayerStatus(e),i.isLive&&"playing"===e&&(i._lastMetaDataUpdate=null)}),r.on("progress_click",function(e){i._isEnded=!1,i._isPause=r.paused(),i._onPlayerSeeked(e)}),r.on("canplay",function(e){i._removePlayerTips()}),r.on("rate_change",function(e){i._isChangeUrl||(i._playbackrate=e)}),r.on("full",function(e){r.trigger("update_controlbar",{isChangeUrl:i._isChangeUrl=!1})}),r.on(Xi?"canplay_through":"loaded_metadata",function(e){if(i._isChangeUrl){i._isChangeUrl=!1;var t=localStorage.getItem("video_"+i.roomInfo.iRoomId);if(!i._isFirstEnter&&+t)return i._isFirstEnter=!0,void i.sunlPlayer.trigger("progress_click",+t);i._seekedTime&&(i.sunlPlayer.currentTime(i._seekedTime),i._seekedTime=0),i.sunlPlayer.playbackRate(i._playbackrate),i._isPause&&(i.sunlPlayer.pause(),i._isPause=!1),r.trigger("update_controlbar",{trueStartTime:i._trueStartTime,isChangeUrl:!1})}}),r.on("ended",function(e){var t=i._getStreamInfo(),r=i._record;t.duration<r.endTime+r.totalDuration+5?i._isEnded=!0:i.sunlPlayer.play()}),r.on("tech_change",function(e){localStorage.setItem("tech",e),window.location.reload()}),window.addEventListener("beforeunload",function(e){i.isLive||localStorage.setItem("video_"+i.roomInfo.iRoomId,i._isEnded?0:i._currentTime)}),this.bindAsyncEvts("sunlPlayer"),this.onPlayerReady(r)}},{key:"_setPlayerTips",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=1<arguments.length&&void 0!==arguments[1]&&arguments[1]?fm:this._getBoardStatus(),r=this.playerEle.querySelector(".sunl-player-poster");if(e)r.classList.add("sunl-player-poster__flash");else{var i=Sm[this.isLive?"live":"vod"],n=(i=void 0===i?{}:i)[t],a=void 0===n?"":n;t!==pm?r&&(r.querySelector(".no-stream").textContent=a,r.classList.add("sunl-player-poster__stream")):r.classList.remove("sunl-player-poster__stream")}}},{key:"_removePlayerTips",value:function(){var e=this.playerEle.querySelector(".sunl-player-poster");e&&e.classList.remove("sunl-player-poster__stream")}},{key:"_getBoardStatus",value:function(){return this.svgBoard&&this.svgBoard._getBoardStatus?this.svgBoard._getBoardStatus():fm}},{key:"_getTech",value:function(){var e="hls"===this._type,t=(this.isLive?nm:rm).supportHls();return this._isSupportHls=this.isLive&&t,this._isPlayHlsUrl=this._isSupportHls&&e,this.isLive?this._isPlayHlsUrl?nm:an:rm}},{key:"_onError",value:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).operation;e&&this.sunlPlayer&&this.isLive&&(this.sunlPlayer.stop(),3===e&&this._setPlayerTips())}},{key:"dispose",value:function(){clearInterval(this.connectPlayerTimer),clearTimeout(this._uploadTimer),this.svgBoard&&this.svgBoard.dispose(),this.sunlPlayer&&this.sunlPlayer.dispose(),this.controlBars&&this.controlBars.forEach(function(e){return e.dispose()})}},{key:"getPlayer",value:function(){return this.sunlPlayer}},{key:"getBoard",value:function(){return this.svgBoard}},{key:"onBoardReady",value:function(e){this.sketchpad.ready&&this.sketchpad.ready(e)}},{key:"onPlayerReady",value:function(e){this.camera.ready&&this.camera.ready(e)}},{key:"onChatReady",value:function(e){this.chat.ready&&this.chat.ready(e)}}],[{key:"_getArraryValueByValue",value:function(e,t,r){var i=e.concat(t).sort(function(e,t){return+e-+t}),n=i.indexOf(t);return r&&i[i.length-1]===t?null:i[n-1<=0?0:n-1]}},{key:"_getArrayByValue",value:function(e,u){return e.reduce(function(e,t){var r=yr(e,3),i=r[0],n=r[1],a=r[2],o=yr(t,2),s=o[0],l=o[1];return s<=u&&u<l&&(i=t),l<u&&(a+=l-s,n=s),[i,n,a]},[[],0,0])}},{key:"_getTimeRange",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],i=e.length;if(0===i)return[];var n=e[0],a=e[i-1<=0?0:i-1],o=t[r?n:n[0]],s=(o=void 0===o?{}:o).lSequence,l=t[r?a:a[0]],u=(l=void 0===l?{}:l).lSequence,c=l.iDuration;return[void 0===s?0:s,(void 0===u?0:u)+1e3*(void 0===c?0:c)]}}]),j}(),km=function(r){return function(e){function t(e){return _r(this,t),It(this,(t.__proto__||B(t)).call(this,dr({},e,{loginType:r})))}return Ft(t,Em),t}()};return{Live:km("live"),Replay:km("video")}});
